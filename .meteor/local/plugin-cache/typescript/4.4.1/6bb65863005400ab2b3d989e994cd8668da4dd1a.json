{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","inputSourceMap":{"version":3,"file":"ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","sourceRoot":"","sources":["ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ResponsiveLine } from '@nivo/line';\nimport { Box, Flex, Skeleton, Tile } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport moment from 'moment';\nimport React, { ReactElement, useMemo } from 'react';\n\nimport CounterSet from '../../../../../../client/components/data/CounterSet';\nimport { useTranslation } from '../../../../../../client/contexts/TranslationContext';\nimport { useFormatDate } from '../../../../../../client/hooks/useFormatDate';\nimport Section from '../Section';\nimport DownloadDataButton from '../data/DownloadDataButton';\nimport LegendSymbol from '../data/LegendSymbol';\nimport { useActiveUsers } from './useActiveUsers';\n\ntype ActiveUsersSectionProps = {\n\ttimezone: 'utc' | 'local';\n};\n\nconst ActiveUsersSection = ({ timezone }: ActiveUsersSectionProps): ReactElement => {\n\tconst utc = timezone === 'utc';\n\tconst { data } = useActiveUsers({ utc });\n\n\tconst [\n\t\tcountDailyActiveUsers,\n\t\tdiffDailyActiveUsers,\n\t\tcountWeeklyActiveUsers,\n\t\tdiffWeeklyActiveUsers,\n\t\tcountMonthlyActiveUsers,\n\t\tdiffMonthlyActiveUsers,\n\t\tdauValues = [],\n\t\twauValues = [],\n\t\tmauValues = [],\n\t] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst createPoint = (i: number): { x: Date; y: number } => ({\n\t\t\tx: moment(data.start).add(i, 'days').toDate(),\n\t\t\ty: 0,\n\t\t});\n\n\t\tconst createPoints = (): { x: Date; y: number }[] =>\n\t\t\tArray.from({ length: moment(data.end).diff(data.start, 'days') + 1 }, (_, i) => createPoint(i));\n\n\t\tconst dauValues = createPoints();\n\t\tconst prevDauValue = createPoint(-1);\n\t\tconst wauValues = createPoints();\n\t\tconst prevWauValue = createPoint(-1);\n\t\tconst mauValues = createPoints();\n\t\tconst prevMauValue = createPoint(-1);\n\n\t\tconst usersListsMap = data.month.reduce<{ [x: number]: string[] }>((map, dayData) => {\n\t\t\tconst date = utc\n\t\t\t\t? moment.utc({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day')\n\t\t\t\t: moment({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day');\n\t\t\tconst dateOffset = date.diff(data.start, 'days');\n\t\t\tif (dateOffset >= 0) {\n\t\t\t\tmap[dateOffset] = dayData.usersList;\n\t\t\t\tdauValues[dateOffset].y = dayData.users;\n\t\t\t}\n\t\t\treturn map;\n\t\t}, {});\n\n\t\tconst distributeValueOverPoints = (\n\t\t\tusersListsMap: { [x: number]: string[] },\n\t\t\tdateOffset: number,\n\t\t\tT: number,\n\t\t\tarray: { x: Date; y: number }[],\n\t\t): void => {\n\t\t\tconst usersSet = new Set();\n\t\t\tfor (let k = dateOffset; T > 0; k--, T--) {\n\t\t\t\tif (usersListsMap[k]) {\n\t\t\t\t\tusersListsMap[k].forEach((userId) => usersSet.add(userId));\n\t\t\t\t}\n\t\t\t}\n\t\t\tarray[dateOffset].y = usersSet.size;\n\t\t};\n\n\t\tfor (let i = 0; i < 30; i++) {\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 7, wauValues);\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 30, mauValues);\n\t\t}\n\t\tprevWauValue.y = wauValues[28].y;\n\t\tprevMauValue.y = mauValues[28].y;\n\t\tprevDauValue.y = dauValues[28].y;\n\n\t\treturn [\n\t\t\tdauValues[dauValues.length - 1].y,\n\t\t\tdauValues[dauValues.length - 1].y - prevDauValue.y,\n\t\t\twauValues[wauValues.length - 1].y,\n\t\t\twauValues[wauValues.length - 1].y - prevWauValue.y,\n\t\t\tmauValues[mauValues.length - 1].y,\n\t\t\tmauValues[mauValues.length - 1].y - prevMauValue.y,\n\t\t\tdauValues,\n\t\t\twauValues,\n\t\t\tmauValues,\n\t\t];\n\t}, [data, utc]);\n\n\tconst formatDate = useFormatDate();\n\tconst t = useTranslation();\n\n\treturn (\n\t\t<Section\n\t\t\ttitle={t('Active_users')}\n\t\t\tfilter={\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`ActiveUsersSection_start_${data?.start}_end_${data?.end}`}\n\t\t\t\t\theaders={['Date', 'DAU', 'WAU', 'MAU']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => {\n\t\t\t\t\t\tconst values = [];\n\n\t\t\t\t\t\tfor (let i = 0; i < 30; i++) {\n\t\t\t\t\t\t\tvalues.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t}\n\t\t>\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countDailyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffDailyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b200} /> {t('Daily_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countWeeklyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffWeeklyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b300} /> {t('Weekly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countMonthlyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffMonthlyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b500} /> {t('Monthly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{data ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveLine\n\t\t\t\t\t\t\t\t\t\tdata={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'dau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: dauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'wau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: wauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'mau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: mauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\txScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'time',\n\t\t\t\t\t\t\t\t\t\t\tformat: 'native',\n\t\t\t\t\t\t\t\t\t\t\tprecision: 'day',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\txFormat='time:%Y-%m-%d'\n\t\t\t\t\t\t\t\t\t\tyScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\t\t\tstacked: true,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableGridX={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\tenablePoints={false}\n\t\t\t\t\t\t\t\t\t\tuseMesh\n\t\t\t\t\t\t\t\t\t\tenableArea\n\t\t\t\t\t\t\t\t\t\tareaOpacity={1}\n\t\t\t\t\t\t\t\t\t\tenableCrosshair\n\t\t\t\t\t\t\t\t\t\tcrosshairType='bottom'\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\t\t\t\tleft: 40,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[colors.b200, colors.b300, colors.b500]}\n\t\t\t\t\t\t\t\t\t\taxisLeft={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 3,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\taxisBottom={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 'every 3 days',\n\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format(dauValues.length === 7 ? 'dddd' : 'L'),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionStiffness={90}\n\t\t\t\t\t\t\t\t\t\tmotionDamping={15}\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: '#9EA2A8',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\t\t\t\t\tcontainer: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#1F2329',\n\t\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: 2,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableSlices='x'\n\t\t\t\t\t\t\t\t\t\tsliceTooltip={({ slice: { points } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<Tile elevation='2'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>{formatDate(points[0].data.x)}</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{points.map(({ serieId, data: { y: activeUsers } }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box key={serieId} fontScale='p1m'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(serieId === 'dau' && t('DAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'wau' && t('WAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'mau' && t('MAU_value', { value: activeUsers }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t</Tile>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</Section>\n\t);\n};\n\nexport default ActiveUsersSection;\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx"}},"code":"let ResponsiveLine;\nmodule.link(\"@nivo/line\", {\n  ResponsiveLine(v) {\n    ResponsiveLine = v;\n  }\n\n}, 0);\nlet Box, Flex, Skeleton, Tile;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  },\n\n  Flex(v) {\n    Flex = v;\n  },\n\n  Skeleton(v) {\n    Skeleton = v;\n  },\n\n  Tile(v) {\n    Tile = v;\n  }\n\n}, 1);\nlet colors;\nmodule.link(\"@rocket.chat/fuselage-tokens/colors.json\", {\n  default(v) {\n    colors = v;\n  }\n\n}, 2);\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n\n}, 3);\nlet React, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  }\n\n}, 4);\nlet CounterSet;\nmodule.link(\"../../../../../../client/components/data/CounterSet\", {\n  default(v) {\n    CounterSet = v;\n  }\n\n}, 5);\nlet useTranslation;\nmodule.link(\"../../../../../../client/contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 6);\nlet useFormatDate;\nmodule.link(\"../../../../../../client/hooks/useFormatDate\", {\n  useFormatDate(v) {\n    useFormatDate = v;\n  }\n\n}, 7);\nlet Section;\nmodule.link(\"../Section\", {\n  default(v) {\n    Section = v;\n  }\n\n}, 8);\nlet DownloadDataButton;\nmodule.link(\"../data/DownloadDataButton\", {\n  default(v) {\n    DownloadDataButton = v;\n  }\n\n}, 9);\nlet LegendSymbol;\nmodule.link(\"../data/LegendSymbol\", {\n  default(v) {\n    LegendSymbol = v;\n  }\n\n}, 10);\nlet useActiveUsers;\nmodule.link(\"./useActiveUsers\", {\n  useActiveUsers(v) {\n    useActiveUsers = v;\n  }\n\n}, 11);\n\nconst ActiveUsersSection = _ref => {\n  let {\n    timezone\n  } = _ref;\n  const utc = timezone === 'utc';\n  const {\n    data\n  } = useActiveUsers({\n    utc\n  });\n  const [countDailyActiveUsers, diffDailyActiveUsers, countWeeklyActiveUsers, diffWeeklyActiveUsers, countMonthlyActiveUsers, diffMonthlyActiveUsers, dauValues = [], wauValues = [], mauValues = []] = useMemo(() => {\n    if (!data) {\n      return [];\n    }\n\n    const createPoint = i => ({\n      x: moment(data.start).add(i, 'days').toDate(),\n      y: 0\n    });\n\n    const createPoints = () => Array.from({\n      length: moment(data.end).diff(data.start, 'days') + 1\n    }, (_, i) => createPoint(i));\n\n    const dauValues = createPoints();\n    const prevDauValue = createPoint(-1);\n    const wauValues = createPoints();\n    const prevWauValue = createPoint(-1);\n    const mauValues = createPoints();\n    const prevMauValue = createPoint(-1);\n    const usersListsMap = data.month.reduce((map, dayData) => {\n      const date = utc ? moment.utc({\n        year: dayData.year,\n        month: dayData.month - 1,\n        day: dayData.day\n      }).endOf('day') : moment({\n        year: dayData.year,\n        month: dayData.month - 1,\n        day: dayData.day\n      }).endOf('day');\n      const dateOffset = date.diff(data.start, 'days');\n\n      if (dateOffset >= 0) {\n        map[dateOffset] = dayData.usersList;\n        dauValues[dateOffset].y = dayData.users;\n      }\n\n      return map;\n    }, {});\n\n    const distributeValueOverPoints = (usersListsMap, dateOffset, T, array) => {\n      const usersSet = new Set();\n\n      for (let k = dateOffset; T > 0; k--, T--) {\n        if (usersListsMap[k]) {\n          usersListsMap[k].forEach(userId => usersSet.add(userId));\n        }\n      }\n\n      array[dateOffset].y = usersSet.size;\n    };\n\n    for (let i = 0; i < 30; i++) {\n      distributeValueOverPoints(usersListsMap, i, 7, wauValues);\n      distributeValueOverPoints(usersListsMap, i, 30, mauValues);\n    }\n\n    prevWauValue.y = wauValues[28].y;\n    prevMauValue.y = mauValues[28].y;\n    prevDauValue.y = dauValues[28].y;\n    return [dauValues[dauValues.length - 1].y, dauValues[dauValues.length - 1].y - prevDauValue.y, wauValues[wauValues.length - 1].y, wauValues[wauValues.length - 1].y - prevWauValue.y, mauValues[mauValues.length - 1].y, mauValues[mauValues.length - 1].y - prevMauValue.y, dauValues, wauValues, mauValues];\n  }, [data, utc]);\n  const formatDate = useFormatDate();\n  const t = useTranslation();\n  return /*#__PURE__*/React.createElement(Section, {\n    title: t('Active_users'),\n    filter: /*#__PURE__*/React.createElement(DownloadDataButton, {\n      attachmentName: \"ActiveUsersSection_start_\".concat(data === null || data === void 0 ? void 0 : data.start, \"_end_\").concat(data === null || data === void 0 ? void 0 : data.end),\n      headers: ['Date', 'DAU', 'WAU', 'MAU'],\n      dataAvailable: !!data,\n      dataExtractor: () => {\n        const values = [];\n\n        for (let i = 0; i < 30; i++) {\n          values.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n        }\n\n        return values;\n      }\n    })\n  }, /*#__PURE__*/React.createElement(CounterSet, {\n    counters: [{\n      count: countDailyActiveUsers !== null && countDailyActiveUsers !== void 0 ? countDailyActiveUsers : /*#__PURE__*/React.createElement(Skeleton, {\n        variant: \"rect\",\n        width: \"3ex\",\n        height: \"1em\"\n      }),\n      variation: diffDailyActiveUsers !== null && diffDailyActiveUsers !== void 0 ? diffDailyActiveUsers : 0,\n      description: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(LegendSymbol, {\n        color: colors.b200\n      }), \" \", t('Daily_Active_Users'))\n    }, {\n      count: countWeeklyActiveUsers !== null && countWeeklyActiveUsers !== void 0 ? countWeeklyActiveUsers : /*#__PURE__*/React.createElement(Skeleton, {\n        variant: \"rect\",\n        width: \"3ex\",\n        height: \"1em\"\n      }),\n      variation: diffWeeklyActiveUsers !== null && diffWeeklyActiveUsers !== void 0 ? diffWeeklyActiveUsers : 0,\n      description: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(LegendSymbol, {\n        color: colors.b300\n      }), \" \", t('Weekly_Active_Users'))\n    }, {\n      count: countMonthlyActiveUsers !== null && countMonthlyActiveUsers !== void 0 ? countMonthlyActiveUsers : /*#__PURE__*/React.createElement(Skeleton, {\n        variant: \"rect\",\n        width: \"3ex\",\n        height: \"1em\"\n      }),\n      variation: diffMonthlyActiveUsers !== null && diffMonthlyActiveUsers !== void 0 ? diffMonthlyActiveUsers : 0,\n      description: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(LegendSymbol, {\n        color: colors.b500\n      }), \" \", t('Monthly_Active_Users'))\n    }]\n  }), /*#__PURE__*/React.createElement(Flex.Container, null, data ? /*#__PURE__*/React.createElement(Box, {\n    style: {\n      height: 240\n    }\n  }, /*#__PURE__*/React.createElement(Flex.Item, {\n    align: \"stretch\",\n    grow: 1,\n    shrink: 0\n  }, /*#__PURE__*/React.createElement(Box, {\n    style: {\n      position: 'relative'\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    style: {\n      position: 'absolute',\n      width: '100%',\n      height: '100%'\n    }\n  }, /*#__PURE__*/React.createElement(ResponsiveLine, {\n    data: [{\n      id: 'dau',\n      data: dauValues\n    }, {\n      id: 'wau',\n      data: wauValues\n    }, {\n      id: 'mau',\n      data: mauValues\n    }],\n    xScale: {\n      type: 'time',\n      format: 'native',\n      precision: 'day'\n    },\n    xFormat: \"time:%Y-%m-%d\",\n    yScale: {\n      type: 'linear',\n      stacked: true\n    },\n    enableGridX: false,\n    enableGridY: false,\n    enablePoints: false,\n    useMesh: true,\n    enableArea: true,\n    areaOpacity: 1,\n    enableCrosshair: true,\n    crosshairType: \"bottom\",\n    margin: {\n      // TODO: Get it from theme\n      top: 0,\n      bottom: 20,\n      right: 0,\n      left: 40\n    },\n    colors: [colors.b200, colors.b300, colors.b500],\n    axisLeft: {\n      // TODO: Get it from theme\n      tickSize: 0,\n      tickPadding: 4,\n      tickRotation: 0,\n      tickValues: 3\n    },\n    axisBottom: {\n      // TODO: Get it from theme\n      tickSize: 0,\n      tickPadding: 4,\n      tickRotation: 0,\n      tickValues: 'every 3 days',\n      format: date => moment(date).format(dauValues.length === 7 ? 'dddd' : 'L')\n    },\n    animate: true,\n    motionStiffness: 90,\n    motionDamping: 15,\n    theme: {\n      // TODO: Get it from theme\n      axis: {\n        ticks: {\n          text: {\n            fill: '#9EA2A8',\n            fontFamily: 'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n            fontSize: '10px',\n            fontStyle: 'normal',\n            fontWeight: 600,\n            letterSpacing: '0.2px',\n            lineHeight: '12px'\n          }\n        }\n      },\n      tooltip: {\n        container: {\n          backgroundColor: '#1F2329',\n          boxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n          borderRadius: 2\n        }\n      }\n    },\n    enableSlices: \"x\",\n    sliceTooltip: _ref2 => {\n      let {\n        slice: {\n          points\n        }\n      } = _ref2;\n      return /*#__PURE__*/React.createElement(Tile, {\n        elevation: \"2\"\n      }, /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Box, null, formatDate(points[0].data.x)), points.map(_ref3 => {\n        let {\n          serieId,\n          data: {\n            y: activeUsers\n          }\n        } = _ref3;\n        return /*#__PURE__*/React.createElement(Box, {\n          key: serieId,\n          fontScale: \"p1m\"\n        }, /*#__PURE__*/React.createElement(Box, null, serieId === 'dau' && t('DAU_value', {\n          value: activeUsers\n        }) || serieId === 'wau' && t('WAU_value', {\n          value: activeUsers\n        }) || serieId === 'mau' && t('MAU_value', {\n          value: activeUsers\n        })));\n      })));\n    }\n  }))))) : /*#__PURE__*/React.createElement(Skeleton, {\n    variant: \"rect\",\n    height: 240\n  })));\n};\n\nmodule.exportDefault(ActiveUsersSection);","map":{"version":3,"sources":["ee/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ResponsiveLine } from '@nivo/line';\nimport { Box, Flex, Skeleton, Tile } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport moment from 'moment';\nimport React, { ReactElement, useMemo } from 'react';\n\nimport CounterSet from '../../../../../../client/components/data/CounterSet';\nimport { useTranslation } from '../../../../../../client/contexts/TranslationContext';\nimport { useFormatDate } from '../../../../../../client/hooks/useFormatDate';\nimport Section from '../Section';\nimport DownloadDataButton from '../data/DownloadDataButton';\nimport LegendSymbol from '../data/LegendSymbol';\nimport { useActiveUsers } from './useActiveUsers';\n\ntype ActiveUsersSectionProps = {\n\ttimezone: 'utc' | 'local';\n};\n\nconst ActiveUsersSection = ({ timezone }: ActiveUsersSectionProps): ReactElement => {\n\tconst utc = timezone === 'utc';\n\tconst { data } = useActiveUsers({ utc });\n\n\tconst [\n\t\tcountDailyActiveUsers,\n\t\tdiffDailyActiveUsers,\n\t\tcountWeeklyActiveUsers,\n\t\tdiffWeeklyActiveUsers,\n\t\tcountMonthlyActiveUsers,\n\t\tdiffMonthlyActiveUsers,\n\t\tdauValues = [],\n\t\twauValues = [],\n\t\tmauValues = [],\n\t] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst createPoint = (i: number): { x: Date; y: number } => ({\n\t\t\tx: moment(data.start).add(i, 'days').toDate(),\n\t\t\ty: 0,\n\t\t});\n\n\t\tconst createPoints = (): { x: Date; y: number }[] =>\n\t\t\tArray.from({ length: moment(data.end).diff(data.start, 'days') + 1 }, (_, i) => createPoint(i));\n\n\t\tconst dauValues = createPoints();\n\t\tconst prevDauValue = createPoint(-1);\n\t\tconst wauValues = createPoints();\n\t\tconst prevWauValue = createPoint(-1);\n\t\tconst mauValues = createPoints();\n\t\tconst prevMauValue = createPoint(-1);\n\n\t\tconst usersListsMap = data.month.reduce<{ [x: number]: string[] }>((map, dayData) => {\n\t\t\tconst date = utc\n\t\t\t\t? moment.utc({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day')\n\t\t\t\t: moment({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day');\n\t\t\tconst dateOffset = date.diff(data.start, 'days');\n\t\t\tif (dateOffset >= 0) {\n\t\t\t\tmap[dateOffset] = dayData.usersList;\n\t\t\t\tdauValues[dateOffset].y = dayData.users;\n\t\t\t}\n\t\t\treturn map;\n\t\t}, {});\n\n\t\tconst distributeValueOverPoints = (\n\t\t\tusersListsMap: { [x: number]: string[] },\n\t\t\tdateOffset: number,\n\t\t\tT: number,\n\t\t\tarray: { x: Date; y: number }[],\n\t\t): void => {\n\t\t\tconst usersSet = new Set();\n\t\t\tfor (let k = dateOffset; T > 0; k--, T--) {\n\t\t\t\tif (usersListsMap[k]) {\n\t\t\t\t\tusersListsMap[k].forEach((userId) => usersSet.add(userId));\n\t\t\t\t}\n\t\t\t}\n\t\t\tarray[dateOffset].y = usersSet.size;\n\t\t};\n\n\t\tfor (let i = 0; i < 30; i++) {\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 7, wauValues);\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 30, mauValues);\n\t\t}\n\t\tprevWauValue.y = wauValues[28].y;\n\t\tprevMauValue.y = mauValues[28].y;\n\t\tprevDauValue.y = dauValues[28].y;\n\n\t\treturn [\n\t\t\tdauValues[dauValues.length - 1].y,\n\t\t\tdauValues[dauValues.length - 1].y - prevDauValue.y,\n\t\t\twauValues[wauValues.length - 1].y,\n\t\t\twauValues[wauValues.length - 1].y - prevWauValue.y,\n\t\t\tmauValues[mauValues.length - 1].y,\n\t\t\tmauValues[mauValues.length - 1].y - prevMauValue.y,\n\t\t\tdauValues,\n\t\t\twauValues,\n\t\t\tmauValues,\n\t\t];\n\t}, [data, utc]);\n\n\tconst formatDate = useFormatDate();\n\tconst t = useTranslation();\n\n\treturn (\n\t\t<Section\n\t\t\ttitle={t('Active_users')}\n\t\t\tfilter={\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`ActiveUsersSection_start_${data?.start}_end_${data?.end}`}\n\t\t\t\t\theaders={['Date', 'DAU', 'WAU', 'MAU']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => {\n\t\t\t\t\t\tconst values = [];\n\n\t\t\t\t\t\tfor (let i = 0; i < 30; i++) {\n\t\t\t\t\t\t\tvalues.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t}\n\t\t>\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countDailyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffDailyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b200} /> {t('Daily_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countWeeklyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffWeeklyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b300} /> {t('Weekly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countMonthlyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffMonthlyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b500} /> {t('Monthly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{data ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveLine\n\t\t\t\t\t\t\t\t\t\tdata={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'dau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: dauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'wau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: wauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'mau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: mauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\txScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'time',\n\t\t\t\t\t\t\t\t\t\t\tformat: 'native',\n\t\t\t\t\t\t\t\t\t\t\tprecision: 'day',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\txFormat='time:%Y-%m-%d'\n\t\t\t\t\t\t\t\t\t\tyScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\t\t\tstacked: true,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableGridX={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\tenablePoints={false}\n\t\t\t\t\t\t\t\t\t\tuseMesh\n\t\t\t\t\t\t\t\t\t\tenableArea\n\t\t\t\t\t\t\t\t\t\tareaOpacity={1}\n\t\t\t\t\t\t\t\t\t\tenableCrosshair\n\t\t\t\t\t\t\t\t\t\tcrosshairType='bottom'\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\t\t\t\tleft: 40,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[colors.b200, colors.b300, colors.b500]}\n\t\t\t\t\t\t\t\t\t\taxisLeft={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 3,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\taxisBottom={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 'every 3 days',\n\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format(dauValues.length === 7 ? 'dddd' : 'L'),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionStiffness={90}\n\t\t\t\t\t\t\t\t\t\tmotionDamping={15}\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: '#9EA2A8',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\t\t\t\t\tcontainer: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#1F2329',\n\t\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: 2,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableSlices='x'\n\t\t\t\t\t\t\t\t\t\tsliceTooltip={({ slice: { points } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<Tile elevation='2'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>{formatDate(points[0].data.x)}</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{points.map(({ serieId, data: { y: activeUsers } }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box key={serieId} fontScale='p1m'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(serieId === 'dau' && t('DAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'wau' && t('WAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'mau' && t('MAU_value', { value: activeUsers }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t</Tile>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</Section>\n\t);\n};\n\nexport default ActiveUsersSection;\n"],"sourceRoot":""},"sourceType":"module","hash":"6bb65863005400ab2b3d989e994cd8668da4dd1a"}
