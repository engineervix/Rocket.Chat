{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx","sourceRoot":"","sources":["client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Button, ButtonGroup, Field, FieldGroup, Modal, Select, SelectOption, Tabs, TextInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { parse as parseDomain, ParsedDomain } from 'psl';\nimport React, { FC, ReactElement, useCallback, useState } from 'react';\n\nimport { useSetting, useSettingSetValue } from '../../../../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../../../../contexts/TranslationContext';\nimport { useForm } from '../../../../../../hooks/useForm';\nimport { DNSRecords } from './DNSRecords';\nimport InviteUsers from './InviteUsers';\nimport { DNSRecordName, ResolvedDNS, TXTRecordValue } from './Types';\n\nexport const FederationModal: FC<{ onClose: () => void }> = ({ onClose, ...props }): ReactElement => {\n\tconst t = useTranslation();\n\n\t// State\n\tconst [currentStep, setCurrentStep] = useState(1);\n\tconst [currentTab, setCurrentTab] = useState(1);\n\n\t// Settings\n\tconst siteUrl = useSetting('Site_Url') as string;\n\tconst { protocol, hostname: rocketChatDomain, port: rocketChatPort } = new URL(siteUrl);\n\tconst rocketChatProtocol = protocol.slice(0, -1);\n\n\tconst federationDomain = useSetting('FEDERATION_Domain') as string;\n\tconst setFederationDomain = useSettingSetValue('FEDERATION_Domain');\n\n\tlet federationSubdomain = '';\n\tconst parsedDomain = parseDomain(federationDomain);\n\tif ((parsedDomain as ParsedDomain)?.subdomain) {\n\t\tfederationSubdomain = (parsedDomain as ParsedDomain).subdomain || '';\n\t}\n\n\tconst federationDiscoveryMethod = useSetting('FEDERATION_Discovery_Method') as string;\n\tconst setFederationDiscoveryMethod = useSettingSetValue('FEDERATION_Discovery_Method');\n\n\tconst federationPublicKey = useSetting('FEDERATION_Public_Key') as string;\n\n\t// Form\n\tconst discoveryOptions: SelectOption[] = [\n\t\t['dns', 'DNS (recommended)'],\n\t\t['hub', 'HUB'],\n\t];\n\n\tconst initialValues = {\n\t\tdomain: federationDomain,\n\t\tdiscoveryMethod: federationDiscoveryMethod,\n\t};\n\tconst { values, handlers, hasUnsavedChanges, commit } = useForm(initialValues);\n\n\tconst { domain, discoveryMethod } = values as { domain: string; discoveryMethod: string };\n\tconst { handleDomain, handleDiscoveryMethod } = handlers;\n\n\tconst onChangeDomain = useMutableCallback((value) => {\n\t\thandleDomain(value);\n\t});\n\n\tconst onChangeDiscoveryMethod = useMutableCallback((value) => {\n\t\thandleDiscoveryMethod(value);\n\t});\n\n\t// Wizard\n\tconst nextStep = useCallback(() => {\n\t\tif (currentStep === 1 && hasUnsavedChanges) {\n\t\t\tsetFederationDomain(domain);\n\t\t\tsetFederationDiscoveryMethod(discoveryMethod);\n\t\t\tcommit();\n\t\t}\n\n\t\tif (currentStep === 3) {\n\t\t\tonClose();\n\t\t} else {\n\t\t\tsetCurrentStep(currentStep + 1);\n\t\t}\n\t}, [currentStep, hasUnsavedChanges, domain, discoveryMethod, commit, onClose, setFederationDomain, setFederationDiscoveryMethod]);\n\n\tconst previousStep = useCallback(() => {\n\t\tif (currentStep === 1) {\n\t\t\tonClose();\n\t\t} else {\n\t\t\tsetCurrentStep(currentStep - 1);\n\t\t}\n\t}, [currentStep, onClose]);\n\n\t// Resolve DNS\n\tconst resolvedSRVString = useSetting('FEDERATION_ResolvedSRV') as string;\n\tconst resolvedSRV: Record<DNSRecordName, string | number> = JSON.parse(resolvedSRVString || '{}');\n\n\tconst resolvedPublicKeyTXT = useSetting('FEDERATION_ResolvedPublicKeyTXT') as string;\n\tconst resolvedProtocolTXT = useSetting('FEDERATION_ResolvedProtocolTXT') as string;\n\n\tconst resolvedDNS: ResolvedDNS = {\n\t\tsrv: resolvedSRV,\n\t\ttxt: {\n\t\t\t[TXTRecordValue.PUBLIC_KEY]: resolvedPublicKeyTXT,\n\t\t\t[TXTRecordValue.PROTOCOL]: resolvedProtocolTXT,\n\t\t},\n\t};\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t{currentStep === 1 && (\n\t\t\t\t<>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title>{t('Federation')}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Federation_Domain')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Description>{t('Federation_Domain_details')}</Field.Description>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<TextInput placeholder='rocket.chat' value={domain} onChange={onChangeDomain} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Federation_Discovery_method')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Description>{t('Federation_Discovery_method_details')}</Field.Description>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<Select width='250px' value={discoveryMethod || 'dns'} options={discoveryOptions} onChange={onChangeDiscoveryMethod} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t</FieldGroup>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{currentStep === 2 && (\n\t\t\t\t<>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title>{t('Federation_Adding_to_your_server')}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<Tabs mi='neg-x24'>\n\t\t\t\t\t\t\t<Tabs.Item selected={currentTab === 1} onClick={(): void => setCurrentTab(1)}>\n\t\t\t\t\t\t\t\t{t('Federation_Configure_DNS')}\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item selected={currentTab === 2} onClick={(): void => setCurrentTab(2)}>\n\t\t\t\t\t\t\t\t{t('Federation_Legacy_support')}\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t\t<Box mbs='x24'>\n\t\t\t\t\t\t\t{currentTab === 1 && (\n\t\t\t\t\t\t\t\t<DNSRecords\n\t\t\t\t\t\t\t\t\tfederationSubdomain={federationSubdomain}\n\t\t\t\t\t\t\t\t\tfederationPublicKey={federationPublicKey}\n\t\t\t\t\t\t\t\t\trocketChatProtocol={rocketChatProtocol}\n\t\t\t\t\t\t\t\t\trocketChatDomain={rocketChatDomain}\n\t\t\t\t\t\t\t\t\trocketChatPort={rocketChatPort}\n\t\t\t\t\t\t\t\t\tresolvedEntries={resolvedDNS}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{currentTab === 2 && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<Box mbe='x16'>\n\t\t\t\t\t\t\t\t\t\t<Box is='p' fontWeight='c2' fontSize='p2'>\n\t\t\t\t\t\t\t\t\t\t\t{t('Federation_SRV_no_support')}\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t<Box is='p' mbs='x8' fontSize='x12'>\n\t\t\t\t\t\t\t\t\t\t\t{t('Federation_SRV_no_support_details')}\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t<DNSRecords\n\t\t\t\t\t\t\t\t\t\tfederationSubdomain={federationSubdomain}\n\t\t\t\t\t\t\t\t\t\tfederationPublicKey={federationPublicKey}\n\t\t\t\t\t\t\t\t\t\trocketChatProtocol={rocketChatProtocol}\n\t\t\t\t\t\t\t\t\t\trocketChatDomain={rocketChatDomain}\n\t\t\t\t\t\t\t\t\t\trocketChatPort={rocketChatPort}\n\t\t\t\t\t\t\t\t\t\tresolvedEntries={resolvedDNS}\n\t\t\t\t\t\t\t\t\t\tlegacy={true}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{currentStep === 3 && (\n\t\t\t\t<>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title>{t('Federation_Adding_users_from_another_server')}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<InviteUsers onClose={onClose} />\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t<Modal.Footer>\n\t\t\t\t{currentStep === 2 && (\n\t\t\t\t\t<Box mbs='x8' color='hint' fontSize='x12' position='absolute'>\n\t\t\t\t\t\t{t('Federation_DNS_info_update')}\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={previousStep}>{currentStep === 1 ? t('Cancel') : t('Back')}</Button>\n\t\t\t\t\t<Button primary onClick={nextStep}>\n\t\t\t\t\t\t{currentStep === 3 ? t('Finish') : t('Next')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx"}},"code":"var _excluded = [\"onClose\"];\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\n\nvar _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default: function (v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nmodule.export({\n  FederationModal: function () {\n    return FederationModal;\n  }\n});\nvar Box, Button, ButtonGroup, Field, FieldGroup, Modal, Select, Tabs, TextInput;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  FieldGroup: function (v) {\n    FieldGroup = v;\n  },\n  Modal: function (v) {\n    Modal = v;\n  },\n  Select: function (v) {\n    Select = v;\n  },\n  Tabs: function (v) {\n    Tabs = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar parseDomain;\nmodule.link(\"psl\", {\n  parse: function (v) {\n    parseDomain = v;\n  }\n}, 2);\nvar React, useCallback, useState;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useState: function (v) {\n    useState = v;\n  }\n}, 3);\nvar useSetting, useSettingSetValue;\nmodule.link(\"../../../../../../contexts/SettingsContext\", {\n  useSetting: function (v) {\n    useSetting = v;\n  },\n  useSettingSetValue: function (v) {\n    useSettingSetValue = v;\n  }\n}, 4);\nvar useTranslation;\nmodule.link(\"../../../../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 5);\nvar useForm;\nmodule.link(\"../../../../../../hooks/useForm\", {\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 6);\nvar DNSRecords;\nmodule.link(\"./DNSRecords\", {\n  DNSRecords: function (v) {\n    DNSRecords = v;\n  }\n}, 7);\nvar InviteUsers;\nmodule.link(\"./InviteUsers\", {\n  \"default\": function (v) {\n    InviteUsers = v;\n  }\n}, 8);\nvar TXTRecordValue;\nmodule.link(\"./Types\", {\n  TXTRecordValue: function (v) {\n    TXTRecordValue = v;\n  }\n}, 9);\n\nvar FederationModal = function (_ref) {\n  var _txt;\n\n  var onClose = _ref.onClose,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  var t = useTranslation(); // State\n\n  var _useState = useState(1),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentStep = _useState2[0],\n      setCurrentStep = _useState2[1];\n\n  var _useState3 = useState(1),\n      _useState4 = _slicedToArray(_useState3, 2),\n      currentTab = _useState4[0],\n      setCurrentTab = _useState4[1]; // Settings\n\n\n  var siteUrl = useSetting('Site_Url');\n\n  var _URL = new URL(siteUrl),\n      protocol = _URL.protocol,\n      rocketChatDomain = _URL.hostname,\n      rocketChatPort = _URL.port;\n\n  var rocketChatProtocol = protocol.slice(0, -1);\n  var federationDomain = useSetting('FEDERATION_Domain');\n  var setFederationDomain = useSettingSetValue('FEDERATION_Domain');\n  var federationSubdomain = '';\n  var parsedDomain = parseDomain(federationDomain);\n\n  if (parsedDomain !== null && parsedDomain !== void 0 && parsedDomain.subdomain) {\n    federationSubdomain = parsedDomain.subdomain || '';\n  }\n\n  var federationDiscoveryMethod = useSetting('FEDERATION_Discovery_Method');\n  var setFederationDiscoveryMethod = useSettingSetValue('FEDERATION_Discovery_Method');\n  var federationPublicKey = useSetting('FEDERATION_Public_Key'); // Form\n\n  var discoveryOptions = [['dns', 'DNS (recommended)'], ['hub', 'HUB']];\n  var initialValues = {\n    domain: federationDomain,\n    discoveryMethod: federationDiscoveryMethod\n  };\n\n  var _useForm = useForm(initialValues),\n      values = _useForm.values,\n      handlers = _useForm.handlers,\n      hasUnsavedChanges = _useForm.hasUnsavedChanges,\n      commit = _useForm.commit;\n\n  var domain = values.domain,\n      discoveryMethod = values.discoveryMethod;\n  var handleDomain = handlers.handleDomain,\n      handleDiscoveryMethod = handlers.handleDiscoveryMethod;\n  var onChangeDomain = useMutableCallback(function (value) {\n    handleDomain(value);\n  });\n  var onChangeDiscoveryMethod = useMutableCallback(function (value) {\n    handleDiscoveryMethod(value);\n  }); // Wizard\n\n  var nextStep = useCallback(function () {\n    if (currentStep === 1 && hasUnsavedChanges) {\n      setFederationDomain(domain);\n      setFederationDiscoveryMethod(discoveryMethod);\n      commit();\n    }\n\n    if (currentStep === 3) {\n      onClose();\n    } else {\n      setCurrentStep(currentStep + 1);\n    }\n  }, [currentStep, hasUnsavedChanges, domain, discoveryMethod, commit, onClose, setFederationDomain, setFederationDiscoveryMethod]);\n  var previousStep = useCallback(function () {\n    if (currentStep === 1) {\n      onClose();\n    } else {\n      setCurrentStep(currentStep - 1);\n    }\n  }, [currentStep, onClose]); // Resolve DNS\n\n  var resolvedSRVString = useSetting('FEDERATION_ResolvedSRV');\n  var resolvedSRV = JSON.parse(resolvedSRVString || '{}');\n  var resolvedPublicKeyTXT = useSetting('FEDERATION_ResolvedPublicKeyTXT');\n  var resolvedProtocolTXT = useSetting('FEDERATION_ResolvedProtocolTXT');\n  var resolvedDNS = {\n    srv: resolvedSRV,\n    txt: (_txt = {}, _txt[TXTRecordValue.PUBLIC_KEY] = resolvedPublicKeyTXT, _txt[TXTRecordValue.PROTOCOL] = resolvedProtocolTXT, _txt)\n  };\n  return /*#__PURE__*/React.createElement(Modal, props, currentStep === 1 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Federation')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Federation_Domain')), /*#__PURE__*/React.createElement(Field.Description, null, t('Federation_Domain_details')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    placeholder: \"rocket.chat\",\n    value: domain,\n    onChange: onChangeDomain\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Federation_Discovery_method')), /*#__PURE__*/React.createElement(Field.Description, null, t('Federation_Discovery_method_details')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(Select, {\n    width: \"250px\",\n    value: discoveryMethod || 'dns',\n    options: discoveryOptions,\n    onChange: onChangeDiscoveryMethod\n  })))))), currentStep === 2 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Federation_Adding_to_your_server')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(Tabs, {\n    mi: \"neg-x24\"\n  }, /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: currentTab === 1,\n    onClick: function () {\n      return setCurrentTab(1);\n    }\n  }, t('Federation_Configure_DNS')), /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: currentTab === 2,\n    onClick: function () {\n      return setCurrentTab(2);\n    }\n  }, t('Federation_Legacy_support'))), /*#__PURE__*/React.createElement(Box, {\n    mbs: \"x24\"\n  }, currentTab === 1 && /*#__PURE__*/React.createElement(DNSRecords, {\n    federationSubdomain: federationSubdomain,\n    federationPublicKey: federationPublicKey,\n    rocketChatProtocol: rocketChatProtocol,\n    rocketChatDomain: rocketChatDomain,\n    rocketChatPort: rocketChatPort,\n    resolvedEntries: resolvedDNS\n  }), currentTab === 2 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, {\n    mbe: \"x16\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    is: \"p\",\n    fontWeight: \"c2\",\n    fontSize: \"p2\"\n  }, t('Federation_SRV_no_support')), /*#__PURE__*/React.createElement(Box, {\n    is: \"p\",\n    mbs: \"x8\",\n    fontSize: \"x12\"\n  }, t('Federation_SRV_no_support_details'))), /*#__PURE__*/React.createElement(DNSRecords, {\n    federationSubdomain: federationSubdomain,\n    federationPublicKey: federationPublicKey,\n    rocketChatProtocol: rocketChatProtocol,\n    rocketChatDomain: rocketChatDomain,\n    rocketChatPort: rocketChatPort,\n    resolvedEntries: resolvedDNS,\n    legacy: true\n  }))))), currentStep === 3 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Federation_Adding_users_from_another_server')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(InviteUsers, {\n    onClose: onClose\n  }))), /*#__PURE__*/React.createElement(Modal.Footer, null, currentStep === 2 && /*#__PURE__*/React.createElement(Box, {\n    mbs: \"x8\",\n    color: \"hint\",\n    fontSize: \"x12\",\n    position: \"absolute\"\n  }, t('Federation_DNS_info_update')), /*#__PURE__*/React.createElement(ButtonGroup, {\n    align: \"end\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: previousStep\n  }, currentStep === 1 ? t('Cancel') : t('Back')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: nextStep\n  }, currentStep === 3 ? t('Finish') : t('Next')))));\n};","map":{"version":3,"sources":["client/views/admin/info/FederationCard/components/FederationModal/FederationModal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Button, ButtonGroup, Field, FieldGroup, Modal, Select, SelectOption, Tabs, TextInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { parse as parseDomain, ParsedDomain } from 'psl';\nimport React, { FC, ReactElement, useCallback, useState } from 'react';\n\nimport { useSetting, useSettingSetValue } from '../../../../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../../../../contexts/TranslationContext';\nimport { useForm } from '../../../../../../hooks/useForm';\nimport { DNSRecords } from './DNSRecords';\nimport InviteUsers from './InviteUsers';\nimport { DNSRecordName, ResolvedDNS, TXTRecordValue } from './Types';\n\nexport const FederationModal: FC<{ onClose: () => void }> = ({ onClose, ...props }): ReactElement => {\n\tconst t = useTranslation();\n\n\t// State\n\tconst [currentStep, setCurrentStep] = useState(1);\n\tconst [currentTab, setCurrentTab] = useState(1);\n\n\t// Settings\n\tconst siteUrl = useSetting('Site_Url') as string;\n\tconst { protocol, hostname: rocketChatDomain, port: rocketChatPort } = new URL(siteUrl);\n\tconst rocketChatProtocol = protocol.slice(0, -1);\n\n\tconst federationDomain = useSetting('FEDERATION_Domain') as string;\n\tconst setFederationDomain = useSettingSetValue('FEDERATION_Domain');\n\n\tlet federationSubdomain = '';\n\tconst parsedDomain = parseDomain(federationDomain);\n\tif ((parsedDomain as ParsedDomain)?.subdomain) {\n\t\tfederationSubdomain = (parsedDomain as ParsedDomain).subdomain || '';\n\t}\n\n\tconst federationDiscoveryMethod = useSetting('FEDERATION_Discovery_Method') as string;\n\tconst setFederationDiscoveryMethod = useSettingSetValue('FEDERATION_Discovery_Method');\n\n\tconst federationPublicKey = useSetting('FEDERATION_Public_Key') as string;\n\n\t// Form\n\tconst discoveryOptions: SelectOption[] = [\n\t\t['dns', 'DNS (recommended)'],\n\t\t['hub', 'HUB'],\n\t];\n\n\tconst initialValues = {\n\t\tdomain: federationDomain,\n\t\tdiscoveryMethod: federationDiscoveryMethod,\n\t};\n\tconst { values, handlers, hasUnsavedChanges, commit } = useForm(initialValues);\n\n\tconst { domain, discoveryMethod } = values as { domain: string; discoveryMethod: string };\n\tconst { handleDomain, handleDiscoveryMethod } = handlers;\n\n\tconst onChangeDomain = useMutableCallback((value) => {\n\t\thandleDomain(value);\n\t});\n\n\tconst onChangeDiscoveryMethod = useMutableCallback((value) => {\n\t\thandleDiscoveryMethod(value);\n\t});\n\n\t// Wizard\n\tconst nextStep = useCallback(() => {\n\t\tif (currentStep === 1 && hasUnsavedChanges) {\n\t\t\tsetFederationDomain(domain);\n\t\t\tsetFederationDiscoveryMethod(discoveryMethod);\n\t\t\tcommit();\n\t\t}\n\n\t\tif (currentStep === 3) {\n\t\t\tonClose();\n\t\t} else {\n\t\t\tsetCurrentStep(currentStep + 1);\n\t\t}\n\t}, [currentStep, hasUnsavedChanges, domain, discoveryMethod, commit, onClose, setFederationDomain, setFederationDiscoveryMethod]);\n\n\tconst previousStep = useCallback(() => {\n\t\tif (currentStep === 1) {\n\t\t\tonClose();\n\t\t} else {\n\t\t\tsetCurrentStep(currentStep - 1);\n\t\t}\n\t}, [currentStep, onClose]);\n\n\t// Resolve DNS\n\tconst resolvedSRVString = useSetting('FEDERATION_ResolvedSRV') as string;\n\tconst resolvedSRV: Record<DNSRecordName, string | number> = JSON.parse(resolvedSRVString || '{}');\n\n\tconst resolvedPublicKeyTXT = useSetting('FEDERATION_ResolvedPublicKeyTXT') as string;\n\tconst resolvedProtocolTXT = useSetting('FEDERATION_ResolvedProtocolTXT') as string;\n\n\tconst resolvedDNS: ResolvedDNS = {\n\t\tsrv: resolvedSRV,\n\t\ttxt: {\n\t\t\t[TXTRecordValue.PUBLIC_KEY]: resolvedPublicKeyTXT,\n\t\t\t[TXTRecordValue.PROTOCOL]: resolvedProtocolTXT,\n\t\t},\n\t};\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t{currentStep === 1 && (\n\t\t\t\t<>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title>{t('Federation')}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Federation_Domain')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Description>{t('Federation_Domain_details')}</Field.Description>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<TextInput placeholder='rocket.chat' value={domain} onChange={onChangeDomain} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Federation_Discovery_method')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Description>{t('Federation_Discovery_method_details')}</Field.Description>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<Select width='250px' value={discoveryMethod || 'dns'} options={discoveryOptions} onChange={onChangeDiscoveryMethod} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t</FieldGroup>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{currentStep === 2 && (\n\t\t\t\t<>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title>{t('Federation_Adding_to_your_server')}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<Tabs mi='neg-x24'>\n\t\t\t\t\t\t\t<Tabs.Item selected={currentTab === 1} onClick={(): void => setCurrentTab(1)}>\n\t\t\t\t\t\t\t\t{t('Federation_Configure_DNS')}\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item selected={currentTab === 2} onClick={(): void => setCurrentTab(2)}>\n\t\t\t\t\t\t\t\t{t('Federation_Legacy_support')}\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t\t<Box mbs='x24'>\n\t\t\t\t\t\t\t{currentTab === 1 && (\n\t\t\t\t\t\t\t\t<DNSRecords\n\t\t\t\t\t\t\t\t\tfederationSubdomain={federationSubdomain}\n\t\t\t\t\t\t\t\t\tfederationPublicKey={federationPublicKey}\n\t\t\t\t\t\t\t\t\trocketChatProtocol={rocketChatProtocol}\n\t\t\t\t\t\t\t\t\trocketChatDomain={rocketChatDomain}\n\t\t\t\t\t\t\t\t\trocketChatPort={rocketChatPort}\n\t\t\t\t\t\t\t\t\tresolvedEntries={resolvedDNS}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{currentTab === 2 && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<Box mbe='x16'>\n\t\t\t\t\t\t\t\t\t\t<Box is='p' fontWeight='c2' fontSize='p2'>\n\t\t\t\t\t\t\t\t\t\t\t{t('Federation_SRV_no_support')}\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t<Box is='p' mbs='x8' fontSize='x12'>\n\t\t\t\t\t\t\t\t\t\t\t{t('Federation_SRV_no_support_details')}\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t<DNSRecords\n\t\t\t\t\t\t\t\t\t\tfederationSubdomain={federationSubdomain}\n\t\t\t\t\t\t\t\t\t\tfederationPublicKey={federationPublicKey}\n\t\t\t\t\t\t\t\t\t\trocketChatProtocol={rocketChatProtocol}\n\t\t\t\t\t\t\t\t\t\trocketChatDomain={rocketChatDomain}\n\t\t\t\t\t\t\t\t\t\trocketChatPort={rocketChatPort}\n\t\t\t\t\t\t\t\t\t\tresolvedEntries={resolvedDNS}\n\t\t\t\t\t\t\t\t\t\tlegacy={true}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{currentStep === 3 && (\n\t\t\t\t<>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title>{t('Federation_Adding_users_from_another_server')}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<InviteUsers onClose={onClose} />\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t<Modal.Footer>\n\t\t\t\t{currentStep === 2 && (\n\t\t\t\t\t<Box mbs='x8' color='hint' fontSize='x12' position='absolute'>\n\t\t\t\t\t\t{t('Federation_DNS_info_update')}\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={previousStep}>{currentStep === 1 ? t('Cancel') : t('Back')}</Button>\n\t\t\t\t\t<Button primary onClick={nextStep}>\n\t\t\t\t\t\t{currentStep === 3 ? t('Finish') : t('Next')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n"],"sourceRoot":""},"sourceType":"module","hash":"d29c6ba7a53c69ae7e6784f543767d59cb4d2b7b"}
