{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/meet/CallPage.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/meet/CallPage.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/meet/CallPage.tsx","inputSourceMap":{"version":3,"file":"client/views/meet/CallPage.tsx","sourceRoot":"","sources":["client/views/meet/CallPage.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Flex, ButtonGroup, Button, Icon } from '@rocket.chat/fuselage';\nimport moment from 'moment';\nimport React, { FC, useEffect, useState } from 'react';\n\nimport { Notifications } from '../../../app/notifications/client';\nimport { WebRTC } from '../../../app/webrtc/client';\nimport { WEB_RTC_EVENTS } from '../../../app/webrtc/index';\nimport UserAvatar from '../../components/avatar/UserAvatar';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport OngoingCallDuration from './OngoingCallDuration';\nimport './styles.css';\n\ntype CallPageProps = {\n\troomId: any;\n\tvisitorToken: any;\n\tvisitorId: any;\n\tstatus: any;\n\tsetStatus: any;\n\tlayout: any;\n\tvisitorName: any;\n\tagentName: any;\n\tcallStartTime: any;\n};\n\nconst CallPage: FC<CallPageProps> = ({\n\troomId,\n\tvisitorToken,\n\tvisitorId,\n\tstatus,\n\tsetStatus,\n\tlayout,\n\tvisitorName,\n\tagentName,\n\tcallStartTime,\n}) => {\n\tconst [isAgentActive, setIsAgentActive] = useState(false);\n\tconst [isMicOn, setIsMicOn] = useState(false);\n\tconst [isCameraOn, setIsCameraOn] = useState(false);\n\tconst [isRemoteMobileDevice, setIsRemoteMobileDevice] = useState(false);\n\tconst [callInIframe, setCallInIframe] = useState(false);\n\tconst [isRemoteCameraOn, setIsRemoteCameraOn] = useState(false);\n\tconst [isLocalMobileDevice, setIsLocalMobileDevice] = useState(false);\n\n\tlet iconSize = 'x21';\n\tlet buttonSize = 'x40';\n\tconst avatarSize = 'x48';\n\tif (layout === 'embedded') {\n\t\ticonSize = 'x19';\n\t\tbuttonSize = 'x35';\n\t}\n\n\tconst t = useTranslation();\n\tuseEffect(() => {\n\t\tif (visitorToken) {\n\t\t\tconst webrtcInstance = WebRTC.getInstanceByRoomId(roomId, visitorId);\n\t\t\tconst isMobileDevice = (): boolean => {\n\t\t\t\tif (layout === 'embedded') {\n\t\t\t\t\tsetCallInIframe(true);\n\t\t\t\t}\n\t\t\t\tif (window.innerWidth <= 450 && window.innerHeight >= 629 && window.innerHeight <= 900) {\n\t\t\t\t\tsetIsLocalMobileDevice(true);\n\t\t\t\t\twebrtcInstance.media = {\n\t\t\t\t\t\taudio: true,\n\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\twidth: { ideal: 440 },\n\t\t\t\t\t\t\theight: { ideal: 580 },\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tNotifications.onUser(\n\t\t\t\tWEB_RTC_EVENTS.WEB_RTC,\n\t\t\t\t(type: any, data: any) => {\n\t\t\t\t\tif (data.room == null) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twebrtcInstance.onUserStream(type, data);\n\t\t\t\t},\n\t\t\t\tvisitorId,\n\t\t\t);\n\t\t\tNotifications.onRoom(roomId, 'webrtc', (type: any, data: any) => {\n\t\t\t\tif (type === 'callStatus' && data.callStatus === 'ended') {\n\t\t\t\t\twebrtcInstance.stop();\n\t\t\t\t\tsetStatus(data.callStatus);\n\t\t\t\t} else if (type === 'getDeviceType') {\n\t\t\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n\t\t\t\t\t\tisMobileDevice: isMobileDevice(),\n\t\t\t\t\t});\n\t\t\t\t} else if (type === 'cameraStatus') {\n\t\t\t\t\tsetIsRemoteCameraOn(data.isCameraOn);\n\t\t\t\t}\n\t\t\t});\n\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n\t\t\t\tisMobileDevice: isMobileDevice(),\n\t\t\t});\n\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'callStatus', { callStatus: 'inProgress' });\n\t\t} else if (!isAgentActive) {\n\t\t\tconst webrtcInstance = WebRTC.getInstanceByRoomId(roomId);\n\t\t\tif (status === 'inProgress') {\n\t\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'getDeviceType');\n\t\t\t\twebrtcInstance.startCall({\n\t\t\t\t\taudio: true,\n\t\t\t\t\tvideo: {\n\t\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\t\theight: { ideal: 1080 },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\tNotifications.onRoom(roomId, 'webrtc', (type: any, data: any) => {\n\t\t\t\tif (type === 'callStatus') {\n\t\t\t\t\tswitch (data.callStatus) {\n\t\t\t\t\t\tcase 'ended':\n\t\t\t\t\t\t\twebrtcInstance.stop();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'inProgress':\n\t\t\t\t\t\t\twebrtcInstance.startCall({\n\t\t\t\t\t\t\t\taudio: true,\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\t\t\t\t\theight: { ideal: 1080 },\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tsetStatus(data.callStatus);\n\t\t\t\t} else if (type === 'deviceType' && data.isMobileDevice) {\n\t\t\t\t\tsetIsRemoteMobileDevice(true);\n\t\t\t\t} else if (type === 'cameraStatus') {\n\t\t\t\t\tsetIsRemoteCameraOn(data.isCameraOn);\n\t\t\t\t}\n\t\t\t});\n\t\t\tsetIsAgentActive(true);\n\t\t}\n\t}, [isAgentActive, status, setStatus, visitorId, roomId, visitorToken, layout]);\n\n\tconst toggleButton = (control: any): any => {\n\t\tif (control === 'mic') {\n\t\t\tWebRTC.getInstanceByRoomId(roomId, visitorToken).toggleAudio();\n\t\t\treturn setIsMicOn(!isMicOn);\n\t\t}\n\t\tWebRTC.getInstanceByRoomId(roomId, visitorToken).toggleVideo();\n\t\tsetIsCameraOn(!isCameraOn);\n\t\tNotifications.notifyRoom(roomId, 'webrtc', 'cameraStatus', { isCameraOn: !isCameraOn });\n\t};\n\n\tconst closeWindow = (): void => {\n\t\tif (layout === 'embedded') {\n\t\t\treturn (parent as any)?.handleIframeClose();\n\t\t}\n\t\treturn window.close();\n\t};\n\n\tconst getCallDuration = (callStartTime: any): any => moment.duration(moment(new Date()).diff(moment(callStartTime))).asSeconds();\n\n\tconst showCallPage = (localAvatar: any, remoteAvatar: any): any => (\n\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t<Box\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t}}\n\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\talignItems='center'\n\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t>\n\t\t\t\t\t<video\n\t\t\t\t\t\tid='localVideo'\n\t\t\t\t\t\tautoPlay\n\t\t\t\t\t\tplaysInline\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t\t\t\t\tdisplay: isCameraOn ? 'block' : 'none',\n\t\t\t\t\t\t}}\n\t\t\t\t\t></video>\n\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: isCameraOn ? 'none' : 'block',\n\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tusername={localAvatar}\n\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\tsize={isLocalMobileDevice || callInIframe ? 'x32' : 'x48'}\n\t\t\t\t\t/>\n\t\t\t\t</Box>\n\t\t\t\t<ButtonGroup\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tbottom: '5%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid='mic'\n\t\t\t\t\t\tsquare\n\t\t\t\t\t\tdata-title={isMicOn ? t('Mute_microphone') : t('Unmute_microphone')}\n\t\t\t\t\t\tonClick={(): any => toggleButton('mic')}\n\t\t\t\t\t\tclassName={isMicOn ? 'On' : 'Off'}\n\t\t\t\t\t\tsize={Number(buttonSize)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isMicOn ? <Icon name='mic' size={iconSize} /> : <Icon name='mic-off' size={iconSize} />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid='camera'\n\t\t\t\t\t\tsquare\n\t\t\t\t\t\tdata-title={isCameraOn ? t('Turn_off_video') : t('Turn_on_video')}\n\t\t\t\t\t\tonClick={(): void => toggleButton('camera')}\n\t\t\t\t\t\tclassName={isCameraOn ? 'On' : 'Off'}\n\t\t\t\t\t\tsize={parseInt(buttonSize)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isCameraOn ? <Icon name='video' size={iconSize} /> : <Icon name='video-off' size={iconSize} />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{layout === 'embedded' && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsquare\n\t\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\t\tborderColor='#2F343D'\n\t\t\t\t\t\t\tdata-title={t('Expand_view')}\n\t\t\t\t\t\t\tonClick={(): void => (parent as any)?.expandCall()}\n\t\t\t\t\t\t\tsize={parseInt(buttonSize)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon name='arrow-expand' size={iconSize} color='white' />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button square primary danger data-title={t('End_call')} onClick={closeWindow} size={parseInt(buttonSize)}>\n\t\t\t\t\t\t<Icon name='phone-off' size={iconSize} color='white' />\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t<video\n\t\t\t\t\tid='remoteVideo'\n\t\t\t\t\tautoPlay\n\t\t\t\t\tplaysInline\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: isRemoteMobileDevice ? '45%' : '100%',\n\t\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t\t\t\tdisplay: isRemoteCameraOn ? 'block' : 'none',\n\t\t\t\t\t}}\n\t\t\t\t></video>\n\t\t\t\t<Box\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tdisplay={isRemoteCameraOn ? 'none' : 'flex'}\n\t\t\t\t\tjustifyContent='center'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\talignItems='center'\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttop: isRemoteMobileDevice || isLocalMobileDevice ? '10%' : '30%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tusername={remoteAvatar}\n\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\tsize={!callInIframe ? 'x124' : avatarSize}\n\t\t\t\t\t/>\n\t\t\t\t\t<Box color='white' fontSize={callInIframe ? 12 : 18} textAlign='center' margin={3}>\n\t\t\t\t\t\t<OngoingCallDuration counter={getCallDuration(callStartTime)} />\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\tfontSize: callInIframe ? 12 : 22,\n\t\t\t\t\t\t\tmargin: callInIframe ? 5 : 9,\n\t\t\t\t\t\t\t...(callInIframe && { marginTop: 0 }),\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{remoteAvatar}\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t</Flex.Container>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{status === 'ringing' && (\n\t\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tusername={agentName}\n\t\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\t\tsize={isLocalMobileDevice ? 'x32' : 'x48'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\ttop: '20%',\n\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\t\t\t\tflexDirection: 'column',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tusername={visitorName}\n\t\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\t\tsize='x124'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Box color='white' fontSize={16} margin={15}>\n\t\t\t\t\t\t\t\t{'Calling...'}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\t\t\tfontSize: isLocalMobileDevice ? 15 : 22,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{visitorName}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Box>\n\t\t\t\t</Flex.Container>\n\t\t\t)}\n\t\t\t{status === 'declined' && (\n\t\t\t\t<Box minHeight='90%' display='flex' justifyContent='center' alignItems='center' color='white' fontSize='s1'>\n\t\t\t\t\t{t('Call_declined')}\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t\t{status === 'inProgress' && (\n\t\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t\t{visitorToken ? showCallPage(visitorName, agentName) : showCallPage(agentName, visitorName)}\n\t\t\t\t</Flex.Container>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CallPage;\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/meet/CallPage.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/meet/CallPage.tsx"}},"code":"var _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 0);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\nvar Box, Flex, ButtonGroup, Button, Icon;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  Flex: function (v) {\n    Flex = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  }\n}, 0);\nvar moment;\nmodule.link(\"moment\", {\n  \"default\": function (v) {\n    moment = v;\n  }\n}, 1);\nvar React, useEffect, useState;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useState: function (v) {\n    useState = v;\n  }\n}, 2);\nvar Notifications;\nmodule.link(\"../../../app/notifications/client\", {\n  Notifications: function (v) {\n    Notifications = v;\n  }\n}, 3);\nvar WebRTC;\nmodule.link(\"../../../app/webrtc/client\", {\n  WebRTC: function (v) {\n    WebRTC = v;\n  }\n}, 4);\nvar WEB_RTC_EVENTS;\nmodule.link(\"../../../app/webrtc/index\", {\n  WEB_RTC_EVENTS: function (v) {\n    WEB_RTC_EVENTS = v;\n  }\n}, 5);\nvar UserAvatar;\nmodule.link(\"../../components/avatar/UserAvatar\", {\n  \"default\": function (v) {\n    UserAvatar = v;\n  }\n}, 6);\nvar useTranslation;\nmodule.link(\"../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 7);\nvar OngoingCallDuration;\nmodule.link(\"./OngoingCallDuration\", {\n  \"default\": function (v) {\n    OngoingCallDuration = v;\n  }\n}, 8);\nmodule.link(\"./styles.css\");\n\nvar CallPage = function (_ref) {\n  var roomId = _ref.roomId,\n      visitorToken = _ref.visitorToken,\n      visitorId = _ref.visitorId,\n      status = _ref.status,\n      setStatus = _ref.setStatus,\n      layout = _ref.layout,\n      visitorName = _ref.visitorName,\n      agentName = _ref.agentName,\n      callStartTime = _ref.callStartTime;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAgentActive = _useState2[0],\n      setIsAgentActive = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isMicOn = _useState4[0],\n      setIsMicOn = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isCameraOn = _useState6[0],\n      setIsCameraOn = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isRemoteMobileDevice = _useState8[0],\n      setIsRemoteMobileDevice = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      callInIframe = _useState10[0],\n      setCallInIframe = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      isRemoteCameraOn = _useState12[0],\n      setIsRemoteCameraOn = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      isLocalMobileDevice = _useState14[0],\n      setIsLocalMobileDevice = _useState14[1];\n\n  var iconSize = 'x21';\n  var buttonSize = 'x40';\n  var avatarSize = 'x48';\n\n  if (layout === 'embedded') {\n    iconSize = 'x19';\n    buttonSize = 'x35';\n  }\n\n  var t = useTranslation();\n  useEffect(function () {\n    if (visitorToken) {\n      var webrtcInstance = WebRTC.getInstanceByRoomId(roomId, visitorId);\n\n      var isMobileDevice = function () {\n        if (layout === 'embedded') {\n          setCallInIframe(true);\n        }\n\n        if (window.innerWidth <= 450 && window.innerHeight >= 629 && window.innerHeight <= 900) {\n          setIsLocalMobileDevice(true);\n          webrtcInstance.media = {\n            audio: true,\n            video: {\n              width: {\n                ideal: 440\n              },\n              height: {\n                ideal: 580\n              }\n            }\n          };\n          return true;\n        }\n\n        return false;\n      };\n\n      Notifications.onUser(WEB_RTC_EVENTS.WEB_RTC, function (type, data) {\n        if (data.room == null) {\n          return;\n        }\n\n        webrtcInstance.onUserStream(type, data);\n      }, visitorId);\n      Notifications.onRoom(roomId, 'webrtc', function (type, data) {\n        if (type === 'callStatus' && data.callStatus === 'ended') {\n          webrtcInstance.stop();\n          setStatus(data.callStatus);\n        } else if (type === 'getDeviceType') {\n          Notifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n            isMobileDevice: isMobileDevice()\n          });\n        } else if (type === 'cameraStatus') {\n          setIsRemoteCameraOn(data.isCameraOn);\n        }\n      });\n      Notifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n        isMobileDevice: isMobileDevice()\n      });\n      Notifications.notifyRoom(roomId, 'webrtc', 'callStatus', {\n        callStatus: 'inProgress'\n      });\n    } else if (!isAgentActive) {\n      var _webrtcInstance = WebRTC.getInstanceByRoomId(roomId);\n\n      if (status === 'inProgress') {\n        Notifications.notifyRoom(roomId, 'webrtc', 'getDeviceType');\n\n        _webrtcInstance.startCall({\n          audio: true,\n          video: {\n            width: {\n              ideal: 1920\n            },\n            height: {\n              ideal: 1080\n            }\n          }\n        });\n      }\n\n      Notifications.onRoom(roomId, 'webrtc', function (type, data) {\n        if (type === 'callStatus') {\n          switch (data.callStatus) {\n            case 'ended':\n              _webrtcInstance.stop();\n\n              break;\n\n            case 'inProgress':\n              _webrtcInstance.startCall({\n                audio: true,\n                video: {\n                  width: {\n                    ideal: 1920\n                  },\n                  height: {\n                    ideal: 1080\n                  }\n                }\n              });\n\n          }\n\n          setStatus(data.callStatus);\n        } else if (type === 'deviceType' && data.isMobileDevice) {\n          setIsRemoteMobileDevice(true);\n        } else if (type === 'cameraStatus') {\n          setIsRemoteCameraOn(data.isCameraOn);\n        }\n      });\n      setIsAgentActive(true);\n    }\n  }, [isAgentActive, status, setStatus, visitorId, roomId, visitorToken, layout]);\n\n  var toggleButton = function (control) {\n    if (control === 'mic') {\n      WebRTC.getInstanceByRoomId(roomId, visitorToken).toggleAudio();\n      return setIsMicOn(!isMicOn);\n    }\n\n    WebRTC.getInstanceByRoomId(roomId, visitorToken).toggleVideo();\n    setIsCameraOn(!isCameraOn);\n    Notifications.notifyRoom(roomId, 'webrtc', 'cameraStatus', {\n      isCameraOn: !isCameraOn\n    });\n  };\n\n  var closeWindow = function () {\n    if (layout === 'embedded') {\n      var _parent;\n\n      return (_parent = parent) === null || _parent === void 0 ? void 0 : _parent.handleIframeClose();\n    }\n\n    return window.close();\n  };\n\n  var getCallDuration = function (callStartTime) {\n    return moment.duration(moment(new Date()).diff(moment(callStartTime))).asSeconds();\n  };\n\n  var showCallPage = function (localAvatar, remoteAvatar) {\n    return /*#__PURE__*/React.createElement(Flex.Container, {\n      direction: \"column\",\n      justifyContent: \"center\"\n    }, /*#__PURE__*/React.createElement(Box, {\n      width: \"full\",\n      minHeight: \"sh\",\n      alignItems: \"center\",\n      backgroundColor: \"neutral-900\",\n      overflow: \"hidden\",\n      position: \"relative\"\n    }, /*#__PURE__*/React.createElement(Box, {\n      position: \"absolute\",\n      zIndex: 1,\n      style: {\n        top: '5%',\n        right: '2%'\n      },\n      className: \"Self_Video\",\n      alignItems: \"center\",\n      backgroundColor: \"#2F343D\"\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      id: \"localVideo\",\n      autoPlay: true,\n      playsInline: true,\n      muted: true,\n      style: {\n        width: '100%',\n        transform: 'scaleX(-1)',\n        display: isCameraOn ? 'block' : 'none'\n      }\n    }), /*#__PURE__*/React.createElement(UserAvatar, {\n      style: {\n        display: isCameraOn ? 'none' : 'block',\n        margin: 'auto'\n      },\n      username: localAvatar,\n      className: \"rcx-message__avatar\",\n      size: isLocalMobileDevice || callInIframe ? 'x32' : 'x48'\n    })), /*#__PURE__*/React.createElement(ButtonGroup, {\n      position: \"absolute\",\n      zIndex: 1,\n      style: {\n        bottom: '5%'\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      id: \"mic\",\n      square: true,\n      \"data-title\": isMicOn ? t('Mute_microphone') : t('Unmute_microphone'),\n      onClick: function () {\n        return toggleButton('mic');\n      },\n      className: isMicOn ? 'On' : 'Off',\n      size: Number(buttonSize)\n    }, isMicOn ? /*#__PURE__*/React.createElement(Icon, {\n      name: \"mic\",\n      size: iconSize\n    }) : /*#__PURE__*/React.createElement(Icon, {\n      name: \"mic-off\",\n      size: iconSize\n    })), /*#__PURE__*/React.createElement(Button, {\n      id: \"camera\",\n      square: true,\n      \"data-title\": isCameraOn ? t('Turn_off_video') : t('Turn_on_video'),\n      onClick: function () {\n        return toggleButton('camera');\n      },\n      className: isCameraOn ? 'On' : 'Off',\n      size: parseInt(buttonSize)\n    }, isCameraOn ? /*#__PURE__*/React.createElement(Icon, {\n      name: \"video\",\n      size: iconSize\n    }) : /*#__PURE__*/React.createElement(Icon, {\n      name: \"video-off\",\n      size: iconSize\n    })), layout === 'embedded' && /*#__PURE__*/React.createElement(Button, {\n      square: true,\n      backgroundColor: \"#2F343D\",\n      borderColor: \"#2F343D\",\n      \"data-title\": t('Expand_view'),\n      onClick: function () {\n        var _parent2;\n\n        return (_parent2 = parent) === null || _parent2 === void 0 ? void 0 : _parent2.expandCall();\n      },\n      size: parseInt(buttonSize)\n    }, /*#__PURE__*/React.createElement(Icon, {\n      name: \"arrow-expand\",\n      size: iconSize,\n      color: \"white\"\n    })), /*#__PURE__*/React.createElement(Button, {\n      square: true,\n      primary: true,\n      danger: true,\n      \"data-title\": t('End_call'),\n      onClick: closeWindow,\n      size: parseInt(buttonSize)\n    }, /*#__PURE__*/React.createElement(Icon, {\n      name: \"phone-off\",\n      size: iconSize,\n      color: \"white\"\n    }))), /*#__PURE__*/React.createElement(\"video\", {\n      id: \"remoteVideo\",\n      autoPlay: true,\n      playsInline: true,\n      style: {\n        width: isRemoteMobileDevice ? '45%' : '100%',\n        transform: 'scaleX(-1)',\n        display: isRemoteCameraOn ? 'block' : 'none'\n      }\n    }), /*#__PURE__*/React.createElement(Box, {\n      position: \"absolute\",\n      zIndex: 1,\n      display: isRemoteCameraOn ? 'none' : 'flex',\n      justifyContent: \"center\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      style: {\n        top: isRemoteMobileDevice || isLocalMobileDevice ? '10%' : '30%'\n      }\n    }, /*#__PURE__*/React.createElement(UserAvatar, {\n      style: {\n        display: 'block',\n        margin: 'auto'\n      },\n      username: remoteAvatar,\n      className: \"rcx-message__avatar\",\n      size: !callInIframe ? 'x124' : avatarSize\n    }), /*#__PURE__*/React.createElement(Box, {\n      color: \"white\",\n      fontSize: callInIframe ? 12 : 18,\n      textAlign: \"center\",\n      margin: 3\n    }, /*#__PURE__*/React.createElement(OngoingCallDuration, {\n      counter: getCallDuration(callStartTime)\n    })), /*#__PURE__*/React.createElement(Box, {\n      style: _objectSpread({\n        color: 'white',\n        fontSize: callInIframe ? 12 : 22,\n        margin: callInIframe ? 5 : 9\n      }, callInIframe && {\n        marginTop: 0\n      })\n    }, remoteAvatar))));\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, status === 'ringing' && /*#__PURE__*/React.createElement(Flex.Container, {\n    direction: \"column\",\n    justifyContent: \"center\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    width: \"full\",\n    minHeight: \"sh\",\n    alignItems: \"center\",\n    backgroundColor: \"neutral-900\",\n    overflow: \"hidden\",\n    position: \"relative\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    position: \"absolute\",\n    zIndex: 1,\n    style: {\n      top: '5%',\n      right: '2%'\n    },\n    className: \"Self_Video\",\n    backgroundColor: \"#2F343D\",\n    alignItems: \"center\"\n  }, /*#__PURE__*/React.createElement(UserAvatar, {\n    style: {\n      display: 'block',\n      margin: 'auto'\n    },\n    username: agentName,\n    className: \"rcx-message__avatar\",\n    size: isLocalMobileDevice ? 'x32' : 'x48'\n  })), /*#__PURE__*/React.createElement(Box, {\n    position: \"absolute\",\n    zIndex: 1,\n    style: {\n      top: '20%',\n      display: 'flex',\n      justifyContent: 'center',\n      flexDirection: 'column'\n    },\n    alignItems: \"center\"\n  }, /*#__PURE__*/React.createElement(UserAvatar, {\n    style: {\n      display: 'block',\n      margin: 'auto'\n    },\n    username: visitorName,\n    className: \"rcx-message__avatar\",\n    size: \"x124\"\n  }), /*#__PURE__*/React.createElement(Box, {\n    color: \"white\",\n    fontSize: 16,\n    margin: 15\n  }, 'Calling...'), /*#__PURE__*/React.createElement(Box, {\n    style: {\n      color: 'white',\n      fontSize: isLocalMobileDevice ? 15 : 22\n    }\n  }, visitorName)))), status === 'declined' && /*#__PURE__*/React.createElement(Box, {\n    minHeight: \"90%\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    color: \"white\",\n    fontSize: \"s1\"\n  }, t('Call_declined')), status === 'inProgress' && /*#__PURE__*/React.createElement(Flex.Container, {\n    direction: \"column\",\n    justifyContent: \"center\"\n  }, visitorToken ? showCallPage(visitorName, agentName) : showCallPage(agentName, visitorName)));\n};\n\nmodule.exportDefault(CallPage);","map":{"version":3,"sources":["client/views/meet/CallPage.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Flex, ButtonGroup, Button, Icon } from '@rocket.chat/fuselage';\nimport moment from 'moment';\nimport React, { FC, useEffect, useState } from 'react';\n\nimport { Notifications } from '../../../app/notifications/client';\nimport { WebRTC } from '../../../app/webrtc/client';\nimport { WEB_RTC_EVENTS } from '../../../app/webrtc/index';\nimport UserAvatar from '../../components/avatar/UserAvatar';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport OngoingCallDuration from './OngoingCallDuration';\nimport './styles.css';\n\ntype CallPageProps = {\n\troomId: any;\n\tvisitorToken: any;\n\tvisitorId: any;\n\tstatus: any;\n\tsetStatus: any;\n\tlayout: any;\n\tvisitorName: any;\n\tagentName: any;\n\tcallStartTime: any;\n};\n\nconst CallPage: FC<CallPageProps> = ({\n\troomId,\n\tvisitorToken,\n\tvisitorId,\n\tstatus,\n\tsetStatus,\n\tlayout,\n\tvisitorName,\n\tagentName,\n\tcallStartTime,\n}) => {\n\tconst [isAgentActive, setIsAgentActive] = useState(false);\n\tconst [isMicOn, setIsMicOn] = useState(false);\n\tconst [isCameraOn, setIsCameraOn] = useState(false);\n\tconst [isRemoteMobileDevice, setIsRemoteMobileDevice] = useState(false);\n\tconst [callInIframe, setCallInIframe] = useState(false);\n\tconst [isRemoteCameraOn, setIsRemoteCameraOn] = useState(false);\n\tconst [isLocalMobileDevice, setIsLocalMobileDevice] = useState(false);\n\n\tlet iconSize = 'x21';\n\tlet buttonSize = 'x40';\n\tconst avatarSize = 'x48';\n\tif (layout === 'embedded') {\n\t\ticonSize = 'x19';\n\t\tbuttonSize = 'x35';\n\t}\n\n\tconst t = useTranslation();\n\tuseEffect(() => {\n\t\tif (visitorToken) {\n\t\t\tconst webrtcInstance = WebRTC.getInstanceByRoomId(roomId, visitorId);\n\t\t\tconst isMobileDevice = (): boolean => {\n\t\t\t\tif (layout === 'embedded') {\n\t\t\t\t\tsetCallInIframe(true);\n\t\t\t\t}\n\t\t\t\tif (window.innerWidth <= 450 && window.innerHeight >= 629 && window.innerHeight <= 900) {\n\t\t\t\t\tsetIsLocalMobileDevice(true);\n\t\t\t\t\twebrtcInstance.media = {\n\t\t\t\t\t\taudio: true,\n\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\twidth: { ideal: 440 },\n\t\t\t\t\t\t\theight: { ideal: 580 },\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tNotifications.onUser(\n\t\t\t\tWEB_RTC_EVENTS.WEB_RTC,\n\t\t\t\t(type: any, data: any) => {\n\t\t\t\t\tif (data.room == null) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twebrtcInstance.onUserStream(type, data);\n\t\t\t\t},\n\t\t\t\tvisitorId,\n\t\t\t);\n\t\t\tNotifications.onRoom(roomId, 'webrtc', (type: any, data: any) => {\n\t\t\t\tif (type === 'callStatus' && data.callStatus === 'ended') {\n\t\t\t\t\twebrtcInstance.stop();\n\t\t\t\t\tsetStatus(data.callStatus);\n\t\t\t\t} else if (type === 'getDeviceType') {\n\t\t\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n\t\t\t\t\t\tisMobileDevice: isMobileDevice(),\n\t\t\t\t\t});\n\t\t\t\t} else if (type === 'cameraStatus') {\n\t\t\t\t\tsetIsRemoteCameraOn(data.isCameraOn);\n\t\t\t\t}\n\t\t\t});\n\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'deviceType', {\n\t\t\t\tisMobileDevice: isMobileDevice(),\n\t\t\t});\n\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'callStatus', { callStatus: 'inProgress' });\n\t\t} else if (!isAgentActive) {\n\t\t\tconst webrtcInstance = WebRTC.getInstanceByRoomId(roomId);\n\t\t\tif (status === 'inProgress') {\n\t\t\t\tNotifications.notifyRoom(roomId, 'webrtc', 'getDeviceType');\n\t\t\t\twebrtcInstance.startCall({\n\t\t\t\t\taudio: true,\n\t\t\t\t\tvideo: {\n\t\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\t\theight: { ideal: 1080 },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\tNotifications.onRoom(roomId, 'webrtc', (type: any, data: any) => {\n\t\t\t\tif (type === 'callStatus') {\n\t\t\t\t\tswitch (data.callStatus) {\n\t\t\t\t\t\tcase 'ended':\n\t\t\t\t\t\t\twebrtcInstance.stop();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'inProgress':\n\t\t\t\t\t\t\twebrtcInstance.startCall({\n\t\t\t\t\t\t\t\taudio: true,\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\t\t\t\t\theight: { ideal: 1080 },\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tsetStatus(data.callStatus);\n\t\t\t\t} else if (type === 'deviceType' && data.isMobileDevice) {\n\t\t\t\t\tsetIsRemoteMobileDevice(true);\n\t\t\t\t} else if (type === 'cameraStatus') {\n\t\t\t\t\tsetIsRemoteCameraOn(data.isCameraOn);\n\t\t\t\t}\n\t\t\t});\n\t\t\tsetIsAgentActive(true);\n\t\t}\n\t}, [isAgentActive, status, setStatus, visitorId, roomId, visitorToken, layout]);\n\n\tconst toggleButton = (control: any): any => {\n\t\tif (control === 'mic') {\n\t\t\tWebRTC.getInstanceByRoomId(roomId, visitorToken).toggleAudio();\n\t\t\treturn setIsMicOn(!isMicOn);\n\t\t}\n\t\tWebRTC.getInstanceByRoomId(roomId, visitorToken).toggleVideo();\n\t\tsetIsCameraOn(!isCameraOn);\n\t\tNotifications.notifyRoom(roomId, 'webrtc', 'cameraStatus', { isCameraOn: !isCameraOn });\n\t};\n\n\tconst closeWindow = (): void => {\n\t\tif (layout === 'embedded') {\n\t\t\treturn (parent as any)?.handleIframeClose();\n\t\t}\n\t\treturn window.close();\n\t};\n\n\tconst getCallDuration = (callStartTime: any): any => moment.duration(moment(new Date()).diff(moment(callStartTime))).asSeconds();\n\n\tconst showCallPage = (localAvatar: any, remoteAvatar: any): any => (\n\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t<Box\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t}}\n\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\talignItems='center'\n\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t>\n\t\t\t\t\t<video\n\t\t\t\t\t\tid='localVideo'\n\t\t\t\t\t\tautoPlay\n\t\t\t\t\t\tplaysInline\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t\t\t\t\tdisplay: isCameraOn ? 'block' : 'none',\n\t\t\t\t\t\t}}\n\t\t\t\t\t></video>\n\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: isCameraOn ? 'none' : 'block',\n\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tusername={localAvatar}\n\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\tsize={isLocalMobileDevice || callInIframe ? 'x32' : 'x48'}\n\t\t\t\t\t/>\n\t\t\t\t</Box>\n\t\t\t\t<ButtonGroup\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tbottom: '5%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid='mic'\n\t\t\t\t\t\tsquare\n\t\t\t\t\t\tdata-title={isMicOn ? t('Mute_microphone') : t('Unmute_microphone')}\n\t\t\t\t\t\tonClick={(): any => toggleButton('mic')}\n\t\t\t\t\t\tclassName={isMicOn ? 'On' : 'Off'}\n\t\t\t\t\t\tsize={Number(buttonSize)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isMicOn ? <Icon name='mic' size={iconSize} /> : <Icon name='mic-off' size={iconSize} />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid='camera'\n\t\t\t\t\t\tsquare\n\t\t\t\t\t\tdata-title={isCameraOn ? t('Turn_off_video') : t('Turn_on_video')}\n\t\t\t\t\t\tonClick={(): void => toggleButton('camera')}\n\t\t\t\t\t\tclassName={isCameraOn ? 'On' : 'Off'}\n\t\t\t\t\t\tsize={parseInt(buttonSize)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isCameraOn ? <Icon name='video' size={iconSize} /> : <Icon name='video-off' size={iconSize} />}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{layout === 'embedded' && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsquare\n\t\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\t\tborderColor='#2F343D'\n\t\t\t\t\t\t\tdata-title={t('Expand_view')}\n\t\t\t\t\t\t\tonClick={(): void => (parent as any)?.expandCall()}\n\t\t\t\t\t\t\tsize={parseInt(buttonSize)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon name='arrow-expand' size={iconSize} color='white' />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button square primary danger data-title={t('End_call')} onClick={closeWindow} size={parseInt(buttonSize)}>\n\t\t\t\t\t\t<Icon name='phone-off' size={iconSize} color='white' />\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t<video\n\t\t\t\t\tid='remoteVideo'\n\t\t\t\t\tautoPlay\n\t\t\t\t\tplaysInline\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: isRemoteMobileDevice ? '45%' : '100%',\n\t\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t\t\t\tdisplay: isRemoteCameraOn ? 'block' : 'none',\n\t\t\t\t\t}}\n\t\t\t\t></video>\n\t\t\t\t<Box\n\t\t\t\t\tposition='absolute'\n\t\t\t\t\tzIndex={1}\n\t\t\t\t\tdisplay={isRemoteCameraOn ? 'none' : 'flex'}\n\t\t\t\t\tjustifyContent='center'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\talignItems='center'\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttop: isRemoteMobileDevice || isLocalMobileDevice ? '10%' : '30%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tusername={remoteAvatar}\n\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\tsize={!callInIframe ? 'x124' : avatarSize}\n\t\t\t\t\t/>\n\t\t\t\t\t<Box color='white' fontSize={callInIframe ? 12 : 18} textAlign='center' margin={3}>\n\t\t\t\t\t\t<OngoingCallDuration counter={getCallDuration(callStartTime)} />\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\tfontSize: callInIframe ? 12 : 22,\n\t\t\t\t\t\t\tmargin: callInIframe ? 5 : 9,\n\t\t\t\t\t\t\t...(callInIframe && { marginTop: 0 }),\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{remoteAvatar}\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t</Flex.Container>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{status === 'ringing' && (\n\t\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t\t<Box width='full' minHeight='sh' alignItems='center' backgroundColor='neutral-900' overflow='hidden' position='relative'>\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\ttop: '5%',\n\t\t\t\t\t\t\t\tright: '2%',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName='Self_Video'\n\t\t\t\t\t\t\tbackgroundColor='#2F343D'\n\t\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tusername={agentName}\n\t\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\t\tsize={isLocalMobileDevice ? 'x32' : 'x48'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\tposition='absolute'\n\t\t\t\t\t\t\tzIndex={1}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\ttop: '20%',\n\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\t\t\t\tflexDirection: 'column',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\talignItems='center'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t\tmargin: 'auto',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tusername={visitorName}\n\t\t\t\t\t\t\t\tclassName='rcx-message__avatar'\n\t\t\t\t\t\t\t\tsize='x124'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Box color='white' fontSize={16} margin={15}>\n\t\t\t\t\t\t\t\t{'Calling...'}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tcolor: 'white',\n\t\t\t\t\t\t\t\t\tfontSize: isLocalMobileDevice ? 15 : 22,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{visitorName}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Box>\n\t\t\t\t</Flex.Container>\n\t\t\t)}\n\t\t\t{status === 'declined' && (\n\t\t\t\t<Box minHeight='90%' display='flex' justifyContent='center' alignItems='center' color='white' fontSize='s1'>\n\t\t\t\t\t{t('Call_declined')}\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t\t{status === 'inProgress' && (\n\t\t\t\t<Flex.Container direction='column' justifyContent='center'>\n\t\t\t\t\t{visitorToken ? showCallPage(visitorName, agentName) : showCallPage(agentName, visitorName)}\n\t\t\t\t</Flex.Container>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CallPage;\n"],"sourceRoot":""},"sourceType":"module","hash":"12a50ab72b8e71260a508ed83322e957764aa592"}
