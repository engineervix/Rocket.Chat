{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/CreateDiscussion/CreateDiscussion.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/components/CreateDiscussion/CreateDiscussion.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/CreateDiscussion/CreateDiscussion.tsx","inputSourceMap":{"version":3,"file":"client/components/CreateDiscussion/CreateDiscussion.tsx","sourceRoot":"","sources":["client/components/CreateDiscussion/CreateDiscussion.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ReactElement } from 'react';\n\nimport { IMessage } from '../../../definition/IMessage';\nimport { IRoom } from '../../../definition/IRoom';\nimport { IUser } from '../../../definition/IUser';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useEndpointActionExperimental } from '../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../hooks/useForm';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\nimport RoomAutoComplete from '../RoomAutoComplete';\nimport UserAutoCompleteMultiple from '../UserAutoCompleteMultiple';\nimport DefaultParentRoomField from './DefaultParentRoomField';\n\ntype CreateDiscussionFormValues = {\n\tname: string;\n\tparentRoom: IRoom['_id'];\n\tencrypted: boolean;\n\tusernames: Array<IUser['username']>;\n\tfirstMessage: string;\n};\n\ntype CreateDiscussionProps = {\n\tparentMessageId: IMessage['_id'];\n\tonClose: () => void;\n\tdefaultParentRoom?: IRoom['_id'];\n\tnameSuggestion?: string;\n};\n\nconst CreateDiscussion = ({ onClose, defaultParentRoom, parentMessageId, nameSuggestion }: CreateDiscussionProps): ReactElement => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm({\n\t\tname: nameSuggestion || '',\n\t\tparentRoom: '',\n\t\tencrypted: false,\n\t\tusernames: [],\n\t\tfirstMessage: '',\n\t});\n\n\tconst { name, parentRoom, encrypted, usernames, firstMessage } = values as CreateDiscussionFormValues;\n\n\tconst { handleName, handleParentRoom, handleEncrypted, handleUsernames, handleFirstMessage } = handlers;\n\n\tconst canCreate = (parentRoom || defaultParentRoom) && name;\n\n\tconst createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');\n\n\tconst create = useMutableCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tconst result = await createDiscussion({\n\t\t\t\tprid: defaultParentRoom || parentRoom,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/camelcase\n\t\t\t\tt_name: name,\n\t\t\t\tusers: usernames,\n\t\t\t\treply: encrypted ? undefined : firstMessage,\n\t\t\t\t...(parentMessageId && { pmid: parentMessageId }),\n\t\t\t});\n\n\t\t\tgoToRoomById(result.discussion._id);\n\t\t\tonClose();\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\t});\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (usernames.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsernames([...usernames, value]);\n\t\t}\n\t\thandleUsernames(usernames.filter((current) => current !== value));\n\t});\n\n\treturn (\n\t\t<Modal>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Discussion_title')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Description>{t('Discussion_description')}</Field.Description>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_target_channel')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t{defaultParentRoom && <DefaultParentRoomField defaultParentRoom={defaultParentRoom} />}\n\n\t\t\t\t\t\t\t{!defaultParentRoom && (\n\t\t\t\t\t\t\t\t<RoomAutoComplete\n\t\t\t\t\t\t\t\t\tvalue={parentRoom}\n\t\t\t\t\t\t\t\t\tonChange={handleParentRoom}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Discussion_target_channel_description')}\n\t\t\t\t\t\t\t\t\tdisabled={defaultParentRoom}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field display='flex' alignItems='center' flexDirection='row' justifyContent='spaceBetween' flexGrow={1}>\n\t\t\t\t\t\t<Box display='flex' flexDirection='column' width='full'>\n\t\t\t\t\t\t\t<Field.Label>{t('Encrypted')}</Field.Label>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<ToggleSwitch checked={encrypted} onChange={handleEncrypted} />\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_name')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\t\tonChange={handleName}\n\t\t\t\t\t\t\t\taddon={<Icon name='baloons' size='x20' />}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_name')}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Invite_Users')}</Field.Label>\n\t\t\t\t\t\t<Field.Row w='full' display='flex' flexDirection='column' alignItems='stretch'>\n\t\t\t\t\t\t\t<UserAutoCompleteMultiple value={usernames} onChange={onChangeUsers} placeholder={t('Username_Placeholder')} />\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_first_message_title')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextAreaInput\n\t\t\t\t\t\t\t\tvalue={firstMessage}\n\t\t\t\t\t\t\t\tonChange={handleFirstMessage}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_first_message')}\n\t\t\t\t\t\t\t\trows={5}\n\t\t\t\t\t\t\t\tdisabled={encrypted}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t{encrypted && <Field.Description>{t('Discussion_first_message_disabled_due_to_e2e')}</Field.Description>}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary disabled={!canCreate} onClick={create}>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default CreateDiscussion;\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/CreateDiscussion/CreateDiscussion.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/components/CreateDiscussion/CreateDiscussion.tsx"}},"code":"let _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 0);\nlet Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Modal(v) {\n    Modal = v;\n  },\n\n  Field(v) {\n    Field = v;\n  },\n\n  FieldGroup(v) {\n    FieldGroup = v;\n  },\n\n  ToggleSwitch(v) {\n    ToggleSwitch = v;\n  },\n\n  TextInput(v) {\n    TextInput = v;\n  },\n\n  TextAreaInput(v) {\n    TextAreaInput = v;\n  },\n\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n\n  Button(v) {\n    Button = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  },\n\n  Box(v) {\n    Box = v;\n  }\n\n}, 0);\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n\n}, 1);\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n\n}, 2);\nlet useTranslation;\nmodule.link(\"../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 3);\nlet useEndpointActionExperimental;\nmodule.link(\"../../hooks/useEndpointActionExperimental\", {\n  useEndpointActionExperimental(v) {\n    useEndpointActionExperimental = v;\n  }\n\n}, 4);\nlet useForm;\nmodule.link(\"../../hooks/useForm\", {\n  useForm(v) {\n    useForm = v;\n  }\n\n}, 5);\nlet goToRoomById;\nmodule.link(\"../../lib/utils/goToRoomById\", {\n  goToRoomById(v) {\n    goToRoomById = v;\n  }\n\n}, 6);\nlet RoomAutoComplete;\nmodule.link(\"../RoomAutoComplete\", {\n  default(v) {\n    RoomAutoComplete = v;\n  }\n\n}, 7);\nlet UserAutoCompleteMultiple;\nmodule.link(\"../UserAutoCompleteMultiple\", {\n  default(v) {\n    UserAutoCompleteMultiple = v;\n  }\n\n}, 8);\nlet DefaultParentRoomField;\nmodule.link(\"./DefaultParentRoomField\", {\n  default(v) {\n    DefaultParentRoomField = v;\n  }\n\n}, 9);\n\nconst CreateDiscussion = _ref => {\n  let {\n    onClose,\n    defaultParentRoom,\n    parentMessageId,\n    nameSuggestion\n  } = _ref;\n  const t = useTranslation();\n  const {\n    values,\n    handlers\n  } = useForm({\n    name: nameSuggestion || '',\n    parentRoom: '',\n    encrypted: false,\n    usernames: [],\n    firstMessage: ''\n  });\n  const {\n    name,\n    parentRoom,\n    encrypted,\n    usernames,\n    firstMessage\n  } = values;\n  const {\n    handleName,\n    handleParentRoom,\n    handleEncrypted,\n    handleUsernames,\n    handleFirstMessage\n  } = handlers;\n  const canCreate = (parentRoom || defaultParentRoom) && name;\n  const createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');\n  const create = useMutableCallback(async () => {\n    try {\n      const result = await createDiscussion(_objectSpread({\n        prid: defaultParentRoom || parentRoom,\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        t_name: name,\n        users: usernames,\n        reply: encrypted ? undefined : firstMessage\n      }, parentMessageId && {\n        pmid: parentMessageId\n      }));\n      goToRoomById(result.discussion._id);\n      onClose();\n    } catch (error) {\n      console.warn(error);\n    }\n  });\n  const onChangeUsers = useMutableCallback((value, action) => {\n    if (!action) {\n      if (usernames.includes(value)) {\n        return;\n      }\n\n      return handleUsernames([...usernames, value]);\n    }\n\n    handleUsernames(usernames.filter(current => current !== value));\n  });\n  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Discussion_title')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_description'))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_target_channel')), /*#__PURE__*/React.createElement(Field.Row, null, defaultParentRoom && /*#__PURE__*/React.createElement(DefaultParentRoomField, {\n    defaultParentRoom: defaultParentRoom\n  }), !defaultParentRoom && /*#__PURE__*/React.createElement(RoomAutoComplete, {\n    value: parentRoom,\n    onChange: handleParentRoom,\n    placeholder: t('Discussion_target_channel_description'),\n    disabled: defaultParentRoom\n  }))), /*#__PURE__*/React.createElement(Field, {\n    display: \"flex\",\n    alignItems: \"center\",\n    flexDirection: \"row\",\n    justifyContent: \"spaceBetween\",\n    flexGrow: 1\n  }, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    width: \"full\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Encrypted'))), /*#__PURE__*/React.createElement(ToggleSwitch, {\n    checked: encrypted,\n    onChange: handleEncrypted\n  })), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_name')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: name,\n    onChange: handleName,\n    addon: /*#__PURE__*/React.createElement(Icon, {\n      name: \"baloons\",\n      size: \"x20\"\n    }),\n    placeholder: t('New_discussion_name')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Invite_Users')), /*#__PURE__*/React.createElement(Field.Row, {\n    w: \"full\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"stretch\"\n  }, /*#__PURE__*/React.createElement(UserAutoCompleteMultiple, {\n    value: usernames,\n    onChange: onChangeUsers,\n    placeholder: t('Username_Placeholder')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_first_message_title')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {\n    value: firstMessage,\n    onChange: handleFirstMessage,\n    placeholder: t('New_discussion_first_message'),\n    rows: 5,\n    disabled: encrypted\n  })), encrypted && /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_first_message_disabled_due_to_e2e'))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    align: \"end\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: onClose\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    disabled: !canCreate,\n    onClick: create\n  }, t('Create')))));\n};\n\nmodule.exportDefault(CreateDiscussion);","map":{"version":3,"sources":["client/components/CreateDiscussion/CreateDiscussion.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ReactElement } from 'react';\n\nimport { IMessage } from '../../../definition/IMessage';\nimport { IRoom } from '../../../definition/IRoom';\nimport { IUser } from '../../../definition/IUser';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useEndpointActionExperimental } from '../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../hooks/useForm';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\nimport RoomAutoComplete from '../RoomAutoComplete';\nimport UserAutoCompleteMultiple from '../UserAutoCompleteMultiple';\nimport DefaultParentRoomField from './DefaultParentRoomField';\n\ntype CreateDiscussionFormValues = {\n\tname: string;\n\tparentRoom: IRoom['_id'];\n\tencrypted: boolean;\n\tusernames: Array<IUser['username']>;\n\tfirstMessage: string;\n};\n\ntype CreateDiscussionProps = {\n\tparentMessageId: IMessage['_id'];\n\tonClose: () => void;\n\tdefaultParentRoom?: IRoom['_id'];\n\tnameSuggestion?: string;\n};\n\nconst CreateDiscussion = ({ onClose, defaultParentRoom, parentMessageId, nameSuggestion }: CreateDiscussionProps): ReactElement => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm({\n\t\tname: nameSuggestion || '',\n\t\tparentRoom: '',\n\t\tencrypted: false,\n\t\tusernames: [],\n\t\tfirstMessage: '',\n\t});\n\n\tconst { name, parentRoom, encrypted, usernames, firstMessage } = values as CreateDiscussionFormValues;\n\n\tconst { handleName, handleParentRoom, handleEncrypted, handleUsernames, handleFirstMessage } = handlers;\n\n\tconst canCreate = (parentRoom || defaultParentRoom) && name;\n\n\tconst createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');\n\n\tconst create = useMutableCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tconst result = await createDiscussion({\n\t\t\t\tprid: defaultParentRoom || parentRoom,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/camelcase\n\t\t\t\tt_name: name,\n\t\t\t\tusers: usernames,\n\t\t\t\treply: encrypted ? undefined : firstMessage,\n\t\t\t\t...(parentMessageId && { pmid: parentMessageId }),\n\t\t\t});\n\n\t\t\tgoToRoomById(result.discussion._id);\n\t\t\tonClose();\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\t});\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (usernames.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsernames([...usernames, value]);\n\t\t}\n\t\thandleUsernames(usernames.filter((current) => current !== value));\n\t});\n\n\treturn (\n\t\t<Modal>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Discussion_title')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Description>{t('Discussion_description')}</Field.Description>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_target_channel')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t{defaultParentRoom && <DefaultParentRoomField defaultParentRoom={defaultParentRoom} />}\n\n\t\t\t\t\t\t\t{!defaultParentRoom && (\n\t\t\t\t\t\t\t\t<RoomAutoComplete\n\t\t\t\t\t\t\t\t\tvalue={parentRoom}\n\t\t\t\t\t\t\t\t\tonChange={handleParentRoom}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Discussion_target_channel_description')}\n\t\t\t\t\t\t\t\t\tdisabled={defaultParentRoom}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field display='flex' alignItems='center' flexDirection='row' justifyContent='spaceBetween' flexGrow={1}>\n\t\t\t\t\t\t<Box display='flex' flexDirection='column' width='full'>\n\t\t\t\t\t\t\t<Field.Label>{t('Encrypted')}</Field.Label>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<ToggleSwitch checked={encrypted} onChange={handleEncrypted} />\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_name')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\t\tonChange={handleName}\n\t\t\t\t\t\t\t\taddon={<Icon name='baloons' size='x20' />}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_name')}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Invite_Users')}</Field.Label>\n\t\t\t\t\t\t<Field.Row w='full' display='flex' flexDirection='column' alignItems='stretch'>\n\t\t\t\t\t\t\t<UserAutoCompleteMultiple value={usernames} onChange={onChangeUsers} placeholder={t('Username_Placeholder')} />\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_first_message_title')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextAreaInput\n\t\t\t\t\t\t\t\tvalue={firstMessage}\n\t\t\t\t\t\t\t\tonChange={handleFirstMessage}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_first_message')}\n\t\t\t\t\t\t\t\trows={5}\n\t\t\t\t\t\t\t\tdisabled={encrypted}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t{encrypted && <Field.Description>{t('Discussion_first_message_disabled_due_to_e2e')}</Field.Description>}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary disabled={!canCreate} onClick={create}>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default CreateDiscussion;\n"],"sourceRoot":""},"sourceType":"module","hash":"86cdacad00af24de55426aa5c9ff843184785bed"}
