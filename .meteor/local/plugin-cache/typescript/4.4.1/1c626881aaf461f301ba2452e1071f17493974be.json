{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/triggers/TriggersForm.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/omnichannel/triggers/TriggersForm.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/triggers/TriggersForm.tsx","inputSourceMap":{"version":3,"file":"client/views/omnichannel/triggers/TriggersForm.tsx","sourceRoot":"","sources":["client/views/omnichannel/triggers/TriggersForm.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Field, TextInput, ToggleSwitch, Select, TextAreaInput, SelectOption } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ComponentProps, FC, FormEvent, useMemo, useState } from 'react';\n\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\n\ntype TriggerConditions = {\n\tname: string;\n\tvalue: string | number;\n};\n\ntype TriggerActions = {\n\tname: string;\n\tparams: {\n\t\tsender: string | undefined;\n\t\tmsg: string;\n\t\tname: string;\n\t};\n};\n\ntype TriggersFormProps = {\n\tvalues: {\n\t\tname: string;\n\t\tdescription: string;\n\t\tenabled: boolean;\n\t\trunOnce: boolean;\n\t\t// In the future, this will be an array\n\t\tconditions: TriggerConditions;\n\t\t// In the future, this will be an array\n\t\tactions: TriggerActions;\n\t};\n\thandlers: {\n\t\thandleName: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleDescription: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleEnabled: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleRunOnce: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleConditions: (value: TriggerConditions) => void;\n\t\thandleActions: (value: TriggerActions) => void;\n\t};\n\tclassName?: ComponentProps<typeof Field>['className'];\n};\n\nconst TriggersForm: FC<TriggersFormProps> = ({ values, handlers, className }) => {\n\tconst [nameError, setNameError] = useState('');\n\tconst [msgError, setMsgError] = useState('');\n\tconst t = useTranslation();\n\tconst { name, description, enabled, runOnce, conditions, actions } = values;\n\n\tconst { handleName, handleDescription, handleEnabled, handleRunOnce, handleConditions, handleActions } = handlers;\n\n\tconst { name: conditionName, value: conditionValue } = conditions;\n\n\tconst {\n\t\tparams: { sender: actionSender, msg: actionMsg, name: actionAgentName },\n\t} = actions;\n\n\tconst conditionOptions: SelectOption[] = useMemo(\n\t\t() => [\n\t\t\t['page-url', t('Visitor_page_URL')],\n\t\t\t['time-on-site', t('Visitor_time_on_site')],\n\t\t\t['chat-opened-by-visitor', t('Chat_opened_by_visitor')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst conditionValuePlaceholders: { [conditionName: string]: string } = useMemo(\n\t\t() => ({\n\t\t\t'page-url': t('Enter_a_regex'),\n\t\t\t'time-on-site': t('Time_in_seconds'),\n\t\t}),\n\t\t[t],\n\t);\n\n\tconst conditionValuePlaceholder = conditionValuePlaceholders[conditionName];\n\n\tconst senderOptions: SelectOption[] = useMemo(\n\t\t() => [\n\t\t\t['queue', t('Impersonate_next_agent_from_queue')],\n\t\t\t['custom', t('Custom_agent')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst handleConditionName = useMutableCallback((name) => {\n\t\thandleConditions({\n\t\t\tname,\n\t\t\tvalue: '',\n\t\t});\n\t});\n\n\tconst handleConditionValue = useMutableCallback(({ currentTarget: { value } }) => {\n\t\thandleConditions({\n\t\t\t...conditions,\n\t\t\tvalue,\n\t\t});\n\t});\n\n\tconst handleActionAgentName = useMutableCallback(({ currentTarget: { value: name } }) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tname,\n\t\t\t},\n\t\t});\n\t});\n\n\tconst handleActionSender = useMutableCallback((sender) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tsender,\n\t\t\t},\n\t\t});\n\t});\n\n\tconst handleActionMessage = useMutableCallback(({ currentTarget: { value: msg } }) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tmsg,\n\t\t\t},\n\t\t});\n\t});\n\tuseComponentDidUpdate(() => {\n\t\tsetNameError(!name ? t('The_field_is_required', t('Name')) : '');\n\t}, [t, name]);\n\tuseComponentDidUpdate(() => {\n\t\tsetMsgError(!actionMsg ? t('The_field_is_required', t('Message')) : '');\n\t}, [t, actionMsg]);\n\treturn (\n\t\t<>\n\t\t\t<Field className={className}>\n\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t<Field.Label>{t('Enabled')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<ToggleSwitch checked={enabled} onChange={handleEnabled} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Box>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t<Field.Label>{t('Run_only_once_for_each_visitor')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<ToggleSwitch checked={runOnce} onChange={handleRunOnce} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Box>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={name} error={nameError} onChange={handleName} placeholder={t('Name')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Error>{nameError}</Field.Error>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Description')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={description} onChange={handleDescription} placeholder={t('Description')} />\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Condition')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select options={conditionOptions} value={conditionName} onChange={handleConditionName} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{conditionValuePlaceholder && (\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={conditionValue} onChange={handleConditionValue} placeholder={conditionValuePlaceholder} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t)}\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Action')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={t('Send_a_message')} disabled />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select options={senderOptions} value={actionSender} onChange={handleActionSender} placeholder={t('Select_an_option')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{actionSender === 'custom' && (\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={actionAgentName} onChange={handleActionAgentName} placeholder={t('Name_of_agent')} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t)}\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextAreaInput rows={3} value={actionMsg} onChange={handleActionMessage} placeholder={`${t('Message')}*`} />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Error>{msgError}</Field.Error>\n\t\t\t</Field>\n\t\t</>\n\t);\n};\n\nexport default TriggersForm;\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/triggers/TriggersForm.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/triggers/TriggersForm.tsx"}},"code":"var _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 0);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\nvar Box, Field, TextInput, ToggleSwitch, Select, TextAreaInput;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  ToggleSwitch: function (v) {\n    ToggleSwitch = v;\n  },\n  Select: function (v) {\n    Select = v;\n  },\n  TextAreaInput: function (v) {\n    TextAreaInput = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar React, useMemo, useState;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useState: function (v) {\n    useState = v;\n  }\n}, 2);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 3);\nvar useComponentDidUpdate;\nmodule.link(\"../../../hooks/useComponentDidUpdate\", {\n  useComponentDidUpdate: function (v) {\n    useComponentDidUpdate = v;\n  }\n}, 4);\n\nvar TriggersForm = function (_ref) {\n  var values = _ref.values,\n      handlers = _ref.handlers,\n      className = _ref.className;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      nameError = _useState2[0],\n      setNameError = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      msgError = _useState4[0],\n      setMsgError = _useState4[1];\n\n  var t = useTranslation();\n  var name = values.name,\n      description = values.description,\n      enabled = values.enabled,\n      runOnce = values.runOnce,\n      conditions = values.conditions,\n      actions = values.actions;\n  var handleName = handlers.handleName,\n      handleDescription = handlers.handleDescription,\n      handleEnabled = handlers.handleEnabled,\n      handleRunOnce = handlers.handleRunOnce,\n      handleConditions = handlers.handleConditions,\n      handleActions = handlers.handleActions;\n  var conditionName = conditions.name,\n      conditionValue = conditions.value;\n  var _actions$params = actions.params,\n      actionSender = _actions$params.sender,\n      actionMsg = _actions$params.msg,\n      actionAgentName = _actions$params.name;\n  var conditionOptions = useMemo(function () {\n    return [['page-url', t('Visitor_page_URL')], ['time-on-site', t('Visitor_time_on_site')], ['chat-opened-by-visitor', t('Chat_opened_by_visitor')]];\n  }, [t]);\n  var conditionValuePlaceholders = useMemo(function () {\n    return {\n      'page-url': t('Enter_a_regex'),\n      'time-on-site': t('Time_in_seconds')\n    };\n  }, [t]);\n  var conditionValuePlaceholder = conditionValuePlaceholders[conditionName];\n  var senderOptions = useMemo(function () {\n    return [['queue', t('Impersonate_next_agent_from_queue')], ['custom', t('Custom_agent')]];\n  }, [t]);\n  var handleConditionName = useMutableCallback(function (name) {\n    handleConditions({\n      name: name,\n      value: ''\n    });\n  });\n  var handleConditionValue = useMutableCallback(function (_ref2) {\n    var value = _ref2.currentTarget.value;\n    handleConditions(_objectSpread(_objectSpread({}, conditions), {}, {\n      value: value\n    }));\n  });\n  var handleActionAgentName = useMutableCallback(function (_ref3) {\n    var name = _ref3.currentTarget.value;\n    handleActions(_objectSpread(_objectSpread({}, actions), {}, {\n      params: _objectSpread(_objectSpread({}, actions.params), {}, {\n        name: name\n      })\n    }));\n  });\n  var handleActionSender = useMutableCallback(function (sender) {\n    handleActions(_objectSpread(_objectSpread({}, actions), {}, {\n      params: _objectSpread(_objectSpread({}, actions.params), {}, {\n        sender: sender\n      })\n    }));\n  });\n  var handleActionMessage = useMutableCallback(function (_ref4) {\n    var msg = _ref4.currentTarget.value;\n    handleActions(_objectSpread(_objectSpread({}, actions), {}, {\n      params: _objectSpread(_objectSpread({}, actions.params), {}, {\n        msg: msg\n      })\n    }));\n  });\n  useComponentDidUpdate(function () {\n    setNameError(!name ? t('The_field_is_required', t('Name')) : '');\n  }, [t, name]);\n  useComponentDidUpdate(function () {\n    setMsgError(!actionMsg ? t('The_field_is_required', t('Message')) : '');\n  }, [t, actionMsg]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Field, {\n    className: className\n  }, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Enabled')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    checked: enabled,\n    onChange: handleEnabled\n  })))), /*#__PURE__*/React.createElement(Field, {\n    className: className\n  }, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Run_only_once_for_each_visitor')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    checked: runOnce,\n    onChange: handleRunOnce\n  })))), /*#__PURE__*/React.createElement(Field, {\n    className: className\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Name'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: name,\n    error: nameError,\n    onChange: handleName,\n    placeholder: t('Name')\n  })), /*#__PURE__*/React.createElement(Field.Error, null, nameError)), /*#__PURE__*/React.createElement(Field, {\n    className: className\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Description')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: description,\n    onChange: handleDescription,\n    placeholder: t('Description')\n  }))), /*#__PURE__*/React.createElement(Field, {\n    className: className\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Condition')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(Select, {\n    options: conditionOptions,\n    value: conditionName,\n    onChange: handleConditionName\n  })), conditionValuePlaceholder && /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: conditionValue,\n    onChange: handleConditionValue,\n    placeholder: conditionValuePlaceholder\n  }))), /*#__PURE__*/React.createElement(Field, {\n    className: className\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Action')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: t('Send_a_message'),\n    disabled: true\n  })), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(Select, {\n    options: senderOptions,\n    value: actionSender,\n    onChange: handleActionSender,\n    placeholder: t('Select_an_option')\n  })), actionSender === 'custom' && /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: actionAgentName,\n    onChange: handleActionAgentName,\n    placeholder: t('Name_of_agent')\n  })), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {\n    rows: 3,\n    value: actionMsg,\n    onChange: handleActionMessage,\n    placeholder: t('Message') + \"*\"\n  })), /*#__PURE__*/React.createElement(Field.Error, null, msgError)));\n};\n\nmodule.exportDefault(TriggersForm);","map":{"version":3,"sources":["client/views/omnichannel/triggers/TriggersForm.tsx"],"names":[],"mappings":"AAAA,IAAA,aAAA;;AAAc,MAAO,CAAA,IAAP,CAAgB,sCAAhB,EAAqE;AAAA,EAAA,OAAM,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,aAAwB,GAAA,CAAxB;AAAwB;AAA9B,CAArE,EAAmG,CAAnG;;AAAmG,IAAA,cAAA;;AAAA,MAAA,CAAA,IAAA,CAAA,sCAAA,EAAA;AAAA,EAAA,OAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,cAAA,GAAA,CAAA;AAAA;AAAA,CAAA,EAAA,CAAA;AAAjH,IAAA,GAAA,EAAO,KAAP,EAAc,SAAd,EAAqB,YAArB,EAAgC,MAAhC,EAA4C,aAA5C;AAAsD,MAAA,CAAA,IAAA,CAA6B,uBAA7B,EAAmC;AAAA,EAAA,GAAuB,EAAC,UAAA,CAAA,EAAA;AAAA,IAAA,GAAA,GAAA,CAAA;AAAA,GAAxB;AAAwB,EAAA,KAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA,GAAxB;AAAwB,EAAA,SAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,SAAA,GAAA,CAAA;AAAA,GAAxB;AAAwB,EAAA,YAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,YAAA,GAAA,CAAA;AAAA,GAAxB;AAAwB,EAAA,MAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,MAAA,GAAA,CAAA;AAAA,GAAxB;AAAwB,EAAA,aAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,aAAA,GAAA,CAAA;AAAA;AAAxB,CAAnC,EAA2D,CAA3D;AAA2D,IAAA,kBAAA;AAAA,MAAA,CAAA,IAAA,CAAA,6BAAA,EAAA;AAAA,EAAA,kBAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,kBAAA,GAAA,CAAA;AAAA;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,KAAA,EAAA,OAAA,EAAA,QAAA;AAAA,MAAA,CAAA,IAAA,CAAA,OAAA,EAAA;AAAA,aAAA,UAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA,GAAA;AAAA,EAAA,OAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,OAAA,GAAA,CAAA;AAAA,GAAA;AAAA,EAAA,QAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,QAAA,GAAA,CAAA;AAAA;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,cAAA;AAAA,MAAA,CAAA,IAAA,CAAA,sCAAA,EAAA;AAAA,EAAA,cAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,cAAA,GAAA,CAAA;AAAA;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,qBAAA;AAAA,MAAA,CAAA,IAAA,CAAA,sCAAA,EAAA;AAAA,EAAA,qBAAA,EAAA,UAAA,CAAA,EAAA;AAAA,IAAA,qBAAA,GAAA,CAAA;AAAA;AAAA,CAAA,EAAA,CAAA;;AA2CjH,IAAM,YAAY,GAA0B,gBAAoC;AAAA,MAAjC,MAAiC,QAAjC,MAAiC;AAAA,MAAzB,QAAyB,QAAzB,QAAyB;AAAA,MAAf,SAAe,QAAf,SAAe;;AAC/E,kBAAkC,QAAQ,CAAC,EAAD,CAA1C;AAAA;AAAA,MAAO,SAAP;AAAA,MAAkB,YAAlB;;AACA,mBAAgC,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAO,QAAP;AAAA,MAAiB,WAAjB;;AACA,MAAM,CAAC,GAAG,cAAc,EAAxB;AACA,MAAQ,IAAR,GAAqE,MAArE,CAAQ,IAAR;AAAA,MAAc,WAAd,GAAqE,MAArE,CAAc,WAAd;AAAA,MAA2B,OAA3B,GAAqE,MAArE,CAA2B,OAA3B;AAAA,MAAoC,OAApC,GAAqE,MAArE,CAAoC,OAApC;AAAA,MAA6C,UAA7C,GAAqE,MAArE,CAA6C,UAA7C;AAAA,MAAyD,OAAzD,GAAqE,MAArE,CAAyD,OAAzD;AAEA,MAAQ,UAAR,GAAyG,QAAzG,CAAQ,UAAR;AAAA,MAAoB,iBAApB,GAAyG,QAAzG,CAAoB,iBAApB;AAAA,MAAuC,aAAvC,GAAyG,QAAzG,CAAuC,aAAvC;AAAA,MAAsD,aAAtD,GAAyG,QAAzG,CAAsD,aAAtD;AAAA,MAAqE,gBAArE,GAAyG,QAAzG,CAAqE,gBAArE;AAAA,MAAuF,aAAvF,GAAyG,QAAzG,CAAuF,aAAvF;AAEA,MAAc,aAAd,GAAuD,UAAvD,CAAQ,IAAR;AAAA,MAAoC,cAApC,GAAuD,UAAvD,CAA6B,KAA7B;AAEA,wBAEI,OAFJ,CACC,MADD;AAAA,MACmB,YADnB,mBACW,MADX;AAAA,MACsC,SADtC,mBACiC,GADjC;AAAA,MACuD,eADvD,mBACiD,IADjD;AAIA,MAAM,gBAAgB,GAAmB,OAAO,CAC/C;AAAA,WAAM,CACL,CAAC,UAAD,EAAa,CAAC,CAAC,kBAAD,CAAd,CADK,EAEL,CAAC,cAAD,EAAiB,CAAC,CAAC,sBAAD,CAAlB,CAFK,EAGL,CAAC,wBAAD,EAA2B,CAAC,CAAC,wBAAD,CAA5B,CAHK,CAAN;AAAA,GAD+C,EAM/C,CAAC,CAAD,CAN+C,CAAhD;AASA,MAAM,0BAA0B,GAAwC,OAAO,CAC9E;AAAA,WAAO;AACN,kBAAY,CAAC,CAAC,eAAD,CADP;AAEN,sBAAgB,CAAC,CAAC,iBAAD;AAFX,KAAP;AAAA,GAD8E,EAK9E,CAAC,CAAD,CAL8E,CAA/E;AAQA,MAAM,yBAAyB,GAAG,0BAA0B,CAAC,aAAD,CAA5D;AAEA,MAAM,aAAa,GAAmB,OAAO,CAC5C;AAAA,WAAM,CACL,CAAC,OAAD,EAAU,CAAC,CAAC,mCAAD,CAAX,CADK,EAEL,CAAC,QAAD,EAAW,CAAC,CAAC,cAAD,CAAZ,CAFK,CAAN;AAAA,GAD4C,EAK5C,CAAC,CAAD,CAL4C,CAA7C;AAQA,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,UAAC,IAAD,EAAS;AACvD,IAAA,gBAAgB,CAAC;AAChB,MAAA,IAAI,EAAJ,IADgB;AAEhB,MAAA,KAAK,EAAE;AAFS,KAAD,CAAhB;AAIA,GAL6C,CAA9C;AAOA,MAAM,oBAAoB,GAAG,kBAAkB,CAAC,iBAAiC;AAAA,QAAb,KAAa,SAA9B,aAA8B,CAAb,KAAa;AAChF,IAAA,gBAAgB,iCACZ,UADY;AAEf,MAAA,KAAK,EAAL;AAFe,OAAhB;AAIA,GAL8C,CAA/C;AAOA,MAAM,qBAAqB,GAAG,kBAAkB,CAAC,iBAAuC;AAAA,QAAZ,IAAY,SAApC,aAAoC,CAAnB,KAAmB;AACvF,IAAA,aAAa,iCACT,OADS;AAEZ,MAAA,MAAM,kCACF,OAAO,CAAC,MADN;AAEL,QAAA,IAAI,EAAJ;AAFK;AAFM,OAAb;AAOA,GAR+C,CAAhD;AAUA,MAAM,kBAAkB,GAAG,kBAAkB,CAAC,UAAC,MAAD,EAAW;AACxD,IAAA,aAAa,iCACT,OADS;AAEZ,MAAA,MAAM,kCACF,OAAO,CAAC,MADN;AAEL,QAAA,MAAM,EAAN;AAFK;AAFM,OAAb;AAOA,GAR4C,CAA7C;AAUA,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,iBAAsC;AAAA,QAAX,GAAW,SAAnC,aAAmC,CAAlB,KAAkB;AACpF,IAAA,aAAa,iCACT,OADS;AAEZ,MAAA,MAAM,kCACF,OAAO,CAAC,MADN;AAEL,QAAA,GAAG,EAAH;AAFK;AAFM,OAAb;AAOA,GAR6C,CAA9C;AASA,EAAA,qBAAqB,CAAC,YAAK;AAC1B,IAAA,YAAY,CAAC,CAAC,IAAD,GAAQ,CAAC,CAAC,uBAAD,EAA0B,CAAC,CAAC,MAAD,CAA3B,CAAT,GAAgD,EAAjD,CAAZ;AACA,GAFoB,EAElB,CAAC,CAAD,EAAI,IAAJ,CAFkB,CAArB;AAGA,EAAA,qBAAqB,CAAC,YAAK;AAC1B,IAAA,WAAW,CAAC,CAAC,SAAD,GAAa,CAAC,CAAC,uBAAD,EAA0B,CAAC,CAAC,SAAD,CAA3B,CAAd,GAAwD,EAAzD,CAAX;AACA,GAFoB,EAElB,CAAC,CAAD,EAAI,SAAJ,CAFkB,CAArB;AAGA,sBACC,uDACC,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAE;AAAlB,kBACC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC;AAAlC,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,SAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,YAAD;AAAc,IAAA,OAAO,EAAE,OAAvB;AAAgC,IAAA,QAAQ,EAAE;AAA1C,IADD,CAFD,CADD,CADD,eASC,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAE;AAAlB,kBACC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC;AAAlC,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,gCAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,YAAD;AAAc,IAAA,OAAO,EAAE,OAAvB;AAAgC,IAAA,QAAQ,EAAE;AAA1C,IADD,CAFD,CADD,CATD,eAiBC,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAE;AAAlB,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,MAAD,CAAf,MADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,IAAlB;AAAwB,IAAA,KAAK,EAAE,SAA/B;AAA0C,IAAA,QAAQ,EAAE,UAApD;AAAgE,IAAA,WAAW,EAAE,CAAC,CAAC,MAAD;AAA9E,IADD,CAFD,eAKC,oBAAC,KAAD,CAAO,KAAP,QAAc,SAAd,CALD,CAjBD,eAwBC,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAE;AAAlB,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,aAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,WAAlB;AAA+B,IAAA,QAAQ,EAAE,iBAAzC;AAA4D,IAAA,WAAW,EAAE,CAAC,CAAC,aAAD;AAA1E,IADD,CAFD,CAxBD,eA8BC,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAE;AAAlB,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,WAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAE,gBAAjB;AAAmC,IAAA,KAAK,EAAE,aAA1C;AAAyD,IAAA,QAAQ,EAAE;AAAnE,IADD,CAFD,EAKE,yBAAyB,iBACzB,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,cAAlB;AAAkC,IAAA,QAAQ,EAAE,oBAA5C;AAAkE,IAAA,WAAW,EAAE;AAA/E,IADD,CANF,CA9BD,eAyCC,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAE;AAAlB,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAc,CAAC,CAAC,QAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,CAAC,CAAC,gBAAD,CAAnB;AAAuC,IAAA,QAAQ;AAA/C,IADD,CAFD,eAKC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAE,aAAjB;AAAgC,IAAA,KAAK,EAAE,YAAvC;AAAqD,IAAA,QAAQ,EAAE,kBAA/D;AAAmF,IAAA,WAAW,EAAE,CAAC,CAAC,kBAAD;AAAjG,IADD,CALD,EAQE,YAAY,KAAK,QAAjB,iBACA,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,eAAlB;AAAmC,IAAA,QAAQ,EAAE,qBAA7C;AAAoE,IAAA,WAAW,EAAE,CAAC,CAAC,eAAD;AAAlF,IADD,CATF,eAaC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,aAAD;AAAe,IAAA,IAAI,EAAE,CAArB;AAAwB,IAAA,KAAK,EAAE,SAA/B;AAA0C,IAAA,QAAQ,EAAE,mBAApD;AAAyE,IAAA,WAAW,EAAK,CAAC,CAAC,SAAD,CAAN;AAApF,IADD,CAbD,eAgBC,oBAAC,KAAD,CAAO,KAAP,QAAc,QAAd,CAhBD,CAzCD,CADD;AA8DA,CAxJD;;AA3CA,MAAA,CAAO,aAAP,CAqMe,YArMf","sourcesContent":["import { Box, Field, TextInput, ToggleSwitch, Select, TextAreaInput, SelectOption } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ComponentProps, FC, FormEvent, useMemo, useState } from 'react';\n\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\n\ntype TriggerConditions = {\n\tname: string;\n\tvalue: string | number;\n};\n\ntype TriggerActions = {\n\tname: string;\n\tparams: {\n\t\tsender: string | undefined;\n\t\tmsg: string;\n\t\tname: string;\n\t};\n};\n\ntype TriggersFormProps = {\n\tvalues: {\n\t\tname: string;\n\t\tdescription: string;\n\t\tenabled: boolean;\n\t\trunOnce: boolean;\n\t\t// In the future, this will be an array\n\t\tconditions: TriggerConditions;\n\t\t// In the future, this will be an array\n\t\tactions: TriggerActions;\n\t};\n\thandlers: {\n\t\thandleName: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleDescription: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleEnabled: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleRunOnce: (event: FormEvent<HTMLInputElement>) => void;\n\t\thandleConditions: (value: TriggerConditions) => void;\n\t\thandleActions: (value: TriggerActions) => void;\n\t};\n\tclassName?: ComponentProps<typeof Field>['className'];\n};\n\nconst TriggersForm: FC<TriggersFormProps> = ({ values, handlers, className }) => {\n\tconst [nameError, setNameError] = useState('');\n\tconst [msgError, setMsgError] = useState('');\n\tconst t = useTranslation();\n\tconst { name, description, enabled, runOnce, conditions, actions } = values;\n\n\tconst { handleName, handleDescription, handleEnabled, handleRunOnce, handleConditions, handleActions } = handlers;\n\n\tconst { name: conditionName, value: conditionValue } = conditions;\n\n\tconst {\n\t\tparams: { sender: actionSender, msg: actionMsg, name: actionAgentName },\n\t} = actions;\n\n\tconst conditionOptions: SelectOption[] = useMemo(\n\t\t() => [\n\t\t\t['page-url', t('Visitor_page_URL')],\n\t\t\t['time-on-site', t('Visitor_time_on_site')],\n\t\t\t['chat-opened-by-visitor', t('Chat_opened_by_visitor')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst conditionValuePlaceholders: { [conditionName: string]: string } = useMemo(\n\t\t() => ({\n\t\t\t'page-url': t('Enter_a_regex'),\n\t\t\t'time-on-site': t('Time_in_seconds'),\n\t\t}),\n\t\t[t],\n\t);\n\n\tconst conditionValuePlaceholder = conditionValuePlaceholders[conditionName];\n\n\tconst senderOptions: SelectOption[] = useMemo(\n\t\t() => [\n\t\t\t['queue', t('Impersonate_next_agent_from_queue')],\n\t\t\t['custom', t('Custom_agent')],\n\t\t],\n\t\t[t],\n\t);\n\n\tconst handleConditionName = useMutableCallback((name) => {\n\t\thandleConditions({\n\t\t\tname,\n\t\t\tvalue: '',\n\t\t});\n\t});\n\n\tconst handleConditionValue = useMutableCallback(({ currentTarget: { value } }) => {\n\t\thandleConditions({\n\t\t\t...conditions,\n\t\t\tvalue,\n\t\t});\n\t});\n\n\tconst handleActionAgentName = useMutableCallback(({ currentTarget: { value: name } }) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tname,\n\t\t\t},\n\t\t});\n\t});\n\n\tconst handleActionSender = useMutableCallback((sender) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tsender,\n\t\t\t},\n\t\t});\n\t});\n\n\tconst handleActionMessage = useMutableCallback(({ currentTarget: { value: msg } }) => {\n\t\thandleActions({\n\t\t\t...actions,\n\t\t\tparams: {\n\t\t\t\t...actions.params,\n\t\t\t\tmsg,\n\t\t\t},\n\t\t});\n\t});\n\tuseComponentDidUpdate(() => {\n\t\tsetNameError(!name ? t('The_field_is_required', t('Name')) : '');\n\t}, [t, name]);\n\tuseComponentDidUpdate(() => {\n\t\tsetMsgError(!actionMsg ? t('The_field_is_required', t('Message')) : '');\n\t}, [t, actionMsg]);\n\treturn (\n\t\t<>\n\t\t\t<Field className={className}>\n\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t<Field.Label>{t('Enabled')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<ToggleSwitch checked={enabled} onChange={handleEnabled} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Box>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t<Field.Label>{t('Run_only_once_for_each_visitor')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<ToggleSwitch checked={runOnce} onChange={handleRunOnce} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Box>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={name} error={nameError} onChange={handleName} placeholder={t('Name')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Error>{nameError}</Field.Error>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Description')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={description} onChange={handleDescription} placeholder={t('Description')} />\n\t\t\t\t</Field.Row>\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Condition')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select options={conditionOptions} value={conditionName} onChange={handleConditionName} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{conditionValuePlaceholder && (\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={conditionValue} onChange={handleConditionValue} placeholder={conditionValuePlaceholder} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t)}\n\t\t\t</Field>\n\t\t\t<Field className={className}>\n\t\t\t\t<Field.Label>{t('Action')}</Field.Label>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextInput value={t('Send_a_message')} disabled />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<Select options={senderOptions} value={actionSender} onChange={handleActionSender} placeholder={t('Select_an_option')} />\n\t\t\t\t</Field.Row>\n\t\t\t\t{actionSender === 'custom' && (\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput value={actionAgentName} onChange={handleActionAgentName} placeholder={t('Name_of_agent')} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t)}\n\t\t\t\t<Field.Row>\n\t\t\t\t\t<TextAreaInput rows={3} value={actionMsg} onChange={handleActionMessage} placeholder={`${t('Message')}*`} />\n\t\t\t\t</Field.Row>\n\t\t\t\t<Field.Error>{msgError}</Field.Error>\n\t\t\t</Field>\n\t\t</>\n\t);\n};\n\nexport default TriggersForm;\n"],"sourceRoot":""},"sourceType":"module","hash":"1c626881aaf461f301ba2452e1071f17493974be"}
