{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx","inputSourceMap":{"version":3,"file":"client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx","sourceRoot":"","sources":["client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AACjE,OAAO,EAAE,UAAU,EAAE,MAAM,2BAA2B,CAAC;AACvD,OAAO,EAAE,OAAO,EAAE,MAAM,gBAAgB,CAAC;AACzC,OAAO,KAAK,EAAE,EAAE,WAAW,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,OAAO,CAAC;AAEhE,OAAO,EAAE,WAAW,EAAE,MAAM,0CAA0C,CAAC;AAEvE,OAAO,oBAAoB,MAAM,+FAA+F,CAAC;AACjI,OAAO,cAAc,MAAM,gEAAgE,CAAC;AAC5F,OAAO,kBAAkB,MAAM,oEAAoE,CAAC;AACpG,OAAO,gBAAgB,MAAM,kEAAkE,CAAC;AAChG,OAAO,oBAAoB,MAAM,sEAAsE,CAAC;AACxG,OAAO,eAAe,MAAM,iEAAiE,CAAC;AAC9F,OAAO,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,iDAAiD,CAAC;AACzF,OAAO,EAAE,WAAW,EAAE,MAAM,yCAAyC,CAAC;AACtE,OAAO,EAAE,yBAAyB,EAAE,MAAM,+CAA+C,CAAC;AAC1F,OAAO,EAAE,WAAW,EAAE,SAAS,EAAE,MAAM,0CAA0C,CAAC;AAClF,OAAO,EAAE,UAAU,EAAE,MAAM,4CAA4C,CAAC;AACxE,OAAO,EAAE,uBAAuB,EAAE,MAAM,iDAAiD,CAAC;AAC1F,OAAO,EAAE,cAAc,EAAE,MAAM,+CAA+C,CAAC;AAC/E,OAAO,EAAE,SAAS,EAAE,MAAM,wCAAwC,CAAC;AACnE,OAAO,EAAE,WAAW,EAAE,MAAM,yCAAyC,CAAC;AACtE,OAAO,EAA4B,gBAAgB,EAAE,MAAM,8BAA8B,CAAC;AAC1F,OAAO,EAAE,sBAAsB,EAAE,MAAM,kDAAkD,CAAC;AAE1F,MAAM,CAAC,MAAM,eAAe,GAAG,CAC9B,IAAsB,EAKrB,EAAE;IACH,MAAM,QAAQ,GAAG,WAAW,EAAE,CAAC;IAE/B,MAAM,CAAC,GAAG,cAAc,EAAE,CAAC;IAC3B,MAAM,oBAAoB,GAAG,uBAAuB,EAAE,CAAC;IACvD,MAAM,OAAO,GAAG,sBAAsB,EAAE,CAAC;IACzC,MAAM,OAAO,GAAI,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE,CAAgC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC;IAErI,MAAM,CAAC,iBAAiB,EAAE,oBAAoB,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAElE,MAAM,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;IACjC,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;IACrB,MAAM,GAAG,GAAG,SAAS,EAAE,CAAC;IACxB,MAAM,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC;IAEzC,MAAM,cAAc,GAAG,WAAW,CAAC,KAAK,EAAE,wBAAwB,CAAC,CAAC;IAEpE,MAAM,eAAe,GAAG,kBAAkB,CAAC,KAAK,IAAI,EAAE;QACrD,IAAI,CAAC,aAAa,EAAE;YACnB,OAAO;SACP;QAED,MAAM,EACL,OAAO,EAAE,EAAE,aAAa,EAAE,GAC1B,GAAG,MAAM,cAAc,CAAC,EAAE,SAAS,EAAE,aAAa,EAAE,CAAC,CAAC;QAEvD,IAAI,aAAa,EAAE,MAAM,IAAI,aAAa,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE;YACtD,OAAO,aAAa,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;SAChC;IACF,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,IAAI,iBAAiB,IAAI,eAAe,EAAE,KAAK,EAAE;YAChD,QAAQ,CAAC,IAAI,CAAC,CAAC;SACf;IACF,CAAC,EAAE,CAAC,eAAe,EAAE,iBAAiB,EAAE,QAAQ,CAAC,CAAC,CAAC;IAEnD,MAAM,UAAU,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC;IAEjE,MAAM,gBAAgB,GAAG,WAAW,CAAC,GAAG,EAAE;QACzC,UAAU,EAAE,CAAC;QACb,oBAAoB,CAAC,KAAK,CAAC,CAAC;IAC7B,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;IAEjB,MAAM,YAAY,GAAG,SAAS,CAAC,0BAA0B,CAAC,CAAC;IAE3D,MAAM,cAAc,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE;QAC7C,IAAI;YACH,MAAM,YAAY,CAAC,GAAG,CAAC,CAAC;YACxB,UAAU,EAAE,CAAC;YACb,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;YAChC,UAAU,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;SACvB;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EAAE,CAAC,UAAU,EAAE,YAAY,EAAE,GAAG,CAAC,CAAC,CAAC;IAEpC,MAAM,iBAAiB,GAAG,SAAS,CAAC,4BAA4B,CAAC,CAAC;IAElE,MAAM,uBAAuB,GAAG,WAAW,CAC1C,KAAK,EAAE,KAAa,EAAE,OAAe,EAAE,EAAE;QACxC,IAAI;YACH,MAAM,iBAAiB,CAAC,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;YAC7C,UAAU,EAAE,CAAC;YACb,WAAW,CAAC,KAAK,CAAC,IAAI,GAAG,EAAE,CAAC,CAAC;YAC7B,oBAAoB,CAAC;gBACpB,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,CAAC,CAAC,wCAAwC,CAAC;aACpD,CAAC,CAAC;SACH;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EACD,CAAC,UAAU,EAAE,oBAAoB,EAAE,iBAAiB,EAAE,GAAG,EAAE,CAAC,CAAC,CAC7D,CAAC;IAEF,MAAM,cAAc,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC;IAE5D,MAAM,oBAAoB,GAAG,WAAW,CACvC,KAAK,EAAE,KAAa,EAAE,OAAe,EAAE,KAAa,EAAE,EAAE;QACvD,IAAI;YACH,MAAM,cAAc,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;YACjD,UAAU,EAAE,CAAC;SACb;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EACD,CAAC,UAAU,EAAE,GAAG,EAAE,cAAc,CAAC,CACjC,CAAC;IAEF,MAAM,iBAAiB,GAAG,SAAS,CAAC,4BAA4B,CAAC,CAAC;IAElE,MAAM,uBAAuB,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE;QACtD,IAAI;YACH,MAAM,iBAAiB,CAAC,GAAG,CAAC,CAAC;YAC7B,oBAAoB,CAAC;gBACpB,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,CAAC,CAAC,+CAA+C,CAAC;aAC3D,CAAC,CAAC;YACH,UAAU,EAAE,CAAC;SACb;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EAAE,CAAC,UAAU,EAAE,iBAAiB,EAAE,oBAAoB,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IAElE,MAAM,WAAW,GAAG,SAAS,CAAC,mBAAmB,CAAC,CAAC;IAEnD,MAAM,iBAAiB,GAAG,WAAW,CACpC,KAAK,EAAE,YAAqB,EAAE,MAAe,EAAE,OAAgB,EAAE,EAAE;QAClE,IAAI,YAAY,IAAI,MAAM,EAAE;YAC3B,OAAO;SACP;QACD,MAAM,YAAY,GAMd;YACH,MAAM,EAAE,GAAG;YACX,OAAO;YACP,YAAY,EAAE,IAAI;SAClB,CAAC;QAEF,IAAI,YAAY,EAAE;YACjB,YAAY,CAAC,YAAY,GAAG,YAAY,CAAC;SACzC;QACD,IAAI,MAAM,EAAE;YACX,YAAY,CAAC,MAAM,GAAG,MAAM,CAAC;SAC7B;QAED,IAAI;YACH,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,YAAY,CAAC,CAAC;YAC/C,IAAI,CAAC,MAAM,EAAE;gBACZ,MAAM,IAAI,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,sCAAsC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,uBAAuB,CAAC,CAAC,CAAC;aACvG;YACD,oBAAoB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;YACrE,UAAU,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;YACnB,UAAU,EAAE,CAAC;SACb;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EACD,CAAC,UAAU,EAAE,oBAAoB,EAAE,WAAW,EAAE,GAAG,EAAE,CAAC,CAAC,CACvD,CAAC;IAEF,MAAM,SAAS,GAAG,SAAS,CAAC,oBAAoB,CAAC,CAAC;IAElD,MAAM,WAAW,GAAG,WAAW,CAC9B,KAAK,EAAE,OAAe,EAAE,IAAc,EAAE,EAAE;QACzC,IAAI;YACH,MAAM,SAAS,CAAC,GAAG,EAAE,OAAO,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5D,UAAU,EAAE,CAAC;YACb,oBAAoB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC;SAClF;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EACD,CAAC,SAAS,EAAE,UAAU,EAAE,oBAAoB,EAAE,GAAG,EAAE,CAAC,CAAC,CACrD,CAAC;IAEF,MAAM,UAAU,GAAG,WAAW,CAAC,MAAM,EAAE,sBAAsB,CAAC,CAAC;IAE/D,MAAM,gBAAgB,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE;QAC/C,IAAI;YACH,MAAM,UAAU,CAAC,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;YAClC,UAAU,EAAE,CAAC;YACb,oBAAoB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;SACnF;QAAC,OAAO,KAAU,EAAE;YACpB,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC,EAAE,CAAC,UAAU,EAAE,GAAG,EAAE,UAAU,EAAE,oBAAoB,EAAE,CAAC,CAAC,CAAC,CAAC;IAE3D,MAAM,SAAS,GAAG,kBAAkB,CAAC,KAAK,EAAE,EAAU,EAAE,EAAE;QACzD,QAAQ,EAAE,EAAE;YACX,KAAK,gBAAgB,CAAC,SAAS;gBAC9B,QAAQ,CAAC,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,EAAG,CAAC,CAAC;gBACrF,MAAM;YACP,KAAK,gBAAgB,CAAC,UAAU;gBAC/B,MAAM,YAAY,GAAG,MAAM,eAAe,EAAE,CAAC;gBAE7C,IAAI,CAAC,YAAY,EAAE;oBAClB,oBAAoB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC,mCAAmC,CAAC,EAAE,CAAC,CAAC;oBACzF,MAAM;iBACN;gBAED,QAAQ,CACP,CAAC,eAAe,CACf,IAAI,CAAC,CAAC,IAAI,CAAC,CACX,KAAK,CAAC,CAAC,YAAY,CAAC,CACpB,SAAS,CAAC,CAAC,uBAAuB,CAAC,CACnC,MAAM,CAAC,CAAC,oBAAoB,CAAC,CAC7B,SAAS,CAAC,CAAC,uBAAuB,CAAC,CACnC,QAAQ,CAAC,CAAC,UAAU,CAAC,EACpB,CACF,CAAC;gBACF,MAAM;YACP,KAAK,gBAAgB,CAAC,WAAW;gBAChC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,EAAG,CAAC,CAAC;gBAC/F,MAAM;YACP,KAAK,gBAAgB,CAAC,SAAS;gBAC9B,QAAQ,CACP,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CACnB,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,EAAG,CACrG,CAAC,CAAC,CAAC,CACH,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,EAAG,CAChE,CACD,CAAC;gBACF,MAAM;YACP,KAAK,gBAAgB,CAAC,UAAU;gBAC/B,QAAQ,CAAC,CAAC,oBAAoB,CAAC,YAAY,CAAC,CAAC,gBAAgB,CAAC,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,EAAG,CAAC,CAAC;gBAC/F,oBAAoB,CAAC,IAAI,CAAC,CAAC;gBAC3B,MAAM;YACP;gBACC,MAAM;SACP;IACF,CAAC,CAAC,CAAC;IAEH,MAAM,sBAAsB,GAAG,yBAAyB,EAAE,CAAC;IAE3D,MAAM,mBAAmB,GAAG,UAAU,CAAC,+BAA+B,CAAC,CAAC;IAExE,MAAM,cAAc,GAAG,OAAO,CAAC,kBAAkB,CAAC,CAAC;IAEnD,MAAM,QAAQ,GAAG,IAAI,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,KAAK,GAAG,IAAI,cAAc,CAAC,IAAI,IAAI,EAAE,WAAW,EAAE,CAAC,KAAK,gBAAgB,CAAC;IACpH,MAAM,YAAY,GAAG,CAAC,CAAC,sBAAsB,EAAE,WAAW,IAAI,IAAI,EAAE,CAAC,KAAK,SAAS,CAAC;IACpF,MAAM,eAAe,GAAG,aAAa,CAAC,yBAAyB,CAAC,CAAC;IACjE,MAAM,iBAAiB,GAAG,aAAa,CAAC,kCAAkC,CAAC,CAAC;IAC5E,MAAM,YAAY,GAAG,aAAa,CAAC,qBAAqB,CAAC,CAAC;IAC1D,MAAM,kBAAkB,GAAG,aAAa,CAAC,4BAA4B,CAAC,CAAC;IACvE,MAAM,kBAAkB,GAAG,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,CAAC,IAAI,CAAE,IAAY,CAAC,WAAW,EAAE,KAAK,IAAI,mBAAmB,CAAC,CAAC;IAEvH,MAAM,oBAAoB,GAAG,CAAC,EAAU,EAAW,EAAE;QACpD,QAAQ,EAAE,EAAE;YACX,KAAK,gBAAgB,CAAC,SAAS;gBAC9B,OAAO,CAAC,CAAC,QAAQ,IAAI,YAAY,CAAC;YACnC,KAAK,gBAAgB,CAAC,WAAW;gBAChC,OAAO,CAAC,CAAC,QAAQ,IAAI,eAAe,CAAC;YACtC,KAAK,gBAAgB,CAAC,UAAU;gBAC/B,OAAO,iBAAiB,CAAC;YAC1B,KAAK,gBAAgB,CAAC,SAAS;gBAC9B,OAAO,CAAC,CAAC,QAAQ,IAAI,CAAC,YAAY,IAAI,kBAAkB,CAAC,CAAC;YAC3D,KAAK,gBAAgB,CAAC,UAAU;gBAC/B,OAAO,CAAC,CAAC,QAAQ,IAAI,kBAAkB,CAAC;YACzC;gBACC,MAAM;SACP;QACD,OAAO,KAAK,CAAC;IACd,CAAC,CAAC;IAEF,MAAM,cAAc,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,CAAC;IAE5E,MAAM,aAAa,GAAG,kBAAkB,CAAC,CAAC,CAAC,EAAE,EAAE;QAC9C,MAAM,KAAK,GAAG,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,oBAAoB,CAAC,CAAC;QACjE,MAAM,EAAE,EAAE,EAAE,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;QACrC,SAAS,CAAC,EAAE,CAAC,CAAC;IACf,CAAC,CAAC,CAAC;IAEH,MAAM,SAAS,GAAG,kBAAkB,CAAC,CAAC,EAAE,EAAE,EAAE;QAC3C,SAAS,CAAC,EAAE,CAAC,CAAC;IACf,CAAC,CAAC,CAAC;IAEH,OAAO,EAAE,cAAc,EAAE,aAAa,EAAE,SAAS,EAAE,CAAC;AACrD,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Session } from 'meteor/session';\nimport React, { useCallback, useState, useEffect } from 'react';\n\nimport { RoomManager } from '../../../../../../../app/ui-utils/client';\nimport { IOmnichannelRoom } from '../../../../../../../definition/IRoom';\nimport PlaceChatOnHoldModal from '../../../../../../../ee/app/livechat-enterprise/client/components/modals/PlaceChatOnHoldModal';\nimport CloseChatModal from '../../../../../../components/Omnichannel/modals/CloseChatModal';\nimport CloseChatModalData from '../../../../../../components/Omnichannel/modals/CloseChatModalData';\nimport ForwardChatModal from '../../../../../../components/Omnichannel/modals/ForwardChatModal';\nimport ReturnChatQueueModal from '../../../../../../components/Omnichannel/modals/ReturnChatQueueModal';\nimport TranscriptModal from '../../../../../../components/Omnichannel/modals/TranscriptModal';\nimport { usePermission, useRole } from '../../../../../../contexts/AuthorizationContext';\nimport { useSetModal } from '../../../../../../contexts/ModalContext';\nimport { useOmnichannelRouteConfig } from '../../../../../../contexts/OmnichannelContext';\nimport { useEndpoint, useMethod } from '../../../../../../contexts/ServerContext';\nimport { useSetting } from '../../../../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../../contexts/TranslationContext';\nimport { useUserId } from '../../../../../../contexts/UserContext';\nimport { handleError } from '../../../../../../lib/utils/handleError';\nimport { QuickActionsActionConfig, QuickActionsEnum } from '../../../../lib/QuickActions';\nimport { useQuickActionsContext } from '../../../../lib/QuickActions/QuickActionsContext';\n\nexport const useQuickActions = (\n\troom: IOmnichannelRoom,\n): {\n\tvisibleActions: QuickActionsActionConfig[];\n\tactionDefault: (e: unknown) => void;\n\tgetAction: (id: string) => void;\n} => {\n\tconst setModal = useSetModal();\n\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst context = useQuickActionsContext();\n\tconst actions = (Array.from(context.actions.values()) as QuickActionsActionConfig[]).sort((a, b) => (a.order || 0) - (b.order || 0));\n\n\tconst [onHoldModalActive, setOnHoldModalActive] = useState(false);\n\n\tconst visitorRoomId = room.v._id;\n\tconst rid = room._id;\n\tconst uid = useUserId();\n\tconst roomLastMessage = room.lastMessage;\n\n\tconst getVisitorInfo = useEndpoint('GET', 'livechat/visitors.info');\n\n\tconst getVisitorEmail = useMutableCallback(async () => {\n\t\tif (!visitorRoomId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tvisitor: { visitorEmails },\n\t\t} = await getVisitorInfo({ visitorId: visitorRoomId });\n\n\t\tif (visitorEmails?.length && visitorEmails[0].address) {\n\t\t\treturn visitorEmails[0].address;\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (onHoldModalActive && roomLastMessage?.token) {\n\t\t\tsetModal(null);\n\t\t}\n\t}, [roomLastMessage, onHoldModalActive, setModal]);\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tconst closeOnHoldModal = useCallback(() => {\n\t\tcloseModal();\n\t\tsetOnHoldModalActive(false);\n\t}, [closeModal]);\n\n\tconst methodReturn = useMethod('livechat:returnAsInquiry');\n\n\tconst handleMoveChat = useCallback(async () => {\n\t\ttry {\n\t\t\tawait methodReturn(rid);\n\t\t\tcloseModal();\n\t\t\tSession.set('openedRoom', null);\n\t\t\tFlowRouter.go('/home');\n\t\t} catch (error: any) {\n\t\t\thandleError(error);\n\t\t}\n\t}, [closeModal, methodReturn, rid]);\n\n\tconst requestTranscript = useMethod('livechat:requestTranscript');\n\n\tconst handleRequestTranscript = useCallback(\n\t\tasync (email: string, subject: string) => {\n\t\t\ttry {\n\t\t\t\tawait requestTranscript(rid, email, subject);\n\t\t\t\tcloseModal();\n\t\t\t\tRoomManager.close(`l${rid}`);\n\t\t\t\tdispatchToastMessage({\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\tmessage: t('Livechat_transcript_has_been_requested'),\n\t\t\t\t});\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, requestTranscript, rid, t],\n\t);\n\n\tconst sendTranscript = useMethod('livechat:sendTranscript');\n\n\tconst handleSendTranscript = useCallback(\n\t\tasync (email: string, subject: string, token: string) => {\n\t\t\ttry {\n\t\t\t\tawait sendTranscript(token, rid, email, subject);\n\t\t\t\tcloseModal();\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeModal, rid, sendTranscript],\n\t);\n\n\tconst discardTranscript = useMethod('livechat:discardTranscript');\n\n\tconst handleDiscardTranscript = useCallback(async () => {\n\t\ttry {\n\t\t\tawait discardTranscript(rid);\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t('Livechat_transcript_request_has_been_canceled'),\n\t\t\t});\n\t\t\tcloseModal();\n\t\t} catch (error: any) {\n\t\t\thandleError(error);\n\t\t}\n\t}, [closeModal, discardTranscript, dispatchToastMessage, rid, t]);\n\n\tconst forwardChat = useMethod('livechat:transfer');\n\n\tconst handleForwardChat = useCallback(\n\t\tasync (departmentId?: string, userId?: string, comment?: string) => {\n\t\t\tif (departmentId && userId) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst transferData: {\n\t\t\t\troomId: string;\n\t\t\t\tclientAction: boolean;\n\t\t\t\tcomment?: string;\n\t\t\t\tdepartmentId?: string;\n\t\t\t\tuserId?: string;\n\t\t\t} = {\n\t\t\t\troomId: rid,\n\t\t\t\tcomment,\n\t\t\t\tclientAction: true,\n\t\t\t};\n\n\t\t\tif (departmentId) {\n\t\t\t\ttransferData.departmentId = departmentId;\n\t\t\t}\n\t\t\tif (userId) {\n\t\t\t\ttransferData.userId = userId;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst result = await forwardChat(transferData);\n\t\t\t\tif (!result) {\n\t\t\t\t\tthrow new Error(departmentId ? t('error-no-agents-online-in-department') : t('error-forwarding-chat'));\n\t\t\t\t}\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Transferred') });\n\t\t\t\tFlowRouter.go('/');\n\t\t\t\tcloseModal();\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, forwardChat, rid, t],\n\t);\n\n\tconst closeChat = useMethod('livechat:closeRoom');\n\n\tconst handleClose = useCallback(\n\t\tasync (comment: string, tags: string[]) => {\n\t\t\ttry {\n\t\t\t\tawait closeChat(rid, comment, { clientAction: true, tags });\n\t\t\t\tcloseModal();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Chat_closed_successfully') });\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeChat, closeModal, dispatchToastMessage, rid, t],\n\t);\n\n\tconst onHoldChat = useEndpoint('POST', 'livechat/room.onHold');\n\n\tconst handleOnHoldChat = useCallback(async () => {\n\t\ttry {\n\t\t\tawait onHoldChat({ roomId: rid });\n\t\t\tcloseModal();\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Chat_On_Hold_Successfully') });\n\t\t} catch (error: any) {\n\t\t\thandleError(error);\n\t\t}\n\t}, [onHoldChat, rid, closeModal, dispatchToastMessage, t]);\n\n\tconst openModal = useMutableCallback(async (id: string) => {\n\t\tswitch (id) {\n\t\t\tcase QuickActionsEnum.MoveQueue:\n\t\t\t\tsetModal(<ReturnChatQueueModal onMoveChat={handleMoveChat} onCancel={closeModal} />);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.Transcript:\n\t\t\t\tconst visitorEmail = await getVisitorEmail();\n\n\t\t\t\tif (!visitorEmail) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Customer_without_registered_email') });\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tsetModal(\n\t\t\t\t\t<TranscriptModal\n\t\t\t\t\t\troom={room}\n\t\t\t\t\t\temail={visitorEmail}\n\t\t\t\t\t\tonRequest={handleRequestTranscript}\n\t\t\t\t\t\tonSend={handleSendTranscript}\n\t\t\t\t\t\tonDiscard={handleDiscardTranscript}\n\t\t\t\t\t\tonCancel={closeModal}\n\t\t\t\t\t/>,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.ChatForward:\n\t\t\t\tsetModal(<ForwardChatModal room={room} onForward={handleForwardChat} onCancel={closeModal} />);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.CloseChat:\n\t\t\t\tsetModal(\n\t\t\t\t\troom.departmentId ? (\n\t\t\t\t\t\t<CloseChatModalData departmentId={room.departmentId} onConfirm={handleClose} onCancel={closeModal} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<CloseChatModal onConfirm={handleClose} onCancel={closeModal} />\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.OnHoldChat:\n\t\t\t\tsetModal(<PlaceChatOnHoldModal onOnHoldChat={handleOnHoldChat} onCancel={closeOnHoldModal} />);\n\t\t\t\tsetOnHoldModalActive(true);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tconst omnichannelRouteConfig = useOmnichannelRouteConfig();\n\n\tconst manualOnHoldAllowed = useSetting('Livechat_allow_manual_on_hold');\n\n\tconst hasManagerRole = useRole('livechat-manager');\n\n\tconst roomOpen = room?.open && (room.u?._id === uid || hasManagerRole) && room?.lastMessage?.t !== 'livechat-close';\n\tconst canMoveQueue = !!omnichannelRouteConfig?.returnQueue && room?.u !== undefined;\n\tconst canForwardGuest = usePermission('transfer-livechat-guest');\n\tconst canSendTranscript = usePermission('send-omnichannel-chat-transcript');\n\tconst canCloseRoom = usePermission('close-livechat-room');\n\tconst canCloseOthersRoom = usePermission('close-others-livechat-room');\n\tconst canPlaceChatOnHold = Boolean(!room.onHold && room.u && !(room as any).lastMessage?.token && manualOnHoldAllowed);\n\n\tconst hasPermissionButtons = (id: string): boolean => {\n\t\tswitch (id) {\n\t\t\tcase QuickActionsEnum.MoveQueue:\n\t\t\t\treturn !!roomOpen && canMoveQueue;\n\t\t\tcase QuickActionsEnum.ChatForward:\n\t\t\t\treturn !!roomOpen && canForwardGuest;\n\t\t\tcase QuickActionsEnum.Transcript:\n\t\t\t\treturn canSendTranscript;\n\t\t\tcase QuickActionsEnum.CloseChat:\n\t\t\t\treturn !!roomOpen && (canCloseRoom || canCloseOthersRoom);\n\t\t\tcase QuickActionsEnum.OnHoldChat:\n\t\t\t\treturn !!roomOpen && canPlaceChatOnHold;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst visibleActions = actions.filter(({ id }) => hasPermissionButtons(id));\n\n\tconst actionDefault = useMutableCallback((e) => {\n\t\tconst index = e.currentTarget.getAttribute('data-quick-actions');\n\t\tconst { id } = visibleActions[index];\n\t\topenModal(id);\n\t});\n\n\tconst getAction = useMutableCallback((id) => {\n\t\topenModal(id);\n\t});\n\n\treturn { visibleActions, actionDefault, getAction };\n};\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\nmodule.export({\n  useQuickActions: function () {\n    return useQuickActions;\n  }\n});\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 0);\nvar FlowRouter;\nmodule.link(\"meteor/kadira:flow-router\", {\n  FlowRouter: function (v) {\n    FlowRouter = v;\n  }\n}, 1);\nvar Session;\nmodule.link(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 2);\nvar React, useCallback, useState, useEffect;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 3);\nvar RoomManager;\nmodule.link(\"../../../../../../../app/ui-utils/client\", {\n  RoomManager: function (v) {\n    RoomManager = v;\n  }\n}, 4);\nvar PlaceChatOnHoldModal;\nmodule.link(\"../../../../../../../ee/app/livechat-enterprise/client/components/modals/PlaceChatOnHoldModal\", {\n  \"default\": function (v) {\n    PlaceChatOnHoldModal = v;\n  }\n}, 5);\nvar CloseChatModal;\nmodule.link(\"../../../../../../components/Omnichannel/modals/CloseChatModal\", {\n  \"default\": function (v) {\n    CloseChatModal = v;\n  }\n}, 6);\nvar CloseChatModalData;\nmodule.link(\"../../../../../../components/Omnichannel/modals/CloseChatModalData\", {\n  \"default\": function (v) {\n    CloseChatModalData = v;\n  }\n}, 7);\nvar ForwardChatModal;\nmodule.link(\"../../../../../../components/Omnichannel/modals/ForwardChatModal\", {\n  \"default\": function (v) {\n    ForwardChatModal = v;\n  }\n}, 8);\nvar ReturnChatQueueModal;\nmodule.link(\"../../../../../../components/Omnichannel/modals/ReturnChatQueueModal\", {\n  \"default\": function (v) {\n    ReturnChatQueueModal = v;\n  }\n}, 9);\nvar TranscriptModal;\nmodule.link(\"../../../../../../components/Omnichannel/modals/TranscriptModal\", {\n  \"default\": function (v) {\n    TranscriptModal = v;\n  }\n}, 10);\nvar usePermission, useRole;\nmodule.link(\"../../../../../../contexts/AuthorizationContext\", {\n  usePermission: function (v) {\n    usePermission = v;\n  },\n  useRole: function (v) {\n    useRole = v;\n  }\n}, 11);\nvar useSetModal;\nmodule.link(\"../../../../../../contexts/ModalContext\", {\n  useSetModal: function (v) {\n    useSetModal = v;\n  }\n}, 12);\nvar useOmnichannelRouteConfig;\nmodule.link(\"../../../../../../contexts/OmnichannelContext\", {\n  useOmnichannelRouteConfig: function (v) {\n    useOmnichannelRouteConfig = v;\n  }\n}, 13);\nvar useEndpoint, useMethod;\nmodule.link(\"../../../../../../contexts/ServerContext\", {\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useMethod: function (v) {\n    useMethod = v;\n  }\n}, 14);\nvar useSetting;\nmodule.link(\"../../../../../../contexts/SettingsContext\", {\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 15);\nvar useToastMessageDispatch;\nmodule.link(\"../../../../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  }\n}, 16);\nvar useTranslation;\nmodule.link(\"../../../../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 17);\nvar useUserId;\nmodule.link(\"../../../../../../contexts/UserContext\", {\n  useUserId: function (v) {\n    useUserId = v;\n  }\n}, 18);\nvar handleError;\nmodule.link(\"../../../../../../lib/utils/handleError\", {\n  handleError: function (v) {\n    handleError = v;\n  }\n}, 19);\nvar QuickActionsEnum;\nmodule.link(\"../../../../lib/QuickActions\", {\n  QuickActionsEnum: function (v) {\n    QuickActionsEnum = v;\n  }\n}, 20);\nvar useQuickActionsContext;\nmodule.link(\"../../../../lib/QuickActions/QuickActionsContext\", {\n  useQuickActionsContext: function (v) {\n    useQuickActionsContext = v;\n  }\n}, 21);\n\nvar useQuickActions = function (room) {\n  var _room$u, _room$lastMessage, _room$lastMessage2;\n\n  var setModal = useSetModal();\n  var t = useTranslation();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var context = useQuickActionsContext();\n  var actions = Array.from(context.actions.values()).sort(function (a, b) {\n    return (a.order || 0) - (b.order || 0);\n  });\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      onHoldModalActive = _useState2[0],\n      setOnHoldModalActive = _useState2[1];\n\n  var visitorRoomId = room.v._id;\n  var rid = room._id;\n  var uid = useUserId();\n  var roomLastMessage = room.lastMessage;\n  var getVisitorInfo = useEndpoint('GET', 'livechat/visitors.info');\n  var getVisitorEmail = useMutableCallback(function () {\n    function _callee() {\n      var _await$getVisitorInfo, visitorEmails;\n\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (visitorRoomId) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                _context.next = 4;\n                return _regeneratorRuntime.awrap(getVisitorInfo({\n                  visitorId: visitorRoomId\n                }));\n\n              case 4:\n                _await$getVisitorInfo = _context.sent;\n                visitorEmails = _await$getVisitorInfo.visitor.visitorEmails;\n\n                if (!(visitorEmails !== null && visitorEmails !== void 0 && visitorEmails.length && visitorEmails[0].address)) {\n                  _context.next = 8;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", visitorEmails[0].address);\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n\n    return _callee;\n  }());\n  useEffect(function () {\n    if (onHoldModalActive && roomLastMessage !== null && roomLastMessage !== void 0 && roomLastMessage.token) {\n      setModal(null);\n    }\n  }, [roomLastMessage, onHoldModalActive, setModal]);\n  var closeModal = useCallback(function () {\n    return setModal(null);\n  }, [setModal]);\n  var closeOnHoldModal = useCallback(function () {\n    closeModal();\n    setOnHoldModalActive(false);\n  }, [closeModal]);\n  var methodReturn = useMethod('livechat:returnAsInquiry');\n  var handleMoveChat = useCallback(function () {\n    function _callee2() {\n      return _regeneratorRuntime.async(function () {\n        function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return _regeneratorRuntime.awrap(methodReturn(rid));\n\n              case 3:\n                closeModal();\n                Session.set('openedRoom', null);\n                FlowRouter.go('/home');\n                _context2.next = 11;\n                break;\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](0);\n                handleError(_context2.t0);\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }\n\n        return _callee2$;\n      }(), null, null, [[0, 8]], Promise);\n    }\n\n    return _callee2;\n  }(), [closeModal, methodReturn, rid]);\n  var requestTranscript = useMethod('livechat:requestTranscript');\n  var handleRequestTranscript = useCallback(function () {\n    function _callee3(email, subject) {\n      return _regeneratorRuntime.async(function () {\n        function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                _context3.next = 3;\n                return _regeneratorRuntime.awrap(requestTranscript(rid, email, subject));\n\n              case 3:\n                closeModal();\n                RoomManager.close(\"l\" + rid);\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Livechat_transcript_has_been_requested')\n                });\n                _context3.next = 11;\n                break;\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](0);\n                handleError(_context3.t0);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }\n\n        return _callee3$;\n      }(), null, null, [[0, 8]], Promise);\n    }\n\n    return _callee3;\n  }(), [closeModal, dispatchToastMessage, requestTranscript, rid, t]);\n  var sendTranscript = useMethod('livechat:sendTranscript');\n  var handleSendTranscript = useCallback(function () {\n    function _callee4(email, subject, token) {\n      return _regeneratorRuntime.async(function () {\n        function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return _regeneratorRuntime.awrap(sendTranscript(token, rid, email, subject));\n\n              case 3:\n                closeModal();\n                _context4.next = 9;\n                break;\n\n              case 6:\n                _context4.prev = 6;\n                _context4.t0 = _context4[\"catch\"](0);\n                handleError(_context4.t0);\n\n              case 9:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }\n\n        return _callee4$;\n      }(), null, null, [[0, 6]], Promise);\n    }\n\n    return _callee4;\n  }(), [closeModal, rid, sendTranscript]);\n  var discardTranscript = useMethod('livechat:discardTranscript');\n  var handleDiscardTranscript = useCallback(function () {\n    function _callee5() {\n      return _regeneratorRuntime.async(function () {\n        function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return _regeneratorRuntime.awrap(discardTranscript(rid));\n\n              case 3:\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Livechat_transcript_request_has_been_canceled')\n                });\n                closeModal();\n                _context5.next = 10;\n                break;\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5[\"catch\"](0);\n                handleError(_context5.t0);\n\n              case 10:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }\n\n        return _callee5$;\n      }(), null, null, [[0, 7]], Promise);\n    }\n\n    return _callee5;\n  }(), [closeModal, discardTranscript, dispatchToastMessage, rid, t]);\n  var forwardChat = useMethod('livechat:transfer');\n  var handleForwardChat = useCallback(function () {\n    function _callee6(departmentId, userId, comment) {\n      var transferData, result;\n      return _regeneratorRuntime.async(function () {\n        function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!(departmentId && userId)) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 2:\n                transferData = {\n                  roomId: rid,\n                  comment: comment,\n                  clientAction: true\n                };\n\n                if (departmentId) {\n                  transferData.departmentId = departmentId;\n                }\n\n                if (userId) {\n                  transferData.userId = userId;\n                }\n\n                _context6.prev = 5;\n                _context6.next = 8;\n                return _regeneratorRuntime.awrap(forwardChat(transferData));\n\n              case 8:\n                result = _context6.sent;\n\n                if (result) {\n                  _context6.next = 11;\n                  break;\n                }\n\n                throw new Error(departmentId ? t('error-no-agents-online-in-department') : t('error-forwarding-chat'));\n\n              case 11:\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Transferred')\n                });\n                FlowRouter.go('/');\n                closeModal();\n                _context6.next = 19;\n                break;\n\n              case 16:\n                _context6.prev = 16;\n                _context6.t0 = _context6[\"catch\"](5);\n                handleError(_context6.t0);\n\n              case 19:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }\n\n        return _callee6$;\n      }(), null, null, [[5, 16]], Promise);\n    }\n\n    return _callee6;\n  }(), [closeModal, dispatchToastMessage, forwardChat, rid, t]);\n  var closeChat = useMethod('livechat:closeRoom');\n  var handleClose = useCallback(function () {\n    function _callee7(comment, tags) {\n      return _regeneratorRuntime.async(function () {\n        function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.prev = 0;\n                _context7.next = 3;\n                return _regeneratorRuntime.awrap(closeChat(rid, comment, {\n                  clientAction: true,\n                  tags: tags\n                }));\n\n              case 3:\n                closeModal();\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Chat_closed_successfully')\n                });\n                _context7.next = 10;\n                break;\n\n              case 7:\n                _context7.prev = 7;\n                _context7.t0 = _context7[\"catch\"](0);\n                handleError(_context7.t0);\n\n              case 10:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }\n\n        return _callee7$;\n      }(), null, null, [[0, 7]], Promise);\n    }\n\n    return _callee7;\n  }(), [closeChat, closeModal, dispatchToastMessage, rid, t]);\n  var onHoldChat = useEndpoint('POST', 'livechat/room.onHold');\n  var handleOnHoldChat = useCallback(function () {\n    function _callee8() {\n      return _regeneratorRuntime.async(function () {\n        function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.prev = 0;\n                _context8.next = 3;\n                return _regeneratorRuntime.awrap(onHoldChat({\n                  roomId: rid\n                }));\n\n              case 3:\n                closeModal();\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Chat_On_Hold_Successfully')\n                });\n                _context8.next = 10;\n                break;\n\n              case 7:\n                _context8.prev = 7;\n                _context8.t0 = _context8[\"catch\"](0);\n                handleError(_context8.t0);\n\n              case 10:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }\n\n        return _callee8$;\n      }(), null, null, [[0, 7]], Promise);\n    }\n\n    return _callee8;\n  }(), [onHoldChat, rid, closeModal, dispatchToastMessage, t]);\n  var openModal = useMutableCallback(function () {\n    function _callee9(id) {\n      var visitorEmail;\n      return _regeneratorRuntime.async(function () {\n        function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.t0 = id;\n                _context9.next = _context9.t0 === QuickActionsEnum.MoveQueue ? 3 : _context9.t0 === QuickActionsEnum.Transcript ? 5 : _context9.t0 === QuickActionsEnum.ChatForward ? 13 : _context9.t0 === QuickActionsEnum.CloseChat ? 15 : _context9.t0 === QuickActionsEnum.OnHoldChat ? 17 : 20;\n                break;\n\n              case 3:\n                setModal( /*#__PURE__*/React.createElement(ReturnChatQueueModal, {\n                  onMoveChat: handleMoveChat,\n                  onCancel: closeModal\n                }));\n                return _context9.abrupt(\"break\", 21);\n\n              case 5:\n                _context9.next = 7;\n                return _regeneratorRuntime.awrap(getVisitorEmail());\n\n              case 7:\n                visitorEmail = _context9.sent;\n\n                if (visitorEmail) {\n                  _context9.next = 11;\n                  break;\n                }\n\n                dispatchToastMessage({\n                  type: 'error',\n                  message: t('Customer_without_registered_email')\n                });\n                return _context9.abrupt(\"break\", 21);\n\n              case 11:\n                setModal( /*#__PURE__*/React.createElement(TranscriptModal, {\n                  room: room,\n                  email: visitorEmail,\n                  onRequest: handleRequestTranscript,\n                  onSend: handleSendTranscript,\n                  onDiscard: handleDiscardTranscript,\n                  onCancel: closeModal\n                }));\n                return _context9.abrupt(\"break\", 21);\n\n              case 13:\n                setModal( /*#__PURE__*/React.createElement(ForwardChatModal, {\n                  room: room,\n                  onForward: handleForwardChat,\n                  onCancel: closeModal\n                }));\n                return _context9.abrupt(\"break\", 21);\n\n              case 15:\n                setModal(room.departmentId ? /*#__PURE__*/React.createElement(CloseChatModalData, {\n                  departmentId: room.departmentId,\n                  onConfirm: handleClose,\n                  onCancel: closeModal\n                }) : /*#__PURE__*/React.createElement(CloseChatModal, {\n                  onConfirm: handleClose,\n                  onCancel: closeModal\n                }));\n                return _context9.abrupt(\"break\", 21);\n\n              case 17:\n                setModal( /*#__PURE__*/React.createElement(PlaceChatOnHoldModal, {\n                  onOnHoldChat: handleOnHoldChat,\n                  onCancel: closeOnHoldModal\n                }));\n                setOnHoldModalActive(true);\n                return _context9.abrupt(\"break\", 21);\n\n              case 20:\n                return _context9.abrupt(\"break\", 21);\n\n              case 21:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }\n\n        return _callee9$;\n      }(), null, null, null, Promise);\n    }\n\n    return _callee9;\n  }());\n  var omnichannelRouteConfig = useOmnichannelRouteConfig();\n  var manualOnHoldAllowed = useSetting('Livechat_allow_manual_on_hold');\n  var hasManagerRole = useRole('livechat-manager');\n  var roomOpen = (room === null || room === void 0 ? void 0 : room.open) && (((_room$u = room.u) === null || _room$u === void 0 ? void 0 : _room$u._id) === uid || hasManagerRole) && (room === null || room === void 0 ? void 0 : (_room$lastMessage = room.lastMessage) === null || _room$lastMessage === void 0 ? void 0 : _room$lastMessage.t) !== 'livechat-close';\n  var canMoveQueue = !!(omnichannelRouteConfig !== null && omnichannelRouteConfig !== void 0 && omnichannelRouteConfig.returnQueue) && (room === null || room === void 0 ? void 0 : room.u) !== undefined;\n  var canForwardGuest = usePermission('transfer-livechat-guest');\n  var canSendTranscript = usePermission('send-omnichannel-chat-transcript');\n  var canCloseRoom = usePermission('close-livechat-room');\n  var canCloseOthersRoom = usePermission('close-others-livechat-room');\n  var canPlaceChatOnHold = Boolean(!room.onHold && room.u && !((_room$lastMessage2 = room.lastMessage) !== null && _room$lastMessage2 !== void 0 && _room$lastMessage2.token) && manualOnHoldAllowed);\n\n  var hasPermissionButtons = function (id) {\n    switch (id) {\n      case QuickActionsEnum.MoveQueue:\n        return !!roomOpen && canMoveQueue;\n\n      case QuickActionsEnum.ChatForward:\n        return !!roomOpen && canForwardGuest;\n\n      case QuickActionsEnum.Transcript:\n        return canSendTranscript;\n\n      case QuickActionsEnum.CloseChat:\n        return !!roomOpen && (canCloseRoom || canCloseOthersRoom);\n\n      case QuickActionsEnum.OnHoldChat:\n        return !!roomOpen && canPlaceChatOnHold;\n\n      default:\n        break;\n    }\n\n    return false;\n  };\n\n  var visibleActions = actions.filter(function (_ref) {\n    var id = _ref.id;\n    return hasPermissionButtons(id);\n  });\n  var actionDefault = useMutableCallback(function (e) {\n    var index = e.currentTarget.getAttribute('data-quick-actions');\n    var id = visibleActions[index].id;\n    openModal(id);\n  });\n  var getAction = useMutableCallback(function (id) {\n    openModal(id);\n  });\n  return {\n    visibleActions: visibleActions,\n    actionDefault: actionDefault,\n    getAction: getAction\n  };\n};","map":{"version":3,"sources":["client/views/room/Header/Omnichannel/QuickActions/hooks/useQuickActions.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Session } from 'meteor/session';\nimport React, { useCallback, useState, useEffect } from 'react';\n\nimport { RoomManager } from '../../../../../../../app/ui-utils/client';\nimport { IOmnichannelRoom } from '../../../../../../../definition/IRoom';\nimport PlaceChatOnHoldModal from '../../../../../../../ee/app/livechat-enterprise/client/components/modals/PlaceChatOnHoldModal';\nimport CloseChatModal from '../../../../../../components/Omnichannel/modals/CloseChatModal';\nimport CloseChatModalData from '../../../../../../components/Omnichannel/modals/CloseChatModalData';\nimport ForwardChatModal from '../../../../../../components/Omnichannel/modals/ForwardChatModal';\nimport ReturnChatQueueModal from '../../../../../../components/Omnichannel/modals/ReturnChatQueueModal';\nimport TranscriptModal from '../../../../../../components/Omnichannel/modals/TranscriptModal';\nimport { usePermission, useRole } from '../../../../../../contexts/AuthorizationContext';\nimport { useSetModal } from '../../../../../../contexts/ModalContext';\nimport { useOmnichannelRouteConfig } from '../../../../../../contexts/OmnichannelContext';\nimport { useEndpoint, useMethod } from '../../../../../../contexts/ServerContext';\nimport { useSetting } from '../../../../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../../contexts/TranslationContext';\nimport { useUserId } from '../../../../../../contexts/UserContext';\nimport { handleError } from '../../../../../../lib/utils/handleError';\nimport { QuickActionsActionConfig, QuickActionsEnum } from '../../../../lib/QuickActions';\nimport { useQuickActionsContext } from '../../../../lib/QuickActions/QuickActionsContext';\n\nexport const useQuickActions = (\n\troom: IOmnichannelRoom,\n): {\n\tvisibleActions: QuickActionsActionConfig[];\n\tactionDefault: (e: unknown) => void;\n\tgetAction: (id: string) => void;\n} => {\n\tconst setModal = useSetModal();\n\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst context = useQuickActionsContext();\n\tconst actions = (Array.from(context.actions.values()) as QuickActionsActionConfig[]).sort((a, b) => (a.order || 0) - (b.order || 0));\n\n\tconst [onHoldModalActive, setOnHoldModalActive] = useState(false);\n\n\tconst visitorRoomId = room.v._id;\n\tconst rid = room._id;\n\tconst uid = useUserId();\n\tconst roomLastMessage = room.lastMessage;\n\n\tconst getVisitorInfo = useEndpoint('GET', 'livechat/visitors.info');\n\n\tconst getVisitorEmail = useMutableCallback(async () => {\n\t\tif (!visitorRoomId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tvisitor: { visitorEmails },\n\t\t} = await getVisitorInfo({ visitorId: visitorRoomId });\n\n\t\tif (visitorEmails?.length && visitorEmails[0].address) {\n\t\t\treturn visitorEmails[0].address;\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (onHoldModalActive && roomLastMessage?.token) {\n\t\t\tsetModal(null);\n\t\t}\n\t}, [roomLastMessage, onHoldModalActive, setModal]);\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tconst closeOnHoldModal = useCallback(() => {\n\t\tcloseModal();\n\t\tsetOnHoldModalActive(false);\n\t}, [closeModal]);\n\n\tconst methodReturn = useMethod('livechat:returnAsInquiry');\n\n\tconst handleMoveChat = useCallback(async () => {\n\t\ttry {\n\t\t\tawait methodReturn(rid);\n\t\t\tcloseModal();\n\t\t\tSession.set('openedRoom', null);\n\t\t\tFlowRouter.go('/home');\n\t\t} catch (error: any) {\n\t\t\thandleError(error);\n\t\t}\n\t}, [closeModal, methodReturn, rid]);\n\n\tconst requestTranscript = useMethod('livechat:requestTranscript');\n\n\tconst handleRequestTranscript = useCallback(\n\t\tasync (email: string, subject: string) => {\n\t\t\ttry {\n\t\t\t\tawait requestTranscript(rid, email, subject);\n\t\t\t\tcloseModal();\n\t\t\t\tRoomManager.close(`l${rid}`);\n\t\t\t\tdispatchToastMessage({\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\tmessage: t('Livechat_transcript_has_been_requested'),\n\t\t\t\t});\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, requestTranscript, rid, t],\n\t);\n\n\tconst sendTranscript = useMethod('livechat:sendTranscript');\n\n\tconst handleSendTranscript = useCallback(\n\t\tasync (email: string, subject: string, token: string) => {\n\t\t\ttry {\n\t\t\t\tawait sendTranscript(token, rid, email, subject);\n\t\t\t\tcloseModal();\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeModal, rid, sendTranscript],\n\t);\n\n\tconst discardTranscript = useMethod('livechat:discardTranscript');\n\n\tconst handleDiscardTranscript = useCallback(async () => {\n\t\ttry {\n\t\t\tawait discardTranscript(rid);\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t('Livechat_transcript_request_has_been_canceled'),\n\t\t\t});\n\t\t\tcloseModal();\n\t\t} catch (error: any) {\n\t\t\thandleError(error);\n\t\t}\n\t}, [closeModal, discardTranscript, dispatchToastMessage, rid, t]);\n\n\tconst forwardChat = useMethod('livechat:transfer');\n\n\tconst handleForwardChat = useCallback(\n\t\tasync (departmentId?: string, userId?: string, comment?: string) => {\n\t\t\tif (departmentId && userId) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst transferData: {\n\t\t\t\troomId: string;\n\t\t\t\tclientAction: boolean;\n\t\t\t\tcomment?: string;\n\t\t\t\tdepartmentId?: string;\n\t\t\t\tuserId?: string;\n\t\t\t} = {\n\t\t\t\troomId: rid,\n\t\t\t\tcomment,\n\t\t\t\tclientAction: true,\n\t\t\t};\n\n\t\t\tif (departmentId) {\n\t\t\t\ttransferData.departmentId = departmentId;\n\t\t\t}\n\t\t\tif (userId) {\n\t\t\t\ttransferData.userId = userId;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst result = await forwardChat(transferData);\n\t\t\t\tif (!result) {\n\t\t\t\t\tthrow new Error(departmentId ? t('error-no-agents-online-in-department') : t('error-forwarding-chat'));\n\t\t\t\t}\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Transferred') });\n\t\t\t\tFlowRouter.go('/');\n\t\t\t\tcloseModal();\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, forwardChat, rid, t],\n\t);\n\n\tconst closeChat = useMethod('livechat:closeRoom');\n\n\tconst handleClose = useCallback(\n\t\tasync (comment: string, tags: string[]) => {\n\t\t\ttry {\n\t\t\t\tawait closeChat(rid, comment, { clientAction: true, tags });\n\t\t\t\tcloseModal();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Chat_closed_successfully') });\n\t\t\t} catch (error: any) {\n\t\t\t\thandleError(error);\n\t\t\t}\n\t\t},\n\t\t[closeChat, closeModal, dispatchToastMessage, rid, t],\n\t);\n\n\tconst onHoldChat = useEndpoint('POST', 'livechat/room.onHold');\n\n\tconst handleOnHoldChat = useCallback(async () => {\n\t\ttry {\n\t\t\tawait onHoldChat({ roomId: rid });\n\t\t\tcloseModal();\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Chat_On_Hold_Successfully') });\n\t\t} catch (error: any) {\n\t\t\thandleError(error);\n\t\t}\n\t}, [onHoldChat, rid, closeModal, dispatchToastMessage, t]);\n\n\tconst openModal = useMutableCallback(async (id: string) => {\n\t\tswitch (id) {\n\t\t\tcase QuickActionsEnum.MoveQueue:\n\t\t\t\tsetModal(<ReturnChatQueueModal onMoveChat={handleMoveChat} onCancel={closeModal} />);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.Transcript:\n\t\t\t\tconst visitorEmail = await getVisitorEmail();\n\n\t\t\t\tif (!visitorEmail) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Customer_without_registered_email') });\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tsetModal(\n\t\t\t\t\t<TranscriptModal\n\t\t\t\t\t\troom={room}\n\t\t\t\t\t\temail={visitorEmail}\n\t\t\t\t\t\tonRequest={handleRequestTranscript}\n\t\t\t\t\t\tonSend={handleSendTranscript}\n\t\t\t\t\t\tonDiscard={handleDiscardTranscript}\n\t\t\t\t\t\tonCancel={closeModal}\n\t\t\t\t\t/>,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.ChatForward:\n\t\t\t\tsetModal(<ForwardChatModal room={room} onForward={handleForwardChat} onCancel={closeModal} />);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.CloseChat:\n\t\t\t\tsetModal(\n\t\t\t\t\troom.departmentId ? (\n\t\t\t\t\t\t<CloseChatModalData departmentId={room.departmentId} onConfirm={handleClose} onCancel={closeModal} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<CloseChatModal onConfirm={handleClose} onCancel={closeModal} />\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase QuickActionsEnum.OnHoldChat:\n\t\t\t\tsetModal(<PlaceChatOnHoldModal onOnHoldChat={handleOnHoldChat} onCancel={closeOnHoldModal} />);\n\t\t\t\tsetOnHoldModalActive(true);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tconst omnichannelRouteConfig = useOmnichannelRouteConfig();\n\n\tconst manualOnHoldAllowed = useSetting('Livechat_allow_manual_on_hold');\n\n\tconst hasManagerRole = useRole('livechat-manager');\n\n\tconst roomOpen = room?.open && (room.u?._id === uid || hasManagerRole) && room?.lastMessage?.t !== 'livechat-close';\n\tconst canMoveQueue = !!omnichannelRouteConfig?.returnQueue && room?.u !== undefined;\n\tconst canForwardGuest = usePermission('transfer-livechat-guest');\n\tconst canSendTranscript = usePermission('send-omnichannel-chat-transcript');\n\tconst canCloseRoom = usePermission('close-livechat-room');\n\tconst canCloseOthersRoom = usePermission('close-others-livechat-room');\n\tconst canPlaceChatOnHold = Boolean(!room.onHold && room.u && !(room as any).lastMessage?.token && manualOnHoldAllowed);\n\n\tconst hasPermissionButtons = (id: string): boolean => {\n\t\tswitch (id) {\n\t\t\tcase QuickActionsEnum.MoveQueue:\n\t\t\t\treturn !!roomOpen && canMoveQueue;\n\t\t\tcase QuickActionsEnum.ChatForward:\n\t\t\t\treturn !!roomOpen && canForwardGuest;\n\t\t\tcase QuickActionsEnum.Transcript:\n\t\t\t\treturn canSendTranscript;\n\t\t\tcase QuickActionsEnum.CloseChat:\n\t\t\t\treturn !!roomOpen && (canCloseRoom || canCloseOthersRoom);\n\t\t\tcase QuickActionsEnum.OnHoldChat:\n\t\t\t\treturn !!roomOpen && canPlaceChatOnHold;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst visibleActions = actions.filter(({ id }) => hasPermissionButtons(id));\n\n\tconst actionDefault = useMutableCallback((e) => {\n\t\tconst index = e.currentTarget.getAttribute('data-quick-actions');\n\t\tconst { id } = visibleActions[index];\n\t\topenModal(id);\n\t});\n\n\tconst getAction = useMutableCallback((id) => {\n\t\topenModal(id);\n\t});\n\n\treturn { visibleActions, actionDefault, getAction };\n};\n"],"sourceRoot":""},"sourceType":"module","hash":"ec91e4b8b1956d7bab21c1805fef3567a9309dd8"}
