{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/lib/rooms/roomTypes/direct.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/lib/rooms/roomTypes/direct.ts","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/lib/rooms/roomTypes/direct.ts","inputSourceMap":{"version":3,"file":"client/lib/rooms/roomTypes/direct.ts","sourceRoot":"","sources":["client/lib/rooms/roomTypes/direct.ts"],"names":[],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nimport { hasAtLeastOnePermission, hasPermission } from '../../../../app/authorization/client';\nimport { Subscriptions, Users, ChatRoom } from '../../../../app/models/client';\nimport { settings } from '../../../../app/settings/client';\nimport { getUserPreference } from '../../../../app/utils/client';\nimport { getAvatarURL } from '../../../../app/utils/lib/getAvatarURL';\nimport { getUserAvatarURL } from '../../../../app/utils/lib/getUserAvatarURL';\nimport type { IRoomTypeClientDirectives } from '../../../../definition/IRoomTypeConfig';\nimport { RoomSettingsEnum, RoomMemberActions, UiTextContext } from '../../../../definition/IRoomTypeConfig';\nimport type { AtLeast } from '../../../../definition/utils';\nimport { getDirectMessageRoomType } from '../../../../lib/rooms/roomTypes/direct';\nimport { roomCoordinator } from '../roomCoordinator';\n\nexport const DirectMessageRoomType = getDirectMessageRoomType(roomCoordinator);\n\nroomCoordinator.add(DirectMessageRoomType, {\n\tallowRoomSettingChange(_room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.TYPE:\n\t\t\tcase RoomSettingsEnum.NAME:\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tcase RoomSettingsEnum.DESCRIPTION:\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\tcase RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:\n\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\treturn false;\n\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\treturn settings.get('E2E_Enable') === true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t},\n\n\tallowMemberAction(room, action) {\n\t\tswitch (action) {\n\t\t\tcase RoomMemberActions.BLOCK:\n\t\t\t\treturn !this.isGroupChat(room);\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t},\n\n\troomName(roomData) {\n\t\tconst subscription = ((): { fname?: string; name?: string } | undefined => {\n\t\t\tif (roomData.fname || roomData.name) {\n\t\t\t\treturn {\n\t\t\t\t\tfname: roomData.fname,\n\t\t\t\t\tname: roomData.name,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (!roomData._id) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn Subscriptions.findOne({ rid: roomData._id });\n\t\t})();\n\n\t\tif (!subscription) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (settings.get('UI_Use_Real_Name') && subscription.fname) {\n\t\t\treturn subscription.fname;\n\t\t}\n\n\t\treturn subscription.name;\n\t},\n\n\tisGroupChat(room) {\n\t\treturn (room?.uids?.length || 0) > 2;\n\t},\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Private_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Private_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t},\n\n\tcondition() {\n\t\tconst groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n\t},\n\n\tgetAvatarPath(room) {\n\t\tif (!room) {\n\t\t\treturn '';\n\t\t}\n\n\t\t// if coming from sidenav search\n\t\tif (room.name && room.avatarETag) {\n\t\t\treturn getUserAvatarURL(room.name, room.avatarETag);\n\t\t}\n\n\t\tif (this.isGroupChat(room)) {\n\t\t\treturn getAvatarURL({\n\t\t\t\tusername: (room.uids || []).length + (room.usernames || []).join(),\n\t\t\t\tcache: room.avatarETag,\n\t\t\t}) as string;\n\t\t}\n\n\t\tconst sub = Subscriptions.findOne({ rid: room._id }, { fields: { name: 1 } });\n\t\tif (sub?.name) {\n\t\t\tconst user = Users.findOne({ username: sub.name }, { fields: { username: 1, avatarETag: 1 } });\n\t\t\treturn getUserAvatarURL(user?.username || sub.name, user?.avatarETag);\n\t\t}\n\n\t\treturn getUserAvatarURL(room.name || this.roomName(room));\n\t},\n\n\tgetIcon(room) {\n\t\tif (this.isGroupChat(room)) {\n\t\t\treturn 'balloon';\n\t\t}\n\n\t\treturn DirectMessageRoomType.icon;\n\t},\n\n\tgetUserStatus(roomId) {\n\t\tconst subscription = Subscriptions.findOne({ rid: roomId });\n\t\tif (!subscription) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Session.get(`user_${subscription.name}_status`);\n\t},\n\n\tfindRoom(identifier) {\n\t\tif (!hasPermission('view-d-room')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\t$or: [{ name: identifier }, { rid: identifier }],\n\t\t};\n\n\t\tconst subscription = Subscriptions.findOne(query);\n\t\tif (subscription?.rid) {\n\t\t\treturn ChatRoom.findOne(subscription.rid);\n\t\t}\n\t},\n} as AtLeast<IRoomTypeClientDirectives, 'isGroupChat' | 'roomName'>);\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/lib/rooms/roomTypes/direct.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/lib/rooms/roomTypes/direct.ts"}},"code":"module.export({\n  DirectMessageRoomType: function () {\n    return DirectMessageRoomType;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Session;\nmodule.link(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 1);\nvar hasAtLeastOnePermission, hasPermission;\nmodule.link(\"../../../../app/authorization/client\", {\n  hasAtLeastOnePermission: function (v) {\n    hasAtLeastOnePermission = v;\n  },\n  hasPermission: function (v) {\n    hasPermission = v;\n  }\n}, 2);\nvar Subscriptions, Users, ChatRoom;\nmodule.link(\"../../../../app/models/client\", {\n  Subscriptions: function (v) {\n    Subscriptions = v;\n  },\n  Users: function (v) {\n    Users = v;\n  },\n  ChatRoom: function (v) {\n    ChatRoom = v;\n  }\n}, 3);\nvar settings;\nmodule.link(\"../../../../app/settings/client\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 4);\nvar getUserPreference;\nmodule.link(\"../../../../app/utils/client\", {\n  getUserPreference: function (v) {\n    getUserPreference = v;\n  }\n}, 5);\nvar getAvatarURL;\nmodule.link(\"../../../../app/utils/lib/getAvatarURL\", {\n  getAvatarURL: function (v) {\n    getAvatarURL = v;\n  }\n}, 6);\nvar getUserAvatarURL;\nmodule.link(\"../../../../app/utils/lib/getUserAvatarURL\", {\n  getUserAvatarURL: function (v) {\n    getUserAvatarURL = v;\n  }\n}, 7);\nvar RoomSettingsEnum, RoomMemberActions, UiTextContext;\nmodule.link(\"../../../../definition/IRoomTypeConfig\", {\n  RoomSettingsEnum: function (v) {\n    RoomSettingsEnum = v;\n  },\n  RoomMemberActions: function (v) {\n    RoomMemberActions = v;\n  },\n  UiTextContext: function (v) {\n    UiTextContext = v;\n  }\n}, 8);\nvar getDirectMessageRoomType;\nmodule.link(\"../../../../lib/rooms/roomTypes/direct\", {\n  getDirectMessageRoomType: function (v) {\n    getDirectMessageRoomType = v;\n  }\n}, 9);\nvar roomCoordinator;\nmodule.link(\"../roomCoordinator\", {\n  roomCoordinator: function (v) {\n    roomCoordinator = v;\n  }\n}, 10);\nvar DirectMessageRoomType = getDirectMessageRoomType(roomCoordinator);\nroomCoordinator.add(DirectMessageRoomType, {\n  allowRoomSettingChange: function (_room, setting) {\n    switch (setting) {\n      case RoomSettingsEnum.TYPE:\n      case RoomSettingsEnum.NAME:\n      case RoomSettingsEnum.SYSTEM_MESSAGES:\n      case RoomSettingsEnum.DESCRIPTION:\n      case RoomSettingsEnum.READ_ONLY:\n      case RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n      case RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:\n      case RoomSettingsEnum.JOIN_CODE:\n        return false;\n\n      case RoomSettingsEnum.E2E:\n        return settings.get('E2E_Enable') === true;\n\n      default:\n        return true;\n    }\n  },\n  allowMemberAction: function (room, action) {\n    switch (action) {\n      case RoomMemberActions.BLOCK:\n        return !this.isGroupChat(room);\n\n      default:\n        return false;\n    }\n  },\n  roomName: function (roomData) {\n    var subscription = function () {\n      if (roomData.fname || roomData.name) {\n        return {\n          fname: roomData.fname,\n          name: roomData.name\n        };\n      }\n\n      if (!roomData._id) {\n        return undefined;\n      }\n\n      return Subscriptions.findOne({\n        rid: roomData._id\n      });\n    }();\n\n    if (!subscription) {\n      return;\n    }\n\n    if (settings.get('UI_Use_Real_Name') && subscription.fname) {\n      return subscription.fname;\n    }\n\n    return subscription.name;\n  },\n  isGroupChat: function (room) {\n    var _room$uids;\n\n    return ((room === null || room === void 0 ? void 0 : (_room$uids = room.uids) === null || _room$uids === void 0 ? void 0 : _room$uids.length) || 0) > 2;\n  },\n  getUiText: function (context) {\n    switch (context) {\n      case UiTextContext.HIDE_WARNING:\n        return 'Hide_Private_Warning';\n\n      case UiTextContext.LEAVE_WARNING:\n        return 'Leave_Private_Warning';\n\n      default:\n        return '';\n    }\n  },\n  condition: function () {\n    var groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n    return groupByType && hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n  },\n  getAvatarPath: function (room) {\n    if (!room) {\n      return '';\n    } // if coming from sidenav search\n\n\n    if (room.name && room.avatarETag) {\n      return getUserAvatarURL(room.name, room.avatarETag);\n    }\n\n    if (this.isGroupChat(room)) {\n      return getAvatarURL({\n        username: (room.uids || []).length + (room.usernames || []).join(),\n        cache: room.avatarETag\n      });\n    }\n\n    var sub = Subscriptions.findOne({\n      rid: room._id\n    }, {\n      fields: {\n        name: 1\n      }\n    });\n\n    if (sub !== null && sub !== void 0 && sub.name) {\n      var user = Users.findOne({\n        username: sub.name\n      }, {\n        fields: {\n          username: 1,\n          avatarETag: 1\n        }\n      });\n      return getUserAvatarURL((user === null || user === void 0 ? void 0 : user.username) || sub.name, user === null || user === void 0 ? void 0 : user.avatarETag);\n    }\n\n    return getUserAvatarURL(room.name || this.roomName(room));\n  },\n  getIcon: function (room) {\n    if (this.isGroupChat(room)) {\n      return 'balloon';\n    }\n\n    return DirectMessageRoomType.icon;\n  },\n  getUserStatus: function (roomId) {\n    var subscription = Subscriptions.findOne({\n      rid: roomId\n    });\n\n    if (!subscription) {\n      return;\n    }\n\n    return Session.get(\"user_\" + subscription.name + \"_status\");\n  },\n  findRoom: function (identifier) {\n    if (!hasPermission('view-d-room')) {\n      return;\n    }\n\n    var query = {\n      t: 'd',\n      $or: [{\n        name: identifier\n      }, {\n        rid: identifier\n      }]\n    };\n    var subscription = Subscriptions.findOne(query);\n\n    if (subscription !== null && subscription !== void 0 && subscription.rid) {\n      return ChatRoom.findOne(subscription.rid);\n    }\n  }\n});","map":{"version":3,"sources":["client/lib/rooms/roomTypes/direct.ts"],"names":[],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nimport { hasAtLeastOnePermission, hasPermission } from '../../../../app/authorization/client';\nimport { Subscriptions, Users, ChatRoom } from '../../../../app/models/client';\nimport { settings } from '../../../../app/settings/client';\nimport { getUserPreference } from '../../../../app/utils/client';\nimport { getAvatarURL } from '../../../../app/utils/lib/getAvatarURL';\nimport { getUserAvatarURL } from '../../../../app/utils/lib/getUserAvatarURL';\nimport type { IRoomTypeClientDirectives } from '../../../../definition/IRoomTypeConfig';\nimport { RoomSettingsEnum, RoomMemberActions, UiTextContext } from '../../../../definition/IRoomTypeConfig';\nimport type { AtLeast } from '../../../../definition/utils';\nimport { getDirectMessageRoomType } from '../../../../lib/rooms/roomTypes/direct';\nimport { roomCoordinator } from '../roomCoordinator';\n\nexport const DirectMessageRoomType = getDirectMessageRoomType(roomCoordinator);\n\nroomCoordinator.add(DirectMessageRoomType, {\n\tallowRoomSettingChange(_room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.TYPE:\n\t\t\tcase RoomSettingsEnum.NAME:\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tcase RoomSettingsEnum.DESCRIPTION:\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\tcase RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:\n\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\treturn false;\n\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\treturn settings.get('E2E_Enable') === true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t},\n\n\tallowMemberAction(room, action) {\n\t\tswitch (action) {\n\t\t\tcase RoomMemberActions.BLOCK:\n\t\t\t\treturn !this.isGroupChat(room);\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t},\n\n\troomName(roomData) {\n\t\tconst subscription = ((): { fname?: string; name?: string } | undefined => {\n\t\t\tif (roomData.fname || roomData.name) {\n\t\t\t\treturn {\n\t\t\t\t\tfname: roomData.fname,\n\t\t\t\t\tname: roomData.name,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (!roomData._id) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn Subscriptions.findOne({ rid: roomData._id });\n\t\t})();\n\n\t\tif (!subscription) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (settings.get('UI_Use_Real_Name') && subscription.fname) {\n\t\t\treturn subscription.fname;\n\t\t}\n\n\t\treturn subscription.name;\n\t},\n\n\tisGroupChat(room) {\n\t\treturn (room?.uids?.length || 0) > 2;\n\t},\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Private_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Private_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t},\n\n\tcondition() {\n\t\tconst groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n\t},\n\n\tgetAvatarPath(room) {\n\t\tif (!room) {\n\t\t\treturn '';\n\t\t}\n\n\t\t// if coming from sidenav search\n\t\tif (room.name && room.avatarETag) {\n\t\t\treturn getUserAvatarURL(room.name, room.avatarETag);\n\t\t}\n\n\t\tif (this.isGroupChat(room)) {\n\t\t\treturn getAvatarURL({\n\t\t\t\tusername: (room.uids || []).length + (room.usernames || []).join(),\n\t\t\t\tcache: room.avatarETag,\n\t\t\t}) as string;\n\t\t}\n\n\t\tconst sub = Subscriptions.findOne({ rid: room._id }, { fields: { name: 1 } });\n\t\tif (sub?.name) {\n\t\t\tconst user = Users.findOne({ username: sub.name }, { fields: { username: 1, avatarETag: 1 } });\n\t\t\treturn getUserAvatarURL(user?.username || sub.name, user?.avatarETag);\n\t\t}\n\n\t\treturn getUserAvatarURL(room.name || this.roomName(room));\n\t},\n\n\tgetIcon(room) {\n\t\tif (this.isGroupChat(room)) {\n\t\t\treturn 'balloon';\n\t\t}\n\n\t\treturn DirectMessageRoomType.icon;\n\t},\n\n\tgetUserStatus(roomId) {\n\t\tconst subscription = Subscriptions.findOne({ rid: roomId });\n\t\tif (!subscription) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Session.get(`user_${subscription.name}_status`);\n\t},\n\n\tfindRoom(identifier) {\n\t\tif (!hasPermission('view-d-room')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\t$or: [{ name: identifier }, { rid: identifier }],\n\t\t};\n\n\t\tconst subscription = Subscriptions.findOne(query);\n\t\tif (subscription?.rid) {\n\t\t\treturn ChatRoom.findOne(subscription.rid);\n\t\t}\n\t},\n} as AtLeast<IRoomTypeClientDirectives, 'isGroupChat' | 'roomName'>);\n"],"sourceRoot":""},"sourceType":"module","hash":"a00e3c270e440635ac8dab176d3cc19b15086d99"}
