{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/contextualBar/Threads/withData.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/contextualBar/Threads/withData.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/contextualBar/Threads/withData.tsx","inputSourceMap":{"version":3,"file":"client/views/room/contextualBar/Threads/withData.tsx","sourceRoot":"","sources":["client/views/room/contextualBar/Threads/withData.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { useUserId, useUserSubscription } from '../../../../contexts/UserContext';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { ThreadsListOptions } from '../../../../lib/lists/ThreadsList';\nimport { useUserRoom } from '../../hooks/useUserRoom';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport { ThreadListProps } from './ThreadList';\nimport { useThreadsList } from './useThreadsList';\n\nconst subscriptionFields = { tunread: true, tunreadUser: true, tunreadGroup: true };\nconst roomFields = { t: 1, name: 1 };\n\nexport function withData(Component: FC<ThreadListProps>): FC<{ rid: string }> {\n\tconst WrappedComponent: FC<{ rid: string }> = ({ rid, ...props }) => {\n\t\tconst userId = useUserId();\n\t\tconst onClose = useTabBarClose();\n\t\tconst room = useUserRoom(rid, roomFields);\n\t\tconst subscription = useUserSubscription(rid, subscriptionFields);\n\n\t\tconst [type, setType] = useLocalStorage<'all' | 'following' | 'unread'>('thread-list-type', 'all');\n\n\t\tconst [text, setText] = useState('');\n\t\tconst debouncedText = useDebouncedValue(text, 400);\n\t\tconst options: ThreadsListOptions = useDebouncedValue(\n\t\t\tuseMemo(() => {\n\t\t\t\tif (type === 'all' || !subscription || !userId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\ttype: 'all',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'following':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tuid: userId,\n\t\t\t\t\t\t};\n\t\t\t\t\tcase 'unread':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\ttunread: subscription?.tunread,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t}, [rid, debouncedText, type, subscription?.tunread?.sort().join(), userId]),\n\t\t\t300,\n\t\t);\n\n\t\tconst { threadsList, loadMoreItems } = useThreadsList(options, userId as string);\n\t\tconst { phase, error, items: threads, itemCount: totalItemCount } = useRecordList(threadsList);\n\n\t\tconst handleTextChange = useCallback((event) => {\n\t\t\tsetText(event.currentTarget.value);\n\t\t}, []);\n\n\t\treturn (\n\t\t\t<Component\n\t\t\t\t{...props}\n\t\t\t\tunread={subscription?.tunread}\n\t\t\t\tunreadUser={subscription?.tunreadUser}\n\t\t\t\tunreadGroup={subscription?.tunreadGroup}\n\t\t\t\tuserId={userId}\n\t\t\t\terror={error}\n\t\t\t\tthreads={threads}\n\t\t\t\ttotal={totalItemCount}\n\t\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\t\tloadMoreItems={loadMoreItems}\n\t\t\t\troom={room}\n\t\t\t\ttext={text}\n\t\t\t\tsetText={handleTextChange}\n\t\t\t\ttype={type}\n\t\t\t\tsetType={setType as any}\n\t\t\t\tonClose={onClose as any}\n\t\t\t/>\n\t\t);\n\t};\n\n\tWrappedComponent.displayName = `withData(${Component.displayName ?? Component.name ?? 'Component'})`;\n\n\treturn WrappedComponent;\n}\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/contextualBar/Threads/withData.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/contextualBar/Threads/withData.tsx"}},"code":"var _excluded = [\"rid\"];\n\nvar _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default: function (v) {\n    _extends = v;\n  }\n}, 0);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\n\nvar _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default: function (v) {\n    _objectWithoutProperties = v;\n  }\n}, 2);\nmodule.export({\n  withData: function () {\n    return withData;\n  }\n});\nvar useDebouncedValue, useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedValue: function (v) {\n    useDebouncedValue = v;\n  },\n  useLocalStorage: function (v) {\n    useLocalStorage = v;\n  }\n}, 0);\nvar React, useCallback, useMemo, useState;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useState: function (v) {\n    useState = v;\n  }\n}, 1);\nvar useUserId, useUserSubscription;\nmodule.link(\"../../../../contexts/UserContext\", {\n  useUserId: function (v) {\n    useUserId = v;\n  },\n  useUserSubscription: function (v) {\n    useUserSubscription = v;\n  }\n}, 2);\nvar useRecordList;\nmodule.link(\"../../../../hooks/lists/useRecordList\", {\n  useRecordList: function (v) {\n    useRecordList = v;\n  }\n}, 3);\nvar AsyncStatePhase;\nmodule.link(\"../../../../hooks/useAsyncState\", {\n  AsyncStatePhase: function (v) {\n    AsyncStatePhase = v;\n  }\n}, 4);\nvar useUserRoom;\nmodule.link(\"../../hooks/useUserRoom\", {\n  useUserRoom: function (v) {\n    useUserRoom = v;\n  }\n}, 5);\nvar useTabBarClose;\nmodule.link(\"../../providers/ToolboxProvider\", {\n  useTabBarClose: function (v) {\n    useTabBarClose = v;\n  }\n}, 6);\nvar useThreadsList;\nmodule.link(\"./useThreadsList\", {\n  useThreadsList: function (v) {\n    useThreadsList = v;\n  }\n}, 7);\nvar subscriptionFields = {\n  tunread: true,\n  tunreadUser: true,\n  tunreadGroup: true\n};\nvar roomFields = {\n  t: 1,\n  name: 1\n};\n\nfunction withData(Component) {\n  var _ref2, _Component$displayNam;\n\n  var WrappedComponent = function (_ref) {\n    var _subscription$tunread;\n\n    var rid = _ref.rid,\n        props = _objectWithoutProperties(_ref, _excluded);\n\n    var userId = useUserId();\n    var onClose = useTabBarClose();\n    var room = useUserRoom(rid, roomFields);\n    var subscription = useUserSubscription(rid, subscriptionFields);\n\n    var _useLocalStorage = useLocalStorage('thread-list-type', 'all'),\n        _useLocalStorage2 = _slicedToArray(_useLocalStorage, 2),\n        type = _useLocalStorage2[0],\n        setType = _useLocalStorage2[1];\n\n    var _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        text = _useState2[0],\n        setText = _useState2[1];\n\n    var debouncedText = useDebouncedValue(text, 400);\n    var options = useDebouncedValue(useMemo(function () {\n      if (type === 'all' || !subscription || !userId) {\n        return {\n          rid: rid,\n          text: debouncedText,\n          type: 'all'\n        };\n      }\n\n      switch (type) {\n        case 'following':\n          return {\n            rid: rid,\n            text: debouncedText,\n            type: type,\n            uid: userId\n          };\n\n        case 'unread':\n          return {\n            rid: rid,\n            text: debouncedText,\n            type: type,\n            tunread: subscription === null || subscription === void 0 ? void 0 : subscription.tunread\n          };\n      } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n    }, [rid, debouncedText, type, subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread = subscription.tunread) === null || _subscription$tunread === void 0 ? void 0 : _subscription$tunread.sort().join(), userId]), 300);\n\n    var _useThreadsList = useThreadsList(options, userId),\n        threadsList = _useThreadsList.threadsList,\n        loadMoreItems = _useThreadsList.loadMoreItems;\n\n    var _useRecordList = useRecordList(threadsList),\n        phase = _useRecordList.phase,\n        error = _useRecordList.error,\n        threads = _useRecordList.items,\n        totalItemCount = _useRecordList.itemCount;\n\n    var handleTextChange = useCallback(function (event) {\n      setText(event.currentTarget.value);\n    }, []);\n    return /*#__PURE__*/React.createElement(Component, _extends({}, props, {\n      unread: subscription === null || subscription === void 0 ? void 0 : subscription.tunread,\n      unreadUser: subscription === null || subscription === void 0 ? void 0 : subscription.tunreadUser,\n      unreadGroup: subscription === null || subscription === void 0 ? void 0 : subscription.tunreadGroup,\n      userId: userId,\n      error: error,\n      threads: threads,\n      total: totalItemCount,\n      loading: phase === AsyncStatePhase.LOADING,\n      loadMoreItems: loadMoreItems,\n      room: room,\n      text: text,\n      setText: handleTextChange,\n      type: type,\n      setType: setType,\n      onClose: onClose\n    }));\n  };\n\n  WrappedComponent.displayName = \"withData(\" + ((_ref2 = (_Component$displayNam = Component.displayName) !== null && _Component$displayNam !== void 0 ? _Component$displayNam : Component.name) !== null && _ref2 !== void 0 ? _ref2 : 'Component') + \")\";\n  return WrappedComponent;\n}","map":{"version":3,"sources":["client/views/room/contextualBar/Threads/withData.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { useUserId, useUserSubscription } from '../../../../contexts/UserContext';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { ThreadsListOptions } from '../../../../lib/lists/ThreadsList';\nimport { useUserRoom } from '../../hooks/useUserRoom';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport { ThreadListProps } from './ThreadList';\nimport { useThreadsList } from './useThreadsList';\n\nconst subscriptionFields = { tunread: true, tunreadUser: true, tunreadGroup: true };\nconst roomFields = { t: 1, name: 1 };\n\nexport function withData(Component: FC<ThreadListProps>): FC<{ rid: string }> {\n\tconst WrappedComponent: FC<{ rid: string }> = ({ rid, ...props }) => {\n\t\tconst userId = useUserId();\n\t\tconst onClose = useTabBarClose();\n\t\tconst room = useUserRoom(rid, roomFields);\n\t\tconst subscription = useUserSubscription(rid, subscriptionFields);\n\n\t\tconst [type, setType] = useLocalStorage<'all' | 'following' | 'unread'>('thread-list-type', 'all');\n\n\t\tconst [text, setText] = useState('');\n\t\tconst debouncedText = useDebouncedValue(text, 400);\n\t\tconst options: ThreadsListOptions = useDebouncedValue(\n\t\t\tuseMemo(() => {\n\t\t\t\tif (type === 'all' || !subscription || !userId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\ttype: 'all',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'following':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tuid: userId,\n\t\t\t\t\t\t};\n\t\t\t\t\tcase 'unread':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\ttunread: subscription?.tunread,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t}, [rid, debouncedText, type, subscription?.tunread?.sort().join(), userId]),\n\t\t\t300,\n\t\t);\n\n\t\tconst { threadsList, loadMoreItems } = useThreadsList(options, userId as string);\n\t\tconst { phase, error, items: threads, itemCount: totalItemCount } = useRecordList(threadsList);\n\n\t\tconst handleTextChange = useCallback((event) => {\n\t\t\tsetText(event.currentTarget.value);\n\t\t}, []);\n\n\t\treturn (\n\t\t\t<Component\n\t\t\t\t{...props}\n\t\t\t\tunread={subscription?.tunread}\n\t\t\t\tunreadUser={subscription?.tunreadUser}\n\t\t\t\tunreadGroup={subscription?.tunreadGroup}\n\t\t\t\tuserId={userId}\n\t\t\t\terror={error}\n\t\t\t\tthreads={threads}\n\t\t\t\ttotal={totalItemCount}\n\t\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\t\tloadMoreItems={loadMoreItems}\n\t\t\t\troom={room}\n\t\t\t\ttext={text}\n\t\t\t\tsetText={handleTextChange}\n\t\t\t\ttype={type}\n\t\t\t\tsetType={setType as any}\n\t\t\t\tonClose={onClose as any}\n\t\t\t/>\n\t\t);\n\t};\n\n\tWrappedComponent.displayName = `withData(${Component.displayName ?? Component.name ?? 'Component'})`;\n\n\treturn WrappedComponent;\n}\n"],"sourceRoot":""},"sourceType":"module","hash":"a1d9a021d46573d894c790d7e3d600b2f9256dea"}
