{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/CreateDiscussion/CreateDiscussion.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/components/CreateDiscussion/CreateDiscussion.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/CreateDiscussion/CreateDiscussion.tsx","inputSourceMap":{"version":3,"file":"client/components/CreateDiscussion/CreateDiscussion.tsx","sourceRoot":"","sources":["client/components/CreateDiscussion/CreateDiscussion.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ReactElement } from 'react';\n\nimport { IMessage } from '../../../definition/IMessage';\nimport { IRoom } from '../../../definition/IRoom';\nimport { IUser } from '../../../definition/IUser';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useEndpointActionExperimental } from '../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../hooks/useForm';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\nimport RoomAutoComplete from '../RoomAutoComplete';\nimport UserAutoCompleteMultiple from '../UserAutoCompleteMultiple';\nimport DefaultParentRoomField from './DefaultParentRoomField';\n\ntype CreateDiscussionFormValues = {\n\tname: string;\n\tparentRoom: IRoom['_id'];\n\tencrypted: boolean;\n\tusernames: Array<IUser['username']>;\n\tfirstMessage: string;\n};\n\ntype CreateDiscussionProps = {\n\tparentMessageId: IMessage['_id'];\n\tonClose: () => void;\n\tdefaultParentRoom?: IRoom['_id'];\n\tnameSuggestion?: string;\n};\n\nconst CreateDiscussion = ({ onClose, defaultParentRoom, parentMessageId, nameSuggestion }: CreateDiscussionProps): ReactElement => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm({\n\t\tname: nameSuggestion || '',\n\t\tparentRoom: '',\n\t\tencrypted: false,\n\t\tusernames: [],\n\t\tfirstMessage: '',\n\t});\n\n\tconst { name, parentRoom, encrypted, usernames, firstMessage } = values as CreateDiscussionFormValues;\n\n\tconst { handleName, handleParentRoom, handleEncrypted, handleUsernames, handleFirstMessage } = handlers;\n\n\tconst canCreate = (parentRoom || defaultParentRoom) && name;\n\n\tconst createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');\n\n\tconst create = useMutableCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tconst result = await createDiscussion({\n\t\t\t\tprid: defaultParentRoom || parentRoom,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/camelcase\n\t\t\t\tt_name: name,\n\t\t\t\tusers: usernames,\n\t\t\t\treply: encrypted ? undefined : firstMessage,\n\t\t\t\t...(parentMessageId && { pmid: parentMessageId }),\n\t\t\t});\n\n\t\t\tgoToRoomById(result.discussion._id);\n\t\t\tonClose();\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\t});\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (usernames.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsernames([...usernames, value]);\n\t\t}\n\t\thandleUsernames(usernames.filter((current) => current !== value));\n\t});\n\n\treturn (\n\t\t<Modal>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Discussion_title')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Description>{t('Discussion_description')}</Field.Description>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_target_channel')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t{defaultParentRoom && <DefaultParentRoomField defaultParentRoom={defaultParentRoom} />}\n\n\t\t\t\t\t\t\t{!defaultParentRoom && (\n\t\t\t\t\t\t\t\t<RoomAutoComplete\n\t\t\t\t\t\t\t\t\tvalue={parentRoom}\n\t\t\t\t\t\t\t\t\tonChange={handleParentRoom}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Discussion_target_channel_description')}\n\t\t\t\t\t\t\t\t\tdisabled={defaultParentRoom}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field display='flex' alignItems='center' flexDirection='row' justifyContent='spaceBetween' flexGrow={1}>\n\t\t\t\t\t\t<Box display='flex' flexDirection='column' width='full'>\n\t\t\t\t\t\t\t<Field.Label>{t('Encrypted')}</Field.Label>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<ToggleSwitch checked={encrypted} onChange={handleEncrypted} />\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_name')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\t\tonChange={handleName}\n\t\t\t\t\t\t\t\taddon={<Icon name='baloons' size='x20' />}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_name')}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Invite_Users')}</Field.Label>\n\t\t\t\t\t\t<Field.Row w='full' display='flex' flexDirection='column' alignItems='stretch'>\n\t\t\t\t\t\t\t<UserAutoCompleteMultiple value={usernames} onChange={onChangeUsers} placeholder={t('Username_Placeholder')} />\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_first_message_title')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextAreaInput\n\t\t\t\t\t\t\t\tvalue={firstMessage}\n\t\t\t\t\t\t\t\tonChange={handleFirstMessage}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_first_message')}\n\t\t\t\t\t\t\t\trows={5}\n\t\t\t\t\t\t\t\tdisabled={encrypted}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t{encrypted && <Field.Description>{t('Discussion_first_message_disabled_due_to_e2e')}</Field.Description>}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary disabled={!canCreate} onClick={create}>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default CreateDiscussion;\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/CreateDiscussion/CreateDiscussion.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/components/CreateDiscussion/CreateDiscussion.tsx"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _toConsumableArray;\n\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\n\nvar _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 2);\nvar Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Modal: function (v) {\n    Modal = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  FieldGroup: function (v) {\n    FieldGroup = v;\n  },\n  ToggleSwitch: function (v) {\n    ToggleSwitch = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  TextAreaInput: function (v) {\n    TextAreaInput = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  },\n  Box: function (v) {\n    Box = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar React;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  }\n}, 2);\nvar useTranslation;\nmodule.link(\"../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 3);\nvar useEndpointActionExperimental;\nmodule.link(\"../../hooks/useEndpointActionExperimental\", {\n  useEndpointActionExperimental: function (v) {\n    useEndpointActionExperimental = v;\n  }\n}, 4);\nvar useForm;\nmodule.link(\"../../hooks/useForm\", {\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 5);\nvar goToRoomById;\nmodule.link(\"../../lib/utils/goToRoomById\", {\n  goToRoomById: function (v) {\n    goToRoomById = v;\n  }\n}, 6);\nvar RoomAutoComplete;\nmodule.link(\"../RoomAutoComplete\", {\n  \"default\": function (v) {\n    RoomAutoComplete = v;\n  }\n}, 7);\nvar UserAutoCompleteMultiple;\nmodule.link(\"../UserAutoCompleteMultiple\", {\n  \"default\": function (v) {\n    UserAutoCompleteMultiple = v;\n  }\n}, 8);\nvar DefaultParentRoomField;\nmodule.link(\"./DefaultParentRoomField\", {\n  \"default\": function (v) {\n    DefaultParentRoomField = v;\n  }\n}, 9);\n\nvar CreateDiscussion = function (_ref) {\n  var onClose = _ref.onClose,\n      defaultParentRoom = _ref.defaultParentRoom,\n      parentMessageId = _ref.parentMessageId,\n      nameSuggestion = _ref.nameSuggestion;\n  var t = useTranslation();\n\n  var _useForm = useForm({\n    name: nameSuggestion || '',\n    parentRoom: '',\n    encrypted: false,\n    usernames: [],\n    firstMessage: ''\n  }),\n      values = _useForm.values,\n      handlers = _useForm.handlers;\n\n  var name = values.name,\n      parentRoom = values.parentRoom,\n      encrypted = values.encrypted,\n      usernames = values.usernames,\n      firstMessage = values.firstMessage;\n  var handleName = handlers.handleName,\n      handleParentRoom = handlers.handleParentRoom,\n      handleEncrypted = handlers.handleEncrypted,\n      handleUsernames = handlers.handleUsernames,\n      handleFirstMessage = handlers.handleFirstMessage;\n  var canCreate = (parentRoom || defaultParentRoom) && name;\n  var createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');\n  var create = useMutableCallback(function () {\n    function _callee() {\n      var result;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(createDiscussion(_objectSpread({\n                  prid: defaultParentRoom || parentRoom,\n                  // eslint-disable-next-line @typescript-eslint/camelcase\n                  t_name: name,\n                  users: usernames,\n                  reply: encrypted ? undefined : firstMessage\n                }, parentMessageId && {\n                  pmid: parentMessageId\n                })));\n\n              case 3:\n                result = _context.sent;\n                goToRoomById(result.discussion._id);\n                onClose();\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                console.warn(_context.t0);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, [[0, 8]], Promise);\n    }\n\n    return _callee;\n  }());\n  var onChangeUsers = useMutableCallback(function (value, action) {\n    if (!action) {\n      if (usernames.includes(value)) {\n        return;\n      }\n\n      return handleUsernames([].concat(_toConsumableArray(usernames), [value]));\n    }\n\n    handleUsernames(usernames.filter(function (current) {\n      return current !== value;\n    }));\n  });\n  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Discussion_title')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_description'))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_target_channel')), /*#__PURE__*/React.createElement(Field.Row, null, defaultParentRoom && /*#__PURE__*/React.createElement(DefaultParentRoomField, {\n    defaultParentRoom: defaultParentRoom\n  }), !defaultParentRoom && /*#__PURE__*/React.createElement(RoomAutoComplete, {\n    value: parentRoom,\n    onChange: handleParentRoom,\n    placeholder: t('Discussion_target_channel_description'),\n    disabled: defaultParentRoom\n  }))), /*#__PURE__*/React.createElement(Field, {\n    display: \"flex\",\n    alignItems: \"center\",\n    flexDirection: \"row\",\n    justifyContent: \"spaceBetween\",\n    flexGrow: 1\n  }, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    width: \"full\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Encrypted'))), /*#__PURE__*/React.createElement(ToggleSwitch, {\n    checked: encrypted,\n    onChange: handleEncrypted\n  })), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_name')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: name,\n    onChange: handleName,\n    addon: /*#__PURE__*/React.createElement(Icon, {\n      name: \"baloons\",\n      size: \"x20\"\n    }),\n    placeholder: t('New_discussion_name')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Invite_Users')), /*#__PURE__*/React.createElement(Field.Row, {\n    w: \"full\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"stretch\"\n  }, /*#__PURE__*/React.createElement(UserAutoCompleteMultiple, {\n    value: usernames,\n    onChange: onChangeUsers,\n    placeholder: t('Username_Placeholder')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Discussion_first_message_title')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {\n    value: firstMessage,\n    onChange: handleFirstMessage,\n    placeholder: t('New_discussion_first_message'),\n    rows: 5,\n    disabled: encrypted\n  })), encrypted && /*#__PURE__*/React.createElement(Field.Description, null, t('Discussion_first_message_disabled_due_to_e2e'))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    align: \"end\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: onClose\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    disabled: !canCreate,\n    onClick: create\n  }, t('Create')))));\n};\n\nmodule.exportDefault(CreateDiscussion);","map":{"version":3,"sources":["client/components/CreateDiscussion/CreateDiscussion.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, Field, FieldGroup, ToggleSwitch, TextInput, TextAreaInput, ButtonGroup, Button, Icon, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { ReactElement } from 'react';\n\nimport { IMessage } from '../../../definition/IMessage';\nimport { IRoom } from '../../../definition/IRoom';\nimport { IUser } from '../../../definition/IUser';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useEndpointActionExperimental } from '../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../hooks/useForm';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\nimport RoomAutoComplete from '../RoomAutoComplete';\nimport UserAutoCompleteMultiple from '../UserAutoCompleteMultiple';\nimport DefaultParentRoomField from './DefaultParentRoomField';\n\ntype CreateDiscussionFormValues = {\n\tname: string;\n\tparentRoom: IRoom['_id'];\n\tencrypted: boolean;\n\tusernames: Array<IUser['username']>;\n\tfirstMessage: string;\n};\n\ntype CreateDiscussionProps = {\n\tparentMessageId: IMessage['_id'];\n\tonClose: () => void;\n\tdefaultParentRoom?: IRoom['_id'];\n\tnameSuggestion?: string;\n};\n\nconst CreateDiscussion = ({ onClose, defaultParentRoom, parentMessageId, nameSuggestion }: CreateDiscussionProps): ReactElement => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm({\n\t\tname: nameSuggestion || '',\n\t\tparentRoom: '',\n\t\tencrypted: false,\n\t\tusernames: [],\n\t\tfirstMessage: '',\n\t});\n\n\tconst { name, parentRoom, encrypted, usernames, firstMessage } = values as CreateDiscussionFormValues;\n\n\tconst { handleName, handleParentRoom, handleEncrypted, handleUsernames, handleFirstMessage } = handlers;\n\n\tconst canCreate = (parentRoom || defaultParentRoom) && name;\n\n\tconst createDiscussion = useEndpointActionExperimental('POST', 'rooms.createDiscussion');\n\n\tconst create = useMutableCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tconst result = await createDiscussion({\n\t\t\t\tprid: defaultParentRoom || parentRoom,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/camelcase\n\t\t\t\tt_name: name,\n\t\t\t\tusers: usernames,\n\t\t\t\treply: encrypted ? undefined : firstMessage,\n\t\t\t\t...(parentMessageId && { pmid: parentMessageId }),\n\t\t\t});\n\n\t\t\tgoToRoomById(result.discussion._id);\n\t\t\tonClose();\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\t});\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (usernames.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsernames([...usernames, value]);\n\t\t}\n\t\thandleUsernames(usernames.filter((current) => current !== value));\n\t});\n\n\treturn (\n\t\t<Modal>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Discussion_title')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Description>{t('Discussion_description')}</Field.Description>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_target_channel')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t{defaultParentRoom && <DefaultParentRoomField defaultParentRoom={defaultParentRoom} />}\n\n\t\t\t\t\t\t\t{!defaultParentRoom && (\n\t\t\t\t\t\t\t\t<RoomAutoComplete\n\t\t\t\t\t\t\t\t\tvalue={parentRoom}\n\t\t\t\t\t\t\t\t\tonChange={handleParentRoom}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Discussion_target_channel_description')}\n\t\t\t\t\t\t\t\t\tdisabled={defaultParentRoom}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field display='flex' alignItems='center' flexDirection='row' justifyContent='spaceBetween' flexGrow={1}>\n\t\t\t\t\t\t<Box display='flex' flexDirection='column' width='full'>\n\t\t\t\t\t\t\t<Field.Label>{t('Encrypted')}</Field.Label>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<ToggleSwitch checked={encrypted} onChange={handleEncrypted} />\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_name')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\t\tonChange={handleName}\n\t\t\t\t\t\t\t\taddon={<Icon name='baloons' size='x20' />}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_name')}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Invite_Users')}</Field.Label>\n\t\t\t\t\t\t<Field.Row w='full' display='flex' flexDirection='column' alignItems='stretch'>\n\t\t\t\t\t\t\t<UserAutoCompleteMultiple value={usernames} onChange={onChangeUsers} placeholder={t('Username_Placeholder')} />\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t('Discussion_first_message_title')}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextAreaInput\n\t\t\t\t\t\t\t\tvalue={firstMessage}\n\t\t\t\t\t\t\t\tonChange={handleFirstMessage}\n\t\t\t\t\t\t\t\tplaceholder={t('New_discussion_first_message')}\n\t\t\t\t\t\t\t\trows={5}\n\t\t\t\t\t\t\t\tdisabled={encrypted}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t{encrypted && <Field.Description>{t('Discussion_first_message_disabled_due_to_e2e')}</Field.Description>}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary disabled={!canCreate} onClick={create}>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default CreateDiscussion;\n"],"sourceRoot":""},"sourceType":"module","hash":"5705cb18c09f3214cc6a98778bc64b6ad4588c8d"}
