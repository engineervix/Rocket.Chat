{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/contextualBar/Threads/withData.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/contextualBar/Threads/withData.tsx","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/contextualBar/Threads/withData.tsx","inputSourceMap":{"version":3,"file":"client/views/room/contextualBar/Threads/withData.tsx","sourceRoot":"","sources":["client/views/room/contextualBar/Threads/withData.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { useUserId, useUserSubscription } from '../../../../contexts/UserContext';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { ThreadsListOptions } from '../../../../lib/lists/ThreadsList';\nimport { useUserRoom } from '../../hooks/useUserRoom';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport { ThreadListProps } from './ThreadList';\nimport { useThreadsList } from './useThreadsList';\n\nconst subscriptionFields = { tunread: true, tunreadUser: true, tunreadGroup: true };\nconst roomFields = { t: 1, name: 1 };\n\nexport function withData(Component: FC<ThreadListProps>): FC<{ rid: string }> {\n\tconst WrappedComponent: FC<{ rid: string }> = ({ rid, ...props }) => {\n\t\tconst userId = useUserId();\n\t\tconst onClose = useTabBarClose();\n\t\tconst room = useUserRoom(rid, roomFields);\n\t\tconst subscription = useUserSubscription(rid, subscriptionFields);\n\n\t\tconst [type, setType] = useLocalStorage<'all' | 'following' | 'unread'>('thread-list-type', 'all');\n\n\t\tconst [text, setText] = useState('');\n\t\tconst debouncedText = useDebouncedValue(text, 400);\n\t\tconst options: ThreadsListOptions = useDebouncedValue(\n\t\t\tuseMemo(() => {\n\t\t\t\tif (type === 'all' || !subscription || !userId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\ttype: 'all',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'following':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tuid: userId,\n\t\t\t\t\t\t};\n\t\t\t\t\tcase 'unread':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\ttunread: subscription?.tunread,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t}, [rid, debouncedText, type, subscription?.tunread?.sort().join(), userId]),\n\t\t\t300,\n\t\t);\n\n\t\tconst { threadsList, loadMoreItems } = useThreadsList(options, userId as string);\n\t\tconst { phase, error, items: threads, itemCount: totalItemCount } = useRecordList(threadsList);\n\n\t\tconst handleTextChange = useCallback((event) => {\n\t\t\tsetText(event.currentTarget.value);\n\t\t}, []);\n\n\t\treturn (\n\t\t\t<Component\n\t\t\t\t{...props}\n\t\t\t\tunread={subscription?.tunread}\n\t\t\t\tunreadUser={subscription?.tunreadUser}\n\t\t\t\tunreadGroup={subscription?.tunreadGroup}\n\t\t\t\tuserId={userId}\n\t\t\t\terror={error}\n\t\t\t\tthreads={threads}\n\t\t\t\ttotal={totalItemCount}\n\t\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\t\tloadMoreItems={loadMoreItems}\n\t\t\t\troom={room}\n\t\t\t\ttext={text}\n\t\t\t\tsetText={handleTextChange}\n\t\t\t\ttype={type}\n\t\t\t\tsetType={setType as any}\n\t\t\t\tonClose={onClose as any}\n\t\t\t/>\n\t\t);\n\t};\n\n\tWrappedComponent.displayName = `withData(${Component.displayName ?? Component.name ?? 'Component'})`;\n\n\treturn WrappedComponent;\n}\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/contextualBar/Threads/withData.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/contextualBar/Threads/withData.tsx"}},"code":"const _excluded = [\"rid\"];\n\nlet _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 1);\nmodule.export({\n  withData: () => withData\n});\nlet useDebouncedValue, useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedValue(v) {\n    useDebouncedValue = v;\n  },\n\n  useLocalStorage(v) {\n    useLocalStorage = v;\n  }\n\n}, 0);\nlet React, useCallback, useMemo, useState;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useCallback(v) {\n    useCallback = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  },\n\n  useState(v) {\n    useState = v;\n  }\n\n}, 1);\nlet useUserId, useUserSubscription;\nmodule.link(\"../../../../contexts/UserContext\", {\n  useUserId(v) {\n    useUserId = v;\n  },\n\n  useUserSubscription(v) {\n    useUserSubscription = v;\n  }\n\n}, 2);\nlet useRecordList;\nmodule.link(\"../../../../hooks/lists/useRecordList\", {\n  useRecordList(v) {\n    useRecordList = v;\n  }\n\n}, 3);\nlet AsyncStatePhase;\nmodule.link(\"../../../../hooks/useAsyncState\", {\n  AsyncStatePhase(v) {\n    AsyncStatePhase = v;\n  }\n\n}, 4);\nlet useUserRoom;\nmodule.link(\"../../hooks/useUserRoom\", {\n  useUserRoom(v) {\n    useUserRoom = v;\n  }\n\n}, 5);\nlet useTabBarClose;\nmodule.link(\"../../providers/ToolboxProvider\", {\n  useTabBarClose(v) {\n    useTabBarClose = v;\n  }\n\n}, 6);\nlet useThreadsList;\nmodule.link(\"./useThreadsList\", {\n  useThreadsList(v) {\n    useThreadsList = v;\n  }\n\n}, 7);\nconst subscriptionFields = {\n  tunread: true,\n  tunreadUser: true,\n  tunreadGroup: true\n};\nconst roomFields = {\n  t: 1,\n  name: 1\n};\n\nfunction withData(Component) {\n  var _ref2, _Component$displayNam;\n\n  const WrappedComponent = _ref => {\n    var _subscription$tunread;\n\n    let {\n      rid\n    } = _ref,\n        props = _objectWithoutProperties(_ref, _excluded);\n\n    const userId = useUserId();\n    const onClose = useTabBarClose();\n    const room = useUserRoom(rid, roomFields);\n    const subscription = useUserSubscription(rid, subscriptionFields);\n    const [type, setType] = useLocalStorage('thread-list-type', 'all');\n    const [text, setText] = useState('');\n    const debouncedText = useDebouncedValue(text, 400);\n    const options = useDebouncedValue(useMemo(() => {\n      if (type === 'all' || !subscription || !userId) {\n        return {\n          rid,\n          text: debouncedText,\n          type: 'all'\n        };\n      }\n\n      switch (type) {\n        case 'following':\n          return {\n            rid,\n            text: debouncedText,\n            type,\n            uid: userId\n          };\n\n        case 'unread':\n          return {\n            rid,\n            text: debouncedText,\n            type,\n            tunread: subscription === null || subscription === void 0 ? void 0 : subscription.tunread\n          };\n      } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n    }, [rid, debouncedText, type, subscription === null || subscription === void 0 ? void 0 : (_subscription$tunread = subscription.tunread) === null || _subscription$tunread === void 0 ? void 0 : _subscription$tunread.sort().join(), userId]), 300);\n    const {\n      threadsList,\n      loadMoreItems\n    } = useThreadsList(options, userId);\n    const {\n      phase,\n      error,\n      items: threads,\n      itemCount: totalItemCount\n    } = useRecordList(threadsList);\n    const handleTextChange = useCallback(event => {\n      setText(event.currentTarget.value);\n    }, []);\n    return /*#__PURE__*/React.createElement(Component, _extends({}, props, {\n      unread: subscription === null || subscription === void 0 ? void 0 : subscription.tunread,\n      unreadUser: subscription === null || subscription === void 0 ? void 0 : subscription.tunreadUser,\n      unreadGroup: subscription === null || subscription === void 0 ? void 0 : subscription.tunreadGroup,\n      userId: userId,\n      error: error,\n      threads: threads,\n      total: totalItemCount,\n      loading: phase === AsyncStatePhase.LOADING,\n      loadMoreItems: loadMoreItems,\n      room: room,\n      text: text,\n      setText: handleTextChange,\n      type: type,\n      setType: setType,\n      onClose: onClose\n    }));\n  };\n\n  WrappedComponent.displayName = \"withData(\".concat((_ref2 = (_Component$displayNam = Component.displayName) !== null && _Component$displayNam !== void 0 ? _Component$displayNam : Component.name) !== null && _ref2 !== void 0 ? _ref2 : 'Component', \")\");\n  return WrappedComponent;\n}","map":{"version":3,"sources":["client/views/room/contextualBar/Threads/withData.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { useUserId, useUserSubscription } from '../../../../contexts/UserContext';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { ThreadsListOptions } from '../../../../lib/lists/ThreadsList';\nimport { useUserRoom } from '../../hooks/useUserRoom';\nimport { useTabBarClose } from '../../providers/ToolboxProvider';\nimport { ThreadListProps } from './ThreadList';\nimport { useThreadsList } from './useThreadsList';\n\nconst subscriptionFields = { tunread: true, tunreadUser: true, tunreadGroup: true };\nconst roomFields = { t: 1, name: 1 };\n\nexport function withData(Component: FC<ThreadListProps>): FC<{ rid: string }> {\n\tconst WrappedComponent: FC<{ rid: string }> = ({ rid, ...props }) => {\n\t\tconst userId = useUserId();\n\t\tconst onClose = useTabBarClose();\n\t\tconst room = useUserRoom(rid, roomFields);\n\t\tconst subscription = useUserSubscription(rid, subscriptionFields);\n\n\t\tconst [type, setType] = useLocalStorage<'all' | 'following' | 'unread'>('thread-list-type', 'all');\n\n\t\tconst [text, setText] = useState('');\n\t\tconst debouncedText = useDebouncedValue(text, 400);\n\t\tconst options: ThreadsListOptions = useDebouncedValue(\n\t\t\tuseMemo(() => {\n\t\t\t\tif (type === 'all' || !subscription || !userId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\ttype: 'all',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'following':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tuid: userId,\n\t\t\t\t\t\t};\n\t\t\t\t\tcase 'unread':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\trid,\n\t\t\t\t\t\t\ttext: debouncedText,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\ttunread: subscription?.tunread,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t}, [rid, debouncedText, type, subscription?.tunread?.sort().join(), userId]),\n\t\t\t300,\n\t\t);\n\n\t\tconst { threadsList, loadMoreItems } = useThreadsList(options, userId as string);\n\t\tconst { phase, error, items: threads, itemCount: totalItemCount } = useRecordList(threadsList);\n\n\t\tconst handleTextChange = useCallback((event) => {\n\t\t\tsetText(event.currentTarget.value);\n\t\t}, []);\n\n\t\treturn (\n\t\t\t<Component\n\t\t\t\t{...props}\n\t\t\t\tunread={subscription?.tunread}\n\t\t\t\tunreadUser={subscription?.tunreadUser}\n\t\t\t\tunreadGroup={subscription?.tunreadGroup}\n\t\t\t\tuserId={userId}\n\t\t\t\terror={error}\n\t\t\t\tthreads={threads}\n\t\t\t\ttotal={totalItemCount}\n\t\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\t\tloadMoreItems={loadMoreItems}\n\t\t\t\troom={room}\n\t\t\t\ttext={text}\n\t\t\t\tsetText={handleTextChange}\n\t\t\t\ttype={type}\n\t\t\t\tsetType={setType as any}\n\t\t\t\tonClose={onClose as any}\n\t\t\t/>\n\t\t);\n\t};\n\n\tWrappedComponent.displayName = `withData(${Component.displayName ?? Component.name ?? 'Component'})`;\n\n\treturn WrappedComponent;\n}\n"],"sourceRoot":""},"sourceType":"module","hash":"ea60a12b9464cdc64da8e863e7ce9a83a4a500d6"}
