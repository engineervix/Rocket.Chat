{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-utils/client/lib/SideNav.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/ui-utils/client/lib/SideNav.ts","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-utils/client/lib/SideNav.ts","inputSourceMap":{"version":3,"file":"app/ui-utils/client/lib/SideNav.ts","sourceRoot":"","sources":["app/ui-utils/client/lib/SideNav.ts"],"names":[],"mappings":"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","sourcesContent":["import { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Session } from 'meteor/session';\nimport { Emitter } from '@rocket.chat/emitter';\n\nimport { Subscriptions } from '../../../models/client';\nimport { RoomManager } from '../../../../client/lib/RoomManager';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\n\nexport const SideNav = new (class extends Emitter<{\n\tchanged: undefined;\n}> {\n\tprivate opened = false;\n\n\tprivate initiated = false;\n\n\tprivate openQueue: {\n\t\tconfig: {\n\t\t\ttemplate?: string;\n\t\t\tdata: Record<string, unknown>;\n\t\t};\n\t\tcallback: () => void;\n\t}[] = [];\n\n\tprivate animating = false;\n\n\tprivate sideNav: JQuery<HTMLElement>;\n\n\tprivate flexNav: JQuery<HTMLElement>;\n\n\ttoggleFlex(status: 1 | -1, callback: () => void): void {\n\t\tif (this.animating === true) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.animating = true;\n\n\t\tif (status === -1 || (status !== 1 && this.opened)) {\n\t\t\tthis.opened = false;\n\t\t\tthis.flexNav.addClass('animated-hidden');\n\t\t} else {\n\t\t\tthis.opened = true;\n\t\t\tthis.flexNav.removeClass('animated-hidden');\n\t\t}\n\n\t\tthis.emit('changed');\n\n\t\t!this.opened && this.setFlex();\n\t\tthis.animating = false;\n\t\ttypeof callback === 'function' && callback();\n\t}\n\n\tcloseFlex(callback: () => void = (): void => undefined): void {\n\t\tconst routeName = FlowRouter.current().route?.name;\n\t\tif (!routeName || !roomCoordinator.isRouteNameKnown(routeName)) {\n\t\t\tconst subscription = Subscriptions.findOne({ rid: RoomManager.lastRid });\n\t\t\tif (subscription) {\n\t\t\t\troomCoordinator.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);\n\t\t\t} else {\n\t\t\t\tFlowRouter.go('home');\n\t\t\t}\n\t\t}\n\t\tif (this.animating === true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.toggleFlex(-1, callback);\n\t}\n\n\tflexStatus(): boolean {\n\t\treturn this.opened;\n\t}\n\n\tsetFlex(template?: string, data = {}): void {\n\t\tSession.set('flex-nav-template', template);\n\t\treturn Session.set('flex-nav-data', data);\n\t}\n\n\tgetFlex(): {\n\t\ttemplate?: string;\n\t\tdata: Record<string, unknown>;\n\t} {\n\t\treturn {\n\t\t\ttemplate: Session.get('flex-nav-template'),\n\t\t\tdata: Session.get('flex-nav-data'),\n\t\t};\n\t}\n\n\topenFlex(callback = (): void => undefined): void {\n\t\tif (!this.initiated) {\n\t\t\tthis.openQueue.push({\n\t\t\t\tconfig: this.getFlex(),\n\t\t\t\tcallback,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (this.animating === true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.toggleFlex(1, callback);\n\t}\n\n\tinit(): void {\n\t\tthis.sideNav = $('.sidebar');\n\t\tthis.flexNav = this.sideNav.find('.flex-nav');\n\t\tthis.setFlex('');\n\t\tthis.initiated = true;\n\t\tif (this.openQueue.length > 0) {\n\t\t\tthis.openQueue.forEach((item) => {\n\t\t\t\tthis.setFlex(item.config.template, item.config.data);\n\t\t\t\treturn this.openFlex(item.callback);\n\t\t\t});\n\t\t\tthis.openQueue = [];\n\t\t}\n\t}\n})();\n"]},"targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-utils/client/lib/SideNav.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-utils/client/lib/SideNav.ts"}},"code":"module.export({\n  SideNav: () => SideNav\n});\nlet FlowRouter;\nmodule.link(\"meteor/kadira:flow-router\", {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 0);\nlet Session;\nmodule.link(\"meteor/session\", {\n  Session(v) {\n    Session = v;\n  }\n\n}, 1);\nlet Emitter;\nmodule.link(\"@rocket.chat/emitter\", {\n  Emitter(v) {\n    Emitter = v;\n  }\n\n}, 2);\nlet Subscriptions;\nmodule.link(\"../../../models/client\", {\n  Subscriptions(v) {\n    Subscriptions = v;\n  }\n\n}, 3);\nlet RoomManager;\nmodule.link(\"../../../../client/lib/RoomManager\", {\n  RoomManager(v) {\n    RoomManager = v;\n  }\n\n}, 4);\nlet roomCoordinator;\nmodule.link(\"../../../../client/lib/rooms/roomCoordinator\", {\n  roomCoordinator(v) {\n    roomCoordinator = v;\n  }\n\n}, 5);\nconst SideNav = new class extends Emitter {\n  constructor() {\n    super(...arguments);\n    this.opened = false;\n    this.initiated = false;\n    this.openQueue = [];\n    this.animating = false;\n    this.sideNav = void 0;\n    this.flexNav = void 0;\n  }\n\n  toggleFlex(status, callback) {\n    if (this.animating === true) {\n      return;\n    }\n\n    this.animating = true;\n\n    if (status === -1 || status !== 1 && this.opened) {\n      this.opened = false;\n      this.flexNav.addClass('animated-hidden');\n    } else {\n      this.opened = true;\n      this.flexNav.removeClass('animated-hidden');\n    }\n\n    this.emit('changed');\n    !this.opened && this.setFlex();\n    this.animating = false;\n    typeof callback === 'function' && callback();\n  }\n\n  closeFlex() {\n    var _FlowRouter$current$r;\n\n    let callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : () => undefined;\n    const routeName = (_FlowRouter$current$r = FlowRouter.current().route) === null || _FlowRouter$current$r === void 0 ? void 0 : _FlowRouter$current$r.name;\n\n    if (!routeName || !roomCoordinator.isRouteNameKnown(routeName)) {\n      const subscription = Subscriptions.findOne({\n        rid: RoomManager.lastRid\n      });\n\n      if (subscription) {\n        roomCoordinator.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);\n      } else {\n        FlowRouter.go('home');\n      }\n    }\n\n    if (this.animating === true) {\n      return;\n    }\n\n    this.toggleFlex(-1, callback);\n  }\n\n  flexStatus() {\n    return this.opened;\n  }\n\n  setFlex(template) {\n    let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Session.set('flex-nav-template', template);\n    return Session.set('flex-nav-data', data);\n  }\n\n  getFlex() {\n    return {\n      template: Session.get('flex-nav-template'),\n      data: Session.get('flex-nav-data')\n    };\n  }\n\n  openFlex() {\n    let callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : () => undefined;\n\n    if (!this.initiated) {\n      this.openQueue.push({\n        config: this.getFlex(),\n        callback\n      });\n      return;\n    }\n\n    if (this.animating === true) {\n      return;\n    }\n\n    this.toggleFlex(1, callback);\n  }\n\n  init() {\n    this.sideNav = $('.sidebar');\n    this.flexNav = this.sideNav.find('.flex-nav');\n    this.setFlex('');\n    this.initiated = true;\n\n    if (this.openQueue.length > 0) {\n      this.openQueue.forEach(item => {\n        this.setFlex(item.config.template, item.config.data);\n        return this.openFlex(item.callback);\n      });\n      this.openQueue = [];\n    }\n  }\n\n}();","map":{"version":3,"sources":["app/ui-utils/client/lib/SideNav.ts"],"names":[],"mappings":"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","sourcesContent":["import { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Session } from 'meteor/session';\nimport { Emitter } from '@rocket.chat/emitter';\n\nimport { Subscriptions } from '../../../models/client';\nimport { RoomManager } from '../../../../client/lib/RoomManager';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\n\nexport const SideNav = new (class extends Emitter<{\n\tchanged: undefined;\n}> {\n\tprivate opened = false;\n\n\tprivate initiated = false;\n\n\tprivate openQueue: {\n\t\tconfig: {\n\t\t\ttemplate?: string;\n\t\t\tdata: Record<string, unknown>;\n\t\t};\n\t\tcallback: () => void;\n\t}[] = [];\n\n\tprivate animating = false;\n\n\tprivate sideNav: JQuery<HTMLElement>;\n\n\tprivate flexNav: JQuery<HTMLElement>;\n\n\ttoggleFlex(status: 1 | -1, callback: () => void): void {\n\t\tif (this.animating === true) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.animating = true;\n\n\t\tif (status === -1 || (status !== 1 && this.opened)) {\n\t\t\tthis.opened = false;\n\t\t\tthis.flexNav.addClass('animated-hidden');\n\t\t} else {\n\t\t\tthis.opened = true;\n\t\t\tthis.flexNav.removeClass('animated-hidden');\n\t\t}\n\n\t\tthis.emit('changed');\n\n\t\t!this.opened && this.setFlex();\n\t\tthis.animating = false;\n\t\ttypeof callback === 'function' && callback();\n\t}\n\n\tcloseFlex(callback: () => void = (): void => undefined): void {\n\t\tconst routeName = FlowRouter.current().route?.name;\n\t\tif (!routeName || !roomCoordinator.isRouteNameKnown(routeName)) {\n\t\t\tconst subscription = Subscriptions.findOne({ rid: RoomManager.lastRid });\n\t\t\tif (subscription) {\n\t\t\t\troomCoordinator.openRouteLink(subscription.t, subscription, FlowRouter.current().queryParams);\n\t\t\t} else {\n\t\t\t\tFlowRouter.go('home');\n\t\t\t}\n\t\t}\n\t\tif (this.animating === true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.toggleFlex(-1, callback);\n\t}\n\n\tflexStatus(): boolean {\n\t\treturn this.opened;\n\t}\n\n\tsetFlex(template?: string, data = {}): void {\n\t\tSession.set('flex-nav-template', template);\n\t\treturn Session.set('flex-nav-data', data);\n\t}\n\n\tgetFlex(): {\n\t\ttemplate?: string;\n\t\tdata: Record<string, unknown>;\n\t} {\n\t\treturn {\n\t\t\ttemplate: Session.get('flex-nav-template'),\n\t\t\tdata: Session.get('flex-nav-data'),\n\t\t};\n\t}\n\n\topenFlex(callback = (): void => undefined): void {\n\t\tif (!this.initiated) {\n\t\t\tthis.openQueue.push({\n\t\t\t\tconfig: this.getFlex(),\n\t\t\t\tcallback,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (this.animating === true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.toggleFlex(1, callback);\n\t}\n\n\tinit(): void {\n\t\tthis.sideNav = $('.sidebar');\n\t\tthis.flexNav = this.sideNav.find('.flex-nav');\n\t\tthis.setFlex('');\n\t\tthis.initiated = true;\n\t\tif (this.openQueue.length > 0) {\n\t\t\tthis.openQueue.forEach((item) => {\n\t\t\t\tthis.setFlex(item.config.template, item.config.data);\n\t\t\t\treturn this.openFlex(item.callback);\n\t\t\t});\n\t\t\tthis.openQueue = [];\n\t\t}\n\t}\n})();\n"],"sourceRoot":""},"sourceType":"module","hash":"4e7829df7a721740ec78d82f5192dd4bd4ba03bd"}
