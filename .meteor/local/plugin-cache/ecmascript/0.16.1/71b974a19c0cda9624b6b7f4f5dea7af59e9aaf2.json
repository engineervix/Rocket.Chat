{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/users/UsersPage.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/users/UsersPage.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/users/UsersPage.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/users/UsersPage.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/users/UsersPage.js"}},"code":"let _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 0);\nlet useDebouncedValue;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedValue(v) {\n    useDebouncedValue = v;\n  }\n\n}, 0);\nlet React, useEffect, useMemo, useState;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useEffect(v) {\n    useEffect = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  },\n\n  useState(v) {\n    useState = v;\n  }\n\n}, 1);\nlet UserPageHeaderContentWithSeatsCap;\nmodule.link(\"../../../../ee/client/views/admin/users/UserPageHeaderContentWithSeatsCap\", {\n  default(v) {\n    UserPageHeaderContentWithSeatsCap = v;\n  }\n\n}, 2);\nlet useSeatsCap;\nmodule.link(\"../../../../ee/client/views/admin/users/useSeatsCap\", {\n  useSeatsCap(v) {\n    useSeatsCap = v;\n  }\n\n}, 3);\nlet Page;\nmodule.link(\"../../../components/Page\", {\n  default(v) {\n    Page = v;\n  }\n\n}, 4);\nlet VerticalBar;\nmodule.link(\"../../../components/VerticalBar\", {\n  default(v) {\n    VerticalBar = v;\n  }\n\n}, 5);\nlet useRoute, useRouteParameter;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute(v) {\n    useRoute = v;\n  },\n\n  useRouteParameter(v) {\n    useRouteParameter = v;\n  }\n\n}, 6);\nlet useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 7);\nlet useEndpointData;\nmodule.link(\"../../../hooks/useEndpointData\", {\n  useEndpointData(v) {\n    useEndpointData = v;\n  }\n\n}, 8);\nlet AddUser;\nmodule.link(\"./AddUser\", {\n  AddUser(v) {\n    AddUser = v;\n  }\n\n}, 9);\nlet EditUserWithData;\nmodule.link(\"./EditUserWithData\", {\n  default(v) {\n    EditUserWithData = v;\n  }\n\n}, 10);\nlet InviteUsers;\nmodule.link(\"./InviteUsers\", {\n  InviteUsers(v) {\n    InviteUsers = v;\n  }\n\n}, 11);\nlet UserInfoWithData;\nmodule.link(\"./UserInfo\", {\n  UserInfoWithData(v) {\n    UserInfoWithData = v;\n  }\n\n}, 12);\nlet UserPageHeaderContent;\nmodule.link(\"./UserPageHeaderContent\", {\n  default(v) {\n    UserPageHeaderContent = v;\n  }\n\n}, 13);\nlet UsersTable;\nmodule.link(\"./UsersTable\", {\n  default(v) {\n    UsersTable = v;\n  }\n\n}, 14);\n\nconst sortDir = sortDir => sortDir === 'asc' ? 1 : -1;\n\nconst useQuery = (_ref, sortFields) => {\n  let {\n    text,\n    itemsPerPage,\n    current\n  } = _ref;\n  return useMemo(() => _objectSpread(_objectSpread({\n    fields: JSON.stringify({\n      name: 1,\n      username: 1,\n      emails: 1,\n      roles: 1,\n      status: 1,\n      avatarETag: 1,\n      active: 1\n    }),\n    query: JSON.stringify({\n      $or: [{\n        'emails.address': {\n          $regex: text || '',\n          $options: 'i'\n        }\n      }, {\n        username: {\n          $regex: text || '',\n          $options: 'i'\n        }\n      }, {\n        name: {\n          $regex: text || '',\n          $options: 'i'\n        }\n      }]\n    }),\n    sort: JSON.stringify(sortFields.reduce((agg, _ref2) => {\n      let [column, direction] = _ref2;\n      agg[column] = sortDir(direction);\n      return agg;\n    }, {}))\n  }, itemsPerPage && {\n    count: itemsPerPage\n  }), current && {\n    offset: current\n  }), [text, itemsPerPage, current, sortFields]);\n};\n\nfunction UsersPage() {\n  const context = useRouteParameter('context');\n  const id = useRouteParameter('id');\n  const seatsCap = useSeatsCap();\n  const usersRoute = useRoute('admin-users');\n  useEffect(() => {\n    if (!context || !seatsCap) {\n      return;\n    }\n\n    if (seatsCap.activeUsers >= seatsCap.maxActiveUsers && !['edit', 'info'].includes(context)) {\n      usersRoute.push({});\n    }\n  }, [context, seatsCap, usersRoute]);\n  const t = useTranslation();\n\n  const handleVerticalBarCloseButtonClick = () => {\n    usersRoute.push({});\n  };\n\n  const [params, setParams] = useState({\n    text: '',\n    current: 0,\n    itemsPerPage: 25\n  });\n  const [sort, setSort] = useState([['name', 'asc'], ['usernames', 'asc']]);\n  const debouncedParams = useDebouncedValue(params, 500);\n  const debouncedSort = useDebouncedValue(sort, 500);\n  const query = useQuery(debouncedParams, debouncedSort);\n  const {\n    value: data = {},\n    reload: reloadList\n  } = useEndpointData('users.list', query);\n\n  const reload = () => {\n    seatsCap === null || seatsCap === void 0 ? void 0 : seatsCap.reload();\n    reloadList();\n  };\n\n  return /*#__PURE__*/React.createElement(Page, {\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: t('Users')\n  }, seatsCap && (seatsCap.maxActiveUsers < Number.POSITIVE_INFINITY ? /*#__PURE__*/React.createElement(UserPageHeaderContentWithSeatsCap, seatsCap) : /*#__PURE__*/React.createElement(UserPageHeaderContent, null))), /*#__PURE__*/React.createElement(Page.Content, null, /*#__PURE__*/React.createElement(UsersTable, {\n    users: data.users,\n    total: data.total,\n    params: params,\n    onChangeParams: setParams,\n    sort: sort,\n    onChangeSort: setSort\n  }))), context && /*#__PURE__*/React.createElement(VerticalBar, null, /*#__PURE__*/React.createElement(VerticalBar.Header, null, context === 'info' && t('User_Info'), context === 'edit' && t('Edit_User'), context === 'new' && t('Add_User'), context === 'invite' && t('Invite_Users'), /*#__PURE__*/React.createElement(VerticalBar.Close, {\n    onClick: handleVerticalBarCloseButtonClick\n  })), context === 'info' && id && /*#__PURE__*/React.createElement(UserInfoWithData, {\n    uid: id,\n    onReload: reload\n  }), context === 'edit' && /*#__PURE__*/React.createElement(EditUserWithData, {\n    uid: id,\n    onReload: reload\n  }), context === 'new' && /*#__PURE__*/React.createElement(AddUser, {\n    onReload: reload\n  }), context === 'invite' && /*#__PURE__*/React.createElement(InviteUsers, null)));\n}\n\nmodule.exportDefault(UsersPage);","map":{"version":3,"sources":["client/views/admin/users/UsersPage.js"],"names":["_objectSpread","module","link","default","v","useDebouncedValue","React","useEffect","useMemo","useState","UserPageHeaderContentWithSeatsCap","useSeatsCap","Page","VerticalBar","useRoute","useRouteParameter","useTranslation","useEndpointData","AddUser","EditUserWithData","InviteUsers","UserInfoWithData","UserPageHeaderContent","UsersTable","sortDir","useQuery","sortFields","text","itemsPerPage","current","fields","JSON","stringify","name","username","emails","roles","status","avatarETag","active","query","$or","$regex","$options","sort","reduce","agg","column","direction","count","offset","UsersPage","context","id","seatsCap","usersRoute","activeUsers","maxActiveUsers","includes","push","t","handleVerticalBarCloseButtonClick","params","setParams","setSort","debouncedParams","debouncedSort","value","data","reload","reloadList","Number","POSITIVE_INFINITY","users","total","exportDefault"],"mappings":"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","sourcesContent":["import { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nimport UserPageHeaderContentWithSeatsCap from '../../../../ee/client/views/admin/users/UserPageHeaderContentWithSeatsCap';\nimport { useSeatsCap } from '../../../../ee/client/views/admin/users/useSeatsCap';\nimport Page from '../../../components/Page';\nimport VerticalBar from '../../../components/VerticalBar';\nimport { useRoute, useRouteParameter } from '../../../contexts/RouterContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport { AddUser } from './AddUser';\nimport EditUserWithData from './EditUserWithData';\nimport { InviteUsers } from './InviteUsers';\nimport { UserInfoWithData } from './UserInfo';\nimport UserPageHeaderContent from './UserPageHeaderContent';\nimport UsersTable from './UsersTable';\n\nconst sortDir = (sortDir) => (sortDir === 'asc' ? 1 : -1);\n\nconst useQuery = ({ text, itemsPerPage, current }, sortFields) =>\n\tuseMemo(\n\t\t() => ({\n\t\t\tfields: JSON.stringify({\n\t\t\t\tname: 1,\n\t\t\t\tusername: 1,\n\t\t\t\temails: 1,\n\t\t\t\troles: 1,\n\t\t\t\tstatus: 1,\n\t\t\t\tavatarETag: 1,\n\t\t\t\tactive: 1,\n\t\t\t}),\n\t\t\tquery: JSON.stringify({\n\t\t\t\t$or: [\n\t\t\t\t\t{ 'emails.address': { $regex: text || '', $options: 'i' } },\n\t\t\t\t\t{ username: { $regex: text || '', $options: 'i' } },\n\t\t\t\t\t{ name: { $regex: text || '', $options: 'i' } },\n\t\t\t\t],\n\t\t\t}),\n\t\t\tsort: JSON.stringify(\n\t\t\t\tsortFields.reduce((agg, [column, direction]) => {\n\t\t\t\t\tagg[column] = sortDir(direction);\n\t\t\t\t\treturn agg;\n\t\t\t\t}, {}),\n\t\t\t),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[text, itemsPerPage, current, sortFields],\n\t);\n\nfunction UsersPage() {\n\tconst context = useRouteParameter('context');\n\tconst id = useRouteParameter('id');\n\tconst seatsCap = useSeatsCap();\n\tconst usersRoute = useRoute('admin-users');\n\n\tuseEffect(() => {\n\t\tif (!context || !seatsCap) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (seatsCap.activeUsers >= seatsCap.maxActiveUsers && !['edit', 'info'].includes(context)) {\n\t\t\tusersRoute.push({});\n\t\t}\n\t}, [context, seatsCap, usersRoute]);\n\n\tconst t = useTranslation();\n\n\tconst handleVerticalBarCloseButtonClick = () => {\n\t\tusersRoute.push({});\n\t};\n\tconst [params, setParams] = useState({ text: '', current: 0, itemsPerPage: 25 });\n\tconst [sort, setSort] = useState([\n\t\t['name', 'asc'],\n\t\t['usernames', 'asc'],\n\t]);\n\n\tconst debouncedParams = useDebouncedValue(params, 500);\n\tconst debouncedSort = useDebouncedValue(sort, 500);\n\tconst query = useQuery(debouncedParams, debouncedSort);\n\tconst { value: data = {}, reload: reloadList } = useEndpointData('users.list', query);\n\n\tconst reload = () => {\n\t\tseatsCap?.reload();\n\t\treloadList();\n\t};\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Users')}>\n\t\t\t\t\t{seatsCap &&\n\t\t\t\t\t\t(seatsCap.maxActiveUsers < Number.POSITIVE_INFINITY ? (\n\t\t\t\t\t\t\t<UserPageHeaderContentWithSeatsCap {...seatsCap} />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<UserPageHeaderContent />\n\t\t\t\t\t\t))}\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.Content>\n\t\t\t\t\t<UsersTable users={data.users} total={data.total} params={params} onChangeParams={setParams} sort={sort} onChangeSort={setSort} />\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t{context && (\n\t\t\t\t<VerticalBar>\n\t\t\t\t\t<VerticalBar.Header>\n\t\t\t\t\t\t{context === 'info' && t('User_Info')}\n\t\t\t\t\t\t{context === 'edit' && t('Edit_User')}\n\t\t\t\t\t\t{context === 'new' && t('Add_User')}\n\t\t\t\t\t\t{context === 'invite' && t('Invite_Users')}\n\t\t\t\t\t\t<VerticalBar.Close onClick={handleVerticalBarCloseButtonClick} />\n\t\t\t\t\t</VerticalBar.Header>\n\n\t\t\t\t\t{context === 'info' && id && <UserInfoWithData uid={id} onReload={reload} />}\n\t\t\t\t\t{context === 'edit' && <EditUserWithData uid={id} onReload={reload} />}\n\t\t\t\t\t{context === 'new' && <AddUser onReload={reload} />}\n\t\t\t\t\t{context === 'invite' && <InviteUsers />}\n\t\t\t\t</VerticalBar>\n\t\t\t)}\n\t\t</Page>\n\t);\n}\n\nexport default UsersPage;\n"]},"sourceType":"module","hash":"71b974a19c0cda9624b6b7f4f5dea7af59e9aaf2"}
