{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/permissions/PermissionsTable.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/permissions/PermissionsTable.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/permissions/PermissionsTable.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/permissions/PermissionsTable.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/permissions/PermissionsTable.js"}},"code":"var _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nvar Margins, Icon, Tabs, Button;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Margins: function (v) {\n    Margins = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  },\n  Tabs: function (v) {\n    Tabs = v;\n  },\n  Button: function (v) {\n    Button = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar React, useState, useCallback;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  }\n}, 2);\nvar GenericTable;\nmodule.link(\"../../../components/GenericTable\", {\n  \"default\": function (v) {\n    GenericTable = v;\n  }\n}, 3);\nvar Page;\nmodule.link(\"../../../components/Page\", {\n  \"default\": function (v) {\n    Page = v;\n  }\n}, 4);\nvar usePermission;\nmodule.link(\"../../../contexts/AuthorizationContext\", {\n  usePermission: function (v) {\n    usePermission = v;\n  }\n}, 5);\nvar useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute: function (v) {\n    useRoute = v;\n  }\n}, 6);\nvar useMethod;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod: function (v) {\n    useMethod = v;\n  }\n}, 7);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 8);\nvar FilterComponent;\nmodule.link(\"./FilterComponent\", {\n  \"default\": function (v) {\n    FilterComponent = v;\n  }\n}, 9);\nvar PermissionRow;\nmodule.link(\"./PermissionRow\", {\n  \"default\": function (v) {\n    PermissionRow = v;\n  }\n}, 10);\nvar PermissionsContextBar;\nmodule.link(\"./PermissionsContextBar\", {\n  \"default\": function (v) {\n    PermissionsContextBar = v;\n  }\n}, 11);\nvar RoleHeader;\nmodule.link(\"./RoleHeader\", {\n  \"default\": function (v) {\n    RoleHeader = v;\n  }\n}, 12);\nvar usePermissionsAndRoles;\nmodule.link(\"./hooks/usePermissionsAndRoles\", {\n  usePermissionsAndRoles: function (v) {\n    usePermissionsAndRoles = v;\n  }\n}, 13);\n\nvar PermissionsTable = function () {\n  var t = useTranslation();\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      filter = _useState2[0],\n      setFilter = _useState2[1];\n\n  var canViewPermission = usePermission('access-permissions');\n  var canViewSettingPermission = usePermission('access-setting-permissions');\n  var defaultType = canViewPermission ? 'permissions' : 'settings';\n\n  var _useState3 = useState(defaultType),\n      _useState4 = _slicedToArray(_useState3, 2),\n      type = _useState4[0],\n      setType = _useState4[1];\n\n  var _useState5 = useState({\n    limit: 25,\n    skip: 0\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      params = _useState6[0],\n      setParams = _useState6[1];\n\n  var router = useRoute('admin-permissions');\n  var grantRole = useMethod('authorization:addPermissionToRole');\n  var removeRole = useMethod('authorization:removeRoleFromPermission');\n  var permissionsData = usePermissionsAndRoles(type, filter, params.limit, params.skip);\n\n  var _permissionsData = _slicedToArray(permissionsData, 3),\n      permissions = _permissionsData[0],\n      total = _permissionsData[1],\n      roleList = _permissionsData[2];\n\n  var handleParams = useMutableCallback(function (_ref) {\n    var current = _ref.current,\n        itemsPerPage = _ref.itemsPerPage;\n    setParams({\n      skip: current,\n      limit: itemsPerPage\n    });\n  });\n  var handlePermissionsTab = useMutableCallback(function () {\n    if (type === 'permissions') {\n      return;\n    }\n\n    setType('permissions');\n  });\n  var handleSettingsTab = useMutableCallback(function () {\n    if (type === 'settings') {\n      return;\n    }\n\n    setType('settings');\n  });\n  var handleAdd = useMutableCallback(function () {\n    router.push({\n      context: 'new'\n    });\n  });\n  return /*#__PURE__*/React.createElement(Page, {\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: t('Permissions')\n  }, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleAdd,\n    \"aria-label\": t('New')\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"plus\"\n  }), \" \", t('New_role'))), /*#__PURE__*/React.createElement(Margins, {\n    blockEnd: \"x16\"\n  }, /*#__PURE__*/React.createElement(Tabs, null, /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: type === 'permissions',\n    onClick: handlePermissionsTab,\n    disabled: !canViewPermission\n  }, t('Permissions')), /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: type === 'settings',\n    onClick: handleSettingsTab,\n    disabled: !canViewSettingPermission\n  }, t('Settings')))), /*#__PURE__*/React.createElement(Page.Content, {\n    mb: \"neg-x8\"\n  }, /*#__PURE__*/React.createElement(Margins, {\n    block: \"x8\"\n  }, /*#__PURE__*/React.createElement(FilterComponent, {\n    onChange: setFilter\n  }), /*#__PURE__*/React.createElement(GenericTable, {\n    header: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(GenericTable.HeaderCell, {\n      width: \"x120\"\n    }, t('Name')), roleList.map(function (_ref2) {\n      var _id = _ref2._id,\n          name = _ref2.name,\n          description = _ref2.description;\n      return /*#__PURE__*/React.createElement(RoleHeader, {\n        key: _id,\n        _id: _id,\n        name: name,\n        description: description,\n        router: router\n      });\n    })),\n    total: total,\n    results: permissions,\n    params: params,\n    setParams: handleParams,\n    fixed: false\n  }, useCallback(function (permission) {\n    return /*#__PURE__*/React.createElement(PermissionRow, {\n      key: permission._id,\n      permission: permission,\n      t: t,\n      roleList: roleList,\n      onGrant: grantRole,\n      onRemove: removeRole\n    });\n  }, [grantRole, removeRole, roleList, t]))))), /*#__PURE__*/React.createElement(PermissionsContextBar, null));\n};\n\nmodule.exportDefault(PermissionsTable);","map":{"version":3,"sources":["client/views/admin/permissions/PermissionsTable.js"],"names":["_slicedToArray","module","link","default","v","Margins","Icon","Tabs","Button","useMutableCallback","React","useState","useCallback","GenericTable","Page","usePermission","useRoute","useMethod","useTranslation","FilterComponent","PermissionRow","PermissionsContextBar","RoleHeader","usePermissionsAndRoles","PermissionsTable","t","filter","setFilter","canViewPermission","canViewSettingPermission","defaultType","type","setType","limit","skip","params","setParams","router","grantRole","removeRole","permissionsData","permissions","total","roleList","handleParams","current","itemsPerPage","handlePermissionsTab","handleSettingsTab","handleAdd","push","context","map","_id","name","description","permission","exportDefault"],"mappings":"AAAA,IAAIA,cAAJ;;AAAmBC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,IAAAA,cAAc,GAACI,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAAnB,IAAIC,OAAJ,EAAYC,IAAZ,EAAiBC,IAAjB,EAAsBC,MAAtB;AAA6BP,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACG,EAAAA,OAAO,EAAC,UAASD,CAAT,EAAW;AAACC,IAAAA,OAAO,GAACD,CAAR;AAAU,GAA/B;AAAgCE,EAAAA,IAAI,EAAC,UAASF,CAAT,EAAW;AAACE,IAAAA,IAAI,GAACF,CAAL;AAAO,GAAxD;AAAyDG,EAAAA,IAAI,EAAC,UAASH,CAAT,EAAW;AAACG,IAAAA,IAAI,GAACH,CAAL;AAAO,GAAjF;AAAkFI,EAAAA,MAAM,EAAC,UAASJ,CAAT,EAAW;AAACI,IAAAA,MAAM,GAACJ,CAAP;AAAS;AAA9G,CAApC,EAAoJ,CAApJ;AAAuJ,IAAIK,kBAAJ;AAAuBR,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACO,EAAAA,kBAAkB,EAAC,UAASL,CAAT,EAAW;AAACK,IAAAA,kBAAkB,GAACL,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,CAAjG;AAAoG,IAAIM,KAAJ,EAAUC,QAAV,EAAmBC,WAAnB;AAA+BX,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACM,IAAAA,KAAK,GAACN,CAAN;AAAQ,GAA7B;AAA8BO,EAAAA,QAAQ,EAAC,UAASP,CAAT,EAAW;AAACO,IAAAA,QAAQ,GAACP,CAAT;AAAW,GAA9D;AAA+DQ,EAAAA,WAAW,EAAC,UAASR,CAAT,EAAW;AAACQ,IAAAA,WAAW,GAACR,CAAZ;AAAc;AAArG,CAApB,EAA2H,CAA3H;AAA8H,IAAIS,YAAJ;AAAiBZ,MAAM,CAACC,IAAP,CAAY,kCAAZ,EAA+C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACS,IAAAA,YAAY,GAACT,CAAb;AAAe;AAApC,CAA/C,EAAqF,CAArF;AAAwF,IAAIU,IAAJ;AAASb,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACU,IAAAA,IAAI,GAACV,CAAL;AAAO;AAA5B,CAAvC,EAAqE,CAArE;AAAwE,IAAIW,aAAJ;AAAkBd,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACa,EAAAA,aAAa,EAAC,UAASX,CAAT,EAAW;AAACW,IAAAA,aAAa,GAACX,CAAd;AAAgB;AAA3C,CAArD,EAAkG,CAAlG;AAAqG,IAAIY,QAAJ;AAAaf,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACc,EAAAA,QAAQ,EAAC,UAASZ,CAAT,EAAW;AAACY,IAAAA,QAAQ,GAACZ,CAAT;AAAW;AAAjC,CAA9C,EAAiF,CAAjF;AAAoF,IAAIa,SAAJ;AAAchB,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACe,EAAAA,SAAS,EAAC,UAASb,CAAT,EAAW;AAACa,IAAAA,SAAS,GAACb,CAAV;AAAY;AAAnC,CAA9C,EAAmF,CAAnF;AAAsF,IAAIc,cAAJ;AAAmBjB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACgB,EAAAA,cAAc,EAAC,UAASd,CAAT,EAAW;AAACc,IAAAA,cAAc,GAACd,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;AAAqG,IAAIe,eAAJ;AAAoBlB,MAAM,CAACC,IAAP,CAAY,mBAAZ,EAAgC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACe,IAAAA,eAAe,GAACf,CAAhB;AAAkB;AAAvC,CAAhC,EAAyE,CAAzE;AAA4E,IAAIgB,aAAJ;AAAkBnB,MAAM,CAACC,IAAP,CAAY,iBAAZ,EAA8B;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACgB,IAAAA,aAAa,GAAChB,CAAd;AAAgB;AAArC,CAA9B,EAAqE,EAArE;AAAyE,IAAIiB,qBAAJ;AAA0BpB,MAAM,CAACC,IAAP,CAAY,yBAAZ,EAAsC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACiB,IAAAA,qBAAqB,GAACjB,CAAtB;AAAwB;AAA7C,CAAtC,EAAqF,EAArF;AAAyF,IAAIkB,UAAJ;AAAerB,MAAM,CAACC,IAAP,CAAY,cAAZ,EAA2B;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACkB,IAAAA,UAAU,GAAClB,CAAX;AAAa;AAAlC,CAA3B,EAA+D,EAA/D;AAAmE,IAAImB,sBAAJ;AAA2BtB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACqB,EAAAA,sBAAsB,EAAC,UAASnB,CAAT,EAAW;AAACmB,IAAAA,sBAAsB,GAACnB,CAAvB;AAAyB;AAA7D,CAA7C,EAA4G,EAA5G;;AAgBr9C,IAAMoB,gBAAgB,GAAG,YAAM;AAC9B,MAAMC,CAAC,GAAGP,cAAc,EAAxB;;AACA,kBAA4BP,QAAQ,CAAC,EAAD,CAApC;AAAA;AAAA,MAAOe,MAAP;AAAA,MAAeC,SAAf;;AACA,MAAMC,iBAAiB,GAAGb,aAAa,CAAC,oBAAD,CAAvC;AACA,MAAMc,wBAAwB,GAAGd,aAAa,CAAC,4BAAD,CAA9C;AACA,MAAMe,WAAW,GAAGF,iBAAiB,GAAG,aAAH,GAAmB,UAAxD;;AACA,mBAAwBjB,QAAQ,CAACmB,WAAD,CAAhC;AAAA;AAAA,MAAOC,IAAP;AAAA,MAAaC,OAAb;;AACA,mBAA4BrB,QAAQ,CAAC;AAAEsB,IAAAA,KAAK,EAAE,EAAT;AAAaC,IAAAA,IAAI,EAAE;AAAnB,GAAD,CAApC;AAAA;AAAA,MAAOC,MAAP;AAAA,MAAeC,SAAf;;AAEA,MAAMC,MAAM,GAAGrB,QAAQ,CAAC,mBAAD,CAAvB;AAEA,MAAMsB,SAAS,GAAGrB,SAAS,CAAC,mCAAD,CAA3B;AACA,MAAMsB,UAAU,GAAGtB,SAAS,CAAC,wCAAD,CAA5B;AAEA,MAAMuB,eAAe,GAAGjB,sBAAsB,CAACQ,IAAD,EAAOL,MAAP,EAAeS,MAAM,CAACF,KAAtB,EAA6BE,MAAM,CAACD,IAApC,CAA9C;;AAEA,wCAAuCM,eAAvC;AAAA,MAAOC,WAAP;AAAA,MAAoBC,KAApB;AAAA,MAA2BC,QAA3B;;AAEA,MAAMC,YAAY,GAAGnC,kBAAkB,CAAC,gBAA+B;AAAA,QAA5BoC,OAA4B,QAA5BA,OAA4B;AAAA,QAAnBC,YAAmB,QAAnBA,YAAmB;AACtEV,IAAAA,SAAS,CAAC;AAAEF,MAAAA,IAAI,EAAEW,OAAR;AAAiBZ,MAAAA,KAAK,EAAEa;AAAxB,KAAD,CAAT;AACA,GAFsC,CAAvC;AAIA,MAAMC,oBAAoB,GAAGtC,kBAAkB,CAAC,YAAM;AACrD,QAAIsB,IAAI,KAAK,aAAb,EAA4B;AAC3B;AACA;;AACDC,IAAAA,OAAO,CAAC,aAAD,CAAP;AACA,GAL8C,CAA/C;AAOA,MAAMgB,iBAAiB,GAAGvC,kBAAkB,CAAC,YAAM;AAClD,QAAIsB,IAAI,KAAK,UAAb,EAAyB;AACxB;AACA;;AACDC,IAAAA,OAAO,CAAC,UAAD,CAAP;AACA,GAL2C,CAA5C;AAOA,MAAMiB,SAAS,GAAGxC,kBAAkB,CAAC,YAAM;AAC1C4B,IAAAA,MAAM,CAACa,IAAP,CAAY;AACXC,MAAAA,OAAO,EAAE;AADE,KAAZ;AAGA,GAJmC,CAApC;AAMA,sBACC,oBAAC,IAAD;AAAM,IAAA,aAAa,EAAC;AAApB,kBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,IAAA,KAAK,EAAE1B,CAAC,CAAC,aAAD;AAArB,kBACC,oBAAC,MAAD;AAAQ,IAAA,OAAO,MAAf;AAAgB,IAAA,OAAO,EAAEwB,SAAzB;AAAoC,kBAAYxB,CAAC,CAAC,KAAD;AAAjD,kBACC,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAC;AAAX,IADD,OACuBA,CAAC,CAAC,UAAD,CADxB,CADD,CADD,eAMC,oBAAC,OAAD;AAAS,IAAA,QAAQ,EAAC;AAAlB,kBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,QAAQ,EAAEM,IAAI,KAAK,aAA9B;AAA6C,IAAA,OAAO,EAAEgB,oBAAtD;AAA4E,IAAA,QAAQ,EAAE,CAACnB;AAAvF,KACEH,CAAC,CAAC,aAAD,CADH,CADD,eAIC,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,QAAQ,EAAEM,IAAI,KAAK,UAA9B;AAA0C,IAAA,OAAO,EAAEiB,iBAAnD;AAAsE,IAAA,QAAQ,EAAE,CAACnB;AAAjF,KACEJ,CAAC,CAAC,UAAD,CADH,CAJD,CADD,CAND,eAgBC,oBAAC,IAAD,CAAM,OAAN;AAAc,IAAA,EAAE,EAAC;AAAjB,kBACC,oBAAC,OAAD;AAAS,IAAA,KAAK,EAAC;AAAf,kBACC,oBAAC,eAAD;AAAiB,IAAA,QAAQ,EAAEE;AAA3B,IADD,eAEC,oBAAC,YAAD;AACC,IAAA,MAAM,eACL,uDACC,oBAAC,YAAD,CAAc,UAAd;AAAyB,MAAA,KAAK,EAAC;AAA/B,OAAuCF,CAAC,CAAC,MAAD,CAAxC,CADD,EAEEkB,QAAQ,CAACS,GAAT,CAAa;AAAA,UAAGC,GAAH,SAAGA,GAAH;AAAA,UAAQC,IAAR,SAAQA,IAAR;AAAA,UAAcC,WAAd,SAAcA,WAAd;AAAA,0BACb,oBAAC,UAAD;AAAY,QAAA,GAAG,EAAEF,GAAjB;AAAsB,QAAA,GAAG,EAAEA,GAA3B;AAAgC,QAAA,IAAI,EAAEC,IAAtC;AAA4C,QAAA,WAAW,EAAEC,WAAzD;AAAsE,QAAA,MAAM,EAAElB;AAA9E,QADa;AAAA,KAAb,CAFF,CAFF;AASC,IAAA,KAAK,EAAEK,KATR;AAUC,IAAA,OAAO,EAAED,WAVV;AAWC,IAAA,MAAM,EAAEN,MAXT;AAYC,IAAA,SAAS,EAAES,YAZZ;AAaC,IAAA,KAAK,EAAE;AAbR,KAeEhC,WAAW,CACX,UAAC4C,UAAD;AAAA,wBACC,oBAAC,aAAD;AACC,MAAA,GAAG,EAAEA,UAAU,CAACH,GADjB;AAEC,MAAA,UAAU,EAAEG,UAFb;AAGC,MAAA,CAAC,EAAE/B,CAHJ;AAIC,MAAA,QAAQ,EAAEkB,QAJX;AAKC,MAAA,OAAO,EAAEL,SALV;AAMC,MAAA,QAAQ,EAAEC;AANX,MADD;AAAA,GADW,EAWX,CAACD,SAAD,EAAYC,UAAZ,EAAwBI,QAAxB,EAAkClB,CAAlC,CAXW,CAfb,CAFD,CADD,CAhBD,CADD,eAoDC,oBAAC,qBAAD,OApDD,CADD;AAwDA,CAlGD;;AAhBAxB,MAAM,CAACwD,aAAP,CAoHejC,gBApHf","sourcesContent":["import { Margins, Icon, Tabs, Button } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useCallback } from 'react';\n\nimport GenericTable from '../../../components/GenericTable';\nimport Page from '../../../components/Page';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport FilterComponent from './FilterComponent';\nimport PermissionRow from './PermissionRow';\nimport PermissionsContextBar from './PermissionsContextBar';\nimport RoleHeader from './RoleHeader';\nimport { usePermissionsAndRoles } from './hooks/usePermissionsAndRoles';\n\nconst PermissionsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst canViewPermission = usePermission('access-permissions');\n\tconst canViewSettingPermission = usePermission('access-setting-permissions');\n\tconst defaultType = canViewPermission ? 'permissions' : 'settings';\n\tconst [type, setType] = useState(defaultType);\n\tconst [params, setParams] = useState({ limit: 25, skip: 0 });\n\n\tconst router = useRoute('admin-permissions');\n\n\tconst grantRole = useMethod('authorization:addPermissionToRole');\n\tconst removeRole = useMethod('authorization:removeRoleFromPermission');\n\n\tconst permissionsData = usePermissionsAndRoles(type, filter, params.limit, params.skip);\n\n\tconst [permissions, total, roleList] = permissionsData;\n\n\tconst handleParams = useMutableCallback(({ current, itemsPerPage }) => {\n\t\tsetParams({ skip: current, limit: itemsPerPage });\n\t});\n\n\tconst handlePermissionsTab = useMutableCallback(() => {\n\t\tif (type === 'permissions') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('permissions');\n\t});\n\n\tconst handleSettingsTab = useMutableCallback(() => {\n\t\tif (type === 'settings') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('settings');\n\t});\n\n\tconst handleAdd = useMutableCallback(() => {\n\t\trouter.push({\n\t\t\tcontext: 'new',\n\t\t});\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Permissions')}>\n\t\t\t\t\t<Button primary onClick={handleAdd} aria-label={t('New')}>\n\t\t\t\t\t\t<Icon name='plus' /> {t('New_role')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Margins blockEnd='x16'>\n\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'permissions'} onClick={handlePermissionsTab} disabled={!canViewPermission}>\n\t\t\t\t\t\t\t{t('Permissions')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'settings'} onClick={handleSettingsTab} disabled={!canViewSettingPermission}>\n\t\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Margins>\n\t\t\t\t<Page.Content mb='neg-x8'>\n\t\t\t\t\t<Margins block='x8'>\n\t\t\t\t\t\t<FilterComponent onChange={setFilter} />\n\t\t\t\t\t\t<GenericTable\n\t\t\t\t\t\t\theader={\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<GenericTable.HeaderCell width='x120'>{t('Name')}</GenericTable.HeaderCell>\n\t\t\t\t\t\t\t\t\t{roleList.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t\t\t<RoleHeader key={_id} _id={_id} name={name} description={description} router={router} />\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttotal={total}\n\t\t\t\t\t\t\tresults={permissions}\n\t\t\t\t\t\t\tparams={params}\n\t\t\t\t\t\t\tsetParams={handleParams}\n\t\t\t\t\t\t\tfixed={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{useCallback(\n\t\t\t\t\t\t\t\t(permission) => (\n\t\t\t\t\t\t\t\t\t<PermissionRow\n\t\t\t\t\t\t\t\t\t\tkey={permission._id}\n\t\t\t\t\t\t\t\t\t\tpermission={permission}\n\t\t\t\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\t\t\t\troleList={roleList}\n\t\t\t\t\t\t\t\t\t\tonGrant={grantRole}\n\t\t\t\t\t\t\t\t\t\tonRemove={removeRole}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t[grantRole, removeRole, roleList, t],\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t<PermissionsContextBar />\n\t\t</Page>\n\t);\n};\n\nexport default PermissionsTable;\n"]},"sourceType":"module","hash":"f1eee4f0e4f3259866907a78e603ae71febf5e7f"}
