{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 1);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar Field, TextInput, ButtonGroup, Button;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field: function (v) {\n    Field = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Button: function (v) {\n    Button = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar React, useState, useMemo;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 2);\nvar useSubscription;\nmodule.link(\"use-subscription\", {\n  useSubscription: function (v) {\n    useSubscription = v;\n  }\n}, 3);\nvar hasAtLeastOnePermission;\nmodule.link(\"../../../../../../app/authorization/client\", {\n  hasAtLeastOnePermission: function (v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 4);\nvar CustomFieldsForm;\nmodule.link(\"../../../../../components/CustomFieldsForm\", {\n  \"default\": function (v) {\n    CustomFieldsForm = v;\n  }\n}, 5);\nvar Tags;\nmodule.link(\"../../../../../components/Omnichannel/Tags\", {\n  \"default\": function (v) {\n    Tags = v;\n  }\n}, 6);\nvar VerticalBar;\nmodule.link(\"../../../../../components/VerticalBar\", {\n  \"default\": function (v) {\n    VerticalBar = v;\n  }\n}, 7);\nvar useMethod;\nmodule.link(\"../../../../../contexts/ServerContext\", {\n  useMethod: function (v) {\n    useMethod = v;\n  }\n}, 8);\nvar useToastMessageDispatch;\nmodule.link(\"../../../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  }\n}, 9);\nvar useTranslation;\nmodule.link(\"../../../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 10);\nvar AsyncStatePhase;\nmodule.link(\"../../../../../hooks/useAsyncState\", {\n  AsyncStatePhase: function (v) {\n    AsyncStatePhase = v;\n  }\n}, 11);\nvar useEndpointData;\nmodule.link(\"../../../../../hooks/useEndpointData\", {\n  useEndpointData: function (v) {\n    useEndpointData = v;\n  }\n}, 12);\nvar useForm;\nmodule.link(\"../../../../../hooks/useForm\", {\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 13);\nvar formsSubscription;\nmodule.link(\"../../../additionalForms\", {\n  formsSubscription: function (v) {\n    formsSubscription = v;\n  }\n}, 14);\nvar FormSkeleton;\nmodule.link(\"../../Skeleton\", {\n  FormSkeleton: function (v) {\n    FormSkeleton = v;\n  }\n}, 15);\nvar initialValuesRoom = {\n  topic: '',\n  tags: [],\n  livechatData: {},\n  priorityId: ''\n};\n\nvar getInitialValuesRoom = function (room) {\n  if (!room) {\n    return initialValuesRoom;\n  }\n\n  var topic = room.topic,\n      tags = room.tags,\n      livechatData = room.livechatData,\n      priorityId = room.priorityId;\n  return {\n    topic: topic !== null && topic !== void 0 ? topic : '',\n    tags: tags !== null && tags !== void 0 ? tags : [],\n    livechatData: livechatData !== null && livechatData !== void 0 ? livechatData : {},\n    priorityId: priorityId !== null && priorityId !== void 0 ? priorityId : ''\n  };\n};\n\nfunction RoomEdit(_ref) {\n  var room = _ref.room,\n      visitor = _ref.visitor,\n      reload = _ref.reload,\n      reloadInfo = _ref.reloadInfo,\n      close = _ref.close;\n  var t = useTranslation();\n\n  var _useForm = useForm(getInitialValuesRoom(room)),\n      valuesRoom = _useForm.values,\n      handlersRoom = _useForm.handlers,\n      hasUnsavedChangesRoom = _useForm.hasUnsavedChanges;\n\n  var canViewCustomFields = function () {\n    return hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n  };\n\n  var handleTopic = handlersRoom.handleTopic,\n      handleTags = handlersRoom.handleTags,\n      handlePriorityId = handlersRoom.handlePriorityId;\n  var topic = valuesRoom.topic,\n      tags = valuesRoom.tags,\n      priorityId = valuesRoom.priorityId;\n  var forms = useSubscription(formsSubscription);\n  var _forms$usePrioritiesS = forms.usePrioritiesSelect,\n      usePrioritiesSelect = _forms$usePrioritiesS === void 0 ? function () {} : _forms$usePrioritiesS;\n  var PrioritiesSelect = usePrioritiesSelect();\n\n  var _useForm2 = useForm({\n    livechatData: valuesRoom.livechatData\n  }),\n      valueCustom = _useForm2.values,\n      handleValueCustom = _useForm2.handlers,\n      hasUnsavedChangesCustomFields = _useForm2.hasUnsavedChanges;\n\n  var handleLivechatData = handleValueCustom.handleLivechatData;\n  var livechatData = valueCustom.livechatData;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      customFieldsError = _useState2[0],\n      setCustomFieldsError = _useState2[1];\n\n  var _useEndpointData = useEndpointData('livechat/custom-fields'),\n      allCustomFields = _useEndpointData.value,\n      stateCustomFields = _useEndpointData.phase;\n\n  var _useEndpointData2 = useEndpointData('livechat/priorities.list'),\n      _useEndpointData2$val = _useEndpointData2.value,\n      prioritiesResult = _useEndpointData2$val === void 0 ? {} : _useEndpointData2$val,\n      statePriorities = _useEndpointData2.phase;\n\n  var jsonConverterToValidFormat = function (customFields) {\n    var jsonObj = {};\n    customFields.forEach(function (_ref2) {\n      var _id = _ref2._id,\n          label = _ref2.label,\n          visibility = _ref2.visibility,\n          options = _ref2.options,\n          scope = _ref2.scope,\n          defaultValue = _ref2.defaultValue,\n          required = _ref2.required;\n      visibility === 'visible' & scope === 'room' && (jsonObj[_id] = {\n        label: label,\n        type: options ? 'select' : 'text',\n        required: required,\n        defaultValue: defaultValue,\n        options: options && options.split(',').map(function (item) {\n          return item.trim();\n        })\n      });\n    });\n    return jsonObj;\n  };\n\n  var jsonCustomField = useMemo(function () {\n    return allCustomFields && allCustomFields.customFields ? jsonConverterToValidFormat(allCustomFields.customFields) : {};\n  }, [allCustomFields]);\n  var dispatchToastMessage = useToastMessageDispatch();\n  var saveRoom = useMethod('livechat:saveInfo');\n  var handleSave = useMutableCallback(function () {\n    function _callee(e) {\n      var userData, roomData;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                userData = {\n                  _id: visitor._id\n                };\n                roomData = _objectSpread({\n                  _id: room._id,\n                  topic: topic,\n                  tags: tags.sort(),\n                  livechatData: livechatData\n                }, priorityId && {\n                  priorityId: priorityId\n                });\n\n                try {\n                  saveRoom(userData, roomData);\n                  dispatchToastMessage({\n                    type: 'success',\n                    message: t('Saved')\n                  });\n                  reload && reload();\n                  reloadInfo && reloadInfo();\n                  close();\n                } catch (error) {\n                  dispatchToastMessage({\n                    type: 'error',\n                    message: error\n                  });\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n\n    return _callee;\n  }());\n  var formIsValid = (hasUnsavedChangesRoom || hasUnsavedChangesCustomFields) && customFieldsError.length === 0;\n\n  if ([stateCustomFields, statePriorities].includes(AsyncStatePhase.LOADING)) {\n    return /*#__PURE__*/React.createElement(FormSkeleton, null);\n  }\n\n  var priorities = prioritiesResult.priorities;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(VerticalBar.ScrollableContent, {\n    is: \"form\"\n  }, canViewCustomFields() && allCustomFields && /*#__PURE__*/React.createElement(CustomFieldsForm, {\n    jsonCustomFields: jsonCustomField,\n    customFieldsData: livechatData,\n    setCustomFieldsData: handleLivechatData,\n    setCustomFieldsError: setCustomFieldsError\n  }), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Topic')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    flexGrow: 1,\n    value: topic,\n    onChange: handleTopic\n  }))), Tags && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Tags, {\n    tags: tags,\n    handler: handleTags\n  })), PrioritiesSelect && priorities && priorities.length > 0 && /*#__PURE__*/React.createElement(PrioritiesSelect, {\n    value: priorityId,\n    label: t('Priority'),\n    options: priorities,\n    handler: handlePriorityId\n  })), /*#__PURE__*/React.createElement(VerticalBar.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    stretch: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    flexGrow: 1,\n    onClick: close\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    mie: \"none\",\n    flexGrow: 1,\n    onClick: handleSave,\n    disabled: !formIsValid,\n    primary: true\n  }, t('Save')))));\n}\n\nmodule.exportDefault(RoomEdit);","map":{"version":3,"sources":["client/views/omnichannel/directory/chats/contextualBar/RoomEdit.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_slicedToArray","Field","TextInput","ButtonGroup","Button","useMutableCallback","React","useState","useMemo","useSubscription","hasAtLeastOnePermission","CustomFieldsForm","Tags","VerticalBar","useMethod","useToastMessageDispatch","useTranslation","AsyncStatePhase","useEndpointData","useForm","formsSubscription","FormSkeleton","initialValuesRoom","topic","tags","livechatData","priorityId","getInitialValuesRoom","room","RoomEdit","visitor","reload","reloadInfo","close","t","valuesRoom","values","handlersRoom","handlers","hasUnsavedChangesRoom","hasUnsavedChanges","canViewCustomFields","handleTopic","handleTags","handlePriorityId","forms","usePrioritiesSelect","PrioritiesSelect","valueCustom","handleValueCustom","hasUnsavedChangesCustomFields","handleLivechatData","customFieldsError","setCustomFieldsError","allCustomFields","value","stateCustomFields","phase","prioritiesResult","statePriorities","jsonConverterToValidFormat","customFields","jsonObj","forEach","_id","label","visibility","options","scope","defaultValue","required","type","split","map","item","trim","jsonCustomField","dispatchToastMessage","saveRoom","handleSave","e","preventDefault","userData","roomData","sort","message","error","formIsValid","length","includes","LOADING","priorities","exportDefault"],"mappings":"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","sourcesContent":["import { Field, TextInput, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useMemo } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { hasAtLeastOnePermission } from '../../../../../../app/authorization/client';\nimport CustomFieldsForm from '../../../../../components/CustomFieldsForm';\nimport Tags from '../../../../../components/Omnichannel/Tags';\nimport VerticalBar from '../../../../../components/VerticalBar';\nimport { useMethod } from '../../../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../../hooks/useEndpointData';\nimport { useForm } from '../../../../../hooks/useForm';\nimport { formsSubscription } from '../../../additionalForms';\nimport { FormSkeleton } from '../../Skeleton';\n\nconst initialValuesRoom = {\n\ttopic: '',\n\ttags: [],\n\tlivechatData: {},\n\tpriorityId: '',\n};\n\nconst getInitialValuesRoom = (room) => {\n\tif (!room) {\n\t\treturn initialValuesRoom;\n\t}\n\n\tconst { topic, tags, livechatData, priorityId } = room;\n\n\treturn {\n\t\ttopic: topic ?? '',\n\t\ttags: tags ?? [],\n\t\tlivechatData: livechatData ?? {},\n\t\tpriorityId: priorityId ?? '',\n\t};\n};\n\nfunction RoomEdit({ room, visitor, reload, reloadInfo, close }) {\n\tconst t = useTranslation();\n\n\tconst { values: valuesRoom, handlers: handlersRoom, hasUnsavedChanges: hasUnsavedChangesRoom } = useForm(getInitialValuesRoom(room));\n\tconst canViewCustomFields = () => hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst { handleTopic, handleTags, handlePriorityId } = handlersRoom;\n\tconst { topic, tags, priorityId } = valuesRoom;\n\n\tconst forms = useSubscription(formsSubscription);\n\n\tconst { usePrioritiesSelect = () => {} } = forms;\n\n\tconst PrioritiesSelect = usePrioritiesSelect();\n\n\tconst {\n\t\tvalues: valueCustom,\n\t\thandlers: handleValueCustom,\n\t\thasUnsavedChanges: hasUnsavedChangesCustomFields,\n\t} = useForm({\n\t\tlivechatData: valuesRoom.livechatData,\n\t});\n\n\tconst { handleLivechatData } = handleValueCustom;\n\tconst { livechatData } = valueCustom;\n\n\tconst [customFieldsError, setCustomFieldsError] = useState([]);\n\n\tconst { value: allCustomFields, phase: stateCustomFields } = useEndpointData('livechat/custom-fields');\n\tconst { value: prioritiesResult = {}, phase: statePriorities } = useEndpointData('livechat/priorities.list');\n\n\tconst jsonConverterToValidFormat = (customFields) => {\n\t\tconst jsonObj = {};\n\t\tcustomFields.forEach(({ _id, label, visibility, options, scope, defaultValue, required }) => {\n\t\t\t(visibility === 'visible') & (scope === 'room') &&\n\t\t\t\t(jsonObj[_id] = {\n\t\t\t\t\tlabel,\n\t\t\t\t\ttype: options ? 'select' : 'text',\n\t\t\t\t\trequired,\n\t\t\t\t\tdefaultValue,\n\t\t\t\t\toptions: options && options.split(',').map((item) => item.trim()),\n\t\t\t\t});\n\t\t});\n\t\treturn jsonObj;\n\t};\n\n\tconst jsonCustomField = useMemo(\n\t\t() => (allCustomFields && allCustomFields.customFields ? jsonConverterToValidFormat(allCustomFields.customFields) : {}),\n\t\t[allCustomFields],\n\t);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst saveRoom = useMethod('livechat:saveInfo');\n\n\tconst handleSave = useMutableCallback(async (e) => {\n\t\te.preventDefault();\n\t\tconst userData = {\n\t\t\t_id: visitor._id,\n\t\t};\n\n\t\tconst roomData = {\n\t\t\t_id: room._id,\n\t\t\ttopic,\n\t\t\ttags: tags.sort(),\n\t\t\tlivechatData,\n\t\t\t...(priorityId && { priorityId }),\n\t\t};\n\n\t\ttry {\n\t\t\tsaveRoom(userData, roomData);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload && reload();\n\t\t\treloadInfo && reloadInfo();\n\t\t\tclose();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst formIsValid = (hasUnsavedChangesRoom || hasUnsavedChangesCustomFields) && customFieldsError.length === 0;\n\n\tif ([stateCustomFields, statePriorities].includes(AsyncStatePhase.LOADING)) {\n\t\treturn <FormSkeleton />;\n\t}\n\n\tconst { priorities } = prioritiesResult;\n\n\treturn (\n\t\t<>\n\t\t\t<VerticalBar.ScrollableContent is='form'>\n\t\t\t\t{canViewCustomFields() && allCustomFields && (\n\t\t\t\t\t<CustomFieldsForm\n\t\t\t\t\t\tjsonCustomFields={jsonCustomField}\n\t\t\t\t\t\tcustomFieldsData={livechatData}\n\t\t\t\t\t\tsetCustomFieldsData={handleLivechatData}\n\t\t\t\t\t\tsetCustomFieldsError={setCustomFieldsError}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<Field>\n\t\t\t\t\t<Field.Label>{t('Topic')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput flexGrow={1} value={topic} onChange={handleTopic} />\n\t\t\t\t\t</Field.Row>\n\t\t\t\t</Field>\n\t\t\t\t{Tags && (\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Tags tags={tags} handler={handleTags} />\n\t\t\t\t\t</Field>\n\t\t\t\t)}\n\t\t\t\t{PrioritiesSelect && priorities && priorities.length > 0 && (\n\t\t\t\t\t<PrioritiesSelect value={priorityId} label={t('Priority')} options={priorities} handler={handlePriorityId} />\n\t\t\t\t)}\n\t\t\t</VerticalBar.ScrollableContent>\n\t\t\t<VerticalBar.Footer>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={close}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button mie='none' flexGrow={1} onClick={handleSave} disabled={!formIsValid} primary>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</VerticalBar.Footer>\n\t\t</>\n\t);\n}\n\nexport default RoomEdit;\n"]},"sourceType":"module","hash":"d8372b1b14dadca0f4ad8b77407a3571ced1c853"}
