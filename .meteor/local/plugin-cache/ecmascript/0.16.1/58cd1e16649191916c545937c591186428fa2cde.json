{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-utils/client/lib/modal.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/ui-utils/client/lib/modal.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-utils/client/lib/modal.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-utils/client/lib/modal.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-utils/client/lib/modal.js"}},"code":"var _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 0);\nmodule.export({\n  modal: function () {\n    return modal;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Blaze;\nmodule.link(\"meteor/blaze\", {\n  Blaze: function (v) {\n    Blaze = v;\n  }\n}, 1);\nvar Template;\nmodule.link(\"meteor/templating\", {\n  Template: function (v) {\n    Template = v;\n  }\n}, 2);\nvar t, getUserPreference;\nmodule.link(\"../../../utils\", {\n  t: function (v) {\n    t = v;\n  },\n  getUserPreference: function (v) {\n    getUserPreference = v;\n  }\n}, 3);\nmodule.link(\"./modal.html\");\nvar handleError;\nmodule.link(\"../../../../client/lib/utils/handleError\", {\n  handleError: function (v) {\n    handleError = v;\n  }\n}, 4);\nvar modalStack = [];\n\nvar createModal = function () {\n  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var fn = arguments.length > 1 ? arguments[1] : undefined;\n  var onCancel = arguments.length > 2 ? arguments[2] : undefined;\n  config.confirmButtonText = config.confirmButtonText || (config.type === 'error' ? t('Ok') : t('Send'));\n  config.cancelButtonText = config.cancelButtonText || t('Cancel');\n  config.closeOnConfirm = config.closeOnConfirm == null ? true : config.closeOnConfirm;\n  config.showConfirmButton = config.showConfirmButton == null ? true : config.showConfirmButton;\n  config.showFooter = config.showConfirmButton === true || config.showCancelButton === true;\n  config.confirmOnEnter = config.confirmOnEnter == null ? true : config.confirmOnEnter;\n  config.closeOnEscape = config.closeOnEscape == null ? true : config.closeOnEscape;\n\n  if (config.type === 'input') {\n    config.input = true;\n    config.type = false;\n\n    if (!config.inputType) {\n      config.inputType = 'text';\n    }\n  }\n\n  var renderedModal;\n  var timer;\n\n  var instance = _objectSpread(_objectSpread({}, config), {}, {\n    render: function () {\n      if (renderedModal) {\n        renderedModal.firstNode().style.display = '';\n        return;\n      }\n\n      renderedModal = Blaze.renderWithData(Template.rc_modal, instance, document.body);\n\n      if (config.timer) {\n        timer = setTimeout(function () {\n          instance.close();\n        }, config.timer);\n      }\n    },\n    hide: function () {\n      if (renderedModal) {\n        renderedModal.firstNode().style.display = 'none';\n      }\n\n      if (timer) {\n        clearTimeout(timer);\n        timer = undefined;\n      }\n    },\n    destroy: function () {\n      if (renderedModal) {\n        Blaze.remove(renderedModal);\n        renderedModal = undefined;\n      }\n\n      if (timer) {\n        clearTimeout(timer);\n        timer = undefined;\n      }\n    },\n    close: function () {\n      if (onCancel) {\n        onCancel.call(instance);\n      }\n\n      instance.destroy();\n      modalStack = modalStack.filter(function (modal) {\n        return modal !== instance;\n      });\n\n      if (modalStack.length) {\n        modalStack[modalStack.length - 1].render();\n      }\n    },\n    confirm: function (value) {\n      config.closeOnConfirm && instance.close();\n\n      if (fn) {\n        fn.call(instance, value);\n        return;\n      }\n\n      instance.close();\n    },\n    cancel: function () {\n      instance.close();\n    },\n    showInputError: function (text) {\n      var errorEl = document.querySelector('.rc-modal__content-error');\n      errorEl.innerHTML = text;\n      errorEl.style.display = 'block';\n    }\n  });\n\n  return instance;\n};\n\nvar modal = {\n  open: function () {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var fn = arguments.length > 1 ? arguments[1] : undefined;\n    var onCancel = arguments.length > 2 ? arguments[2] : undefined;\n    modalStack.forEach(function (instance) {\n      instance.destroy();\n    });\n    modalStack = [];\n    var instance = createModal(config, fn, onCancel);\n\n    if (config.dontAskAgain) {\n      var dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');\n\n      if (dontAskAgainList && dontAskAgainList.some(function (dontAsk) {\n        return dontAsk.action === config.dontAskAgain.action;\n      })) {\n        instance.confirm(true);\n        return;\n      }\n    }\n\n    instance.render();\n    modalStack.push(instance);\n  },\n  push: function () {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var fn = arguments.length > 1 ? arguments[1] : undefined;\n    var onCancel = arguments.length > 2 ? arguments[2] : undefined;\n    var instance = createModal(config, fn, onCancel);\n    modalStack.forEach(function (instance) {\n      instance.hide();\n    });\n    instance.render();\n    modalStack.push(instance);\n    return instance;\n  },\n  cancel: function () {\n    if (modalStack.length) {\n      modalStack[modalStack.length - 1].cancel();\n    }\n  },\n  close: function () {\n    if (modalStack.length) {\n      modalStack[modalStack.length - 1].close();\n    }\n  },\n  confirm: function (value) {\n    if (modalStack.length) {\n      modalStack[modalStack.length - 1].confirm(value);\n    }\n  },\n  showInputError: function (text) {\n    if (modalStack.length) {\n      modalStack[modalStack.length - 1].showInputError(text);\n    }\n  },\n  onKeyDown: function (event) {\n    if (!modalStack.length) {\n      return;\n    }\n\n    var instance = modalStack[modalStack.length - 1];\n\n    if (event.key === 'Escape') {\n      event.preventDefault();\n      event.stopPropagation();\n      instance.close();\n    }\n\n    if (instance && instance.confirmOnEnter && event.key === 'Enter') {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (instance.input) {\n        return instance.confirm($('.js-modal-input').val());\n      }\n\n      instance.confirm(true);\n    }\n  }\n};\nTemplate.rc_modal.helpers({\n  showFooter: function () {\n    var showCancelButton = this.showCancelButton,\n        showConfirmButton = this.showConfirmButton;\n    return showCancelButton || showConfirmButton;\n  },\n  hasAction: function () {\n    return !!this.action;\n  },\n  type: function () {\n    return this.type && \"rc-modal__content-icon rc-modal__content-icon--modal-\" + this.type;\n  },\n  modalIcon: function () {\n    switch (this.type) {\n      case 'success':\n        return 'checkmark-circled';\n\n      case 'error':\n        return 'circle-cross';\n\n      case 'info':\n        return 'info-circled';\n\n      default:\n        return \"modal-\" + this.type;\n    }\n  }\n});\nTemplate.rc_modal.onRendered(function () {\n  this.oldFocus = document.activeElement;\n\n  if (this.data.input) {\n    $('.js-modal-input', this.firstNode).focus();\n  } else if (this.data.showConfirmButton && this.data.confirmOnEnter) {\n    $('.js-confirm', this.firstNode).focus();\n  }\n\n  if (this.data.onRendered) {\n    this.data.onRendered();\n  }\n\n  this.data.closeOnEscape && document.addEventListener('keydown', modal.onKeyDown);\n});\nTemplate.rc_modal.onDestroyed(function () {\n  this.oldFocus && this.oldFocus.focus();\n  document.removeEventListener('keydown', modal.onKeyDown);\n});\nTemplate.rc_modal.events({\n  'click .js-action': function (event, instance) {\n    !this.action || this.action.call(instance.data.data, event, instance);\n    event.stopPropagation();\n    this.close();\n  },\n  'click .js-input-action': function (e, instance) {\n    !this.inputAction || this.inputAction.call(instance.data.data, e, instance);\n    e.stopPropagation();\n  },\n  'click .js-close': function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.cancel();\n  },\n  'click .js-confirm': function (event, instance) {\n    event.stopPropagation();\n    var dontAskAgain = instance.data.dontAskAgain;\n\n    if (dontAskAgain && document.getElementById('dont-ask-me-again').checked) {\n      var dontAskAgainObject = {\n        action: dontAskAgain.action,\n        label: dontAskAgain.label\n      };\n      var dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');\n\n      if (dontAskAgainList) {\n        dontAskAgainList.push(dontAskAgainObject);\n      } else {\n        dontAskAgainList = [dontAskAgainObject];\n      }\n\n      Meteor.call('saveUserPreferences', {\n        dontAskAgainList: dontAskAgainList\n      }, function (error) {\n        if (error) {\n          return handleError(error);\n        }\n      });\n    }\n\n    if (instance.data.input) {\n      this.confirm(document.getElementsByClassName('js-modal-input')[0].value);\n      return;\n    }\n\n    this.confirm(true);\n  },\n  'click .rc-modal-wrapper': function (event, instance) {\n    if (instance.data.allowOutsideClick === false) {\n      return false;\n    }\n\n    if (event.currentTarget === event.target) {\n      event.stopPropagation();\n      this.close();\n    }\n  }\n});","map":{"version":3,"sources":["app/ui-utils/client/lib/modal.js"],"names":["_objectSpread","module","link","default","v","export","modal","Meteor","Blaze","Template","t","getUserPreference","handleError","modalStack","createModal","config","fn","onCancel","confirmButtonText","type","cancelButtonText","closeOnConfirm","showConfirmButton","showFooter","showCancelButton","confirmOnEnter","closeOnEscape","input","inputType","renderedModal","timer","instance","render","firstNode","style","display","renderWithData","rc_modal","document","body","setTimeout","close","hide","clearTimeout","undefined","destroy","remove","call","filter","length","confirm","value","cancel","showInputError","text","errorEl","querySelector","innerHTML","open","forEach","dontAskAgain","dontAskAgainList","userId","some","dontAsk","action","push","onKeyDown","event","key","preventDefault","stopPropagation","$","val","helpers","hasAction","modalIcon","onRendered","oldFocus","activeElement","data","focus","addEventListener","onDestroyed","removeEventListener","events","e","inputAction","getElementById","checked","dontAskAgainObject","label","error","getElementsByClassName","allowOutsideClick","currentTarget","target"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Blaze } from 'meteor/blaze';\nimport { Template } from 'meteor/templating';\n\nimport { t, getUserPreference } from '../../../utils';\nimport './modal.html';\nimport { handleError } from '../../../../client/lib/utils/handleError';\n\nlet modalStack = [];\n\nconst createModal = (config = {}, fn, onCancel) => {\n\tconfig.confirmButtonText = config.confirmButtonText || (config.type === 'error' ? t('Ok') : t('Send'));\n\tconfig.cancelButtonText = config.cancelButtonText || t('Cancel');\n\tconfig.closeOnConfirm = config.closeOnConfirm == null ? true : config.closeOnConfirm;\n\tconfig.showConfirmButton = config.showConfirmButton == null ? true : config.showConfirmButton;\n\tconfig.showFooter = config.showConfirmButton === true || config.showCancelButton === true;\n\tconfig.confirmOnEnter = config.confirmOnEnter == null ? true : config.confirmOnEnter;\n\tconfig.closeOnEscape = config.closeOnEscape == null ? true : config.closeOnEscape;\n\n\tif (config.type === 'input') {\n\t\tconfig.input = true;\n\t\tconfig.type = false;\n\n\t\tif (!config.inputType) {\n\t\t\tconfig.inputType = 'text';\n\t\t}\n\t}\n\n\tlet renderedModal;\n\tlet timer;\n\n\tconst instance = {\n\t\t...config,\n\n\t\trender: () => {\n\t\t\tif (renderedModal) {\n\t\t\t\trenderedModal.firstNode().style.display = '';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\trenderedModal = Blaze.renderWithData(Template.rc_modal, instance, document.body);\n\n\t\t\tif (config.timer) {\n\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\tinstance.close();\n\t\t\t\t}, config.timer);\n\t\t\t}\n\t\t},\n\n\t\thide: () => {\n\t\t\tif (renderedModal) {\n\t\t\t\trenderedModal.firstNode().style.display = 'none';\n\t\t\t}\n\n\t\t\tif (timer) {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = undefined;\n\t\t\t}\n\t\t},\n\n\t\tdestroy: () => {\n\t\t\tif (renderedModal) {\n\t\t\t\tBlaze.remove(renderedModal);\n\t\t\t\trenderedModal = undefined;\n\t\t\t}\n\n\t\t\tif (timer) {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = undefined;\n\t\t\t}\n\t\t},\n\n\t\tclose: () => {\n\t\t\tif (onCancel) {\n\t\t\t\tonCancel.call(instance);\n\t\t\t}\n\t\t\tinstance.destroy();\n\t\t\tmodalStack = modalStack.filter((modal) => modal !== instance);\n\t\t\tif (modalStack.length) {\n\t\t\t\tmodalStack[modalStack.length - 1].render();\n\t\t\t}\n\t\t},\n\n\t\tconfirm: (value) => {\n\t\t\tconfig.closeOnConfirm && instance.close();\n\n\t\t\tif (fn) {\n\t\t\t\tfn.call(instance, value);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tinstance.close();\n\t\t},\n\n\t\tcancel: () => {\n\t\t\tinstance.close();\n\t\t},\n\n\t\tshowInputError: (text) => {\n\t\t\tconst errorEl = document.querySelector('.rc-modal__content-error');\n\t\t\terrorEl.innerHTML = text;\n\t\t\terrorEl.style.display = 'block';\n\t\t},\n\t};\n\n\treturn instance;\n};\n\nexport const modal = {\n\topen: (config = {}, fn, onCancel) => {\n\t\tmodalStack.forEach((instance) => {\n\t\t\tinstance.destroy();\n\t\t});\n\t\tmodalStack = [];\n\n\t\tconst instance = createModal(config, fn, onCancel);\n\n\t\tif (config.dontAskAgain) {\n\t\t\tconst dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');\n\n\t\t\tif (dontAskAgainList && dontAskAgainList.some((dontAsk) => dontAsk.action === config.dontAskAgain.action)) {\n\t\t\t\tinstance.confirm(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tinstance.render();\n\t\tmodalStack.push(instance);\n\t},\n\tpush: (config = {}, fn, onCancel) => {\n\t\tconst instance = createModal(config, fn, onCancel);\n\n\t\tmodalStack.forEach((instance) => {\n\t\t\tinstance.hide();\n\t\t});\n\t\tinstance.render();\n\t\tmodalStack.push(instance);\n\t\treturn instance;\n\t},\n\tcancel: () => {\n\t\tif (modalStack.length) {\n\t\t\tmodalStack[modalStack.length - 1].cancel();\n\t\t}\n\t},\n\tclose: () => {\n\t\tif (modalStack.length) {\n\t\t\tmodalStack[modalStack.length - 1].close();\n\t\t}\n\t},\n\tconfirm: (value) => {\n\t\tif (modalStack.length) {\n\t\t\tmodalStack[modalStack.length - 1].confirm(value);\n\t\t}\n\t},\n\tshowInputError: (text) => {\n\t\tif (modalStack.length) {\n\t\t\tmodalStack[modalStack.length - 1].showInputError(text);\n\t\t}\n\t},\n\tonKeyDown: (event) => {\n\t\tif (!modalStack.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst instance = modalStack[modalStack.length - 1];\n\t\tif (event.key === 'Escape') {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tinstance.close();\n\t\t}\n\n\t\tif (instance && instance.confirmOnEnter && event.key === 'Enter') {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tif (instance.input) {\n\t\t\t\treturn instance.confirm($('.js-modal-input').val());\n\t\t\t}\n\n\t\t\tinstance.confirm(true);\n\t\t}\n\t},\n};\n\nTemplate.rc_modal.helpers({\n\tshowFooter() {\n\t\tconst { showCancelButton, showConfirmButton } = this;\n\t\treturn showCancelButton || showConfirmButton;\n\t},\n\thasAction() {\n\t\treturn !!this.action;\n\t},\n\ttype() {\n\t\treturn this.type && `rc-modal__content-icon rc-modal__content-icon--modal-${this.type}`;\n\t},\n\tmodalIcon() {\n\t\tswitch (this.type) {\n\t\t\tcase 'success':\n\t\t\t\treturn 'checkmark-circled';\n\t\t\tcase 'error':\n\t\t\t\treturn 'circle-cross';\n\t\t\tcase 'info':\n\t\t\t\treturn 'info-circled';\n\t\t\tdefault:\n\t\t\t\treturn `modal-${this.type}`;\n\t\t}\n\t},\n});\n\nTemplate.rc_modal.onRendered(function () {\n\tthis.oldFocus = document.activeElement;\n\tif (this.data.input) {\n\t\t$('.js-modal-input', this.firstNode).focus();\n\t} else if (this.data.showConfirmButton && this.data.confirmOnEnter) {\n\t\t$('.js-confirm', this.firstNode).focus();\n\t}\n\tif (this.data.onRendered) {\n\t\tthis.data.onRendered();\n\t}\n\tthis.data.closeOnEscape && document.addEventListener('keydown', modal.onKeyDown);\n});\n\nTemplate.rc_modal.onDestroyed(function () {\n\tthis.oldFocus && this.oldFocus.focus();\n\tdocument.removeEventListener('keydown', modal.onKeyDown);\n});\n\nTemplate.rc_modal.events({\n\t'click .js-action'(event, instance) {\n\t\t!this.action || this.action.call(instance.data.data, event, instance);\n\t\tevent.stopPropagation();\n\t\tthis.close();\n\t},\n\t'click .js-input-action'(e, instance) {\n\t\t!this.inputAction || this.inputAction.call(instance.data.data, e, instance);\n\t\te.stopPropagation();\n\t},\n\t'click .js-close'(e) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.cancel();\n\t},\n\t'click .js-confirm'(event, instance) {\n\t\tevent.stopPropagation();\n\t\tconst { dontAskAgain } = instance.data;\n\t\tif (dontAskAgain && document.getElementById('dont-ask-me-again').checked) {\n\t\t\tconst dontAskAgainObject = {\n\t\t\t\taction: dontAskAgain.action,\n\t\t\t\tlabel: dontAskAgain.label,\n\t\t\t};\n\n\t\t\tlet dontAskAgainList = getUserPreference(Meteor.userId(), 'dontAskAgainList');\n\t\t\tif (dontAskAgainList) {\n\t\t\t\tdontAskAgainList.push(dontAskAgainObject);\n\t\t\t} else {\n\t\t\t\tdontAskAgainList = [dontAskAgainObject];\n\t\t\t}\n\n\t\t\tMeteor.call('saveUserPreferences', { dontAskAgainList }, function (error) {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (instance.data.input) {\n\t\t\tthis.confirm(document.getElementsByClassName('js-modal-input')[0].value);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.confirm(true);\n\t},\n\t'click .rc-modal-wrapper'(event, instance) {\n\t\tif (instance.data.allowOutsideClick === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (event.currentTarget === event.target) {\n\t\t\tevent.stopPropagation();\n\t\t\tthis.close();\n\t\t}\n\t},\n});\n"]},"sourceType":"module","hash":"58cd1e16649191916c545937c591186428fa2cde"}
