{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/sidebar/search/SearchList.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/sidebar/search/SearchList.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/sidebar/search/SearchList.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/sidebar/search/SearchList.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/sidebar/search/SearchList.js"}},"code":"var _templateObject;\n\nconst _excluded = [\"setValue\"];\n\nlet _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _taggedTemplateLiteral;\n\nmodule.link(\"@babel/runtime/helpers/taggedTemplateLiteral\", {\n  default(v) {\n    _taggedTemplateLiteral = v;\n  }\n\n}, 1);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 2);\n\nlet _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 3);\nlet css;\nmodule.link(\"@rocket.chat/css-in-js\", {\n  css(v) {\n    css = v;\n  }\n\n}, 0);\nlet Sidebar, TextInput, Box, Icon;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Sidebar(v) {\n    Sidebar = v;\n  },\n\n  TextInput(v) {\n    TextInput = v;\n  },\n\n  Box(v) {\n    Box = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  }\n\n}, 1);\nlet useMutableCallback, useDebouncedValue, useStableArray, useAutoFocus, useUniqueId;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  },\n\n  useDebouncedValue(v) {\n    useDebouncedValue = v;\n  },\n\n  useStableArray(v) {\n    useStableArray = v;\n  },\n\n  useAutoFocus(v) {\n    useAutoFocus = v;\n  },\n\n  useUniqueId(v) {\n    useUniqueId = v;\n  }\n\n}, 2);\nlet escapeRegExp;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeRegExp(v) {\n    escapeRegExp = v;\n  }\n\n}, 3);\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 4);\nlet React, forwardRef, useState, useMemo, useEffect, useRef;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  forwardRef(v) {\n    forwardRef = v;\n  },\n\n  useState(v) {\n    useState = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  },\n\n  useEffect(v) {\n    useEffect = v;\n  },\n\n  useRef(v) {\n    useRef = v;\n  }\n\n}, 5);\nlet Virtuoso;\nmodule.link(\"react-virtuoso\", {\n  Virtuoso(v) {\n    Virtuoso = v;\n  }\n\n}, 6);\nlet tinykeys;\nmodule.link(\"tinykeys\", {\n  default(v) {\n    tinykeys = v;\n  }\n\n}, 7);\nlet useSetting;\nmodule.link(\"../../contexts/SettingsContext\", {\n  useSetting(v) {\n    useSetting = v;\n  }\n\n}, 8);\nlet useTranslation;\nmodule.link(\"../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 9);\nlet useUserPreference, useUserSubscriptions;\nmodule.link(\"../../contexts/UserContext\", {\n  useUserPreference(v) {\n    useUserPreference = v;\n  },\n\n  useUserSubscriptions(v) {\n    useUserSubscriptions = v;\n  }\n\n}, 10);\nlet AsyncStatePhase;\nmodule.link(\"../../hooks/useAsyncState\", {\n  AsyncStatePhase(v) {\n    AsyncStatePhase = v;\n  }\n\n}, 11);\nlet useMethodData;\nmodule.link(\"../../hooks/useMethodData\", {\n  useMethodData(v) {\n    useMethodData = v;\n  }\n\n}, 12);\nlet useAvatarTemplate;\nmodule.link(\"../hooks/useAvatarTemplate\", {\n  useAvatarTemplate(v) {\n    useAvatarTemplate = v;\n  }\n\n}, 13);\nlet useTemplateByViewMode;\nmodule.link(\"../hooks/useTemplateByViewMode\", {\n  useTemplateByViewMode(v) {\n    useTemplateByViewMode = v;\n  }\n\n}, 14);\nlet Row;\nmodule.link(\"./Row\", {\n  default(v) {\n    Row = v;\n  }\n\n}, 15);\nlet ScrollerWithCustomProps;\nmodule.link(\"./ScrollerWithCustomProps\", {\n  default(v) {\n    ScrollerWithCustomProps = v;\n  }\n\n}, 16);\n\nconst shortcut = (() => {\n  if (!Meteor.Device.isDesktop()) {\n    return '';\n  }\n\n  if (window.navigator.platform.toLowerCase().includes('mac')) {\n    return \"(\\u2318+K)\";\n  }\n\n  return \"(\\u2303+K)\";\n})();\n\nconst useSpotlight = function () {\n  let filterText = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  let usernames = arguments.length > 1 ? arguments[1] : undefined;\n  const expression = /(@|#)?(.*)/i;\n  const [, mention, name] = filterText.match(expression);\n  const searchForChannels = mention === '#';\n  const searchForDMs = mention === '@';\n  const type = useMemo(() => {\n    if (searchForChannels) {\n      return {\n        users: false,\n        rooms: true\n      };\n    }\n\n    if (searchForDMs) {\n      return {\n        users: true,\n        rooms: false\n      };\n    }\n\n    return {\n      users: true,\n      rooms: true\n    };\n  }, [searchForChannels, searchForDMs]);\n  const args = useMemo(() => [name, usernames, type], [type, name, usernames]);\n  const {\n    value: data = {\n      users: [],\n      rooms: []\n    },\n    phase: status\n  } = useMethodData('spotlight', args);\n  return useMemo(() => {\n    if (!data) {\n      return {\n        data: {\n          users: [],\n          rooms: []\n        },\n        status: 'loading'\n      };\n    }\n\n    return {\n      data,\n      status\n    };\n  }, [data, status]);\n};\n\nconst options = {\n  sort: {\n    lm: -1,\n    name: 1\n  }\n};\n\nconst useSearchItems = filterText => {\n  const expression = /(@|#)?(.*)/i;\n  const teste = filterText.match(expression);\n  const [, type, name] = teste;\n  const query = useMemo(() => {\n    const filterRegex = new RegExp(escapeRegExp(name), 'i');\n    return _objectSpread({\n      $or: [{\n        name: filterRegex\n      }, {\n        fname: filterRegex\n      }]\n    }, type && {\n      t: type === '@' ? 'd' : {\n        $ne: 'd'\n      }\n    });\n  }, [name, type]);\n  const localRooms = useUserSubscriptions(query, options);\n  const usernamesFromClient = useStableArray([...(localRooms === null || localRooms === void 0 ? void 0 : localRooms.map(_ref => {\n    let {\n      t,\n      name\n    } = _ref;\n    return t === 'd' ? name : null;\n  }))].filter(Boolean));\n  const {\n    data: spotlight,\n    status\n  } = useSpotlight(filterText, usernamesFromClient);\n  return useMemo(() => {\n    const resultsFromServer = [];\n\n    const filterUsersUnique = (_ref2, index, arr) => {\n      let {\n        _id\n      } = _ref2;\n      return index === arr.findIndex(user => _id === user._id);\n    };\n\n    const roomFilter = room => !localRooms.find(item => {\n      var _room$uids;\n\n      return room.t === 'd' && ((_room$uids = room.uids) === null || _room$uids === void 0 ? void 0 : _room$uids.length) > 1 && room.uids.includes(item._id) || [item.rid, item._id].includes(room._id);\n    });\n\n    const usersfilter = user => !localRooms.find(room => {\n      var _room$uids2;\n\n      return room.t === 'd' && ((_room$uids2 = room.uids) === null || _room$uids2 === void 0 ? void 0 : _room$uids2.length) === 2 && room.uids.includes(user._id);\n    });\n\n    const userMap = user => ({\n      _id: user._id,\n      t: 'd',\n      name: user.username,\n      fname: user.name,\n      avatarETag: user.avatarETag\n    });\n\n    const exact = resultsFromServer.filter(item => [item.usernamame, item.name, item.fname].includes(name));\n    resultsFromServer.push(...spotlight.users.filter(filterUsersUnique).filter(usersfilter).map(userMap));\n    resultsFromServer.push(...spotlight.rooms.filter(roomFilter));\n    return {\n      data: Array.from(new Set([...exact, ...localRooms, ...resultsFromServer])),\n      status\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [localRooms, name, spotlight]);\n};\n\nconst useInput = initial => {\n  const [value, setValue] = useState(initial);\n  const onChange = useMutableCallback(e => {\n    setValue(e.currentTarget.value);\n  });\n  return {\n    value,\n    onChange,\n    setValue\n  };\n};\n\nconst toggleSelectionState = (next, current, input) => {\n  input.setAttribute('aria-activedescendant', next.id);\n  next.setAttribute('aria-selected', true);\n  next.classList.add('rcx-sidebar-item--selected');\n\n  if (current) {\n    current.setAttribute('aria-selected', false);\n    current.classList.remove('rcx-sidebar-item--selected');\n  }\n};\n/**\n * @type import('react').ForwardRefExoticComponent<{ onClose: unknown } & import('react').RefAttributes<HTMLElement>>\n */\n\n\nconst SearchList = /*#__PURE__*/forwardRef(function SearchList(_ref3, ref) {\n  let {\n    onClose\n  } = _ref3;\n  const listId = useUniqueId();\n  const t = useTranslation();\n\n  const _useInput = useInput(''),\n        {\n    setValue: setFilterValue\n  } = _useInput,\n        filter = _objectWithoutProperties(_useInput, _excluded);\n\n  const autofocus = useAutoFocus();\n  const listRef = useRef();\n  const boxRef = useRef();\n  const selectedElement = useRef();\n  const itemIndexRef = useRef(0);\n  const sidebarViewMode = useUserPreference('sidebarViewMode');\n  const showRealName = useSetting('UI_Use_Real_Name');\n  const sideBarItemTemplate = useTemplateByViewMode();\n  const avatarTemplate = useAvatarTemplate();\n  const extended = sidebarViewMode === 'extended';\n  const filterText = useDebouncedValue(filter.value, 100);\n  const placeholder = [t('Search'), shortcut].filter(Boolean).join(' ');\n  const {\n    data: items,\n    status\n  } = useSearchItems(filterText);\n  const itemData = useMemo(() => ({\n    items,\n    t,\n    SideBarItemTemplate: sideBarItemTemplate,\n    avatarTemplate,\n    showRealName,\n    extended,\n    sidebarViewMode\n  }), [avatarTemplate, extended, items, showRealName, sideBarItemTemplate, sidebarViewMode, t]);\n  const changeSelection = useMutableCallback(dir => {\n    let nextSelectedElement = null;\n\n    if (dir === 'up') {\n      nextSelectedElement = selectedElement.current.parentElement.previousSibling.querySelector('a');\n    } else {\n      nextSelectedElement = selectedElement.current.parentElement.nextSibling.querySelector('a');\n    }\n\n    if (nextSelectedElement) {\n      toggleSelectionState(nextSelectedElement, selectedElement.current, autofocus.current);\n      return nextSelectedElement;\n    }\n\n    return selectedElement.current;\n  });\n  const resetCursor = useMutableCallback(() => {\n    var _boxRef$current;\n\n    itemIndexRef.current = 0;\n    listRef.current.scrollToIndex({\n      index: itemIndexRef.current\n    });\n    selectedElement.current = (_boxRef$current = boxRef.current) === null || _boxRef$current === void 0 ? void 0 : _boxRef$current.querySelector('a.rcx-sidebar-item');\n\n    if (selectedElement.current) {\n      toggleSelectionState(selectedElement.current, undefined, autofocus.current);\n    }\n  });\n  useEffect(() => {\n    resetCursor();\n  });\n  useEffect(() => {\n    resetCursor();\n  }, [filterText, resetCursor]);\n  useEffect(() => {\n    if (!autofocus.current) {\n      return;\n    }\n\n    const unsubscribe = tinykeys(autofocus.current, {\n      Escape: event => {\n        event.preventDefault();\n        setFilterValue(value => {\n          if (!value) {\n            onClose();\n          }\n\n          resetCursor();\n          return '';\n        });\n      },\n      Tab: onClose,\n      ArrowUp: () => {\n        const currentElement = changeSelection('up');\n        itemIndexRef.current = Math.max(itemIndexRef.current - 1, 0);\n        listRef.current.scrollToIndex({\n          index: itemIndexRef.current\n        });\n        selectedElement.current = currentElement;\n      },\n      ArrowDown: () => {\n        const currentElement = changeSelection('down');\n        itemIndexRef.current = Math.min(itemIndexRef.current + 1, (items === null || items === void 0 ? void 0 : items.length) + 1);\n        listRef.current.scrollToIndex({\n          index: itemIndexRef.current\n        });\n        selectedElement.current = currentElement;\n      },\n      Enter: () => {\n        if (selectedElement.current) {\n          selectedElement.current.click();\n        }\n      }\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, [autofocus, changeSelection, items.length, onClose, resetCursor, setFilterValue]);\n  return /*#__PURE__*/React.createElement(Box, {\n    position: \"absolute\",\n    \"rcx-sidebar\": true,\n    h: \"full\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    zIndex: 99,\n    w: \"full\",\n    className: css(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n\\t\\t\\t\\tleft: 0;\\n\\t\\t\\t\\ttop: 0;\\n\\t\\t\\t\"]))),\n    ref: ref\n  }, /*#__PURE__*/React.createElement(Sidebar.TopBar.Section, {\n    role: \"search\",\n    is: \"form\"\n  }, /*#__PURE__*/React.createElement(TextInput, _extends({\n    \"aria-owns\": listId,\n    \"data-qa\": \"sidebar-search-input\",\n    ref: autofocus\n  }, filter, {\n    placeholder: placeholder,\n    addon: /*#__PURE__*/React.createElement(Icon, {\n      name: \"cross\",\n      size: \"x20\",\n      onClick: onClose\n    })\n  }))), /*#__PURE__*/React.createElement(Box, {\n    ref: boxRef,\n    \"aria-expanded\": \"true\",\n    role: \"listbox\",\n    id: listId,\n    tabIndex: -1,\n    flexShrink: 1,\n    h: \"full\",\n    w: \"full\",\n    \"data-qa\": \"sidebar-search-result\",\n    onClick: onClose,\n    \"aria-busy\": status !== AsyncStatePhase.RESOLVED\n  }, /*#__PURE__*/React.createElement(Virtuoso, {\n    style: {\n      height: '100%',\n      width: '100%'\n    },\n    totalCount: items === null || items === void 0 ? void 0 : items.length,\n    data: items,\n    components: {\n      Scroller: ScrollerWithCustomProps\n    },\n    itemContent: (index, data) => /*#__PURE__*/React.createElement(Row, {\n      data: itemData,\n      item: data\n    }),\n    ref: listRef\n  })));\n});\nmodule.exportDefault(SearchList);","map":{"version":3,"sources":["client/sidebar/search/SearchList.js"],"names":["_extends","module","link","default","v","_taggedTemplateLiteral","_objectWithoutProperties","_objectSpread","css","Sidebar","TextInput","Box","Icon","useMutableCallback","useDebouncedValue","useStableArray","useAutoFocus","useUniqueId","escapeRegExp","Meteor","React","forwardRef","useState","useMemo","useEffect","useRef","Virtuoso","tinykeys","useSetting","useTranslation","useUserPreference","useUserSubscriptions","AsyncStatePhase","useMethodData","useAvatarTemplate","useTemplateByViewMode","Row","ScrollerWithCustomProps","shortcut","Device","isDesktop","window","navigator","platform","toLowerCase","includes","useSpotlight","filterText","usernames","expression","mention","name","match","searchForChannels","searchForDMs","type","users","rooms","args","value","data","phase","status","options","sort","lm","useSearchItems","teste","query","filterRegex","RegExp","$or","fname","t","$ne","localRooms","usernamesFromClient","map","filter","Boolean","spotlight","resultsFromServer","filterUsersUnique","index","arr","_id","findIndex","user","roomFilter","room","find","item","uids","length","rid","usersfilter","userMap","username","avatarETag","exact","usernamame","push","Array","from","Set","useInput","initial","setValue","onChange","e","currentTarget","toggleSelectionState","next","current","input","setAttribute","id","classList","add","remove","SearchList","ref","onClose","listId","setFilterValue","autofocus","listRef","boxRef","selectedElement","itemIndexRef","sidebarViewMode","showRealName","sideBarItemTemplate","avatarTemplate","extended","placeholder","join","items","itemData","SideBarItemTemplate","changeSelection","dir","nextSelectedElement","parentElement","previousSibling","querySelector","nextSibling","resetCursor","scrollToIndex","undefined","unsubscribe","Escape","event","preventDefault","Tab","ArrowUp","currentElement","Math","max","ArrowDown","min","Enter","click","RESOLVED","height","width","Scroller","exportDefault"],"mappings":"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","sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport { Sidebar, TextInput, Box, Icon } from '@rocket.chat/fuselage';\nimport { useMutableCallback, useDebouncedValue, useStableArray, useAutoFocus, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { Meteor } from 'meteor/meteor';\nimport React, { forwardRef, useState, useMemo, useEffect, useRef } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\nimport tinykeys from 'tinykeys';\n\nimport { useSetting } from '../../contexts/SettingsContext';\nimport { useTranslation } from '../../contexts/TranslationContext';\nimport { useUserPreference, useUserSubscriptions } from '../../contexts/UserContext';\nimport { AsyncStatePhase } from '../../hooks/useAsyncState';\nimport { useMethodData } from '../../hooks/useMethodData';\nimport { useAvatarTemplate } from '../hooks/useAvatarTemplate';\nimport { useTemplateByViewMode } from '../hooks/useTemplateByViewMode';\nimport Row from './Row';\nimport ScrollerWithCustomProps from './ScrollerWithCustomProps';\n\nconst shortcut = (() => {\n\tif (!Meteor.Device.isDesktop()) {\n\t\treturn '';\n\t}\n\tif (window.navigator.platform.toLowerCase().includes('mac')) {\n\t\treturn '(\\u2318+K)';\n\t}\n\treturn '(\\u2303+K)';\n})();\n\nconst useSpotlight = (filterText = '', usernames) => {\n\tconst expression = /(@|#)?(.*)/i;\n\tconst [, mention, name] = filterText.match(expression);\n\n\tconst searchForChannels = mention === '#';\n\tconst searchForDMs = mention === '@';\n\n\tconst type = useMemo(() => {\n\t\tif (searchForChannels) {\n\t\t\treturn { users: false, rooms: true };\n\t\t}\n\t\tif (searchForDMs) {\n\t\t\treturn { users: true, rooms: false };\n\t\t}\n\t\treturn { users: true, rooms: true };\n\t}, [searchForChannels, searchForDMs]);\n\tconst args = useMemo(() => [name, usernames, type], [type, name, usernames]);\n\n\tconst { value: data = { users: [], rooms: [] }, phase: status } = useMethodData('spotlight', args);\n\n\treturn useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn { data: { users: [], rooms: [] }, status: 'loading' };\n\t\t}\n\t\treturn { data, status };\n\t}, [data, status]);\n};\n\nconst options = {\n\tsort: {\n\t\tlm: -1,\n\t\tname: 1,\n\t},\n};\n\nconst useSearchItems = (filterText) => {\n\tconst expression = /(@|#)?(.*)/i;\n\tconst teste = filterText.match(expression);\n\n\tconst [, type, name] = teste;\n\tconst query = useMemo(() => {\n\t\tconst filterRegex = new RegExp(escapeRegExp(name), 'i');\n\n\t\treturn {\n\t\t\t$or: [{ name: filterRegex }, { fname: filterRegex }],\n\t\t\t...(type && {\n\t\t\t\tt: type === '@' ? 'd' : { $ne: 'd' },\n\t\t\t}),\n\t\t};\n\t}, [name, type]);\n\n\tconst localRooms = useUserSubscriptions(query, options);\n\n\tconst usernamesFromClient = useStableArray([...localRooms?.map(({ t, name }) => (t === 'd' ? name : null))].filter(Boolean));\n\n\tconst { data: spotlight, status } = useSpotlight(filterText, usernamesFromClient);\n\n\treturn useMemo(() => {\n\t\tconst resultsFromServer = [];\n\n\t\tconst filterUsersUnique = ({ _id }, index, arr) => index === arr.findIndex((user) => _id === user._id);\n\t\tconst roomFilter = (room) =>\n\t\t\t!localRooms.find(\n\t\t\t\t(item) => (room.t === 'd' && room.uids?.length > 1 && room.uids.includes(item._id)) || [item.rid, item._id].includes(room._id),\n\t\t\t);\n\t\tconst usersfilter = (user) => !localRooms.find((room) => room.t === 'd' && room.uids?.length === 2 && room.uids.includes(user._id));\n\n\t\tconst userMap = (user) => ({\n\t\t\t_id: user._id,\n\t\t\tt: 'd',\n\t\t\tname: user.username,\n\t\t\tfname: user.name,\n\t\t\tavatarETag: user.avatarETag,\n\t\t});\n\n\t\tconst exact = resultsFromServer.filter((item) => [item.usernamame, item.name, item.fname].includes(name));\n\n\t\tresultsFromServer.push(...spotlight.users.filter(filterUsersUnique).filter(usersfilter).map(userMap));\n\t\tresultsFromServer.push(...spotlight.rooms.filter(roomFilter));\n\n\t\treturn { data: Array.from(new Set([...exact, ...localRooms, ...resultsFromServer])), status };\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [localRooms, name, spotlight]);\n};\n\nconst useInput = (initial) => {\n\tconst [value, setValue] = useState(initial);\n\tconst onChange = useMutableCallback((e) => {\n\t\tsetValue(e.currentTarget.value);\n\t});\n\treturn { value, onChange, setValue };\n};\n\nconst toggleSelectionState = (next, current, input) => {\n\tinput.setAttribute('aria-activedescendant', next.id);\n\tnext.setAttribute('aria-selected', true);\n\tnext.classList.add('rcx-sidebar-item--selected');\n\tif (current) {\n\t\tcurrent.setAttribute('aria-selected', false);\n\t\tcurrent.classList.remove('rcx-sidebar-item--selected');\n\t}\n};\n\n/**\n * @type import('react').ForwardRefExoticComponent<{ onClose: unknown } & import('react').RefAttributes<HTMLElement>>\n */\nconst SearchList = forwardRef(function SearchList({ onClose }, ref) {\n\tconst listId = useUniqueId();\n\tconst t = useTranslation();\n\tconst { setValue: setFilterValue, ...filter } = useInput('');\n\n\tconst autofocus = useAutoFocus();\n\n\tconst listRef = useRef();\n\tconst boxRef = useRef();\n\n\tconst selectedElement = useRef();\n\tconst itemIndexRef = useRef(0);\n\n\tconst sidebarViewMode = useUserPreference('sidebarViewMode');\n\tconst showRealName = useSetting('UI_Use_Real_Name');\n\n\tconst sideBarItemTemplate = useTemplateByViewMode();\n\tconst avatarTemplate = useAvatarTemplate();\n\n\tconst extended = sidebarViewMode === 'extended';\n\n\tconst filterText = useDebouncedValue(filter.value, 100);\n\n\tconst placeholder = [t('Search'), shortcut].filter(Boolean).join(' ');\n\n\tconst { data: items, status } = useSearchItems(filterText);\n\n\tconst itemData = useMemo(\n\t\t() => ({\n\t\t\titems,\n\t\t\tt,\n\t\t\tSideBarItemTemplate: sideBarItemTemplate,\n\t\t\tavatarTemplate,\n\t\t\tshowRealName,\n\t\t\textended,\n\t\t\tsidebarViewMode,\n\t\t}),\n\t\t[avatarTemplate, extended, items, showRealName, sideBarItemTemplate, sidebarViewMode, t],\n\t);\n\n\tconst changeSelection = useMutableCallback((dir) => {\n\t\tlet nextSelectedElement = null;\n\n\t\tif (dir === 'up') {\n\t\t\tnextSelectedElement = selectedElement.current.parentElement.previousSibling.querySelector('a');\n\t\t} else {\n\t\t\tnextSelectedElement = selectedElement.current.parentElement.nextSibling.querySelector('a');\n\t\t}\n\n\t\tif (nextSelectedElement) {\n\t\t\ttoggleSelectionState(nextSelectedElement, selectedElement.current, autofocus.current);\n\t\t\treturn nextSelectedElement;\n\t\t}\n\t\treturn selectedElement.current;\n\t});\n\n\tconst resetCursor = useMutableCallback(() => {\n\t\titemIndexRef.current = 0;\n\t\tlistRef.current.scrollToIndex({ index: itemIndexRef.current });\n\n\t\tselectedElement.current = boxRef.current?.querySelector('a.rcx-sidebar-item');\n\n\t\tif (selectedElement.current) {\n\t\t\ttoggleSelectionState(selectedElement.current, undefined, autofocus.current);\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tresetCursor();\n\t});\n\n\tuseEffect(() => {\n\t\tresetCursor();\n\t}, [filterText, resetCursor]);\n\n\tuseEffect(() => {\n\t\tif (!autofocus.current) {\n\t\t\treturn;\n\t\t}\n\t\tconst unsubscribe = tinykeys(autofocus.current, {\n\t\t\tEscape: (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tsetFilterValue((value) => {\n\t\t\t\t\tif (!value) {\n\t\t\t\t\t\tonClose();\n\t\t\t\t\t}\n\t\t\t\t\tresetCursor();\n\t\t\t\t\treturn '';\n\t\t\t\t});\n\t\t\t},\n\t\t\tTab: onClose,\n\t\t\tArrowUp: () => {\n\t\t\t\tconst currentElement = changeSelection('up');\n\t\t\t\titemIndexRef.current = Math.max(itemIndexRef.current - 1, 0);\n\t\t\t\tlistRef.current.scrollToIndex({ index: itemIndexRef.current });\n\t\t\t\tselectedElement.current = currentElement;\n\t\t\t},\n\t\t\tArrowDown: () => {\n\t\t\t\tconst currentElement = changeSelection('down');\n\t\t\t\titemIndexRef.current = Math.min(itemIndexRef.current + 1, items?.length + 1);\n\t\t\t\tlistRef.current.scrollToIndex({ index: itemIndexRef.current });\n\t\t\t\tselectedElement.current = currentElement;\n\t\t\t},\n\t\t\tEnter: () => {\n\t\t\t\tif (selectedElement.current) {\n\t\t\t\t\tselectedElement.current.click();\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\treturn () => {\n\t\t\tunsubscribe();\n\t\t};\n\t}, [autofocus, changeSelection, items.length, onClose, resetCursor, setFilterValue]);\n\n\treturn (\n\t\t<Box\n\t\t\tposition='absolute'\n\t\t\trcx-sidebar\n\t\t\th='full'\n\t\t\tdisplay='flex'\n\t\t\tflexDirection='column'\n\t\t\tzIndex={99}\n\t\t\tw='full'\n\t\t\tclassName={css`\n\t\t\t\tleft: 0;\n\t\t\t\ttop: 0;\n\t\t\t`}\n\t\t\tref={ref}\n\t\t>\n\t\t\t<Sidebar.TopBar.Section role='search' is='form'>\n\t\t\t\t<TextInput\n\t\t\t\t\taria-owns={listId}\n\t\t\t\t\tdata-qa='sidebar-search-input'\n\t\t\t\t\tref={autofocus}\n\t\t\t\t\t{...filter}\n\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\taddon={<Icon name='cross' size='x20' onClick={onClose} />}\n\t\t\t\t/>\n\t\t\t</Sidebar.TopBar.Section>\n\t\t\t<Box\n\t\t\t\tref={boxRef}\n\t\t\t\taria-expanded='true'\n\t\t\t\trole='listbox'\n\t\t\t\tid={listId}\n\t\t\t\ttabIndex={-1}\n\t\t\t\tflexShrink={1}\n\t\t\t\th='full'\n\t\t\t\tw='full'\n\t\t\t\tdata-qa='sidebar-search-result'\n\t\t\t\tonClick={onClose}\n\t\t\t\taria-busy={status !== AsyncStatePhase.RESOLVED}\n\t\t\t>\n\t\t\t\t<Virtuoso\n\t\t\t\t\tstyle={{ height: '100%', width: '100%' }}\n\t\t\t\t\ttotalCount={items?.length}\n\t\t\t\t\tdata={items}\n\t\t\t\t\tcomponents={{ Scroller: ScrollerWithCustomProps }}\n\t\t\t\t\titemContent={(index, data) => <Row data={itemData} item={data} />}\n\t\t\t\t\tref={listRef}\n\t\t\t\t/>\n\t\t\t</Box>\n\t\t</Box>\n\t);\n});\n\nexport default SearchList;\n"]},"sourceType":"module","hash":"f67a94de34afcd11a6bfe7edea40d30a1af292f1"}
