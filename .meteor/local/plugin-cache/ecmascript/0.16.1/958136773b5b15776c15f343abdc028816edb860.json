{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/emoji/client/emojiPicker.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/emoji/client/emojiPicker.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/emoji/client/emojiPicker.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/emoji/client/emojiPicker.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/emoji/client/emojiPicker.js"}},"code":"module.export({\n  updateRecentEmoji: () => updateRecentEmoji\n});\n\nlet _;\n\nmodule.link(\"underscore\", {\n  default(v) {\n    _ = v;\n  }\n\n}, 0);\nlet ReactiveVar;\nmodule.link(\"meteor/reactive-var\", {\n  ReactiveVar(v) {\n    ReactiveVar = v;\n  }\n\n}, 1);\nlet ReactiveDict;\nmodule.link(\"meteor/reactive-dict\", {\n  ReactiveDict(v) {\n    ReactiveDict = v;\n  }\n\n}, 2);\nlet FlowRouter;\nmodule.link(\"meteor/kadira:flow-router\", {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 3);\nlet Template;\nmodule.link(\"meteor/templating\", {\n  Template(v) {\n    Template = v;\n  }\n\n}, 4);\nlet escapeRegExp;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeRegExp(v) {\n    escapeRegExp = v;\n  }\n\n}, 5);\nmodule.link(\"../../theme/client/imports/components/emojiPicker.css\");\nlet t;\nmodule.link(\"../../utils/client\", {\n  t(v) {\n    t = v;\n  }\n\n}, 6);\nlet EmojiPicker;\nmodule.link(\"./lib/EmojiPicker\", {\n  EmojiPicker(v) {\n    EmojiPicker = v;\n  }\n\n}, 7);\nlet emoji;\nmodule.link(\"../lib/rocketchat\", {\n  emoji(v) {\n    emoji = v;\n  }\n\n}, 8);\nmodule.link(\"./emojiPicker.html\");\nconst ESCAPE = 27;\nconst emojiListByCategory = new ReactiveDict('emojiList');\n\nconst getEmojiElement = (emoji, image) => image && \"<li class=\\\"emoji-\".concat(emoji, \" emoji-picker-item\\\" data-emoji=\\\"\").concat(emoji, \"\\\" title=\\\"\").concat(emoji, \"\\\">\").concat(image, \"</li>\");\n\nconst createEmojiList = (category, actualTone) => {\n  const html = Object.values(emoji.packages).map(emojiPackage => {\n    if (!emojiPackage.emojisByCategory || !emojiPackage.emojisByCategory[category]) {\n      return;\n    }\n\n    return emojiPackage.emojisByCategory[category].map(current => {\n      const tone = actualTone > 0 && emojiPackage.toneList.hasOwnProperty(current) ? \"_tone\".concat(actualTone) : '';\n      return getEmojiElement(current, emojiPackage.renderPicker(\":\".concat(current).concat(tone, \":\")));\n    }).join('');\n  }).join('') || \"<li>\".concat(t('No_emojis_found'), \"</li>\");\n  return html;\n};\n\nfunction updateRecentEmoji(category) {\n  emojiListByCategory.set(category, createEmojiList(category));\n}\n\nconst createPickerEmojis = instance => {\n  const categories = instance.categoriesList;\n  const actualTone = instance.tone;\n  categories.forEach(category => emojiListByCategory.set(category.key, createEmojiList(category.key, actualTone)));\n};\n\nfunction getEmojisBySearchTerm(searchTerm) {\n  let html = '<ul class=\"emoji-list\">';\n  const t = Template.instance();\n  const actualTone = t.tone;\n  EmojiPicker.currentCategory.set('');\n  const searchRegExp = new RegExp(escapeRegExp(searchTerm.replace(/:/g, '')), 'i');\n\n  for (let current in emoji.list) {\n    if (!emoji.list.hasOwnProperty(current)) {\n      continue;\n    }\n\n    if (searchRegExp.test(current)) {\n      const emojiObject = emoji.list[current];\n      const {\n        emojiPackage,\n        shortnames = []\n      } = emojiObject;\n      let tone = '';\n      current = current.replace(/:/g, '');\n      const alias = shortnames[0] !== undefined ? shortnames[0].replace(/:/g, '') : shortnames[0];\n\n      if (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(emoji)) {\n        tone = \"_tone\".concat(actualTone);\n      }\n\n      let emojiFound = false;\n\n      for (const key in emoji.packages[emojiPackage].emojisByCategory) {\n        if (emoji.packages[emojiPackage].emojisByCategory.hasOwnProperty(key)) {\n          const contents = emoji.packages[emojiPackage].emojisByCategory[key];\n          const searchValArray = alias !== undefined ? alias.replace(/:/g, '').split('_') : alias;\n\n          if (contents.indexOf(current) !== -1 || searchValArray !== undefined && searchValArray.includes(searchTerm)) {\n            emojiFound = true;\n            break;\n          }\n        }\n      }\n\n      if (emojiFound) {\n        const image = emoji.packages[emojiPackage].renderPicker(\":\".concat(current).concat(tone, \":\"));\n        html += getEmojiElement(current, image);\n      }\n    }\n  }\n\n  html += '</ul>';\n  return html;\n}\n\nTemplate.emojiPicker.helpers({\n  emojiCategories() {\n    return Template.instance().categoriesList;\n  },\n\n  emojiByCategory(category) {\n    let emojisByCategory = [];\n\n    for (const emojiPackage in emoji.packages) {\n      if (emoji.packages.hasOwnProperty(emojiPackage)) {\n        if (emoji.packages[emojiPackage].emojisByCategory.hasOwnProperty(category)) {\n          emojisByCategory = emojisByCategory.concat(emoji.packages[emojiPackage].emojisByCategory[category]);\n        }\n      }\n    }\n\n    return emojisByCategory;\n  },\n\n  searching() {\n    return Template.instance().currentSearchTerm.get().length > 0;\n  },\n\n  searchResults() {\n    return getEmojisBySearchTerm(Template.instance().currentSearchTerm.get());\n  },\n\n  emojiList(category) {\n    return emojiListByCategory.get(category);\n  },\n\n  currentTone() {\n    return \"tone-\".concat(Template.instance().tone);\n  },\n\n  /**\n   * Returns true if a given emoji category is active\n   *\n   * @param {string} category hash\n   * @return {boolean} true if active, false otherwise\n   */\n  activeCategory(category) {\n    return EmojiPicker.currentCategory.get() === category ? 'active' : '';\n  },\n\n  /**\n   * Returns currently active emoji category hash\n   *\n   * @return {string} category hash\n   */\n  currentCategory() {\n    return EmojiPicker.currentCategory.get();\n  }\n\n});\nTemplate.emojiPicker.events({\n  'click .emoji-picker'(event) {\n    event.stopPropagation();\n    event.preventDefault();\n  },\n\n  'click .add-custom'(event) {\n    event.stopPropagation();\n    event.preventDefault();\n    FlowRouter.go('/admin/emoji-custom');\n    EmojiPicker.close();\n  },\n\n  'click .category-link'(event) {\n    event.stopPropagation();\n    event.preventDefault();\n    EmojiPicker.showCategory(event.currentTarget.hash.substr(1));\n    return false;\n  },\n\n  'scroll .emojis': _.throttle((event, instance) => {\n    if (EmojiPicker.scrollingToCategory) {\n      return;\n    }\n\n    const container = instance.$(event.currentTarget);\n    const scrollTop = container.scrollTop() + 8;\n    const last = EmojiPicker.getCategoryPositions().filter(pos => pos.top <= scrollTop).pop();\n\n    if (!last) {\n      return;\n    }\n\n    const {\n      el\n    } = last;\n    const category = el.id.replace('emoji-list-category-', '');\n    EmojiPicker.currentCategory.set(category);\n  }, 300),\n\n  'click .change-tone > a'(event, instance) {\n    event.stopPropagation();\n    event.preventDefault();\n    instance.$('.tone-selector').toggleClass('show');\n  },\n\n  'click .tone-selector .tone'(event, instance) {\n    event.stopPropagation();\n    event.preventDefault();\n    const tone = parseInt(event.currentTarget.dataset.tone);\n    let newTone;\n\n    if (tone > 0) {\n      newTone = \"_tone\".concat(tone);\n    } else {\n      newTone = '';\n    }\n\n    for (const emojiPackage in emoji.packages) {\n      if (emoji.packages.hasOwnProperty(emojiPackage)) {\n        if (emoji.packages[emojiPackage].hasOwnProperty('toneList')) {\n          for (const _emoji in emoji.packages[emojiPackage].toneList) {\n            if (emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n              $(\".emoji-\".concat(_emoji)).html(emoji.packages[emojiPackage].render(\":\".concat(_emoji).concat(newTone, \":\")));\n            }\n          }\n        }\n      }\n    }\n\n    EmojiPicker.setTone(tone);\n    instance.setCurrentTone(tone);\n    $('.tone-selector').toggleClass('show');\n  },\n\n  'click .emoji-list .emoji-picker-item'(event, instance) {\n    event.stopPropagation();\n    const _emoji = event.currentTarget.dataset.emoji;\n    const actualTone = instance.tone;\n    let tone = '';\n\n    for (const emojiPackage in emoji.packages) {\n      if (emoji.packages.hasOwnProperty(emojiPackage)) {\n        if (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n          tone = \"_tone\".concat(actualTone);\n        }\n      }\n    }\n\n    const input = $('.emoji-picker .js-emojipicker-search');\n\n    if (input) {\n      input.val('');\n    }\n\n    instance.currentSearchTerm.set('');\n    EmojiPicker.pickEmoji(_emoji + tone);\n  },\n\n  'keyup .js-emojipicker-search, change .js-emojipicker-search'(event, instance) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (event.keyCode === ESCAPE) {\n      return EmojiPicker.close();\n    }\n\n    const value = event.target.value.trim();\n    const cst = instance.currentSearchTerm;\n\n    if (value === cst.get()) {\n      return;\n    }\n\n    cst.set(value);\n  }\n\n});\nTemplate.emojiPicker.onCreated(function () {\n  this.tone = EmojiPicker.getTone();\n  const recent = EmojiPicker.getRecent();\n  this.currentSearchTerm = new ReactiveVar('');\n  this.categoriesList = [];\n\n  for (const emojiPackage in emoji.packages) {\n    if (emoji.packages.hasOwnProperty(emojiPackage)) {\n      if (emoji.packages[emojiPackage].emojiCategories) {\n        if (typeof emoji.packages[emojiPackage].categoryIndex !== 'undefined') {\n          this.categoriesList.splice(emoji.packages[emojiPackage].categoryIndex, 0, ...emoji.packages[emojiPackage].emojiCategories);\n        } else {\n          this.categoriesList = this.categoriesList.concat(emoji.packages[emojiPackage].emojiCategories);\n        }\n      }\n    }\n  }\n\n  recent.forEach(_emoji => {\n    emoji.packages.base.emojisByCategory.recent.push(_emoji);\n  });\n\n  this.setCurrentTone = newTone => {\n    $('.current-tone').removeClass(\"tone-\".concat(this.tone));\n    $('.current-tone').addClass(\"tone-\".concat(newTone));\n    this.tone = newTone;\n  };\n\n  createPickerEmojis(this);\n});","map":{"version":3,"sources":["app/emoji/client/emojiPicker.js"],"names":["module","export","updateRecentEmoji","_","link","default","v","ReactiveVar","ReactiveDict","FlowRouter","Template","escapeRegExp","t","EmojiPicker","emoji","ESCAPE","emojiListByCategory","getEmojiElement","image","createEmojiList","category","actualTone","html","Object","values","packages","map","emojiPackage","emojisByCategory","current","tone","toneList","hasOwnProperty","renderPicker","join","set","createPickerEmojis","instance","categories","categoriesList","forEach","key","getEmojisBySearchTerm","searchTerm","currentCategory","searchRegExp","RegExp","replace","list","test","emojiObject","shortnames","alias","undefined","emojiFound","contents","searchValArray","split","indexOf","includes","emojiPicker","helpers","emojiCategories","emojiByCategory","concat","searching","currentSearchTerm","get","length","searchResults","emojiList","currentTone","activeCategory","events","event","stopPropagation","preventDefault","go","close","showCategory","currentTarget","hash","substr","throttle","scrollingToCategory","container","$","scrollTop","last","getCategoryPositions","filter","pos","top","pop","el","id","toggleClass","parseInt","dataset","newTone","_emoji","render","setTone","setCurrentTone","input","val","pickEmoji","keyCode","value","target","trim","cst","onCreated","getTone","recent","getRecent","categoryIndex","splice","base","push","removeClass","addClass"],"mappings":"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","sourcesContent":["import _ from 'underscore';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { ReactiveDict } from 'meteor/reactive-dict';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Template } from 'meteor/templating';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\n\nimport '../../theme/client/imports/components/emojiPicker.css';\nimport { t } from '../../utils/client';\nimport { EmojiPicker } from './lib/EmojiPicker';\nimport { emoji } from '../lib/rocketchat';\nimport './emojiPicker.html';\n\nconst ESCAPE = 27;\n\nconst emojiListByCategory = new ReactiveDict('emojiList');\n\nconst getEmojiElement = (emoji, image) =>\n\timage && `<li class=\"emoji-${emoji} emoji-picker-item\" data-emoji=\"${emoji}\" title=\"${emoji}\">${image}</li>`;\n\nconst createEmojiList = (category, actualTone) => {\n\tconst html =\n\t\tObject.values(emoji.packages)\n\t\t\t.map((emojiPackage) => {\n\t\t\t\tif (!emojiPackage.emojisByCategory || !emojiPackage.emojisByCategory[category]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn emojiPackage.emojisByCategory[category]\n\t\t\t\t\t.map((current) => {\n\t\t\t\t\t\tconst tone = actualTone > 0 && emojiPackage.toneList.hasOwnProperty(current) ? `_tone${actualTone}` : '';\n\t\t\t\t\t\treturn getEmojiElement(current, emojiPackage.renderPicker(`:${current}${tone}:`));\n\t\t\t\t\t})\n\t\t\t\t\t.join('');\n\t\t\t})\n\t\t\t.join('') || `<li>${t('No_emojis_found')}</li>`;\n\n\treturn html;\n};\n\nexport function updateRecentEmoji(category) {\n\temojiListByCategory.set(category, createEmojiList(category));\n}\n\nconst createPickerEmojis = (instance) => {\n\tconst categories = instance.categoriesList;\n\tconst actualTone = instance.tone;\n\n\tcategories.forEach((category) => emojiListByCategory.set(category.key, createEmojiList(category.key, actualTone)));\n};\n\nfunction getEmojisBySearchTerm(searchTerm) {\n\tlet html = '<ul class=\"emoji-list\">';\n\tconst t = Template.instance();\n\tconst actualTone = t.tone;\n\n\tEmojiPicker.currentCategory.set('');\n\n\tconst searchRegExp = new RegExp(escapeRegExp(searchTerm.replace(/:/g, '')), 'i');\n\n\tfor (let current in emoji.list) {\n\t\tif (!emoji.list.hasOwnProperty(current)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (searchRegExp.test(current)) {\n\t\t\tconst emojiObject = emoji.list[current];\n\t\t\tconst { emojiPackage, shortnames = [] } = emojiObject;\n\t\t\tlet tone = '';\n\t\t\tcurrent = current.replace(/:/g, '');\n\t\t\tconst alias = shortnames[0] !== undefined ? shortnames[0].replace(/:/g, '') : shortnames[0];\n\n\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(emoji)) {\n\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t}\n\n\t\t\tlet emojiFound = false;\n\n\t\t\tfor (const key in emoji.packages[emojiPackage].emojisByCategory) {\n\t\t\t\tif (emoji.packages[emojiPackage].emojisByCategory.hasOwnProperty(key)) {\n\t\t\t\t\tconst contents = emoji.packages[emojiPackage].emojisByCategory[key];\n\t\t\t\t\tconst searchValArray = alias !== undefined ? alias.replace(/:/g, '').split('_') : alias;\n\t\t\t\t\tif (contents.indexOf(current) !== -1 || (searchValArray !== undefined && searchValArray.includes(searchTerm))) {\n\t\t\t\t\t\temojiFound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (emojiFound) {\n\t\t\t\tconst image = emoji.packages[emojiPackage].renderPicker(`:${current}${tone}:`);\n\t\t\t\thtml += getEmojiElement(current, image);\n\t\t\t}\n\t\t}\n\t}\n\thtml += '</ul>';\n\n\treturn html;\n}\n\nTemplate.emojiPicker.helpers({\n\temojiCategories() {\n\t\treturn Template.instance().categoriesList;\n\t},\n\temojiByCategory(category) {\n\t\tlet emojisByCategory = [];\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (emoji.packages[emojiPackage].emojisByCategory.hasOwnProperty(category)) {\n\t\t\t\t\temojisByCategory = emojisByCategory.concat(emoji.packages[emojiPackage].emojisByCategory[category]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn emojisByCategory;\n\t},\n\tsearching() {\n\t\treturn Template.instance().currentSearchTerm.get().length > 0;\n\t},\n\tsearchResults() {\n\t\treturn getEmojisBySearchTerm(Template.instance().currentSearchTerm.get());\n\t},\n\temojiList(category) {\n\t\treturn emojiListByCategory.get(category);\n\t},\n\tcurrentTone() {\n\t\treturn `tone-${Template.instance().tone}`;\n\t},\n\t/**\n\t * Returns true if a given emoji category is active\n\t *\n\t * @param {string} category hash\n\t * @return {boolean} true if active, false otherwise\n\t */\n\tactiveCategory(category) {\n\t\treturn EmojiPicker.currentCategory.get() === category ? 'active' : '';\n\t},\n\t/**\n\t * Returns currently active emoji category hash\n\t *\n\t * @return {string} category hash\n\t */\n\tcurrentCategory() {\n\t\treturn EmojiPicker.currentCategory.get();\n\t},\n});\n\nTemplate.emojiPicker.events({\n\t'click .emoji-picker'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t},\n\t'click .add-custom'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tFlowRouter.go('/admin/emoji-custom');\n\t\tEmojiPicker.close();\n\t},\n\t'click .category-link'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tEmojiPicker.showCategory(event.currentTarget.hash.substr(1));\n\n\t\treturn false;\n\t},\n\t'scroll .emojis': _.throttle((event, instance) => {\n\t\tif (EmojiPicker.scrollingToCategory) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst container = instance.$(event.currentTarget);\n\t\tconst scrollTop = container.scrollTop() + 8;\n\n\t\tconst last = EmojiPicker.getCategoryPositions()\n\t\t\t.filter((pos) => pos.top <= scrollTop)\n\t\t\t.pop();\n\n\t\tif (!last) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { el } = last;\n\n\t\tconst category = el.id.replace('emoji-list-category-', '');\n\n\t\tEmojiPicker.currentCategory.set(category);\n\t}, 300),\n\t'click .change-tone > a'(event, instance) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tinstance.$('.tone-selector').toggleClass('show');\n\t},\n\t'click .tone-selector .tone'(event, instance) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst tone = parseInt(event.currentTarget.dataset.tone);\n\t\tlet newTone;\n\n\t\tif (tone > 0) {\n\t\t\tnewTone = `_tone${tone}`;\n\t\t} else {\n\t\t\tnewTone = '';\n\t\t}\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (emoji.packages[emojiPackage].hasOwnProperty('toneList')) {\n\t\t\t\t\tfor (const _emoji in emoji.packages[emojiPackage].toneList) {\n\t\t\t\t\t\tif (emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\t\t\t$(`.emoji-${_emoji}`).html(emoji.packages[emojiPackage].render(`:${_emoji}${newTone}:`));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tEmojiPicker.setTone(tone);\n\n\t\tinstance.setCurrentTone(tone);\n\n\t\t$('.tone-selector').toggleClass('show');\n\t},\n\t'click .emoji-list .emoji-picker-item'(event, instance) {\n\t\tevent.stopPropagation();\n\n\t\tconst _emoji = event.currentTarget.dataset.emoji;\n\t\tconst actualTone = instance.tone;\n\t\tlet tone = '';\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst input = $('.emoji-picker .js-emojipicker-search');\n\t\tif (input) {\n\t\t\tinput.val('');\n\t\t}\n\t\tinstance.currentSearchTerm.set('');\n\n\t\tEmojiPicker.pickEmoji(_emoji + tone);\n\t},\n\t'keyup .js-emojipicker-search, change .js-emojipicker-search'(event, instance) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif (event.keyCode === ESCAPE) {\n\t\t\treturn EmojiPicker.close();\n\t\t}\n\n\t\tconst value = event.target.value.trim();\n\t\tconst cst = instance.currentSearchTerm;\n\t\tif (value === cst.get()) {\n\t\t\treturn;\n\t\t}\n\t\tcst.set(value);\n\t},\n});\n\nTemplate.emojiPicker.onCreated(function () {\n\tthis.tone = EmojiPicker.getTone();\n\tconst recent = EmojiPicker.getRecent();\n\n\tthis.currentSearchTerm = new ReactiveVar('');\n\n\tthis.categoriesList = [];\n\tfor (const emojiPackage in emoji.packages) {\n\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\tif (emoji.packages[emojiPackage].emojiCategories) {\n\t\t\t\tif (typeof emoji.packages[emojiPackage].categoryIndex !== 'undefined') {\n\t\t\t\t\tthis.categoriesList.splice(emoji.packages[emojiPackage].categoryIndex, 0, ...emoji.packages[emojiPackage].emojiCategories);\n\t\t\t\t} else {\n\t\t\t\t\tthis.categoriesList = this.categoriesList.concat(emoji.packages[emojiPackage].emojiCategories);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trecent.forEach((_emoji) => {\n\t\temoji.packages.base.emojisByCategory.recent.push(_emoji);\n\t});\n\n\tthis.setCurrentTone = (newTone) => {\n\t\t$('.current-tone').removeClass(`tone-${this.tone}`);\n\t\t$('.current-tone').addClass(`tone-${newTone}`);\n\t\tthis.tone = newTone;\n\t};\n\n\tcreatePickerEmojis(this);\n});\n"]},"sourceType":"module","hash":"958136773b5b15776c15f343abdc028816edb860"}
