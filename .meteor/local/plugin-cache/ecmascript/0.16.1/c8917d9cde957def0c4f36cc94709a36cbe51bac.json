{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/login/ResetPassword/ResetPassword.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/login/ResetPassword/ResetPassword.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/login/ResetPassword/ResetPassword.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/login/ResetPassword/ResetPassword.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/login/ResetPassword/ResetPassword.js"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _toConsumableArray;\n\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar Button, TextInput, Field, Modal, Box, Throbber;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Button: function (v) {\n    Button = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  Modal: function (v) {\n    Modal = v;\n  },\n  Box: function (v) {\n    Box = v;\n  },\n  Throbber: function (v) {\n    Throbber = v;\n  }\n}, 0);\nvar useSafely;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useSafely: function (v) {\n    useSafely = v;\n  }\n}, 1);\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 2);\nvar React, useState, useCallback, useMemo;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 3);\nvar useRouteParameter, useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRouteParameter: function (v) {\n    useRouteParameter = v;\n  },\n  useRoute: function (v) {\n    useRoute = v;\n  }\n}, 4);\nvar useMethod;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod: function (v) {\n    useMethod = v;\n  }\n}, 5);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 6);\nvar useUser;\nmodule.link(\"../../../contexts/UserContext\", {\n  useUser: function (v) {\n    useUser = v;\n  }\n}, 7);\nvar useMethodData;\nmodule.link(\"../../../hooks/useMethodData\", {\n  useMethodData: function (v) {\n    useMethodData = v;\n  }\n}, 8);\nvar LoginLayout;\nmodule.link(\"../LoginLayout\", {\n  \"default\": function (v) {\n    LoginLayout = v;\n  }\n}, 9);\n\nvar getChangePasswordReason = function () {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      requirePasswordChange = _ref.requirePasswordChange,\n      _ref$requirePasswordC = _ref.requirePasswordChangeReason,\n      requirePasswordChangeReason = _ref$requirePasswordC === void 0 ? requirePasswordChange ? 'You_need_to_change_your_password' : 'Please_enter_your_new_password_below' : _ref$requirePasswordC;\n\n  return requirePasswordChangeReason;\n};\n\nvar ResetPassword = function () {\n  var user = useUser();\n  var t = useTranslation();\n  var setUserPassword = useMethod('setUserPassword');\n  var resetPassword = useMethod('resetPassword');\n  var token = useRouteParameter('token');\n  var params = useMemo(function () {\n    return [{\n      token: token\n    }];\n  }, [token]);\n\n  var _useMethodData = useMethodData('getPasswordPolicy', params),\n      _useMethodData$value = _useMethodData.value;\n\n  _useMethodData$value = _useMethodData$value === void 0 ? {} : _useMethodData$value;\n  var policyEnabled = _useMethodData$value.enabled,\n      policies = _useMethodData$value.policy;\n  var router = useRoute('home');\n  var changePasswordReason = getChangePasswordReason(user || {});\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      newPassword = _useState2[0],\n      setNewPassword = _useState2[1];\n\n  var _useSafely = useSafely(useState(false)),\n      _useSafely2 = _slicedToArray(_useSafely, 2),\n      isLoading = _useSafely2[0],\n      setIsLoading = _useSafely2[1];\n\n  var _useSafely3 = useSafely(useState()),\n      _useSafely4 = _slicedToArray(_useSafely3, 2),\n      error = _useSafely4[0],\n      setError = _useSafely4[1];\n\n  var handleOnChange = useCallback(function (event) {\n    return setNewPassword(event.currentTarget.value);\n  }, [setNewPassword]);\n  var isSubmitDisabled = !newPassword.trim() || isLoading;\n  var handleSubmit = useCallback(function () {\n    function _callee(e) {\n      var result, error, _ref2$reason, reason;\n\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n\n                if (!isSubmitDisabled) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 3:\n                setIsLoading(true);\n                _context.prev = 4;\n\n                if (!(token && resetPassword)) {\n                  _context.next = 14;\n                  break;\n                }\n\n                _context.next = 8;\n                return _regeneratorRuntime.awrap(resetPassword(token, newPassword));\n\n              case 8:\n                result = _context.sent;\n                _context.next = 11;\n                return _regeneratorRuntime.awrap(Meteor.loginWithToken(result.token));\n\n              case 11:\n                router.push({});\n                _context.next = 16;\n                break;\n\n              case 14:\n                _context.next = 16;\n                return _regeneratorRuntime.awrap(setUserPassword(newPassword));\n\n              case 16:\n                _context.next = 24;\n                break;\n\n              case 18:\n                _context.prev = 18;\n                _context.t0 = _context[\"catch\"](4);\n                error = _context.t0.error;\n                _ref2$reason = _context.t0.reason;\n                reason = _ref2$reason === void 0 ? error : _ref2$reason;\n                setError(reason);\n\n              case 24:\n                _context.prev = 24;\n                setIsLoading(false);\n                return _context.finish(24);\n\n              case 27:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, [[4, 18, 24, 27]], Promise);\n    }\n\n    return _callee;\n  }(), [isSubmitDisabled, setIsLoading, token, resetPassword, newPassword, router, setUserPassword, setError]);\n  return /*#__PURE__*/React.createElement(LoginLayout, null, /*#__PURE__*/React.createElement(Modal, {\n    is: \"form\",\n    onSubmit: handleSubmit\n  }, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, {\n    textAlign: \"start\"\n  }, t('Password'))), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t(changePasswordReason)), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    placeholder: t('Type_your_new_password'),\n    type: \"password\",\n    name: \"newPassword\",\n    id: \"newPassword\",\n    dir: \"auto\",\n    onChange: handleOnChange,\n    autoComplete: \"off\",\n    value: newPassword\n  })), error && /*#__PURE__*/React.createElement(Field.Error, null, error), policyEnabled && /*#__PURE__*/React.createElement(Field.Hint, null, policies.map(function (policy, index) {\n    return /*#__PURE__*/React.createElement(Box, {\n      is: \"p\",\n      textAlign: \"start\",\n      key: index\n    }, t.apply(void 0, _toConsumableArray(policy)));\n  })))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    disabled: isSubmitDisabled,\n    type: \"submit\"\n  }, isLoading ? /*#__PURE__*/React.createElement(Throbber, {\n    size: \"x12\",\n    inheritColor: true\n  }) : t('Reset')))))));\n};\n\nmodule.exportDefault(ResetPassword);","map":{"version":3,"sources":["client/views/login/ResetPassword/ResetPassword.js"],"names":["_regeneratorRuntime","module","link","default","v","_toConsumableArray","_slicedToArray","Button","TextInput","Field","Modal","Box","Throbber","useSafely","Meteor","React","useState","useCallback","useMemo","useRouteParameter","useRoute","useMethod","useTranslation","useUser","useMethodData","LoginLayout","getChangePasswordReason","requirePasswordChange","requirePasswordChangeReason","ResetPassword","user","t","setUserPassword","resetPassword","token","params","value","policyEnabled","enabled","policies","policy","router","changePasswordReason","newPassword","setNewPassword","isLoading","setIsLoading","error","setError","handleOnChange","event","currentTarget","isSubmitDisabled","trim","handleSubmit","e","preventDefault","result","loginWithToken","push","reason","map","index","exportDefault"],"mappings":"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","sourcesContent":["import { Button, TextInput, Field, Modal, Box, Throbber } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { Meteor } from 'meteor/meteor';\nimport React, { useState, useCallback, useMemo } from 'react';\n\nimport { useRouteParameter, useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useUser } from '../../../contexts/UserContext';\nimport { useMethodData } from '../../../hooks/useMethodData';\nimport LoginLayout from '../LoginLayout';\n\nconst getChangePasswordReason = ({\n\trequirePasswordChange,\n\trequirePasswordChangeReason = requirePasswordChange ? 'You_need_to_change_your_password' : 'Please_enter_your_new_password_below',\n} = {}) => requirePasswordChangeReason;\n\nconst ResetPassword = () => {\n\tconst user = useUser();\n\tconst t = useTranslation();\n\tconst setUserPassword = useMethod('setUserPassword');\n\tconst resetPassword = useMethod('resetPassword');\n\tconst token = useRouteParameter('token');\n\tconst params = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ttoken,\n\t\t\t},\n\t\t],\n\t\t[token],\n\t);\n\n\tconst { value: { enabled: policyEnabled, policy: policies } = {} } = useMethodData('getPasswordPolicy', params);\n\n\tconst router = useRoute('home');\n\n\tconst changePasswordReason = getChangePasswordReason(user || {});\n\n\tconst [newPassword, setNewPassword] = useState('');\n\tconst [isLoading, setIsLoading] = useSafely(useState(false));\n\tconst [error, setError] = useSafely(useState());\n\n\tconst handleOnChange = useCallback((event) => setNewPassword(event.currentTarget.value), [setNewPassword]);\n\n\tconst isSubmitDisabled = !newPassword.trim() || isLoading;\n\n\tconst handleSubmit = useCallback(\n\t\tasync (e) => {\n\t\t\te.preventDefault();\n\t\t\tif (isSubmitDisabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetIsLoading(true);\n\t\t\ttry {\n\t\t\t\tif (token && resetPassword) {\n\t\t\t\t\tconst result = await resetPassword(token, newPassword);\n\t\t\t\t\tawait Meteor.loginWithToken(result.token);\n\t\t\t\t\trouter.push({});\n\t\t\t\t} else {\n\t\t\t\t\tawait setUserPassword(newPassword);\n\t\t\t\t}\n\t\t\t} catch ({ error, reason = error }) {\n\t\t\t\tsetError(reason);\n\t\t\t} finally {\n\t\t\t\tsetIsLoading(false);\n\t\t\t}\n\t\t},\n\t\t[isSubmitDisabled, setIsLoading, token, resetPassword, newPassword, router, setUserPassword, setError],\n\t);\n\n\treturn (\n\t\t<LoginLayout>\n\t\t\t<Modal is='form' onSubmit={handleSubmit}>\n\t\t\t\t<Modal.Header>\n\t\t\t\t\t<Modal.Title textAlign='start'>{t('Password')}</Modal.Title>\n\t\t\t\t</Modal.Header>\n\t\t\t\t<Modal.Content>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Label>{t(changePasswordReason)}</Field.Label>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tplaceholder={t('Type_your_new_password')}\n\t\t\t\t\t\t\t\ttype='password'\n\t\t\t\t\t\t\t\tname='newPassword'\n\t\t\t\t\t\t\t\tid='newPassword'\n\t\t\t\t\t\t\t\tdir='auto'\n\t\t\t\t\t\t\t\tonChange={handleOnChange}\n\t\t\t\t\t\t\t\tautoComplete='off'\n\t\t\t\t\t\t\t\tvalue={newPassword}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t{error && <Field.Error>{error}</Field.Error>}\n\t\t\t\t\t\t{policyEnabled && (\n\t\t\t\t\t\t\t<Field.Hint>\n\t\t\t\t\t\t\t\t{policies.map((policy, index) => (\n\t\t\t\t\t\t\t\t\t<Box is='p' textAlign='start' key={index}>\n\t\t\t\t\t\t\t\t\t\t{t(...policy)}\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</Field.Hint>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Field>\n\t\t\t\t</Modal.Content>\n\t\t\t\t<Modal.Footer>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t<Button primary disabled={isSubmitDisabled} type='submit'>\n\t\t\t\t\t\t\t\t{isLoading ? <Throbber size='x12' inheritColor /> : t('Reset')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t</Field>\n\t\t\t\t</Modal.Footer>\n\t\t\t</Modal>\n\t\t</LoginLayout>\n\t);\n};\n\nexport default ResetPassword;\n"]},"sourceType":"module","hash":"c8917d9cde957def0c4f36cc94709a36cbe51bac"}
