{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-message/client/messageBox/messageBoxNotSubscribed.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/ui-message/client/messageBox/messageBoxNotSubscribed.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-message/client/messageBox/messageBoxNotSubscribed.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-message/client/messageBox/messageBoxNotSubscribed.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-message/client/messageBox/messageBoxNotSubscribed.js"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Session;\nmodule.link(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 1);\nvar Template;\nmodule.link(\"meteor/templating\", {\n  Template: function (v) {\n    Template = v;\n  }\n}, 2);\nvar settings;\nmodule.link(\"../../../settings/client\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 3);\nvar RoomManager, RoomHistoryManager;\nmodule.link(\"../../../ui-utils/client\", {\n  RoomManager: function (v) {\n    RoomManager = v;\n  },\n  RoomHistoryManager: function (v) {\n    RoomHistoryManager = v;\n  }\n}, 4);\nvar hasAllPermission;\nmodule.link(\"../../../authorization/client\", {\n  hasAllPermission: function (v) {\n    hasAllPermission = v;\n  }\n}, 5);\nmodule.link(\"./messageBoxNotSubscribed.html\");\nvar call;\nmodule.link(\"../../../../client/lib/utils/call\", {\n  call: function (v) {\n    call = v;\n  }\n}, 6);\nvar roomCoordinator;\nmodule.link(\"../../../../client/lib/rooms/roomCoordinator\", {\n  roomCoordinator: function (v) {\n    roomCoordinator = v;\n  }\n}, 7);\nTemplate.messageBoxNotSubscribed.helpers({\n  customTemplate: function () {\n    var _roomCoordinator$getR;\n\n    return (_roomCoordinator$getR = roomCoordinator.getRoomTypeConfigById(this.rid)) === null || _roomCoordinator$getR === void 0 ? void 0 : _roomCoordinator$getR.notSubscribedTpl;\n  },\n  canJoinRoom: function () {\n    var _roomCoordinator$getR2;\n\n    return Meteor.userId() && ((_roomCoordinator$getR2 = roomCoordinator.getRoomDirectivesById(this.rid)) === null || _roomCoordinator$getR2 === void 0 ? void 0 : _roomCoordinator$getR2.showJoinLink(this.rid));\n  },\n  roomName: function () {\n    var room = Session.get(\"roomData\" + this.rid);\n    return roomCoordinator.getRoomName(room.t, room);\n  },\n  isJoinCodeRequired: function () {\n    var room = Session.get(\"roomData\" + this.rid);\n    return room && room.joinCodeRequired;\n  },\n  isAnonymousReadAllowed: function () {\n    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true;\n  },\n  isAnonymousWriteAllowed: function () {\n    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true && settings.get('Accounts_AllowAnonymousWrite') === true;\n  }\n});\nTemplate.messageBoxNotSubscribed.events({\n  'click .js-join-code': function () {\n    function _callee(event) {\n      var joinCodeInput, joinCode;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.stopPropagation();\n                event.preventDefault();\n                joinCodeInput = Template.instance().find('[name=joinCode]');\n                joinCode = joinCodeInput && joinCodeInput.value;\n                _context.next = 6;\n                return _regeneratorRuntime.awrap(call('joinRoom', this.rid, joinCode));\n\n              case 6:\n                if (hasAllPermission('preview-c-room') === false && RoomHistoryManager.getRoom(this.rid).loaded === 0) {\n                  RoomManager.getOpenedRoomByRid(this.rid).streamActive = false;\n                  RoomManager.getOpenedRoomByRid(this.rid).ready = false;\n                  RoomHistoryManager.getRoom(this.rid).loaded = null;\n                  RoomManager.computation.invalidate();\n                }\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, this, null, Promise);\n    }\n\n    return _callee;\n  }(),\n  'click .js-register': function (event) {\n    event.stopPropagation();\n    event.preventDefault();\n    Session.set('forceLogin', true);\n  },\n  'click .js-register-anonymous': function () {\n    function _callee2(event) {\n      var _await$call, token;\n\n      return _regeneratorRuntime.async(function () {\n        function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.stopPropagation();\n                event.preventDefault();\n                _context2.next = 4;\n                return _regeneratorRuntime.awrap(call('registerUser', {}));\n\n              case 4:\n                _await$call = _context2.sent;\n                token = _await$call.token;\n                Meteor.loginWithToken(token);\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }\n\n        return _callee2$;\n      }(), null, null, null, Promise);\n    }\n\n    return _callee2;\n  }()\n});","map":{"version":3,"sources":["app/ui-message/client/messageBox/messageBoxNotSubscribed.js"],"names":["_regeneratorRuntime","module","link","default","v","Meteor","Session","Template","settings","RoomManager","RoomHistoryManager","hasAllPermission","call","roomCoordinator","messageBoxNotSubscribed","helpers","customTemplate","getRoomTypeConfigById","rid","notSubscribedTpl","canJoinRoom","userId","getRoomDirectivesById","showJoinLink","roomName","room","get","getRoomName","t","isJoinCodeRequired","joinCodeRequired","isAnonymousReadAllowed","isAnonymousWriteAllowed","events","event","stopPropagation","preventDefault","joinCodeInput","instance","find","joinCode","value","getRoom","loaded","getOpenedRoomByRid","streamActive","ready","computation","invalidate","set","token","loginWithToken"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { Template } from 'meteor/templating';\n\nimport { settings } from '../../../settings/client';\nimport { RoomManager, RoomHistoryManager } from '../../../ui-utils/client';\nimport { hasAllPermission } from '../../../authorization/client';\nimport './messageBoxNotSubscribed.html';\nimport { call } from '../../../../client/lib/utils/call';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\n\nTemplate.messageBoxNotSubscribed.helpers({\n\tcustomTemplate() {\n\t\treturn roomCoordinator.getRoomTypeConfigById(this.rid)?.notSubscribedTpl;\n\t},\n\tcanJoinRoom() {\n\t\treturn Meteor.userId() && roomCoordinator.getRoomDirectivesById(this.rid)?.showJoinLink(this.rid);\n\t},\n\troomName() {\n\t\tconst room = Session.get(`roomData${this.rid}`);\n\t\treturn roomCoordinator.getRoomName(room.t, room);\n\t},\n\tisJoinCodeRequired() {\n\t\tconst room = Session.get(`roomData${this.rid}`);\n\t\treturn room && room.joinCodeRequired;\n\t},\n\tisAnonymousReadAllowed() {\n\t\treturn Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true;\n\t},\n\tisAnonymousWriteAllowed() {\n\t\treturn (\n\t\t\tMeteor.userId() == null &&\n\t\t\tsettings.get('Accounts_AllowAnonymousRead') === true &&\n\t\t\tsettings.get('Accounts_AllowAnonymousWrite') === true\n\t\t);\n\t},\n});\n\nTemplate.messageBoxNotSubscribed.events({\n\tasync 'click .js-join-code'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst joinCodeInput = Template.instance().find('[name=joinCode]');\n\t\tconst joinCode = joinCodeInput && joinCodeInput.value;\n\n\t\tawait call('joinRoom', this.rid, joinCode);\n\n\t\tif (hasAllPermission('preview-c-room') === false && RoomHistoryManager.getRoom(this.rid).loaded === 0) {\n\t\t\tRoomManager.getOpenedRoomByRid(this.rid).streamActive = false;\n\t\t\tRoomManager.getOpenedRoomByRid(this.rid).ready = false;\n\t\t\tRoomHistoryManager.getRoom(this.rid).loaded = null;\n\t\t\tRoomManager.computation.invalidate();\n\t\t}\n\t},\n\t'click .js-register'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tSession.set('forceLogin', true);\n\t},\n\tasync 'click .js-register-anonymous'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst { token } = await call('registerUser', {});\n\t\tMeteor.loginWithToken(token);\n\t},\n});\n"]},"sourceType":"module","hash":"651f47de4a5b643de2b6470570bfa324a024fe91"}
