{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/custom-sounds/client/lib/CustomSounds.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/custom-sounds/client/lib/CustomSounds.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/custom-sounds/client/lib/CustomSounds.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/custom-sounds/client/lib/CustomSounds.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/custom-sounds/client/lib/CustomSounds.js"}},"code":"module.export({\n  CustomSounds: () => CustomSounds\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet ReactiveVar;\nmodule.link(\"meteor/reactive-var\", {\n  ReactiveVar(v) {\n    ReactiveVar = v;\n  }\n\n}, 1);\n\nlet _;\n\nmodule.link(\"underscore\", {\n  default(v) {\n    _ = v;\n  }\n\n}, 2);\nlet CachedCollectionManager;\nmodule.link(\"../../../ui-cached-collection\", {\n  CachedCollectionManager(v) {\n    CachedCollectionManager = v;\n  }\n\n}, 3);\nlet getURL;\nmodule.link(\"../../../utils/client\", {\n  getURL(v) {\n    getURL = v;\n  }\n\n}, 4);\n\nconst getCustomSoundId = sound => \"custom-sound-\".concat(sound);\n\nclass CustomSoundsClass {\n  constructor() {\n    this.play = function (sound) {\n      let {\n        volume = 1,\n        loop = false\n      } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      const audio = document.querySelector(\"#\".concat(getCustomSoundId(sound)));\n\n      if (!audio || !audio.play) {\n        return;\n      }\n\n      audio.volume = volume;\n      audio.loop = loop;\n      audio.play();\n      return audio;\n    };\n\n    this.pause = sound => {\n      const audio = document.querySelector(\"#\".concat(getCustomSoundId(sound)));\n\n      if (!audio || !audio.pause) {\n        return;\n      }\n\n      audio.pause();\n\n      if (audio.currentTime !== 0) {\n        audio.currentTime = 0;\n      }\n    };\n\n    this.list = new ReactiveVar({});\n    this.add({\n      _id: 'chime',\n      name: 'Chime',\n      extension: 'mp3',\n      src: getURL('sounds/chime.mp3')\n    });\n    this.add({\n      _id: 'door',\n      name: 'Door',\n      extension: 'mp3',\n      src: getURL('sounds/door.mp3')\n    });\n    this.add({\n      _id: 'beep',\n      name: 'Beep',\n      extension: 'mp3',\n      src: getURL('sounds/beep.mp3')\n    });\n    this.add({\n      _id: 'chelle',\n      name: 'Chelle',\n      extension: 'mp3',\n      src: getURL('sounds/chelle.mp3')\n    });\n    this.add({\n      _id: 'ding',\n      name: 'Ding',\n      extension: 'mp3',\n      src: getURL('sounds/ding.mp3')\n    });\n    this.add({\n      _id: 'droplet',\n      name: 'Droplet',\n      extension: 'mp3',\n      src: getURL('sounds/droplet.mp3')\n    });\n    this.add({\n      _id: 'highbell',\n      name: 'Highbell',\n      extension: 'mp3',\n      src: getURL('sounds/highbell.mp3')\n    });\n    this.add({\n      _id: 'seasons',\n      name: 'Seasons',\n      extension: 'mp3',\n      src: getURL('sounds/seasons.mp3')\n    });\n    this.add({\n      _id: 'telephone',\n      name: 'Telephone',\n      extension: 'mp3',\n      src: getURL('sounds/telephone.mp3')\n    });\n  }\n\n  add(sound) {\n    if (!sound.src) {\n      sound.src = this.getURL(sound);\n    }\n\n    const audio = $('<audio />', {\n      id: getCustomSoundId(sound._id),\n      preload: true\n    }).append($('<source />', {\n      src: sound.src\n    }));\n    const list = this.list.get();\n    list[sound._id] = sound;\n    this.list.set(list);\n    $('body').append(audio);\n  }\n\n  remove(sound) {\n    const list = this.list.get();\n    delete list[sound._id];\n    this.list.set(list);\n    $(\"#\".concat(sound._id)).remove();\n  }\n\n  update(sound) {\n    const audio = $(\"#\".concat(sound._id));\n\n    if (audio && audio[0]) {\n      const list = this.list.get();\n\n      if (!sound.src) {\n        sound.src = this.getURL(sound);\n      }\n\n      list[sound._id] = sound;\n      this.list.set(list);\n      $('source', audio).attr('src', sound.src);\n      audio[0].load();\n    } else {\n      this.add(sound);\n    }\n  }\n\n  getURL(sound) {\n    return getURL(\"/custom-sounds/\".concat(sound._id, \".\").concat(sound.extension, \"?_dc=\").concat(sound.random || 0));\n  }\n\n  getList() {\n    const list = Object.values(this.list.get());\n    return _.sortBy(list, 'name');\n  }\n\n}\n\nconst CustomSounds = new CustomSoundsClass();\nMeteor.startup(() => CachedCollectionManager.onLogin(() => {\n  Meteor.call('listCustomSounds', (error, result) => {\n    for (const sound of result) {\n      CustomSounds.add(sound);\n    }\n  });\n}));","map":{"version":3,"sources":["app/custom-sounds/client/lib/CustomSounds.js"],"names":["module","export","CustomSounds","Meteor","link","v","ReactiveVar","_","default","CachedCollectionManager","getURL","getCustomSoundId","sound","CustomSoundsClass","constructor","play","volume","loop","audio","document","querySelector","pause","currentTime","list","add","_id","name","extension","src","$","id","preload","append","get","set","remove","update","attr","load","random","getList","Object","values","sortBy","startup","onLogin","call","error","result"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport _ from 'underscore';\n\nimport { CachedCollectionManager } from '../../../ui-cached-collection';\nimport { getURL } from '../../../utils/client';\n\nconst getCustomSoundId = (sound) => `custom-sound-${sound}`;\n\nclass CustomSoundsClass {\n\tconstructor() {\n\t\tthis.list = new ReactiveVar({});\n\t\tthis.add({ _id: 'chime', name: 'Chime', extension: 'mp3', src: getURL('sounds/chime.mp3') });\n\t\tthis.add({ _id: 'door', name: 'Door', extension: 'mp3', src: getURL('sounds/door.mp3') });\n\t\tthis.add({ _id: 'beep', name: 'Beep', extension: 'mp3', src: getURL('sounds/beep.mp3') });\n\t\tthis.add({ _id: 'chelle', name: 'Chelle', extension: 'mp3', src: getURL('sounds/chelle.mp3') });\n\t\tthis.add({ _id: 'ding', name: 'Ding', extension: 'mp3', src: getURL('sounds/ding.mp3') });\n\t\tthis.add({\n\t\t\t_id: 'droplet',\n\t\t\tname: 'Droplet',\n\t\t\textension: 'mp3',\n\t\t\tsrc: getURL('sounds/droplet.mp3'),\n\t\t});\n\t\tthis.add({\n\t\t\t_id: 'highbell',\n\t\t\tname: 'Highbell',\n\t\t\textension: 'mp3',\n\t\t\tsrc: getURL('sounds/highbell.mp3'),\n\t\t});\n\t\tthis.add({\n\t\t\t_id: 'seasons',\n\t\t\tname: 'Seasons',\n\t\t\textension: 'mp3',\n\t\t\tsrc: getURL('sounds/seasons.mp3'),\n\t\t});\n\t\tthis.add({\n\t\t\t_id: 'telephone',\n\t\t\tname: 'Telephone',\n\t\t\textension: 'mp3',\n\t\t\tsrc: getURL('sounds/telephone.mp3'),\n\t\t});\n\t}\n\n\tadd(sound) {\n\t\tif (!sound.src) {\n\t\t\tsound.src = this.getURL(sound);\n\t\t}\n\t\tconst audio = $('<audio />', { id: getCustomSoundId(sound._id), preload: true }).append($('<source />', { src: sound.src }));\n\t\tconst list = this.list.get();\n\t\tlist[sound._id] = sound;\n\t\tthis.list.set(list);\n\t\t$('body').append(audio);\n\t}\n\n\tremove(sound) {\n\t\tconst list = this.list.get();\n\t\tdelete list[sound._id];\n\t\tthis.list.set(list);\n\t\t$(`#${sound._id}`).remove();\n\t}\n\n\tupdate(sound) {\n\t\tconst audio = $(`#${sound._id}`);\n\t\tif (audio && audio[0]) {\n\t\t\tconst list = this.list.get();\n\t\t\tif (!sound.src) {\n\t\t\t\tsound.src = this.getURL(sound);\n\t\t\t}\n\t\t\tlist[sound._id] = sound;\n\t\t\tthis.list.set(list);\n\t\t\t$('source', audio).attr('src', sound.src);\n\t\t\taudio[0].load();\n\t\t} else {\n\t\t\tthis.add(sound);\n\t\t}\n\t}\n\n\tgetURL(sound) {\n\t\treturn getURL(`/custom-sounds/${sound._id}.${sound.extension}?_dc=${sound.random || 0}`);\n\t}\n\n\tgetList() {\n\t\tconst list = Object.values(this.list.get());\n\t\treturn _.sortBy(list, 'name');\n\t}\n\n\tplay = (sound, { volume = 1, loop = false } = {}) => {\n\t\tconst audio = document.querySelector(`#${getCustomSoundId(sound)}`);\n\t\tif (!audio || !audio.play) {\n\t\t\treturn;\n\t\t}\n\n\t\taudio.volume = volume;\n\t\taudio.loop = loop;\n\t\taudio.play();\n\n\t\treturn audio;\n\t};\n\n\tpause = (sound) => {\n\t\tconst audio = document.querySelector(`#${getCustomSoundId(sound)}`);\n\t\tif (!audio || !audio.pause) {\n\t\t\treturn;\n\t\t}\n\n\t\taudio.pause();\n\t\tif (audio.currentTime !== 0) {\n\t\t\taudio.currentTime = 0;\n\t\t}\n\t};\n}\n\nexport const CustomSounds = new CustomSoundsClass();\n\nMeteor.startup(() =>\n\tCachedCollectionManager.onLogin(() => {\n\t\tMeteor.call('listCustomSounds', (error, result) => {\n\t\t\tfor (const sound of result) {\n\t\t\t\tCustomSounds.add(sound);\n\t\t\t}\n\t\t});\n\t}),\n);\n"]},"sourceType":"module","hash":"20a74ee7da6bd72e9dabd96e79087eaeff38ec6a"}
