{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/audit/AuditPage.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"ee/client/audit/AuditPage.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/audit/AuditPage.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/audit/AuditPage.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/client/audit/AuditPage.js"}},"code":"let useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n\n}, 0);\nlet React, useRef, useState;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useRef(v) {\n    useRef = v;\n  },\n\n  useState(v) {\n    useState = v;\n  }\n\n}, 1);\nlet useTranslation;\nmodule.link(\"../../../client/contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 2);\nlet useForm;\nmodule.link(\"../../../client/hooks/useForm\", {\n  useForm(v) {\n    useForm = v;\n  }\n\n}, 3);\nlet AuditPageBase;\nmodule.link(\"./AuditPageBase\", {\n  AuditPageBase(v) {\n    AuditPageBase = v;\n  }\n\n}, 4);\nconst initialValues = {\n  msg: '',\n  type: '',\n  dateRange: {\n    start: '',\n    end: ''\n  },\n  visitor: '',\n  agent: 'all',\n  rid: '',\n  users: []\n};\n\nconst AuditPage = () => {\n  const t = useTranslation();\n  const {\n    values,\n    handlers\n  } = useForm(initialValues);\n  const setData = useRef(() => {});\n  const [errors, setErrors] = useState({});\n  const {\n    msg,\n    type,\n    dateRange: {\n      start: startDate,\n      end: endDate\n    },\n    visitor,\n    agent,\n    users,\n    rid\n  } = values;\n  const {\n    handleMsg,\n    handleType,\n    handleVisitor,\n    handleAgent,\n    handleUsers,\n    handleRid,\n    handleDateRange\n  } = handlers;\n  const onChangeUsers = useMutableCallback((value, action) => {\n    if (!action) {\n      if (users.includes(value)) {\n        return;\n      }\n\n      return handleUsers([...users, value]);\n    }\n\n    handleUsers(users.filter(current => current !== value));\n  });\n  const apply = useMutableCallback(eventStats => {\n    if (!rid && type === '') {\n      return setErrors({\n        rid: t('The_field_is_required', t('Channel_name'))\n      });\n    }\n\n    if (users.length < 2 && type === 'd') {\n      return setErrors({\n        users: t('Select_at_least_two_users')\n      });\n    }\n\n    if (type === 'l') {\n      const errors = {};\n\n      if (agent === '') {\n        errors.agent = t('The_field_is_required', t('Agent'));\n      }\n\n      if (visitor === '') {\n        errors.visitor = t('The_field_is_required', t('Visitor'));\n      }\n\n      if (errors.visitor || errors.agent) {\n        return setErrors(errors);\n      }\n    }\n\n    setErrors({});\n    eventStats();\n    setData.current({\n      msg,\n      type,\n      startDate: new Date(startDate),\n      endDate: new Date(\"\".concat(endDate, \"T23:59:00\")),\n      visitor,\n      agent,\n      users,\n      rid\n    });\n  });\n  return /*#__PURE__*/React.createElement(AuditPageBase, {\n    type: type,\n    handleType: handleType,\n    msg: msg,\n    handleMsg: handleMsg,\n    handleDateRange: handleDateRange,\n    errors: errors,\n    rid: rid,\n    handleRid: handleRid,\n    users: users,\n    handleUsers: handleUsers,\n    onChangeUsers: onChangeUsers,\n    visitor: visitor,\n    handleVisitor: handleVisitor,\n    agent: agent,\n    handleAgent: handleAgent,\n    apply: apply,\n    setData: setData\n  });\n};\n\nmodule.exportDefault(AuditPage);","map":{"version":3,"sources":["ee/client/audit/AuditPage.js"],"names":["useMutableCallback","module","link","v","React","useRef","useState","default","useTranslation","useForm","AuditPageBase","initialValues","msg","type","dateRange","start","end","visitor","agent","rid","users","AuditPage","t","values","handlers","setData","errors","setErrors","startDate","endDate","handleMsg","handleType","handleVisitor","handleAgent","handleUsers","handleRid","handleDateRange","onChangeUsers","value","action","includes","filter","current","apply","eventStats","length","Date","exportDefault"],"mappings":"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","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useRef, useState } from 'react';\n\nimport { useTranslation } from '../../../client/contexts/TranslationContext';\nimport { useForm } from '../../../client/hooks/useForm';\nimport { AuditPageBase } from './AuditPageBase';\n\nconst initialValues = {\n\tmsg: '',\n\ttype: '',\n\tdateRange: {\n\t\tstart: '',\n\t\tend: '',\n\t},\n\tvisitor: '',\n\tagent: 'all',\n\trid: '',\n\tusers: [],\n};\n\nconst AuditPage = () => {\n\tconst t = useTranslation();\n\n\tconst { values, handlers } = useForm(initialValues);\n\tconst setData = useRef(() => {});\n\n\tconst [errors, setErrors] = useState({});\n\n\tconst {\n\t\tmsg,\n\t\ttype,\n\t\tdateRange: { start: startDate, end: endDate },\n\t\tvisitor,\n\t\tagent,\n\t\tusers,\n\t\trid,\n\t} = values;\n\n\tconst { handleMsg, handleType, handleVisitor, handleAgent, handleUsers, handleRid, handleDateRange } = handlers;\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (users.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsers([...users, value]);\n\t\t}\n\t\thandleUsers(users.filter((current) => current !== value));\n\t});\n\n\tconst apply = useMutableCallback((eventStats) => {\n\t\tif (!rid && type === '') {\n\t\t\treturn setErrors({\n\t\t\t\trid: t('The_field_is_required', t('Channel_name')),\n\t\t\t});\n\t\t}\n\n\t\tif (users.length < 2 && type === 'd') {\n\t\t\treturn setErrors({\n\t\t\t\tusers: t('Select_at_least_two_users'),\n\t\t\t});\n\t\t}\n\n\t\tif (type === 'l') {\n\t\t\tconst errors = {};\n\n\t\t\tif (agent === '') {\n\t\t\t\terrors.agent = t('The_field_is_required', t('Agent'));\n\t\t\t}\n\n\t\t\tif (visitor === '') {\n\t\t\t\terrors.visitor = t('The_field_is_required', t('Visitor'));\n\t\t\t}\n\n\t\t\tif (errors.visitor || errors.agent) {\n\t\t\t\treturn setErrors(errors);\n\t\t\t}\n\t\t}\n\n\t\tsetErrors({});\n\t\teventStats();\n\t\tsetData.current({\n\t\t\tmsg,\n\t\t\ttype,\n\t\t\tstartDate: new Date(startDate),\n\t\t\tendDate: new Date(`${endDate}T23:59:00`),\n\t\t\tvisitor,\n\t\t\tagent,\n\t\t\tusers,\n\t\t\trid,\n\t\t});\n\t});\n\n\treturn (\n\t\t<AuditPageBase\n\t\t\ttype={type}\n\t\t\thandleType={handleType}\n\t\t\tmsg={msg}\n\t\t\thandleMsg={handleMsg}\n\t\t\thandleDateRange={handleDateRange}\n\t\t\terrors={errors}\n\t\t\trid={rid}\n\t\t\thandleRid={handleRid}\n\t\t\tusers={users}\n\t\t\thandleUsers={handleUsers}\n\t\t\tonChangeUsers={onChangeUsers}\n\t\t\tvisitor={visitor}\n\t\t\thandleVisitor={handleVisitor}\n\t\t\tagent={agent}\n\t\t\thandleAgent={handleAgent}\n\t\t\tapply={apply}\n\t\t\tsetData={setData}\n\t\t/>\n\t);\n};\n\nexport default AuditPage;\n"]},"sourceType":"module","hash":"f4245044fcaa1facceecdddc06367dbab79f2c23"}
