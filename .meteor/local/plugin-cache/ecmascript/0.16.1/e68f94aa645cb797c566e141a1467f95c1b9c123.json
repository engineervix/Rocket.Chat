{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/analytics/client/trackEvents.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/analytics/client/trackEvents.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/analytics/client/trackEvents.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/analytics/client/trackEvents.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/analytics/client/trackEvents.js"}},"code":"var Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar FlowRouter;\nmodule.link(\"meteor/kadira:flow-router\", {\n  FlowRouter: function (v) {\n    FlowRouter = v;\n  }\n}, 1);\nvar Tracker;\nmodule.link(\"meteor/tracker\", {\n  Tracker: function (v) {\n    Tracker = v;\n  }\n}, 2);\nvar settings;\nmodule.link(\"../../settings\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 3);\nvar callbacks;\nmodule.link(\"../../../lib/callbacks\", {\n  callbacks: function (v) {\n    callbacks = v;\n  }\n}, 4);\nvar ChatRoom;\nmodule.link(\"../../models\", {\n  ChatRoom: function (v) {\n    ChatRoom = v;\n  }\n}, 5);\n\nfunction trackEvent(category, action, label) {\n  if (window._paq) {\n    window._paq.push(['trackEvent', category, action, label]);\n  }\n\n  if (window.ga) {\n    window.ga('send', 'event', category, action, label);\n  }\n}\n\nif (!window._paq || window.ga) {\n  // Trigger the trackPageView manually as the page views are only loaded when the loadScript.js code is executed\n  FlowRouter.triggers.enter([function (route) {\n    if (window._paq) {\n      var http = location.protocol;\n      var slashes = http.concat('//');\n      var host = slashes.concat(window.location.hostname);\n\n      window._paq.push(['setCustomUrl', host + route.path]);\n\n      window._paq.push(['trackPageView']);\n    }\n\n    if (window.ga) {\n      window.ga('send', 'pageview', route.path);\n    }\n  }]); // Login page has manual switches\n\n  callbacks.add('loginPageStateChange', function (state) {\n    trackEvent('Navigation', 'Login Page State Change', state);\n  }, callbacks.priority.MEDIUM, 'analytics-login-state-change'); // Messsages\n\n  callbacks.add('afterSaveMessage', function (message) {\n    if ((window._paq || window.ga) && settings.get('Analytics_features_messages')) {\n      var room = ChatRoom.findOne({\n        _id: message.rid\n      });\n      trackEvent('Message', 'Send', room.name + \" (\" + room._id + \")\");\n    }\n  }, 2000, 'trackEvents'); // Rooms\n\n  callbacks.add('afterCreateChannel', function (owner, room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Create', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-after-create-channel');\n  callbacks.add('roomNameChanged', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Changed Name', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-room-name-changed');\n  callbacks.add('roomTopicChanged', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Changed Topic', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-room-topic-changed');\n  callbacks.add('roomAnnouncementChanged', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Changed Announcement', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-room-announcement-changed');\n  callbacks.add('roomTypeChanged', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Changed Room Type', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-room-type-changed');\n  callbacks.add('archiveRoom', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Archived', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-archive-room');\n  callbacks.add('unarchiveRoom', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Unarchived', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-unarchive-room'); // Users\n  // Track logins and associate user ids with piwik\n\n  (function () {\n    var oldUserId = null;\n    Tracker.autorun(function () {\n      var newUserId = Meteor.userId();\n\n      if (oldUserId === null && newUserId) {\n        if (window._paq && settings.get('Analytics_features_users')) {\n          trackEvent('User', 'Login', newUserId);\n\n          window._paq.push(['setUserId', newUserId]);\n        }\n      } else if (newUserId === null && oldUserId) {\n        if (window._paq && settings.get('Analytics_features_users')) {\n          trackEvent('User', 'Logout', oldUserId);\n        }\n      }\n\n      oldUserId = Meteor.userId();\n    });\n  })();\n\n  callbacks.add('userRegistered', function () {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Registered');\n    }\n  }, callbacks.priority.MEDIUM, 'piwik-user-resitered');\n  callbacks.add('usernameSet', function () {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Username Set');\n    }\n  }, callbacks.priority.MEDIUM, 'piweik-username-set');\n  callbacks.add('userPasswordReset', function () {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Reset Password');\n    }\n  }, callbacks.priority.MEDIUM, 'piwik-user-password-reset');\n  callbacks.add('userConfirmationEmailRequested', function () {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Confirmation Email Requested');\n    }\n  }, callbacks.priority.MEDIUM, 'piwik-user-confirmation-email-requested');\n  callbacks.add('userForgotPasswordEmailRequested', function () {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Forgot Password Email Requested');\n    }\n  }, callbacks.priority.MEDIUM, 'piwik-user-forgot-password-email-requested');\n  callbacks.add('userStatusManuallySet', function (status) {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Status Manually Changed', status);\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-user-status-manually-set');\n  callbacks.add('userAvatarSet', function (service) {\n    if (settings.get('Analytics_features_users')) {\n      trackEvent('User', 'Avatar Changed', service);\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-user-avatar-set');\n  callbacks.add('roomAvatarChanged', function (room) {\n    if (settings.get('Analytics_features_rooms')) {\n      trackEvent('Room', 'Changed Avatar', room.name + \" (\" + room._id + \")\");\n    }\n  }, callbacks.priority.MEDIUM, 'analytics-room-avatar-changed');\n}","map":{"version":3,"sources":["app/analytics/client/trackEvents.js"],"names":["Meteor","module","link","v","FlowRouter","Tracker","settings","callbacks","ChatRoom","trackEvent","category","action","label","window","_paq","push","ga","triggers","enter","route","http","location","protocol","slashes","concat","host","hostname","path","add","state","priority","MEDIUM","message","get","room","findOne","_id","rid","name","owner","oldUserId","autorun","newUserId","userId","status","service"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Tracker } from 'meteor/tracker';\n\nimport { settings } from '../../settings';\nimport { callbacks } from '../../../lib/callbacks';\nimport { ChatRoom } from '../../models';\n\nfunction trackEvent(category, action, label) {\n\tif (window._paq) {\n\t\twindow._paq.push(['trackEvent', category, action, label]);\n\t}\n\tif (window.ga) {\n\t\twindow.ga('send', 'event', category, action, label);\n\t}\n}\n\nif (!window._paq || window.ga) {\n\t// Trigger the trackPageView manually as the page views are only loaded when the loadScript.js code is executed\n\tFlowRouter.triggers.enter([\n\t\t(route) => {\n\t\t\tif (window._paq) {\n\t\t\t\tconst http = location.protocol;\n\t\t\t\tconst slashes = http.concat('//');\n\t\t\t\tconst host = slashes.concat(window.location.hostname);\n\t\t\t\twindow._paq.push(['setCustomUrl', host + route.path]);\n\t\t\t\twindow._paq.push(['trackPageView']);\n\t\t\t}\n\t\t\tif (window.ga) {\n\t\t\t\twindow.ga('send', 'pageview', route.path);\n\t\t\t}\n\t\t},\n\t]);\n\n\t// Login page has manual switches\n\tcallbacks.add(\n\t\t'loginPageStateChange',\n\t\t(state) => {\n\t\t\ttrackEvent('Navigation', 'Login Page State Change', state);\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-login-state-change',\n\t);\n\n\t// Messsages\n\tcallbacks.add(\n\t\t'afterSaveMessage',\n\t\t(message) => {\n\t\t\tif ((window._paq || window.ga) && settings.get('Analytics_features_messages')) {\n\t\t\t\tconst room = ChatRoom.findOne({ _id: message.rid });\n\t\t\t\ttrackEvent('Message', 'Send', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\t2000,\n\t\t'trackEvents',\n\t);\n\n\t// Rooms\n\tcallbacks.add(\n\t\t'afterCreateChannel',\n\t\t(owner, room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Create', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-after-create-channel',\n\t);\n\n\tcallbacks.add(\n\t\t'roomNameChanged',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Changed Name', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-room-name-changed',\n\t);\n\n\tcallbacks.add(\n\t\t'roomTopicChanged',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Changed Topic', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-room-topic-changed',\n\t);\n\n\tcallbacks.add(\n\t\t'roomAnnouncementChanged',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Changed Announcement', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-room-announcement-changed',\n\t);\n\n\tcallbacks.add(\n\t\t'roomTypeChanged',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Changed Room Type', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-room-type-changed',\n\t);\n\n\tcallbacks.add(\n\t\t'archiveRoom',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Archived', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-archive-room',\n\t);\n\n\tcallbacks.add(\n\t\t'unarchiveRoom',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Unarchived', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-unarchive-room',\n\t);\n\n\t// Users\n\t// Track logins and associate user ids with piwik\n\t(() => {\n\t\tlet oldUserId = null;\n\n\t\tTracker.autorun(() => {\n\t\t\tconst newUserId = Meteor.userId();\n\t\t\tif (oldUserId === null && newUserId) {\n\t\t\t\tif (window._paq && settings.get('Analytics_features_users')) {\n\t\t\t\t\ttrackEvent('User', 'Login', newUserId);\n\t\t\t\t\twindow._paq.push(['setUserId', newUserId]);\n\t\t\t\t}\n\t\t\t} else if (newUserId === null && oldUserId) {\n\t\t\t\tif (window._paq && settings.get('Analytics_features_users')) {\n\t\t\t\t\ttrackEvent('User', 'Logout', oldUserId);\n\t\t\t\t}\n\t\t\t}\n\t\t\toldUserId = Meteor.userId();\n\t\t});\n\t})();\n\n\tcallbacks.add(\n\t\t'userRegistered',\n\t\t() => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Registered');\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'piwik-user-resitered',\n\t);\n\n\tcallbacks.add(\n\t\t'usernameSet',\n\t\t() => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Username Set');\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'piweik-username-set',\n\t);\n\n\tcallbacks.add(\n\t\t'userPasswordReset',\n\t\t() => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Reset Password');\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'piwik-user-password-reset',\n\t);\n\n\tcallbacks.add(\n\t\t'userConfirmationEmailRequested',\n\t\t() => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Confirmation Email Requested');\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'piwik-user-confirmation-email-requested',\n\t);\n\n\tcallbacks.add(\n\t\t'userForgotPasswordEmailRequested',\n\t\t() => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Forgot Password Email Requested');\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'piwik-user-forgot-password-email-requested',\n\t);\n\n\tcallbacks.add(\n\t\t'userStatusManuallySet',\n\t\t(status) => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Status Manually Changed', status);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-user-status-manually-set',\n\t);\n\n\tcallbacks.add(\n\t\t'userAvatarSet',\n\t\t(service) => {\n\t\t\tif (settings.get('Analytics_features_users')) {\n\t\t\t\ttrackEvent('User', 'Avatar Changed', service);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-user-avatar-set',\n\t);\n\n\tcallbacks.add(\n\t\t'roomAvatarChanged',\n\t\t(room) => {\n\t\t\tif (settings.get('Analytics_features_rooms')) {\n\t\t\t\ttrackEvent('Room', 'Changed Avatar', `${room.name} (${room._id})`);\n\t\t\t}\n\t\t},\n\t\tcallbacks.priority.MEDIUM,\n\t\t'analytics-room-avatar-changed',\n\t);\n}\n"]},"sourceType":"module","hash":"e68f94aa645cb797c566e141a1467f95c1b9c123"}
