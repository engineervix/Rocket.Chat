{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-message/client/messageBox/messageBoxNotSubscribed.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/ui-message/client/messageBox/messageBoxNotSubscribed.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-message/client/messageBox/messageBoxNotSubscribed.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui-message/client/messageBox/messageBoxNotSubscribed.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-message/client/messageBox/messageBoxNotSubscribed.js"}},"code":"let Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Session;\nmodule.link(\"meteor/session\", {\n  Session(v) {\n    Session = v;\n  }\n\n}, 1);\nlet Template;\nmodule.link(\"meteor/templating\", {\n  Template(v) {\n    Template = v;\n  }\n\n}, 2);\nlet settings;\nmodule.link(\"../../../settings/client\", {\n  settings(v) {\n    settings = v;\n  }\n\n}, 3);\nlet RoomManager, RoomHistoryManager;\nmodule.link(\"../../../ui-utils/client\", {\n  RoomManager(v) {\n    RoomManager = v;\n  },\n\n  RoomHistoryManager(v) {\n    RoomHistoryManager = v;\n  }\n\n}, 4);\nlet hasAllPermission;\nmodule.link(\"../../../authorization/client\", {\n  hasAllPermission(v) {\n    hasAllPermission = v;\n  }\n\n}, 5);\nmodule.link(\"./messageBoxNotSubscribed.html\");\nlet call;\nmodule.link(\"../../../../client/lib/utils/call\", {\n  call(v) {\n    call = v;\n  }\n\n}, 6);\nlet roomCoordinator;\nmodule.link(\"../../../../client/lib/rooms/roomCoordinator\", {\n  roomCoordinator(v) {\n    roomCoordinator = v;\n  }\n\n}, 7);\nTemplate.messageBoxNotSubscribed.helpers({\n  customTemplate() {\n    var _roomCoordinator$getR;\n\n    return (_roomCoordinator$getR = roomCoordinator.getRoomTypeConfigById(this.rid)) === null || _roomCoordinator$getR === void 0 ? void 0 : _roomCoordinator$getR.notSubscribedTpl;\n  },\n\n  canJoinRoom() {\n    var _roomCoordinator$getR2;\n\n    return Meteor.userId() && ((_roomCoordinator$getR2 = roomCoordinator.getRoomDirectivesById(this.rid)) === null || _roomCoordinator$getR2 === void 0 ? void 0 : _roomCoordinator$getR2.showJoinLink(this.rid));\n  },\n\n  roomName() {\n    const room = Session.get(\"roomData\".concat(this.rid));\n    return roomCoordinator.getRoomName(room.t, room);\n  },\n\n  isJoinCodeRequired() {\n    const room = Session.get(\"roomData\".concat(this.rid));\n    return room && room.joinCodeRequired;\n  },\n\n  isAnonymousReadAllowed() {\n    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true;\n  },\n\n  isAnonymousWriteAllowed() {\n    return Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true && settings.get('Accounts_AllowAnonymousWrite') === true;\n  }\n\n});\nTemplate.messageBoxNotSubscribed.events({\n  async 'click .js-join-code'(event) {\n    event.stopPropagation();\n    event.preventDefault();\n    const joinCodeInput = Template.instance().find('[name=joinCode]');\n    const joinCode = joinCodeInput && joinCodeInput.value;\n    await call('joinRoom', this.rid, joinCode);\n\n    if (hasAllPermission('preview-c-room') === false && RoomHistoryManager.getRoom(this.rid).loaded === 0) {\n      RoomManager.getOpenedRoomByRid(this.rid).streamActive = false;\n      RoomManager.getOpenedRoomByRid(this.rid).ready = false;\n      RoomHistoryManager.getRoom(this.rid).loaded = null;\n      RoomManager.computation.invalidate();\n    }\n  },\n\n  'click .js-register'(event) {\n    event.stopPropagation();\n    event.preventDefault();\n    Session.set('forceLogin', true);\n  },\n\n  async 'click .js-register-anonymous'(event) {\n    event.stopPropagation();\n    event.preventDefault();\n    const {\n      token\n    } = await call('registerUser', {});\n    Meteor.loginWithToken(token);\n  }\n\n});","map":{"version":3,"sources":["app/ui-message/client/messageBox/messageBoxNotSubscribed.js"],"names":["Meteor","module","link","v","Session","Template","settings","RoomManager","RoomHistoryManager","hasAllPermission","call","roomCoordinator","messageBoxNotSubscribed","helpers","customTemplate","getRoomTypeConfigById","rid","notSubscribedTpl","canJoinRoom","userId","getRoomDirectivesById","showJoinLink","roomName","room","get","getRoomName","t","isJoinCodeRequired","joinCodeRequired","isAnonymousReadAllowed","isAnonymousWriteAllowed","events","event","stopPropagation","preventDefault","joinCodeInput","instance","find","joinCode","value","getRoom","loaded","getOpenedRoomByRid","streamActive","ready","computation","invalidate","set","token","loginWithToken"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { Template } from 'meteor/templating';\n\nimport { settings } from '../../../settings/client';\nimport { RoomManager, RoomHistoryManager } from '../../../ui-utils/client';\nimport { hasAllPermission } from '../../../authorization/client';\nimport './messageBoxNotSubscribed.html';\nimport { call } from '../../../../client/lib/utils/call';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\n\nTemplate.messageBoxNotSubscribed.helpers({\n\tcustomTemplate() {\n\t\treturn roomCoordinator.getRoomTypeConfigById(this.rid)?.notSubscribedTpl;\n\t},\n\tcanJoinRoom() {\n\t\treturn Meteor.userId() && roomCoordinator.getRoomDirectivesById(this.rid)?.showJoinLink(this.rid);\n\t},\n\troomName() {\n\t\tconst room = Session.get(`roomData${this.rid}`);\n\t\treturn roomCoordinator.getRoomName(room.t, room);\n\t},\n\tisJoinCodeRequired() {\n\t\tconst room = Session.get(`roomData${this.rid}`);\n\t\treturn room && room.joinCodeRequired;\n\t},\n\tisAnonymousReadAllowed() {\n\t\treturn Meteor.userId() == null && settings.get('Accounts_AllowAnonymousRead') === true;\n\t},\n\tisAnonymousWriteAllowed() {\n\t\treturn (\n\t\t\tMeteor.userId() == null &&\n\t\t\tsettings.get('Accounts_AllowAnonymousRead') === true &&\n\t\t\tsettings.get('Accounts_AllowAnonymousWrite') === true\n\t\t);\n\t},\n});\n\nTemplate.messageBoxNotSubscribed.events({\n\tasync 'click .js-join-code'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst joinCodeInput = Template.instance().find('[name=joinCode]');\n\t\tconst joinCode = joinCodeInput && joinCodeInput.value;\n\n\t\tawait call('joinRoom', this.rid, joinCode);\n\n\t\tif (hasAllPermission('preview-c-room') === false && RoomHistoryManager.getRoom(this.rid).loaded === 0) {\n\t\t\tRoomManager.getOpenedRoomByRid(this.rid).streamActive = false;\n\t\t\tRoomManager.getOpenedRoomByRid(this.rid).ready = false;\n\t\t\tRoomHistoryManager.getRoom(this.rid).loaded = null;\n\t\t\tRoomManager.computation.invalidate();\n\t\t}\n\t},\n\t'click .js-register'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tSession.set('forceLogin', true);\n\t},\n\tasync 'click .js-register-anonymous'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tconst { token } = await call('registerUser', {});\n\t\tMeteor.loginWithToken(token);\n\t},\n});\n"]},"sourceType":"module","hash":"4423b8dd6fc7fca0fd5977990492deb08222cb18"}
