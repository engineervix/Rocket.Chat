{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/avatar/UserAvatarEditor/UserAvatarEditor.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/components/avatar/UserAvatarEditor/UserAvatarEditor.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/avatar/UserAvatarEditor/UserAvatarEditor.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/avatar/UserAvatarEditor/UserAvatarEditor.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/components/avatar/UserAvatarEditor/UserAvatarEditor.js"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\nvar Box, Button, Icon, TextInput, Margins, Avatar;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  Margins: function (v) {\n    Margins = v;\n  },\n  Avatar: function (v) {\n    Avatar = v;\n  }\n}, 0);\nvar React, useState, useCallback;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  }\n}, 1);\nvar useSetting;\nmodule.link(\"../../../contexts/SettingsContext\", {\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 2);\nvar useToastMessageDispatch;\nmodule.link(\"../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  }\n}, 3);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 4);\nvar useFileInput;\nmodule.link(\"../../../hooks/useFileInput\", {\n  useFileInput: function (v) {\n    useFileInput = v;\n  }\n}, 5);\nvar UserAvatar;\nmodule.link(\"../UserAvatar\", {\n  \"default\": function (v) {\n    UserAvatar = v;\n  }\n}, 6);\nvar UserAvatarSuggestions;\nmodule.link(\"./UserAvatarSuggestions\", {\n  \"default\": function (v) {\n    UserAvatarSuggestions = v;\n  }\n}, 7);\n\nfunction UserAvatarEditor(_ref) {\n  var currentUsername = _ref.currentUsername,\n      username = _ref.username,\n      setAvatarObj = _ref.setAvatarObj,\n      suggestions = _ref.suggestions,\n      disabled = _ref.disabled,\n      etag = _ref.etag;\n  var t = useTranslation();\n  var rotateImages = useSetting('FileUpload_RotateImages');\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      avatarFromUrl = _useState2[0],\n      setAvatarFromUrl = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      newAvatarSource = _useState4[0],\n      setNewAvatarSource = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      urlEmpty = _useState6[0],\n      setUrlEmpty = _useState6[1];\n\n  var dispatchToastMessage = useToastMessageDispatch();\n\n  var toDataURL = function (file, callback) {\n    var reader = new FileReader();\n\n    reader.onload = function (e) {\n      callback(e.target.result);\n    };\n\n    reader.readAsDataURL(file);\n  };\n\n  var setUploadedPreview = useCallback(function () {\n    function _callee(file, avatarObj) {\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (file.type.startsWith('image/')) {\n                  setAvatarObj(avatarObj);\n                  toDataURL(file, function (dataurl) {\n                    setNewAvatarSource(dataurl);\n                  });\n                } else dispatchToastMessage({\n                  type: 'error',\n                  message: t('Avatar_format_invalid')\n                });\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n\n    return _callee;\n  }(), [setAvatarObj, t, dispatchToastMessage]);\n\n  var _useFileInput = useFileInput(setUploadedPreview),\n      _useFileInput2 = _slicedToArray(_useFileInput, 1),\n      clickUpload = _useFileInput2[0];\n\n  var clickUrl = function () {\n    if (avatarFromUrl === '') {\n      return;\n    }\n\n    setNewAvatarSource(avatarFromUrl);\n    setAvatarObj({\n      avatarUrl: avatarFromUrl\n    });\n  };\n\n  var clickReset = function () {\n    setNewAvatarSource(\"/avatar/%40\" + username);\n    setAvatarObj('reset');\n  };\n\n  var url = newAvatarSource;\n\n  var handleAvatarFromUrlChange = function (event) {\n    event.currentTarget.value !== '' ? setUrlEmpty(false) : setUrlEmpty(true);\n    setAvatarFromUrl(event.currentTarget.value);\n  };\n\n  return /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    fontScale: \"p2m\"\n  }, t('Profile_picture'), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\",\n    mbs: \"x4\"\n  }, /*#__PURE__*/React.createElement(UserAvatar, {\n    size: \"x124\",\n    url: url,\n    username: currentUsername,\n    etag: etag,\n    style: {\n      objectFit: 'contain',\n      imageOrientation: rotateImages ? 'from-image' : 'none'\n    },\n    mie: \"x4\"\n  }), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: \"1\",\n    justifyContent: \"space-between\",\n    mis: \"x4\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\",\n    mbs: \"none\"\n  }, /*#__PURE__*/React.createElement(Margins, {\n    inline: \"x4\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    square: true,\n    mis: \"none\",\n    onClick: clickReset,\n    disabled: disabled,\n    mie: \"x4\",\n    title: t('Accounts_SetDefaultAvatar')\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    url: \"/avatar/%40\" + username\n  })), /*#__PURE__*/React.createElement(Button, {\n    square: true,\n    onClick: clickUpload,\n    disabled: disabled,\n    title: t('Upload')\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"upload\",\n    size: \"x20\"\n  })), /*#__PURE__*/React.createElement(Button, {\n    square: true,\n    mie: \"none\",\n    onClick: clickUrl,\n    disabled: disabled || urlEmpty,\n    title: t('Add URL')\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"permalink\",\n    size: \"x20\"\n  })), suggestions && /*#__PURE__*/React.createElement(UserAvatarSuggestions, {\n    suggestions: suggestions,\n    setAvatarObj: setAvatarObj,\n    setNewAvatarSource: setNewAvatarSource,\n    disabled: disabled\n  }))), /*#__PURE__*/React.createElement(Margins, {\n    inlineStart: \"x4\"\n  }, /*#__PURE__*/React.createElement(Box, null, t('Use_url_for_avatar')), /*#__PURE__*/React.createElement(TextInput, {\n    flexGrow: 0,\n    placeholder: t('Use_url_for_avatar'),\n    value: avatarFromUrl,\n    onChange: handleAvatarFromUrlChange\n  })))));\n}\n\nmodule.exportDefault(UserAvatarEditor);","map":{"version":3,"sources":["client/components/avatar/UserAvatarEditor/UserAvatarEditor.js"],"names":["_regeneratorRuntime","module","link","default","v","_slicedToArray","Box","Button","Icon","TextInput","Margins","Avatar","React","useState","useCallback","useSetting","useToastMessageDispatch","useTranslation","useFileInput","UserAvatar","UserAvatarSuggestions","UserAvatarEditor","currentUsername","username","setAvatarObj","suggestions","disabled","etag","t","rotateImages","avatarFromUrl","setAvatarFromUrl","newAvatarSource","setNewAvatarSource","urlEmpty","setUrlEmpty","dispatchToastMessage","toDataURL","file","callback","reader","FileReader","onload","e","target","result","readAsDataURL","setUploadedPreview","avatarObj","type","startsWith","dataurl","message","clickUpload","clickUrl","avatarUrl","clickReset","url","handleAvatarFromUrlChange","event","currentTarget","value","objectFit","imageOrientation","exportDefault"],"mappings":"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","sourcesContent":["import { Box, Button, Icon, TextInput, Margins, Avatar } from '@rocket.chat/fuselage';\nimport React, { useState, useCallback } from 'react';\n\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useFileInput } from '../../../hooks/useFileInput';\nimport UserAvatar from '../UserAvatar';\nimport UserAvatarSuggestions from './UserAvatarSuggestions';\n\nfunction UserAvatarEditor({ currentUsername, username, setAvatarObj, suggestions, disabled, etag }) {\n\tconst t = useTranslation();\n\tconst rotateImages = useSetting('FileUpload_RotateImages');\n\tconst [avatarFromUrl, setAvatarFromUrl] = useState('');\n\tconst [newAvatarSource, setNewAvatarSource] = useState();\n\tconst [urlEmpty, setUrlEmpty] = useState(true);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst toDataURL = (file, callback) => {\n\t\tconst reader = new FileReader();\n\t\treader.onload = function (e) {\n\t\t\tcallback(e.target.result);\n\t\t};\n\t\treader.readAsDataURL(file);\n\t};\n\n\tconst setUploadedPreview = useCallback(\n\t\tasync (file, avatarObj) => {\n\t\t\tif (file.type.startsWith('image/')) {\n\t\t\t\tsetAvatarObj(avatarObj);\n\t\t\t\ttoDataURL(file, (dataurl) => {\n\t\t\t\t\tsetNewAvatarSource(dataurl);\n\t\t\t\t});\n\t\t\t} else dispatchToastMessage({ type: 'error', message: t('Avatar_format_invalid') });\n\t\t},\n\t\t[setAvatarObj, t, dispatchToastMessage],\n\t);\n\n\tconst [clickUpload] = useFileInput(setUploadedPreview);\n\n\tconst clickUrl = () => {\n\t\tif (avatarFromUrl === '') {\n\t\t\treturn;\n\t\t}\n\t\tsetNewAvatarSource(avatarFromUrl);\n\t\tsetAvatarObj({ avatarUrl: avatarFromUrl });\n\t};\n\tconst clickReset = () => {\n\t\tsetNewAvatarSource(`/avatar/%40${username}`);\n\t\tsetAvatarObj('reset');\n\t};\n\n\tconst url = newAvatarSource;\n\n\tconst handleAvatarFromUrlChange = (event) => {\n\t\tevent.currentTarget.value !== '' ? setUrlEmpty(false) : setUrlEmpty(true);\n\t\tsetAvatarFromUrl(event.currentTarget.value);\n\t};\n\n\treturn (\n\t\t<Box display='flex' flexDirection='column' fontScale='p2m'>\n\t\t\t{t('Profile_picture')}\n\t\t\t<Box display='flex' flexDirection='row' mbs='x4'>\n\t\t\t\t<UserAvatar\n\t\t\t\t\tsize='x124'\n\t\t\t\t\turl={url}\n\t\t\t\t\tusername={currentUsername}\n\t\t\t\t\tetag={etag}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tobjectFit: 'contain',\n\t\t\t\t\t\timageOrientation: rotateImages ? 'from-image' : 'none',\n\t\t\t\t\t}}\n\t\t\t\t\tmie='x4'\n\t\t\t\t/>\n\t\t\t\t<Box display='flex' flexDirection='column' flexGrow='1' justifyContent='space-between' mis='x4'>\n\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none'>\n\t\t\t\t\t\t<Margins inline='x4'>\n\t\t\t\t\t\t\t<Button square mis='none' onClick={clickReset} disabled={disabled} mie='x4' title={t('Accounts_SetDefaultAvatar')}>\n\t\t\t\t\t\t\t\t<Avatar url={`/avatar/%40${username}`} />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button square onClick={clickUpload} disabled={disabled} title={t('Upload')}>\n\t\t\t\t\t\t\t\t<Icon name='upload' size='x20' />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button square mie='none' onClick={clickUrl} disabled={disabled || urlEmpty} title={t('Add URL')}>\n\t\t\t\t\t\t\t\t<Icon name='permalink' size='x20' />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t{suggestions && (\n\t\t\t\t\t\t\t\t<UserAvatarSuggestions\n\t\t\t\t\t\t\t\t\tsuggestions={suggestions}\n\t\t\t\t\t\t\t\t\tsetAvatarObj={setAvatarObj}\n\t\t\t\t\t\t\t\t\tsetNewAvatarSource={setNewAvatarSource}\n\t\t\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Margins inlineStart='x4'>\n\t\t\t\t\t\t<Box>{t('Use_url_for_avatar')}</Box>\n\t\t\t\t\t\t<TextInput flexGrow={0} placeholder={t('Use_url_for_avatar')} value={avatarFromUrl} onChange={handleAvatarFromUrlChange} />\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t</Box>\n\t);\n}\n\nexport default UserAvatarEditor;\n"]},"sourceType":"module","hash":"78952216c4ab362e1bb0d505aa26d7337f24e7cf"}
