{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/analytics/client/loadScript.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/analytics/client/loadScript.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/analytics/client/loadScript.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/analytics/client/loadScript.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/analytics/client/loadScript.js"}},"code":"var Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Template;\nmodule.link(\"meteor/templating\", {\n  Template: function (v) {\n    Template = v;\n  }\n}, 1);\nvar settings;\nmodule.link(\"../../settings\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 2);\nTemplate.body.onRendered(function () {\n  this.autorun(function (c) {\n    var piwikUrl = settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url');\n    var piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');\n    var piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');\n    var piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');\n    var piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');\n    var piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');\n    var googleId = settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID');\n\n    if (piwikSiteId || googleId) {\n      c.stop();\n\n      if (piwikSiteId) {\n        window._paq = window._paq || [];\n\n        if (Meteor.userId()) {\n          window._paq.push(['setUserId', Meteor.userId()]);\n        }\n\n        window._paq.push(['trackPageView']);\n\n        window._paq.push(['enableLinkTracking']);\n\n        if (piwikPrependDomain) {\n          window._paq.push(['setDocumentTitle', window.location.hostname + \"/\" + document.title]);\n        }\n\n        var upperLevelDomain = \"*.\" + window.location.hostname.split('.').slice(1).join('.');\n\n        if (piwikCookieDomain) {\n          window._paq.push(['setCookieDomain', upperLevelDomain]);\n        }\n\n        if (piwikDomains) {\n          // array\n          var domainsArray = piwikDomains.split(/\\n/);\n          var domains = [];\n\n          for (var i = 0; i < domainsArray.length; i++) {\n            // only push domain if it contains a non whitespace character.\n            if (/\\S/.test(domainsArray[i])) {\n              domains.push(\"*.\" + domainsArray[i].trim());\n            }\n          }\n\n          window._paq.push(['setDomains', domains]);\n        }\n\n        (function () {\n          try {\n            if (/\\S/.test(piwikAdditionalTracker)) {\n              // piwikAdditionalTracker is not empty or whitespace only\n              var addTrackers = JSON.parse(piwikAdditionalTracker);\n\n              for (var _i = 0; _i < addTrackers.length; _i++) {\n                var tracker = addTrackers[_i];\n\n                window._paq.push(['addTracker', tracker.trackerURL + \"js/\", tracker.siteId]);\n              }\n            }\n          } catch (e) {\n            // parsing JSON faild\n            console.log('Error while parsing JSON value of \"piwikAdditionalTracker\": ', e);\n          }\n\n          window._paq.push(['setTrackerUrl', piwikUrl + \"js/\"]);\n\n          window._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);\n\n          var d = document;\n          var g = d.createElement('script');\n          var s = d.getElementsByTagName('script')[0];\n          g.type = 'text/javascript';\n          g.async = true;\n          g.defer = true;\n          g.src = piwikUrl + \"js/\";\n          s.parentNode.insertBefore(g, s);\n        })();\n      }\n\n      if (googleId) {\n        /*eslint-disable */\n        (function (i, s, o, g, r, a, m) {\n          i['GoogleAnalyticsObject'] = r;\n          i[r] = i[r] || function () {\n            (i[r].q = i[r].q || []).push(arguments);\n          }, i[r].l = 1 * new Date();\n          a = s.createElement(o), m = s.getElementsByTagName(o)[0];\n          a.async = 1;\n          a.src = g;\n          m.parentNode.insertBefore(a, m);\n        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');\n\n        ga('create', googleId, 'auto');\n        ga('send', 'pageview');\n        /* eslint-enable */\n      }\n    }\n  });\n});","map":{"version":3,"sources":["app/analytics/client/loadScript.js"],"names":["Meteor","module","link","v","Template","settings","body","onRendered","autorun","c","piwikUrl","get","piwikSiteId","piwikPrependDomain","piwikCookieDomain","piwikDomains","piwikAdditionalTracker","googleId","stop","window","_paq","userId","push","location","hostname","document","title","upperLevelDomain","split","slice","join","domainsArray","domains","i","length","test","trim","addTrackers","JSON","parse","tracker","trackerURL","siteId","e","console","log","Number","parseInt","d","g","createElement","s","getElementsByTagName","type","async","defer","src","parentNode","insertBefore","o","r","a","m","q","arguments","l","Date","ga"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Template } from 'meteor/templating';\n\nimport { settings } from '../../settings';\n\nTemplate.body.onRendered(function () {\n\tthis.autorun((c) => {\n\t\tconst piwikUrl = settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url');\n\t\tconst piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');\n\t\tconst piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');\n\t\tconst piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');\n\t\tconst piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');\n\t\tconst piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');\n\t\tconst googleId = settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID');\n\t\tif (piwikSiteId || googleId) {\n\t\t\tc.stop();\n\n\t\t\tif (piwikSiteId) {\n\t\t\t\twindow._paq = window._paq || [];\n\t\t\t\tif (Meteor.userId()) {\n\t\t\t\t\twindow._paq.push(['setUserId', Meteor.userId()]);\n\t\t\t\t}\n\n\t\t\t\twindow._paq.push(['trackPageView']);\n\t\t\t\twindow._paq.push(['enableLinkTracking']);\n\t\t\t\tif (piwikPrependDomain) {\n\t\t\t\t\twindow._paq.push(['setDocumentTitle', `${window.location.hostname}/${document.title}`]);\n\t\t\t\t}\n\t\t\t\tconst upperLevelDomain = `*.${window.location.hostname.split('.').slice(1).join('.')}`;\n\t\t\t\tif (piwikCookieDomain) {\n\t\t\t\t\twindow._paq.push(['setCookieDomain', upperLevelDomain]);\n\t\t\t\t}\n\t\t\t\tif (piwikDomains) {\n\t\t\t\t\t// array\n\t\t\t\t\tconst domainsArray = piwikDomains.split(/\\n/);\n\t\t\t\t\tconst domains = [];\n\t\t\t\t\tfor (let i = 0; i < domainsArray.length; i++) {\n\t\t\t\t\t\t// only push domain if it contains a non whitespace character.\n\t\t\t\t\t\tif (/\\S/.test(domainsArray[i])) {\n\t\t\t\t\t\t\tdomains.push(`*.${domainsArray[i].trim()}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twindow._paq.push(['setDomains', domains]);\n\t\t\t\t}\n\t\t\t\t(() => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (/\\S/.test(piwikAdditionalTracker)) {\n\t\t\t\t\t\t\t// piwikAdditionalTracker is not empty or whitespace only\n\t\t\t\t\t\t\tconst addTrackers = JSON.parse(piwikAdditionalTracker);\n\t\t\t\t\t\t\tfor (let i = 0; i < addTrackers.length; i++) {\n\t\t\t\t\t\t\t\tconst tracker = addTrackers[i];\n\t\t\t\t\t\t\t\twindow._paq.push(['addTracker', `${tracker.trackerURL}js/`, tracker.siteId]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// parsing JSON faild\n\t\t\t\t\t\tconsole.log('Error while parsing JSON value of \"piwikAdditionalTracker\": ', e);\n\t\t\t\t\t}\n\t\t\t\t\twindow._paq.push(['setTrackerUrl', `${piwikUrl}js/`]);\n\t\t\t\t\twindow._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);\n\t\t\t\t\tconst d = document;\n\t\t\t\t\tconst g = d.createElement('script');\n\t\t\t\t\tconst s = d.getElementsByTagName('script')[0];\n\t\t\t\t\tg.type = 'text/javascript';\n\t\t\t\t\tg.async = true;\n\t\t\t\t\tg.defer = true;\n\t\t\t\t\tg.src = `${piwikUrl}js/`;\n\t\t\t\t\ts.parentNode.insertBefore(g, s);\n\t\t\t\t})();\n\t\t\t}\n\n\t\t\tif (googleId) {\n\t\t\t\t/*eslint-disable */\n\t\t\t  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n\t\t\t  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n\t\t\t  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n\t\t\t  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n\n\t\t\t  ga('create', googleId, 'auto');\n\t\t\t  ga('send', 'pageview');\n\t\t\t\t/* eslint-enable */\n\t\t\t}\n\t\t}\n\t});\n});\n"]},"sourceType":"module","hash":"dc8610ccc5239ef4f6af147e9654ec4e043ed177"}
