{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/permissions/PermissionsTable.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/permissions/PermissionsTable.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/permissions/PermissionsTable.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/permissions/PermissionsTable.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/permissions/PermissionsTable.js"}},"code":"let Margins, Icon, Tabs, Button;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Margins(v) {\n    Margins = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  },\n\n  Tabs(v) {\n    Tabs = v;\n  },\n\n  Button(v) {\n    Button = v;\n  }\n\n}, 0);\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n\n}, 1);\nlet React, useState, useCallback;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useState(v) {\n    useState = v;\n  },\n\n  useCallback(v) {\n    useCallback = v;\n  }\n\n}, 2);\nlet GenericTable;\nmodule.link(\"../../../components/GenericTable\", {\n  default(v) {\n    GenericTable = v;\n  }\n\n}, 3);\nlet Page;\nmodule.link(\"../../../components/Page\", {\n  default(v) {\n    Page = v;\n  }\n\n}, 4);\nlet usePermission;\nmodule.link(\"../../../contexts/AuthorizationContext\", {\n  usePermission(v) {\n    usePermission = v;\n  }\n\n}, 5);\nlet useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute(v) {\n    useRoute = v;\n  }\n\n}, 6);\nlet useMethod;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod(v) {\n    useMethod = v;\n  }\n\n}, 7);\nlet useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 8);\nlet FilterComponent;\nmodule.link(\"./FilterComponent\", {\n  default(v) {\n    FilterComponent = v;\n  }\n\n}, 9);\nlet PermissionRow;\nmodule.link(\"./PermissionRow\", {\n  default(v) {\n    PermissionRow = v;\n  }\n\n}, 10);\nlet PermissionsContextBar;\nmodule.link(\"./PermissionsContextBar\", {\n  default(v) {\n    PermissionsContextBar = v;\n  }\n\n}, 11);\nlet RoleHeader;\nmodule.link(\"./RoleHeader\", {\n  default(v) {\n    RoleHeader = v;\n  }\n\n}, 12);\nlet usePermissionsAndRoles;\nmodule.link(\"./hooks/usePermissionsAndRoles\", {\n  usePermissionsAndRoles(v) {\n    usePermissionsAndRoles = v;\n  }\n\n}, 13);\n\nconst PermissionsTable = () => {\n  const t = useTranslation();\n  const [filter, setFilter] = useState('');\n  const canViewPermission = usePermission('access-permissions');\n  const canViewSettingPermission = usePermission('access-setting-permissions');\n  const defaultType = canViewPermission ? 'permissions' : 'settings';\n  const [type, setType] = useState(defaultType);\n  const [params, setParams] = useState({\n    limit: 25,\n    skip: 0\n  });\n  const router = useRoute('admin-permissions');\n  const grantRole = useMethod('authorization:addPermissionToRole');\n  const removeRole = useMethod('authorization:removeRoleFromPermission');\n  const permissionsData = usePermissionsAndRoles(type, filter, params.limit, params.skip);\n  const [permissions, total, roleList] = permissionsData;\n  const handleParams = useMutableCallback(_ref => {\n    let {\n      current,\n      itemsPerPage\n    } = _ref;\n    setParams({\n      skip: current,\n      limit: itemsPerPage\n    });\n  });\n  const handlePermissionsTab = useMutableCallback(() => {\n    if (type === 'permissions') {\n      return;\n    }\n\n    setType('permissions');\n  });\n  const handleSettingsTab = useMutableCallback(() => {\n    if (type === 'settings') {\n      return;\n    }\n\n    setType('settings');\n  });\n  const handleAdd = useMutableCallback(() => {\n    router.push({\n      context: 'new'\n    });\n  });\n  return /*#__PURE__*/React.createElement(Page, {\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: t('Permissions')\n  }, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleAdd,\n    \"aria-label\": t('New')\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"plus\"\n  }), \" \", t('New_role'))), /*#__PURE__*/React.createElement(Margins, {\n    blockEnd: \"x16\"\n  }, /*#__PURE__*/React.createElement(Tabs, null, /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: type === 'permissions',\n    onClick: handlePermissionsTab,\n    disabled: !canViewPermission\n  }, t('Permissions')), /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: type === 'settings',\n    onClick: handleSettingsTab,\n    disabled: !canViewSettingPermission\n  }, t('Settings')))), /*#__PURE__*/React.createElement(Page.Content, {\n    mb: \"neg-x8\"\n  }, /*#__PURE__*/React.createElement(Margins, {\n    block: \"x8\"\n  }, /*#__PURE__*/React.createElement(FilterComponent, {\n    onChange: setFilter\n  }), /*#__PURE__*/React.createElement(GenericTable, {\n    header: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(GenericTable.HeaderCell, {\n      width: \"x120\"\n    }, t('Name')), roleList.map(_ref2 => {\n      let {\n        _id,\n        name,\n        description\n      } = _ref2;\n      return /*#__PURE__*/React.createElement(RoleHeader, {\n        key: _id,\n        _id: _id,\n        name: name,\n        description: description,\n        router: router\n      });\n    })),\n    total: total,\n    results: permissions,\n    params: params,\n    setParams: handleParams,\n    fixed: false\n  }, useCallback(permission => /*#__PURE__*/React.createElement(PermissionRow, {\n    key: permission._id,\n    permission: permission,\n    t: t,\n    roleList: roleList,\n    onGrant: grantRole,\n    onRemove: removeRole\n  }), [grantRole, removeRole, roleList, t]))))), /*#__PURE__*/React.createElement(PermissionsContextBar, null));\n};\n\nmodule.exportDefault(PermissionsTable);","map":{"version":3,"sources":["client/views/admin/permissions/PermissionsTable.js"],"names":["Margins","Icon","Tabs","Button","module","link","v","useMutableCallback","React","useState","useCallback","default","GenericTable","Page","usePermission","useRoute","useMethod","useTranslation","FilterComponent","PermissionRow","PermissionsContextBar","RoleHeader","usePermissionsAndRoles","PermissionsTable","t","filter","setFilter","canViewPermission","canViewSettingPermission","defaultType","type","setType","params","setParams","limit","skip","router","grantRole","removeRole","permissionsData","permissions","total","roleList","handleParams","current","itemsPerPage","handlePermissionsTab","handleSettingsTab","handleAdd","push","context","map","_id","name","description","permission","exportDefault"],"mappings":"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","sourcesContent":["import { Margins, Icon, Tabs, Button } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useState, useCallback } from 'react';\n\nimport GenericTable from '../../../components/GenericTable';\nimport Page from '../../../components/Page';\nimport { usePermission } from '../../../contexts/AuthorizationContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport FilterComponent from './FilterComponent';\nimport PermissionRow from './PermissionRow';\nimport PermissionsContextBar from './PermissionsContextBar';\nimport RoleHeader from './RoleHeader';\nimport { usePermissionsAndRoles } from './hooks/usePermissionsAndRoles';\n\nconst PermissionsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst canViewPermission = usePermission('access-permissions');\n\tconst canViewSettingPermission = usePermission('access-setting-permissions');\n\tconst defaultType = canViewPermission ? 'permissions' : 'settings';\n\tconst [type, setType] = useState(defaultType);\n\tconst [params, setParams] = useState({ limit: 25, skip: 0 });\n\n\tconst router = useRoute('admin-permissions');\n\n\tconst grantRole = useMethod('authorization:addPermissionToRole');\n\tconst removeRole = useMethod('authorization:removeRoleFromPermission');\n\n\tconst permissionsData = usePermissionsAndRoles(type, filter, params.limit, params.skip);\n\n\tconst [permissions, total, roleList] = permissionsData;\n\n\tconst handleParams = useMutableCallback(({ current, itemsPerPage }) => {\n\t\tsetParams({ skip: current, limit: itemsPerPage });\n\t});\n\n\tconst handlePermissionsTab = useMutableCallback(() => {\n\t\tif (type === 'permissions') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('permissions');\n\t});\n\n\tconst handleSettingsTab = useMutableCallback(() => {\n\t\tif (type === 'settings') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('settings');\n\t});\n\n\tconst handleAdd = useMutableCallback(() => {\n\t\trouter.push({\n\t\t\tcontext: 'new',\n\t\t});\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Permissions')}>\n\t\t\t\t\t<Button primary onClick={handleAdd} aria-label={t('New')}>\n\t\t\t\t\t\t<Icon name='plus' /> {t('New_role')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Margins blockEnd='x16'>\n\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'permissions'} onClick={handlePermissionsTab} disabled={!canViewPermission}>\n\t\t\t\t\t\t\t{t('Permissions')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t<Tabs.Item selected={type === 'settings'} onClick={handleSettingsTab} disabled={!canViewSettingPermission}>\n\t\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Margins>\n\t\t\t\t<Page.Content mb='neg-x8'>\n\t\t\t\t\t<Margins block='x8'>\n\t\t\t\t\t\t<FilterComponent onChange={setFilter} />\n\t\t\t\t\t\t<GenericTable\n\t\t\t\t\t\t\theader={\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<GenericTable.HeaderCell width='x120'>{t('Name')}</GenericTable.HeaderCell>\n\t\t\t\t\t\t\t\t\t{roleList.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t\t\t<RoleHeader key={_id} _id={_id} name={name} description={description} router={router} />\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttotal={total}\n\t\t\t\t\t\t\tresults={permissions}\n\t\t\t\t\t\t\tparams={params}\n\t\t\t\t\t\t\tsetParams={handleParams}\n\t\t\t\t\t\t\tfixed={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{useCallback(\n\t\t\t\t\t\t\t\t(permission) => (\n\t\t\t\t\t\t\t\t\t<PermissionRow\n\t\t\t\t\t\t\t\t\t\tkey={permission._id}\n\t\t\t\t\t\t\t\t\t\tpermission={permission}\n\t\t\t\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\t\t\t\troleList={roleList}\n\t\t\t\t\t\t\t\t\t\tonGrant={grantRole}\n\t\t\t\t\t\t\t\t\t\tonRemove={removeRole}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t[grantRole, removeRole, roleList, t],\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t<PermissionsContextBar />\n\t\t</Page>\n\t);\n};\n\nexport default PermissionsTable;\n"]},"sourceType":"module","hash":"bf2b5394748c6a9e1892c6c1806093ac2ded18ac"}
