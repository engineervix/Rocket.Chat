{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/businessHours/EditBusinessHoursPage.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/omnichannel/businessHours/EditBusinessHoursPage.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/businessHours/EditBusinessHoursPage.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/businessHours/EditBusinessHoursPage.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/businessHours/EditBusinessHoursPage.js"}},"code":"var _excluded = [\"departments\"];\n\nvar _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 1);\n\nvar _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default: function (v) {\n    _objectWithoutProperties = v;\n  }\n}, 2);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 3);\nvar Button, ButtonGroup, Callout;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Button: function (v) {\n    Button = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Callout: function (v) {\n    Callout = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar React, useRef, useMemo, useState;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useRef: function (v) {\n    useRef = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useState: function (v) {\n    useState = v;\n  }\n}, 2);\nvar Page;\nmodule.link(\"../../../components/Page\", {\n  \"default\": function (v) {\n    Page = v;\n  }\n}, 3);\nvar PageSkeleton;\nmodule.link(\"../../../components/PageSkeleton\", {\n  \"default\": function (v) {\n    PageSkeleton = v;\n  }\n}, 4);\nvar useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute: function (v) {\n    useRoute = v;\n  }\n}, 5);\nvar useMethod;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod: function (v) {\n    useMethod = v;\n  }\n}, 6);\nvar useToastMessageDispatch;\nmodule.link(\"../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  }\n}, 7);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 8);\nvar AsyncStatePhase;\nmodule.link(\"../../../hooks/useAsyncState\", {\n  AsyncStatePhase: function (v) {\n    AsyncStatePhase = v;\n  }\n}, 9);\nvar useEndpointData;\nmodule.link(\"../../../hooks/useEndpointData\", {\n  useEndpointData: function (v) {\n    useEndpointData = v;\n  }\n}, 10);\nvar BusinessHoursFormContainer;\nmodule.link(\"./BusinessHoursFormContainer\", {\n  \"default\": function (v) {\n    BusinessHoursFormContainer = v;\n  }\n}, 11);\nvar useIsSingleBusinessHours;\nmodule.link(\"./BusinessHoursRouter\", {\n  useIsSingleBusinessHours: function (v) {\n    useIsSingleBusinessHours = v;\n  }\n}, 12);\nvar mapBusinessHoursForm;\nmodule.link(\"./mapBusinessHoursForm\", {\n  mapBusinessHoursForm: function (v) {\n    mapBusinessHoursForm = v;\n  }\n}, 13);\n\nvar EditBusinessHoursPage = function (_ref) {\n  var id = _ref.id,\n      type = _ref.type;\n  var t = useTranslation();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var isSingleBH = useIsSingleBusinessHours();\n\n  var _useEndpointData = useEndpointData('livechat/business-hour', useMemo(function () {\n    return {\n      _id: id,\n      type: type\n    };\n  }, [id, type])),\n      data = _useEndpointData.value,\n      state = _useEndpointData.phase;\n\n  var saveData = useRef({\n    form: {}\n  });\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasChanges = _useState2[0],\n      setHasChanges = _useState2[1];\n\n  var save = useMethod('livechat:saveBusinessHour');\n  var deleteBH = useMethod('livechat:removeBusinessHour');\n  var router = useRoute('omnichannel-businessHours');\n  var handleSave = useMutableCallback(function () {\n    function _callee() {\n      var _saveData$current, form, _saveData$current$mul, departments, multiple, _saveData$current$tim, timezoneName, mappedForm, departmentsToApplyBusinessHour, payload;\n\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(state !== AsyncStatePhase.RESOLVED || !data.success)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                _saveData$current = saveData.current, form = _saveData$current.form, _saveData$current$mul = _saveData$current.multiple;\n                _saveData$current$mul = _saveData$current$mul === void 0 ? {} : _saveData$current$mul;\n                departments = _saveData$current$mul.departments, multiple = _objectWithoutProperties(_saveData$current$mul, _excluded), _saveData$current$tim = _saveData$current.timezone;\n                _saveData$current$tim = _saveData$current$tim === void 0 ? {} : _saveData$current$tim;\n                timezoneName = _saveData$current$tim.name;\n\n                if (!(data.businessHour.type !== 'default' && multiple.name === '')) {\n                  _context.next = 9;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", dispatchToastMessage({\n                  type: 'error',\n                  message: t('error-the-field-is-required', {\n                    field: t('Name')\n                  })\n                }));\n\n              case 9:\n                mappedForm = mapBusinessHoursForm(form, data.businessHour);\n                departmentsToApplyBusinessHour = (departments === null || departments === void 0 ? void 0 : departments.map(function (dep) {\n                  return dep.value;\n                }).join(',')) || '';\n                _context.prev = 11;\n                payload = _objectSpread(_objectSpread(_objectSpread({}, data.businessHour), multiple), {}, {\n                  departmentsToApplyBusinessHour: departmentsToApplyBusinessHour !== null && departmentsToApplyBusinessHour !== void 0 ? departmentsToApplyBusinessHour : '',\n                  timezoneName: timezoneName || data.businessHour.timezone.name,\n                  workHours: mappedForm\n                });\n                _context.next = 15;\n                return _regeneratorRuntime.awrap(save(payload));\n\n              case 15:\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Business_hours_updated')\n                });\n                router.push({});\n                _context.next = 22;\n                break;\n\n              case 19:\n                _context.prev = 19;\n                _context.t0 = _context[\"catch\"](11);\n                dispatchToastMessage({\n                  type: 'error',\n                  message: _context.t0\n                });\n\n              case 22:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, [[11, 19]], Promise);\n    }\n\n    return _callee;\n  }());\n  var handleDelete = useMutableCallback(function () {\n    function _callee2() {\n      return _regeneratorRuntime.async(function () {\n        function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(type !== 'custom')) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                _context2.prev = 2;\n                _context2.next = 5;\n                return _regeneratorRuntime.awrap(deleteBH(id, type));\n\n              case 5:\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Business_Hour_Removed')\n                });\n                router.push({});\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](2);\n                dispatchToastMessage({\n                  type: 'error',\n                  message: _context2.t0\n                });\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }\n\n        return _callee2$;\n      }(), null, null, [[2, 9]], Promise);\n    }\n\n    return _callee2;\n  }());\n  var handleReturn = useMutableCallback(function () {\n    router.push({});\n  });\n\n  if (state === AsyncStatePhase.LOADING) {\n    return /*#__PURE__*/React.createElement(PageSkeleton, null);\n  }\n\n  if (state === AsyncStatePhase.REJECTED || AsyncStatePhase.RESOLVED && !data.businessHour) {\n    return /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n      title: t('Business_Hours')\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: handleReturn\n    }, t('Back'))), /*#__PURE__*/React.createElement(Page.ScrollableContentWithShadow, null, /*#__PURE__*/React.createElement(Callout, {\n      type: \"danger\"\n    }, t('Error'))));\n  }\n\n  return /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: t('Business_Hours')\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, !isSingleBH && /*#__PURE__*/React.createElement(Button, {\n    onClick: handleReturn\n  }, t('Back')), type === 'custom' && /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    danger: true,\n    onClick: handleDelete\n  }, t('Delete')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleSave,\n    disabled: !hasChanges\n  }, t('Save')))), /*#__PURE__*/React.createElement(Page.ScrollableContentWithShadow, null, /*#__PURE__*/React.createElement(BusinessHoursFormContainer, {\n    data: data.businessHour,\n    saveRef: saveData,\n    onChange: setHasChanges\n  })));\n};\n\nmodule.exportDefault(EditBusinessHoursPage);","map":{"version":3,"sources":["client/views/omnichannel/businessHours/EditBusinessHoursPage.js"],"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_objectWithoutProperties","_slicedToArray","Button","ButtonGroup","Callout","useMutableCallback","React","useRef","useMemo","useState","Page","PageSkeleton","useRoute","useMethod","useToastMessageDispatch","useTranslation","AsyncStatePhase","useEndpointData","BusinessHoursFormContainer","useIsSingleBusinessHours","mapBusinessHoursForm","EditBusinessHoursPage","id","type","t","dispatchToastMessage","isSingleBH","_id","data","value","state","phase","saveData","form","hasChanges","setHasChanges","save","deleteBH","router","handleSave","RESOLVED","success","current","multiple","departments","timezone","timezoneName","name","businessHour","message","field","mappedForm","departmentsToApplyBusinessHour","map","dep","join","payload","workHours","push","handleDelete","handleReturn","LOADING","REJECTED","exportDefault"],"mappings":";;AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,IAAAA,mBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,aAAJ;;AAAkBJ,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACC,IAAAA,aAAa,GAACD,CAAd;AAAgB;AAArC,CAAnD,EAA0F,CAA1F;;AAA6F,IAAIE,wBAAJ;;AAA6BL,MAAM,CAACC,IAAP,CAAY,gDAAZ,EAA6D;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACE,IAAAA,wBAAwB,GAACF,CAAzB;AAA2B;AAAhD,CAA7D,EAA+G,CAA/G;;AAAkH,IAAIG,cAAJ;;AAAmBN,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACG,IAAAA,cAAc,GAACH,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAAlY,IAAII,MAAJ,EAAWC,WAAX,EAAuBC,OAAvB;AAA+BT,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACM,EAAAA,MAAM,EAAC,UAASJ,CAAT,EAAW;AAACI,IAAAA,MAAM,GAACJ,CAAP;AAAS,GAA7B;AAA8BK,EAAAA,WAAW,EAAC,UAASL,CAAT,EAAW;AAACK,IAAAA,WAAW,GAACL,CAAZ;AAAc,GAApE;AAAqEM,EAAAA,OAAO,EAAC,UAASN,CAAT,EAAW;AAACM,IAAAA,OAAO,GAACN,CAAR;AAAU;AAAnG,CAApC,EAAyI,CAAzI;AAA4I,IAAIO,kBAAJ;AAAuBV,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACS,EAAAA,kBAAkB,EAAC,UAASP,CAAT,EAAW;AAACO,IAAAA,kBAAkB,GAACP,CAAnB;AAAqB;AAArD,CAA1C,EAAiG,CAAjG;AAAoG,IAAIQ,KAAJ,EAAUC,MAAV,EAAiBC,OAAjB,EAAyBC,QAAzB;AAAkCd,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACQ,IAAAA,KAAK,GAACR,CAAN;AAAQ,GAA7B;AAA8BS,EAAAA,MAAM,EAAC,UAAST,CAAT,EAAW;AAACS,IAAAA,MAAM,GAACT,CAAP;AAAS,GAA1D;AAA2DU,EAAAA,OAAO,EAAC,UAASV,CAAT,EAAW;AAACU,IAAAA,OAAO,GAACV,CAAR;AAAU,GAAzF;AAA0FW,EAAAA,QAAQ,EAAC,UAASX,CAAT,EAAW;AAACW,IAAAA,QAAQ,GAACX,CAAT;AAAW;AAA1H,CAApB,EAAgJ,CAAhJ;AAAmJ,IAAIY,IAAJ;AAASf,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACY,IAAAA,IAAI,GAACZ,CAAL;AAAO;AAA5B,CAAvC,EAAqE,CAArE;AAAwE,IAAIa,YAAJ;AAAiBhB,MAAM,CAACC,IAAP,CAAY,kCAAZ,EAA+C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACa,IAAAA,YAAY,GAACb,CAAb;AAAe;AAApC,CAA/C,EAAqF,CAArF;AAAwF,IAAIc,QAAJ;AAAajB,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACgB,EAAAA,QAAQ,EAAC,UAASd,CAAT,EAAW;AAACc,IAAAA,QAAQ,GAACd,CAAT;AAAW;AAAjC,CAA9C,EAAiF,CAAjF;AAAoF,IAAIe,SAAJ;AAAclB,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACiB,EAAAA,SAAS,EAAC,UAASf,CAAT,EAAW;AAACe,IAAAA,SAAS,GAACf,CAAV;AAAY;AAAnC,CAA9C,EAAmF,CAAnF;AAAsF,IAAIgB,uBAAJ;AAA4BnB,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAACkB,EAAAA,uBAAuB,EAAC,UAAShB,CAAT,EAAW;AAACgB,IAAAA,uBAAuB,GAAChB,CAAxB;AAA0B;AAA/D,CAArD,EAAsH,CAAtH;AAAyH,IAAIiB,cAAJ;AAAmBpB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACmB,EAAAA,cAAc,EAAC,UAASjB,CAAT,EAAW;AAACiB,IAAAA,cAAc,GAACjB,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;AAAqG,IAAIkB,eAAJ;AAAoBrB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAACoB,EAAAA,eAAe,EAAC,UAASlB,CAAT,EAAW;AAACkB,IAAAA,eAAe,GAAClB,CAAhB;AAAkB;AAA/C,CAA3C,EAA4F,CAA5F;AAA+F,IAAImB,eAAJ;AAAoBtB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACqB,EAAAA,eAAe,EAAC,UAASnB,CAAT,EAAW;AAACmB,IAAAA,eAAe,GAACnB,CAAhB;AAAkB;AAA/C,CAA7C,EAA8F,EAA9F;AAAkG,IAAIoB,0BAAJ;AAA+BvB,MAAM,CAACC,IAAP,CAAY,8BAAZ,EAA2C;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACoB,IAAAA,0BAA0B,GAACpB,CAA3B;AAA6B;AAAlD,CAA3C,EAA+F,EAA/F;AAAmG,IAAIqB,wBAAJ;AAA6BxB,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACuB,EAAAA,wBAAwB,EAAC,UAASrB,CAAT,EAAW;AAACqB,IAAAA,wBAAwB,GAACrB,CAAzB;AAA2B;AAAjE,CAApC,EAAuG,EAAvG;AAA2G,IAAIsB,oBAAJ;AAAyBzB,MAAM,CAACC,IAAP,CAAY,wBAAZ,EAAqC;AAACwB,EAAAA,oBAAoB,EAAC,UAAStB,CAAT,EAAW;AAACsB,IAAAA,oBAAoB,GAACtB,CAArB;AAAuB;AAAzD,CAArC,EAAgG,EAAhG;;AAgBnnD,IAAMuB,qBAAqB,GAAG,gBAAkB;AAAA,MAAfC,EAAe,QAAfA,EAAe;AAAA,MAAXC,IAAW,QAAXA,IAAW;AAC/C,MAAMC,CAAC,GAAGT,cAAc,EAAxB;AACA,MAAMU,oBAAoB,GAAGX,uBAAuB,EAApD;AACA,MAAMY,UAAU,GAAGP,wBAAwB,EAA3C;;AAEA,yBAAsCF,eAAe,CACpD,wBADoD,EAEpDT,OAAO,CAAC;AAAA,WAAO;AAAEmB,MAAAA,GAAG,EAAEL,EAAP;AAAWC,MAAAA,IAAI,EAAJA;AAAX,KAAP;AAAA,GAAD,EAA4B,CAACD,EAAD,EAAKC,IAAL,CAA5B,CAF6C,CAArD;AAAA,MAAeK,IAAf,oBAAQC,KAAR;AAAA,MAA4BC,KAA5B,oBAAqBC,KAArB;;AAKA,MAAMC,QAAQ,GAAGzB,MAAM,CAAC;AAAE0B,IAAAA,IAAI,EAAE;AAAR,GAAD,CAAvB;;AAEA,kBAAoCxB,QAAQ,CAAC,KAAD,CAA5C;AAAA;AAAA,MAAOyB,UAAP;AAAA,MAAmBC,aAAnB;;AAEA,MAAMC,IAAI,GAAGvB,SAAS,CAAC,2BAAD,CAAtB;AACA,MAAMwB,QAAQ,GAAGxB,SAAS,CAAC,6BAAD,CAA1B;AAEA,MAAMyB,MAAM,GAAG1B,QAAQ,CAAC,2BAAD,CAAvB;AAEA,MAAM2B,UAAU,GAAGlC,kBAAkB;AAAC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACjCyB,KAAK,KAAKd,eAAe,CAACwB,QAA1B,IAAsC,CAACZ,IAAI,CAACa,OADX;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,oCAOjCT,QAPiC,CAMpCU,OANoC,EAMzBT,IANyB,qBAMzBA,IANyB,4CAMnBU,QANmB;AAKrC,2EAC2D,EAD3D;AAC8BC,gBAAAA,WANO,yBAMPA,WANO,EAMSD,QANT,yGAM0BE,QAN1B;AAKrC,2EACkG,EADlG;AACiFC,gBAAAA,YAN5C,yBAMsCC,IANtC;;AAAA,sBASjCnB,IAAI,CAACoB,YAAL,CAAkBzB,IAAlB,KAA2B,SAA3B,IAAwCoB,QAAQ,CAACI,IAAT,KAAkB,EATzB;AAAA;AAAA;AAAA;;AAAA,iDAU7BtB,oBAAoB,CAAC;AAC3BF,kBAAAA,IAAI,EAAE,OADqB;AAE3B0B,kBAAAA,OAAO,EAAEzB,CAAC,CAAC,6BAAD,EAAgC;AAAE0B,oBAAAA,KAAK,EAAE1B,CAAC,CAAC,MAAD;AAAV,mBAAhC;AAFiB,iBAAD,CAVS;;AAAA;AAgB/B2B,gBAAAA,UAhB+B,GAgBlB/B,oBAAoB,CAACa,IAAD,EAAOL,IAAI,CAACoB,YAAZ,CAhBF;AAkB/BI,gBAAAA,8BAlB+B,GAkBE,CAAAR,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW,CAAES,GAAb,CAAiB,UAACC,GAAD;AAAA,yBAASA,GAAG,CAACzB,KAAb;AAAA,iBAAjB,EAAqC0B,IAArC,CAA0C,GAA1C,MAAkD,EAlBpD;AAAA;AAqB9BC,gBAAAA,OArB8B,iDAsBhC5B,IAAI,CAACoB,YAtB2B,GAuBhCL,QAvBgC;AAwBnCS,kBAAAA,8BAA8B,EAAEA,8BAAF,aAAEA,8BAAF,cAAEA,8BAAF,GAAoC,EAxB/B;AAyBnCN,kBAAAA,YAAY,EAAEA,YAAY,IAAIlB,IAAI,CAACoB,YAAL,CAAkBH,QAAlB,CAA2BE,IAzBtB;AA0BnCU,kBAAAA,SAAS,EAAEN;AA1BwB;AAAA;AAAA,iDA6B9Bf,IAAI,CAACoB,OAAD,CA7B0B;;AAAA;AA8BpC/B,gBAAAA,oBAAoB,CAAC;AAAEF,kBAAAA,IAAI,EAAE,SAAR;AAAmB0B,kBAAAA,OAAO,EAAEzB,CAAC,CAAC,wBAAD;AAA7B,iBAAD,CAApB;AACAc,gBAAAA,MAAM,CAACoB,IAAP,CAAY,EAAZ;AA/BoC;AAAA;;AAAA;AAAA;AAAA;AAiCpCjC,gBAAAA,oBAAoB,CAAC;AAAEF,kBAAAA,IAAI,EAAE,OAAR;AAAiB0B,kBAAAA,OAAO;AAAxB,iBAAD,CAApB;;AAjCoC;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAD;AAAA,MAArC;AAqCA,MAAMU,YAAY,GAAGtD,kBAAkB;AAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACnCkB,IAAI,KAAK,QAD0B;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,iDAMhCc,QAAQ,CAACf,EAAD,EAAKC,IAAL,CANwB;;AAAA;AAOtCE,gBAAAA,oBAAoB,CAAC;AAAEF,kBAAAA,IAAI,EAAE,SAAR;AAAmB0B,kBAAAA,OAAO,EAAEzB,CAAC,CAAC,uBAAD;AAA7B,iBAAD,CAApB;AACAc,gBAAAA,MAAM,CAACoB,IAAP,CAAY,EAAZ;AARsC;AAAA;;AAAA;AAAA;AAAA;AAUtCjC,gBAAAA,oBAAoB,CAAC;AAAEF,kBAAAA,IAAI,EAAE,OAAR;AAAiB0B,kBAAAA,OAAO;AAAxB,iBAAD,CAApB;;AAVsC;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAD;AAAA,MAAvC;AAcA,MAAMW,YAAY,GAAGvD,kBAAkB,CAAC,YAAM;AAC7CiC,IAAAA,MAAM,CAACoB,IAAP,CAAY,EAAZ;AACA,GAFsC,CAAvC;;AAIA,MAAI5B,KAAK,KAAKd,eAAe,CAAC6C,OAA9B,EAAuC;AACtC,wBAAO,oBAAC,YAAD,OAAP;AACA;;AAED,MAAI/B,KAAK,KAAKd,eAAe,CAAC8C,QAA1B,IAAuC9C,eAAe,CAACwB,QAAhB,IAA4B,CAACZ,IAAI,CAACoB,YAA7E,EAA4F;AAC3F,wBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,MAAA,KAAK,EAAExB,CAAC,CAAC,gBAAD;AAArB,oBACC,oBAAC,MAAD;AAAQ,MAAA,OAAO,EAAEoC;AAAjB,OAAgCpC,CAAC,CAAC,MAAD,CAAjC,CADD,CADD,eAIC,oBAAC,IAAD,CAAM,2BAAN,qBACC,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAC;AAAd,OAAwBA,CAAC,CAAC,OAAD,CAAzB,CADD,CAJD,CADD;AAUA;;AAED,sBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,IAAA,KAAK,EAAEA,CAAC,CAAC,gBAAD;AAArB,kBACC,oBAAC,WAAD,QACE,CAACE,UAAD,iBAAe,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAEkC;AAAjB,KAAgCpC,CAAC,CAAC,MAAD,CAAjC,CADjB,EAEED,IAAI,KAAK,QAAT,iBACA,oBAAC,MAAD;AAAQ,IAAA,OAAO,MAAf;AAAgB,IAAA,MAAM,MAAtB;AAAuB,IAAA,OAAO,EAAEoC;AAAhC,KACEnC,CAAC,CAAC,QAAD,CADH,CAHF,eAOC,oBAAC,MAAD;AAAQ,IAAA,OAAO,MAAf;AAAgB,IAAA,OAAO,EAAEe,UAAzB;AAAqC,IAAA,QAAQ,EAAE,CAACL;AAAhD,KACEV,CAAC,CAAC,MAAD,CADH,CAPD,CADD,CADD,eAcC,oBAAC,IAAD,CAAM,2BAAN,qBACC,oBAAC,0BAAD;AAA4B,IAAA,IAAI,EAAEI,IAAI,CAACoB,YAAvC;AAAqD,IAAA,OAAO,EAAEhB,QAA9D;AAAwE,IAAA,QAAQ,EAAEG;AAAlF,IADD,CAdD,CADD;AAoBA,CA/GD;;AAhBAxC,MAAM,CAACoE,aAAP,CAiIe1C,qBAjIf","sourcesContent":["import { Button, ButtonGroup, Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useRef, useMemo, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport PageSkeleton from '../../../components/PageSkeleton';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport BusinessHoursFormContainer from './BusinessHoursFormContainer';\nimport { useIsSingleBusinessHours } from './BusinessHoursRouter';\nimport { mapBusinessHoursForm } from './mapBusinessHoursForm';\n\nconst EditBusinessHoursPage = ({ id, type }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst isSingleBH = useIsSingleBusinessHours();\n\n\tconst { value: data, phase: state } = useEndpointData(\n\t\t'livechat/business-hour',\n\t\tuseMemo(() => ({ _id: id, type }), [id, type]),\n\t);\n\n\tconst saveData = useRef({ form: {} });\n\n\tconst [hasChanges, setHasChanges] = useState(false);\n\n\tconst save = useMethod('livechat:saveBusinessHour');\n\tconst deleteBH = useMethod('livechat:removeBusinessHour');\n\n\tconst router = useRoute('omnichannel-businessHours');\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tif (state !== AsyncStatePhase.RESOLVED || !data.success) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tcurrent: { form, multiple: { departments, ...multiple } = {}, timezone: { name: timezoneName } = {} },\n\t\t} = saveData;\n\n\t\tif (data.businessHour.type !== 'default' && multiple.name === '') {\n\t\t\treturn dispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-the-field-is-required', { field: t('Name') }),\n\t\t\t});\n\t\t}\n\n\t\tconst mappedForm = mapBusinessHoursForm(form, data.businessHour);\n\n\t\tconst departmentsToApplyBusinessHour = departments?.map((dep) => dep.value).join(',') || '';\n\n\t\ttry {\n\t\t\tconst payload = {\n\t\t\t\t...data.businessHour,\n\t\t\t\t...multiple,\n\t\t\t\tdepartmentsToApplyBusinessHour: departmentsToApplyBusinessHour ?? '',\n\t\t\t\ttimezoneName: timezoneName || data.businessHour.timezone.name,\n\t\t\t\tworkHours: mappedForm,\n\t\t\t};\n\n\t\t\tawait save(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_hours_updated') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (type !== 'custom') {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait deleteBH(id, type);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_Hour_Removed') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\trouter.push({});\n\t});\n\n\tif (state === AsyncStatePhase.LOADING) {\n\t\treturn <PageSkeleton />;\n\t}\n\n\tif (state === AsyncStatePhase.REJECTED || (AsyncStatePhase.RESOLVED && !data.businessHour)) {\n\t\treturn (\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t\t<Button onClick={handleReturn}>{t('Back')}</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<Callout type='danger'>{t('Error')}</Callout>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t{!isSingleBH && <Button onClick={handleReturn}>{t('Back')}</Button>}\n\t\t\t\t\t{type === 'custom' && (\n\t\t\t\t\t\t<Button primary danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button primary onClick={handleSave} disabled={!hasChanges}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<BusinessHoursFormContainer data={data.businessHour} saveRef={saveData} onChange={setHasChanges} />\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default EditBusinessHoursPage;\n"]},"sourceType":"module","hash":"eeb98b5be1a450e955c3ffc9e1c99b77773405f6"}
