{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/apps/client/RealAppsEngineUIHost.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/apps/client/RealAppsEngineUIHost.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/apps/client/RealAppsEngineUIHost.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/apps/client/RealAppsEngineUIHost.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/apps/client/RealAppsEngineUIHost.js"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _inheritsLoose;\n\nmodule.link(\"@babel/runtime/helpers/inheritsLoose\", {\n  default: function (v) {\n    _inheritsLoose = v;\n  }\n}, 1);\nmodule.export({\n  RealAppsEngineUIHost: function () {\n    return RealAppsEngineUIHost;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Session;\nmodule.link(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 1);\nvar AppsEngineUIHost;\nmodule.link(\"@rocket.chat/apps-engine/client/AppsEngineUIHost\", {\n  AppsEngineUIHost: function (v) {\n    AppsEngineUIHost = v;\n  }\n}, 2);\nvar Rooms;\nmodule.link(\"../../models/client\", {\n  Rooms: function (v) {\n    Rooms = v;\n  }\n}, 3);\nvar APIClient;\nmodule.link(\"../../utils/client\", {\n  APIClient: function (v) {\n    APIClient = v;\n  }\n}, 4);\nvar getUserAvatarURL;\nmodule.link(\"../../utils/lib/getUserAvatarURL\", {\n  getUserAvatarURL: function (v) {\n    getUserAvatarURL = v;\n  }\n}, 5);\nvar baseURI;\nmodule.link(\"../../../client/lib/baseURI\", {\n  baseURI: function (v) {\n    baseURI = v;\n  }\n}, 6);\n\nvar RealAppsEngineUIHost = /*#__PURE__*/function (_AppsEngineUIHost) {\n  _inheritsLoose(RealAppsEngineUIHost, _AppsEngineUIHost);\n\n  function RealAppsEngineUIHost() {\n    var _this;\n\n    _this = _AppsEngineUIHost.call(this) || this;\n    _this._baseURL = baseURI.replace(/\\/$/, '');\n    return _this;\n  }\n\n  var _proto = RealAppsEngineUIHost.prototype;\n\n  _proto.getUserAvatarUrl = function () {\n    function getUserAvatarUrl(username) {\n      var avatarUrl = getUserAvatarURL(username);\n\n      if (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data')) {\n        return \"\" + this._baseURL + avatarUrl;\n      }\n\n      return avatarUrl;\n    }\n\n    return getUserAvatarUrl;\n  }();\n\n  _proto.getClientRoomInfo = function () {\n    function getClientRoomInfo() {\n      var _this2 = this;\n\n      var _Rooms$findOne, slugifiedName, id, cachedMembers, _await$APIClient$get, members;\n\n      return _regeneratorRuntime.async(function () {\n        function getClientRoomInfo$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _Rooms$findOne = Rooms.findOne(Session.get('openedRoom')), slugifiedName = _Rooms$findOne.name, id = _Rooms$findOne._id;\n                cachedMembers = [];\n                _context.prev = 2;\n                _context.next = 5;\n                return _regeneratorRuntime.awrap(APIClient.get('v1/groups.members', {\n                  roomId: id\n                }));\n\n              case 5:\n                _await$APIClient$get = _context.sent;\n                members = _await$APIClient$get.members;\n                cachedMembers = members.map(function (_ref) {\n                  var _id = _ref._id,\n                      username = _ref.username;\n                  return {\n                    id: _id,\n                    username: username,\n                    avatarUrl: _this2.getUserAvatarUrl(username)\n                  };\n                });\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](2);\n                console.warn(_context.t0);\n\n              case 13:\n                return _context.abrupt(\"return\", {\n                  id: id,\n                  slugifiedName: slugifiedName,\n                  members: cachedMembers\n                });\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return getClientRoomInfo$;\n      }(), null, null, [[2, 10]], Promise);\n    }\n\n    return getClientRoomInfo;\n  }();\n\n  _proto.getClientUserInfo = function () {\n    function getClientUserInfo() {\n      var _Meteor$user, username, _id;\n\n      return _regeneratorRuntime.async(function () {\n        function getClientUserInfo$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _Meteor$user = Meteor.user(), username = _Meteor$user.username, _id = _Meteor$user._id;\n                return _context2.abrupt(\"return\", {\n                  id: _id,\n                  username: username,\n                  avatarUrl: this.getUserAvatarUrl(username)\n                });\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }\n\n        return getClientUserInfo$;\n      }(), null, this, null, Promise);\n    }\n\n    return getClientUserInfo;\n  }();\n\n  return RealAppsEngineUIHost;\n}(AppsEngineUIHost);","map":{"version":3,"sources":["app/apps/client/RealAppsEngineUIHost.js"],"names":["_regeneratorRuntime","module","link","default","v","_inheritsLoose","export","RealAppsEngineUIHost","Meteor","Session","AppsEngineUIHost","Rooms","APIClient","getUserAvatarURL","baseURI","_baseURL","replace","getUserAvatarUrl","username","avatarUrl","startsWith","getClientRoomInfo","findOne","get","slugifiedName","name","id","_id","cachedMembers","roomId","members","map","console","warn","getClientUserInfo","user"],"mappings":"AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,IAAAA,mBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,cAAJ;;AAAmBJ,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACC,IAAAA,cAAc,GAACD,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAApIH,MAAM,CAACK,MAAP,CAAc;AAACC,EAAAA,oBAAoB,EAAC,YAAU;AAAC,WAAOA,oBAAP;AAA4B;AAA7D,CAAd;AAA8E,IAAIC,MAAJ;AAAWP,MAAM,CAACC,IAAP,CAAY,eAAZ,EAA4B;AAACM,EAAAA,MAAM,EAAC,UAASJ,CAAT,EAAW;AAACI,IAAAA,MAAM,GAACJ,CAAP;AAAS;AAA7B,CAA5B,EAA2D,CAA3D;AAA8D,IAAIK,OAAJ;AAAYR,MAAM,CAACC,IAAP,CAAY,gBAAZ,EAA6B;AAACO,EAAAA,OAAO,EAAC,UAASL,CAAT,EAAW;AAACK,IAAAA,OAAO,GAACL,CAAR;AAAU;AAA/B,CAA7B,EAA8D,CAA9D;AAAiE,IAAIM,gBAAJ;AAAqBT,MAAM,CAACC,IAAP,CAAY,kDAAZ,EAA+D;AAACQ,EAAAA,gBAAgB,EAAC,UAASN,CAAT,EAAW;AAACM,IAAAA,gBAAgB,GAACN,CAAjB;AAAmB;AAAjD,CAA/D,EAAkH,CAAlH;AAAqH,IAAIO,KAAJ;AAAUV,MAAM,CAACC,IAAP,CAAY,qBAAZ,EAAkC;AAACS,EAAAA,KAAK,EAAC,UAASP,CAAT,EAAW;AAACO,IAAAA,KAAK,GAACP,CAAN;AAAQ;AAA3B,CAAlC,EAA+D,CAA/D;AAAkE,IAAIQ,SAAJ;AAAcX,MAAM,CAACC,IAAP,CAAY,oBAAZ,EAAiC;AAACU,EAAAA,SAAS,EAAC,UAASR,CAAT,EAAW;AAACQ,IAAAA,SAAS,GAACR,CAAV;AAAY;AAAnC,CAAjC,EAAsE,CAAtE;AAAyE,IAAIS,gBAAJ;AAAqBZ,MAAM,CAACC,IAAP,CAAY,kCAAZ,EAA+C;AAACW,EAAAA,gBAAgB,EAAC,UAAST,CAAT,EAAW;AAACS,IAAAA,gBAAgB,GAACT,CAAjB;AAAmB;AAAjD,CAA/C,EAAkG,CAAlG;AAAqG,IAAIU,OAAJ;AAAYb,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACY,EAAAA,OAAO,EAAC,UAASV,CAAT,EAAW;AAACU,IAAAA,OAAO,GAACV,CAAR;AAAU;AAA/B,CAA1C,EAA2E,CAA3E;;IAS1oBG,oB;;;AACZ,kCAAc;AAAA;;AACb;AAEA,UAAKQ,QAAL,GAAgBD,OAAO,CAACE,OAAR,CAAgB,KAAhB,EAAuB,EAAvB,CAAhB;AAHa;AAIb;;;;SAEDC,gB;AAAA,8BAAiBC,QAAjB,EAA2B;AAC1B,UAAMC,SAAS,GAAGN,gBAAgB,CAACK,QAAD,CAAlC;;AAEA,UAAI,CAACC,SAAS,CAACC,UAAV,CAAqB,MAArB,CAAD,IAAiC,CAACD,SAAS,CAACC,UAAV,CAAqB,MAArB,CAAtC,EAAoE;AACnE,oBAAU,KAAKL,QAAf,GAA0BI,SAA1B;AACA;;AAED,aAAOA,SAAP;AACA;;;;;SAEKE,iB;AAAN;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAC0CV,KAAK,CAACW,OAAN,CAAcb,OAAO,CAACc,GAAR,CAAY,YAAZ,CAAd,CAD1C,EACeC,aADf,kBACSC,IADT,EACmCC,EADnC,kBAC8BC,GAD9B;AAGKC,gBAAAA,aAHL,GAGqB,EAHrB;AAAA;AAAA;AAAA,iDAK4BhB,SAAS,CAACW,GAAV,CAAc,mBAAd,EAAmC;AAAEM,kBAAAA,MAAM,EAAEH;AAAV,iBAAnC,CAL5B;;AAAA;AAAA;AAKUI,gBAAAA,OALV,wBAKUA,OALV;AAOEF,gBAAAA,aAAa,GAAGE,OAAO,CAACC,GAAR,CAAY;AAAA,sBAAGJ,GAAH,QAAGA,GAAH;AAAA,sBAAQT,QAAR,QAAQA,QAAR;AAAA,yBAAwB;AACnDQ,oBAAAA,EAAE,EAAEC,GAD+C;AAEnDT,oBAAAA,QAAQ,EAARA,QAFmD;AAGnDC,oBAAAA,SAAS,EAAE,MAAI,CAACF,gBAAL,CAAsBC,QAAtB;AAHwC,mBAAxB;AAAA,iBAAZ,CAAhB;AAPF;AAAA;;AAAA;AAAA;AAAA;AAaEc,gBAAAA,OAAO,CAACC,IAAR;;AAbF;AAAA,iDAgBQ;AACNP,kBAAAA,EAAE,EAAFA,EADM;AAENF,kBAAAA,aAAa,EAAbA,aAFM;AAGNM,kBAAAA,OAAO,EAAEF;AAHH,iBAhBR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;;;;SAuBMM,iB;AAAN;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAC2B1B,MAAM,CAAC2B,IAAP,EAD3B,EACSjB,QADT,gBACSA,QADT,EACmBS,GADnB,gBACmBA,GADnB;AAAA,kDAGQ;AACND,kBAAAA,EAAE,EAAEC,GADE;AAENT,kBAAAA,QAAQ,EAARA,QAFM;AAGNC,kBAAAA,SAAS,EAAE,KAAKF,gBAAL,CAAsBC,QAAtB;AAHL,iBAHR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;;;;;EAxCyCR,gB","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { AppsEngineUIHost } from '@rocket.chat/apps-engine/client/AppsEngineUIHost';\n\nimport { Rooms } from '../../models/client';\nimport { APIClient } from '../../utils/client';\nimport { getUserAvatarURL } from '../../utils/lib/getUserAvatarURL';\nimport { baseURI } from '../../../client/lib/baseURI';\n\nexport class RealAppsEngineUIHost extends AppsEngineUIHost {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._baseURL = baseURI.replace(/\\/$/, '');\n\t}\n\n\tgetUserAvatarUrl(username) {\n\t\tconst avatarUrl = getUserAvatarURL(username);\n\n\t\tif (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data')) {\n\t\t\treturn `${this._baseURL}${avatarUrl}`;\n\t\t}\n\n\t\treturn avatarUrl;\n\t}\n\n\tasync getClientRoomInfo() {\n\t\tconst { name: slugifiedName, _id: id } = Rooms.findOne(Session.get('openedRoom'));\n\n\t\tlet cachedMembers = [];\n\t\ttry {\n\t\t\tconst { members } = await APIClient.get('v1/groups.members', { roomId: id });\n\n\t\t\tcachedMembers = members.map(({ _id, username }) => ({\n\t\t\t\tid: _id,\n\t\t\t\tusername,\n\t\t\t\tavatarUrl: this.getUserAvatarUrl(username),\n\t\t\t}));\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\n\t\treturn {\n\t\t\tid,\n\t\t\tslugifiedName,\n\t\t\tmembers: cachedMembers,\n\t\t};\n\t}\n\n\tasync getClientUserInfo() {\n\t\tconst { username, _id } = Meteor.user();\n\n\t\treturn {\n\t\t\tid: _id,\n\t\t\tusername,\n\t\t\tavatarUrl: this.getUserAvatarUrl(username),\n\t\t};\n\t}\n}\n"]},"sourceType":"module","hash":"55813812c7534f39d1157473db41a65ef4df13c2"}
