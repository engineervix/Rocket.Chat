{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/emoji-custom/client/lib/emojiCustom.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/emoji-custom/client/lib/emojiCustom.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/emoji-custom/client/lib/emojiCustom.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/emoji-custom/client/lib/emojiCustom.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/emoji-custom/client/lib/emojiCustom.js"}},"code":"module.export({\n  getEmojiUrlFromName: () => getEmojiUrlFromName,\n  deleteEmojiCustom: () => deleteEmojiCustom,\n  updateEmojiCustom: () => updateEmojiCustom\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Session;\nmodule.link(\"meteor/session\", {\n  Session(v) {\n    Session = v;\n  }\n\n}, 1);\nlet escapeRegExp;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeRegExp(v) {\n    escapeRegExp = v;\n  }\n\n}, 2);\nlet isSetNotNull;\nmodule.link(\"./function-isSet\", {\n  isSetNotNull(v) {\n    isSetNotNull = v;\n  }\n\n}, 3);\nlet RoomManager;\nmodule.link(\"../../../ui-utils/client\", {\n  RoomManager(v) {\n    RoomManager = v;\n  }\n\n}, 4);\nlet emoji, EmojiPicker;\nmodule.link(\"../../../emoji/client\", {\n  emoji(v) {\n    emoji = v;\n  },\n\n  EmojiPicker(v) {\n    EmojiPicker = v;\n  }\n\n}, 5);\nlet CachedCollectionManager;\nmodule.link(\"../../../ui-cached-collection/client\", {\n  CachedCollectionManager(v) {\n    CachedCollectionManager = v;\n  }\n\n}, 6);\nlet APIClient;\nmodule.link(\"../../../utils/client\", {\n  APIClient(v) {\n    APIClient = v;\n  }\n\n}, 7);\n\nconst getEmojiUrlFromName = function (name, extension) {\n  Session.get;\n  const key = \"emoji_random_\".concat(name);\n  let random = 0;\n\n  if (isSetNotNull(() => Session.keys[key])) {\n    random = Session.keys[key];\n  }\n\n  if (name == null) {\n    return;\n  }\n\n  const path = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';\n  return \"\".concat(path, \"/emoji-custom/\").concat(encodeURIComponent(name), \".\").concat(extension, \"?_dc=\").concat(random);\n};\n\nconst deleteEmojiCustom = function (emojiData) {\n  delete emoji.list[\":\".concat(emojiData.name, \":\")];\n  const arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.name);\n\n  if (arrayIndex !== -1) {\n    emoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);\n  }\n\n  const arrayIndexList = emoji.packages.emojiCustom.list.indexOf(\":\".concat(emojiData.name, \":\"));\n\n  if (arrayIndexList !== -1) {\n    emoji.packages.emojiCustom.list.splice(arrayIndexList, 1);\n  }\n\n  if (isSetNotNull(() => emojiData.aliases)) {\n    for (const alias of emojiData.aliases) {\n      delete emoji.list[\":\".concat(alias, \":\")];\n      const aliasIndex = emoji.packages.emojiCustom.list.indexOf(\":\".concat(alias, \":\"));\n\n      if (aliasIndex !== -1) {\n        emoji.packages.emojiCustom.list.splice(aliasIndex, 1);\n      }\n    }\n  }\n\n  EmojiPicker.updateRecent('rocket');\n};\n\nconst updateEmojiCustom = function (emojiData) {\n  let key = \"emoji_random_\".concat(emojiData.name);\n  Session.set(key, Math.round(Math.random() * 1000));\n  const previousExists = isSetNotNull(() => emojiData.previousName);\n  const currentAliases = isSetNotNull(() => emojiData.aliases);\n\n  if (previousExists && isSetNotNull(() => emoji.list[\":\".concat(emojiData.previousName, \":\")].aliases)) {\n    for (const alias of emoji.list[\":\".concat(emojiData.previousName, \":\")].aliases) {\n      delete emoji.list[\":\".concat(alias, \":\")];\n      const aliasIndex = emoji.packages.emojiCustom.list.indexOf(\":\".concat(alias, \":\"));\n\n      if (aliasIndex !== -1) {\n        emoji.packages.emojiCustom.list.splice(aliasIndex, 1);\n      }\n    }\n  }\n\n  if (previousExists && emojiData.name !== emojiData.previousName) {\n    const arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.previousName);\n\n    if (arrayIndex !== -1) {\n      emoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);\n    }\n\n    const arrayIndexList = emoji.packages.emojiCustom.list.indexOf(\":\".concat(emojiData.previousName, \":\"));\n\n    if (arrayIndexList !== -1) {\n      emoji.packages.emojiCustom.list.splice(arrayIndexList, 1);\n    }\n\n    delete emoji.list[\":\".concat(emojiData.previousName, \":\")];\n  }\n\n  const categoryIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(\"\".concat(emojiData.name));\n\n  if (categoryIndex === -1) {\n    emoji.packages.emojiCustom.emojisByCategory.rocket.push(\"\".concat(emojiData.name));\n    emoji.packages.emojiCustom.list.push(\":\".concat(emojiData.name, \":\"));\n  }\n\n  emoji.list[\":\".concat(emojiData.name, \":\")] = Object.assign({\n    emojiPackage: 'emojiCustom'\n  }, emoji.list[\":\".concat(emojiData.name, \":\")], emojiData);\n\n  if (currentAliases) {\n    for (const alias of emojiData.aliases) {\n      emoji.packages.emojiCustom.list.push(\":\".concat(alias, \":\"));\n      emoji.list[\":\".concat(alias, \":\")] = {};\n      emoji.list[\":\".concat(alias, \":\")].emojiPackage = 'emojiCustom';\n      emoji.list[\":\".concat(alias, \":\")].aliasOf = emojiData.name;\n    }\n  }\n\n  const url = getEmojiUrlFromName(emojiData.name, emojiData.extension); // update in admin interface\n\n  if (previousExists && emojiData.name !== emojiData.previousName) {\n    $(document).find(\".emojiAdminPreview-image[data-emoji='\".concat(emojiData.previousName, \"']\")).css('background-image', \"url('\".concat(url, \")'\")).attr('data-emoji', \"\".concat(emojiData.name));\n  } else {\n    $(document).find(\".emojiAdminPreview-image[data-emoji='\".concat(emojiData.name, \"']\")).css('background-image', \"url('\".concat(url, \"')\"));\n  } // update in picker\n\n\n  if (previousExists && emojiData.name !== emojiData.previousName) {\n    $(document).find(\"li[data-emoji='\".concat(emojiData.previousName, \"'] span\")).css('background-image', \"url('\".concat(url, \"')\")).attr('data-emoji', \"\".concat(emojiData.name));\n    $(document).find(\"li[data-emoji='\".concat(emojiData.previousName, \"']\")).attr('data-emoji', \"\".concat(emojiData.name)).attr('class', \"emoji-\".concat(emojiData.name));\n  } else {\n    $(document).find(\"li[data-emoji='\".concat(emojiData.name, \"'] span\")).css('background-image', \"url('\".concat(url, \"')\"));\n  } // update in picker and opened rooms\n\n\n  for (key in RoomManager.openedRooms) {\n    if (RoomManager.openedRooms.hasOwnProperty(key)) {\n      const room = RoomManager.openedRooms[key];\n\n      if (previousExists && emojiData.name !== emojiData.previousName) {\n        $(room.dom).find(\"span[data-emoji='\".concat(emojiData.previousName, \"']\")).css('background-image', \"url('\".concat(url, \"')\")).attr('data-emoji', \"\".concat(emojiData.name));\n      } else {\n        $(room.dom).find(\"span[data-emoji='\".concat(emojiData.name, \"']\")).css('background-image', \"url('\".concat(url, \"')\"));\n      }\n    }\n  }\n\n  EmojiPicker.updateRecent('rocket');\n};\n\nconst customRender = html => {\n  const emojisMatchGroup = emoji.packages.emojiCustom.list.map(escapeRegExp).join('|');\n\n  if (emojisMatchGroup !== emoji.packages.emojiCustom._regexpSignature) {\n    emoji.packages.emojiCustom._regexpSignature = emojisMatchGroup;\n    emoji.packages.emojiCustom._regexp = new RegExp(\"<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|(\".concat(emojisMatchGroup, \")\"), 'gi');\n  }\n\n  html = html.replace(emoji.packages.emojiCustom._regexp, shortname => {\n    if (typeof shortname === 'undefined' || shortname === '' || emoji.packages.emojiCustom.list.indexOf(shortname) === -1) {\n      return shortname;\n    }\n\n    let emojiAlias = shortname.replace(/:/g, '');\n    let dataCheck = emoji.list[shortname];\n\n    if (dataCheck.hasOwnProperty('aliasOf')) {\n      emojiAlias = dataCheck.aliasOf;\n      dataCheck = emoji.list[\":\".concat(emojiAlias, \":\")];\n    }\n\n    return \"<span class=\\\"emoji\\\" style=\\\"background-image:url(\".concat(getEmojiUrlFromName(emojiAlias, dataCheck.extension), \");\\\" data-emoji=\\\"\").concat(emojiAlias, \"\\\" title=\\\"\").concat(shortname, \"\\\">\").concat(shortname, \"</span>\");\n  });\n  return html;\n};\n\nemoji.packages.emojiCustom = {\n  emojiCategories: [{\n    key: 'rocket',\n    i18n: 'Custom'\n  }],\n  categoryIndex: 1,\n  toneList: {},\n  list: [],\n  _regexpSignature: null,\n  _regexp: null,\n  render: customRender,\n  renderPicker: customRender\n};\nMeteor.startup(() => CachedCollectionManager.onLogin(async () => {\n  try {\n    const {\n      emojis: {\n        update: emojis\n      }\n    } = await APIClient.v1.get('emoji-custom.list');\n    emoji.packages.emojiCustom.emojisByCategory = {\n      rocket: []\n    };\n\n    for (const currentEmoji of emojis) {\n      emoji.packages.emojiCustom.emojisByCategory.rocket.push(currentEmoji.name);\n      emoji.packages.emojiCustom.list.push(\":\".concat(currentEmoji.name, \":\"));\n      emoji.list[\":\".concat(currentEmoji.name, \":\")] = currentEmoji;\n      emoji.list[\":\".concat(currentEmoji.name, \":\")].emojiPackage = 'emojiCustom';\n\n      for (const alias of currentEmoji.aliases) {\n        emoji.packages.emojiCustom.list.push(\":\".concat(alias, \":\"));\n        emoji.list[\":\".concat(alias, \":\")] = {\n          emojiPackage: 'emojiCustom',\n          aliasOf: currentEmoji.name\n        };\n      }\n    }\n\n    EmojiPicker.updateRecent('rocket');\n  } catch (e) {\n    console.error('Error getting custom emoji', e);\n  }\n}));","map":{"version":3,"sources":["app/emoji-custom/client/lib/emojiCustom.js"],"names":["module","export","getEmojiUrlFromName","deleteEmojiCustom","updateEmojiCustom","Meteor","link","v","Session","escapeRegExp","isSetNotNull","RoomManager","emoji","EmojiPicker","CachedCollectionManager","APIClient","name","extension","get","key","random","keys","path","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","encodeURIComponent","emojiData","list","arrayIndex","packages","emojiCustom","emojisByCategory","rocket","indexOf","splice","arrayIndexList","aliases","alias","aliasIndex","updateRecent","set","Math","round","previousExists","previousName","currentAliases","categoryIndex","push","Object","assign","emojiPackage","aliasOf","url","$","document","find","css","attr","openedRooms","hasOwnProperty","room","dom","customRender","html","emojisMatchGroup","map","join","_regexpSignature","_regexp","RegExp","replace","shortname","emojiAlias","dataCheck","emojiCategories","i18n","toneList","render","renderPicker","startup","onLogin","emojis","update","v1","currentEmoji","e","console","error"],"mappings":"AAAAA,MAAM,CAACC,MAAP,CAAc;AAACC,EAAAA,mBAAmB,EAAC,MAAIA,mBAAzB;AAA6CC,EAAAA,iBAAiB,EAAC,MAAIA,iBAAnE;AAAqFC,EAAAA,iBAAiB,EAAC,MAAIA;AAA3G,CAAd;AAA6I,IAAIC,MAAJ;AAAWL,MAAM,CAACM,IAAP,CAAY,eAAZ,EAA4B;AAACD,EAAAA,MAAM,CAACE,CAAD,EAAG;AAACF,IAAAA,MAAM,GAACE,CAAP;AAAS;;AAApB,CAA5B,EAAkD,CAAlD;AAAqD,IAAIC,OAAJ;AAAYR,MAAM,CAACM,IAAP,CAAY,gBAAZ,EAA6B;AAACE,EAAAA,OAAO,CAACD,CAAD,EAAG;AAACC,IAAAA,OAAO,GAACD,CAAR;AAAU;;AAAtB,CAA7B,EAAqD,CAArD;AAAwD,IAAIE,YAAJ;AAAiBT,MAAM,CAACM,IAAP,CAAY,6BAAZ,EAA0C;AAACG,EAAAA,YAAY,CAACF,CAAD,EAAG;AAACE,IAAAA,YAAY,GAACF,CAAb;AAAe;;AAAhC,CAA1C,EAA4E,CAA5E;AAA+E,IAAIG,YAAJ;AAAiBV,MAAM,CAACM,IAAP,CAAY,kBAAZ,EAA+B;AAACI,EAAAA,YAAY,CAACH,CAAD,EAAG;AAACG,IAAAA,YAAY,GAACH,CAAb;AAAe;;AAAhC,CAA/B,EAAiE,CAAjE;AAAoE,IAAII,WAAJ;AAAgBX,MAAM,CAACM,IAAP,CAAY,0BAAZ,EAAuC;AAACK,EAAAA,WAAW,CAACJ,CAAD,EAAG;AAACI,IAAAA,WAAW,GAACJ,CAAZ;AAAc;;AAA9B,CAAvC,EAAuE,CAAvE;AAA0E,IAAIK,KAAJ,EAAUC,WAAV;AAAsBb,MAAM,CAACM,IAAP,CAAY,uBAAZ,EAAoC;AAACM,EAAAA,KAAK,CAACL,CAAD,EAAG;AAACK,IAAAA,KAAK,GAACL,CAAN;AAAQ,GAAlB;;AAAmBM,EAAAA,WAAW,CAACN,CAAD,EAAG;AAACM,IAAAA,WAAW,GAACN,CAAZ;AAAc;;AAAhD,CAApC,EAAsF,CAAtF;AAAyF,IAAIO,uBAAJ;AAA4Bd,MAAM,CAACM,IAAP,CAAY,sCAAZ,EAAmD;AAACQ,EAAAA,uBAAuB,CAACP,CAAD,EAAG;AAACO,IAAAA,uBAAuB,GAACP,CAAxB;AAA0B;;AAAtD,CAAnD,EAA2G,CAA3G;AAA8G,IAAIQ,SAAJ;AAAcf,MAAM,CAACM,IAAP,CAAY,uBAAZ,EAAoC;AAACS,EAAAA,SAAS,CAACR,CAAD,EAAG;AAACQ,IAAAA,SAAS,GAACR,CAAV;AAAY;;AAA1B,CAApC,EAAgE,CAAhE;;AAUhyB,MAAML,mBAAmB,GAAG,UAAUc,IAAV,EAAgBC,SAAhB,EAA2B;AAC7DT,EAAAA,OAAO,CAACU,GAAR;AAEA,QAAMC,GAAG,0BAAmBH,IAAnB,CAAT;AAEA,MAAII,MAAM,GAAG,CAAb;;AACA,MAAIV,YAAY,CAAC,MAAMF,OAAO,CAACa,IAAR,CAAaF,GAAb,CAAP,CAAhB,EAA2C;AAC1CC,IAAAA,MAAM,GAAGZ,OAAO,CAACa,IAAR,CAAaF,GAAb,CAAT;AACA;;AAED,MAAIH,IAAI,IAAI,IAAZ,EAAkB;AACjB;AACA;;AACD,QAAMM,IAAI,GAAGC,yBAAyB,CAACC,oBAA1B,IAAkD,EAA/D;AACA,mBAAUF,IAAV,2BAA+BG,kBAAkB,CAACT,IAAD,CAAjD,cAA2DC,SAA3D,kBAA4EG,MAA5E;AACA,CAfM;;AAiBA,MAAMjB,iBAAiB,GAAG,UAAUuB,SAAV,EAAqB;AACrD,SAAOd,KAAK,CAACe,IAAN,YAAeD,SAAS,CAACV,IAAzB,OAAP;AACA,QAAMY,UAAU,GAAGhB,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDC,OAAnD,CAA2DP,SAAS,CAACV,IAArE,CAAnB;;AACA,MAAIY,UAAU,KAAK,CAAC,CAApB,EAAuB;AACtBhB,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDE,MAAnD,CAA0DN,UAA1D,EAAsE,CAAtE;AACA;;AACD,QAAMO,cAAc,GAAGvB,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCM,OAAhC,YAA4CP,SAAS,CAACV,IAAtD,OAAvB;;AACA,MAAImB,cAAc,KAAK,CAAC,CAAxB,EAA2B;AAC1BvB,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCO,MAAhC,CAAuCC,cAAvC,EAAuD,CAAvD;AACA;;AACD,MAAIzB,YAAY,CAAC,MAAMgB,SAAS,CAACU,OAAjB,CAAhB,EAA2C;AAC1C,SAAK,MAAMC,KAAX,IAAoBX,SAAS,CAACU,OAA9B,EAAuC;AACtC,aAAOxB,KAAK,CAACe,IAAN,YAAeU,KAAf,OAAP;AACA,YAAMC,UAAU,GAAG1B,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCM,OAAhC,YAA4CI,KAA5C,OAAnB;;AACA,UAAIC,UAAU,KAAK,CAAC,CAApB,EAAuB;AACtB1B,QAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCO,MAAhC,CAAuCI,UAAvC,EAAmD,CAAnD;AACA;AACD;AACD;;AACDzB,EAAAA,WAAW,CAAC0B,YAAZ,CAAyB,QAAzB;AACA,CApBM;;AAsBA,MAAMnC,iBAAiB,GAAG,UAAUsB,SAAV,EAAqB;AACrD,MAAIP,GAAG,0BAAmBO,SAAS,CAACV,IAA7B,CAAP;AACAR,EAAAA,OAAO,CAACgC,GAAR,CAAYrB,GAAZ,EAAiBsB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACrB,MAAL,KAAgB,IAA3B,CAAjB;AAEA,QAAMuB,cAAc,GAAGjC,YAAY,CAAC,MAAMgB,SAAS,CAACkB,YAAjB,CAAnC;AACA,QAAMC,cAAc,GAAGnC,YAAY,CAAC,MAAMgB,SAAS,CAACU,OAAjB,CAAnC;;AAEA,MAAIO,cAAc,IAAIjC,YAAY,CAAC,MAAME,KAAK,CAACe,IAAN,YAAeD,SAAS,CAACkB,YAAzB,QAA0CR,OAAjD,CAAlC,EAA6F;AAC5F,SAAK,MAAMC,KAAX,IAAoBzB,KAAK,CAACe,IAAN,YAAeD,SAAS,CAACkB,YAAzB,QAA0CR,OAA9D,EAAuE;AACtE,aAAOxB,KAAK,CAACe,IAAN,YAAeU,KAAf,OAAP;AACA,YAAMC,UAAU,GAAG1B,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCM,OAAhC,YAA4CI,KAA5C,OAAnB;;AACA,UAAIC,UAAU,KAAK,CAAC,CAApB,EAAuB;AACtB1B,QAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCO,MAAhC,CAAuCI,UAAvC,EAAmD,CAAnD;AACA;AACD;AACD;;AAED,MAAIK,cAAc,IAAIjB,SAAS,CAACV,IAAV,KAAmBU,SAAS,CAACkB,YAAnD,EAAiE;AAChE,UAAMhB,UAAU,GAAGhB,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDC,OAAnD,CAA2DP,SAAS,CAACkB,YAArE,CAAnB;;AACA,QAAIhB,UAAU,KAAK,CAAC,CAApB,EAAuB;AACtBhB,MAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDE,MAAnD,CAA0DN,UAA1D,EAAsE,CAAtE;AACA;;AACD,UAAMO,cAAc,GAAGvB,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCM,OAAhC,YAA4CP,SAAS,CAACkB,YAAtD,OAAvB;;AACA,QAAIT,cAAc,KAAK,CAAC,CAAxB,EAA2B;AAC1BvB,MAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCO,MAAhC,CAAuCC,cAAvC,EAAuD,CAAvD;AACA;;AACD,WAAOvB,KAAK,CAACe,IAAN,YAAeD,SAAS,CAACkB,YAAzB,OAAP;AACA;;AAED,QAAME,aAAa,GAAGlC,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDC,OAAnD,WAA8DP,SAAS,CAACV,IAAxE,EAAtB;;AACA,MAAI8B,aAAa,KAAK,CAAC,CAAvB,EAA0B;AACzBlC,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDe,IAAnD,WAA2DrB,SAAS,CAACV,IAArE;AACAJ,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCoB,IAAhC,YAAyCrB,SAAS,CAACV,IAAnD;AACA;;AACDJ,EAAAA,KAAK,CAACe,IAAN,YAAeD,SAAS,CAACV,IAAzB,UAAoCgC,MAAM,CAACC,MAAP,CAAc;AAAEC,IAAAA,YAAY,EAAE;AAAhB,GAAd,EAA+CtC,KAAK,CAACe,IAAN,YAAeD,SAAS,CAACV,IAAzB,OAA/C,EAAkFU,SAAlF,CAApC;;AACA,MAAImB,cAAJ,EAAoB;AACnB,SAAK,MAAMR,KAAX,IAAoBX,SAAS,CAACU,OAA9B,EAAuC;AACtCxB,MAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCoB,IAAhC,YAAyCV,KAAzC;AACAzB,MAAAA,KAAK,CAACe,IAAN,YAAeU,KAAf,UAA2B,EAA3B;AACAzB,MAAAA,KAAK,CAACe,IAAN,YAAeU,KAAf,QAAyBa,YAAzB,GAAwC,aAAxC;AACAtC,MAAAA,KAAK,CAACe,IAAN,YAAeU,KAAf,QAAyBc,OAAzB,GAAmCzB,SAAS,CAACV,IAA7C;AACA;AACD;;AAED,QAAMoC,GAAG,GAAGlD,mBAAmB,CAACwB,SAAS,CAACV,IAAX,EAAiBU,SAAS,CAACT,SAA3B,CAA/B,CA5CqD,CA8CrD;;AACA,MAAI0B,cAAc,IAAIjB,SAAS,CAACV,IAAV,KAAmBU,SAAS,CAACkB,YAAnD,EAAiE;AAChES,IAAAA,CAAC,CAACC,QAAD,CAAD,CACEC,IADF,gDAC+C7B,SAAS,CAACkB,YADzD,SAEEY,GAFF,CAEM,kBAFN,iBAEkCJ,GAFlC,SAGEK,IAHF,CAGO,YAHP,YAGwB/B,SAAS,CAACV,IAHlC;AAIA,GALD,MAKO;AACNqC,IAAAA,CAAC,CAACC,QAAD,CAAD,CAAYC,IAAZ,gDAAyD7B,SAAS,CAACV,IAAnE,SAA6EwC,GAA7E,CAAiF,kBAAjF,iBAA6GJ,GAA7G;AACA,GAtDoD,CAwDrD;;;AACA,MAAIT,cAAc,IAAIjB,SAAS,CAACV,IAAV,KAAmBU,SAAS,CAACkB,YAAnD,EAAiE;AAChES,IAAAA,CAAC,CAACC,QAAD,CAAD,CACEC,IADF,0BACyB7B,SAAS,CAACkB,YADnC,cAEEY,GAFF,CAEM,kBAFN,iBAEkCJ,GAFlC,SAGEK,IAHF,CAGO,YAHP,YAGwB/B,SAAS,CAACV,IAHlC;AAIAqC,IAAAA,CAAC,CAACC,QAAD,CAAD,CACEC,IADF,0BACyB7B,SAAS,CAACkB,YADnC,SAEEa,IAFF,CAEO,YAFP,YAEwB/B,SAAS,CAACV,IAFlC,GAGEyC,IAHF,CAGO,OAHP,kBAGyB/B,SAAS,CAACV,IAHnC;AAIA,GATD,MASO;AACNqC,IAAAA,CAAC,CAACC,QAAD,CAAD,CAAYC,IAAZ,0BAAmC7B,SAAS,CAACV,IAA7C,cAA4DwC,GAA5D,CAAgE,kBAAhE,iBAA4FJ,GAA5F;AACA,GApEoD,CAsErD;;;AACA,OAAKjC,GAAL,IAAYR,WAAW,CAAC+C,WAAxB,EAAqC;AACpC,QAAI/C,WAAW,CAAC+C,WAAZ,CAAwBC,cAAxB,CAAuCxC,GAAvC,CAAJ,EAAiD;AAChD,YAAMyC,IAAI,GAAGjD,WAAW,CAAC+C,WAAZ,CAAwBvC,GAAxB,CAAb;;AACA,UAAIwB,cAAc,IAAIjB,SAAS,CAACV,IAAV,KAAmBU,SAAS,CAACkB,YAAnD,EAAiE;AAChES,QAAAA,CAAC,CAACO,IAAI,CAACC,GAAN,CAAD,CACEN,IADF,4BAC2B7B,SAAS,CAACkB,YADrC,SAEEY,GAFF,CAEM,kBAFN,iBAEkCJ,GAFlC,SAGEK,IAHF,CAGO,YAHP,YAGwB/B,SAAS,CAACV,IAHlC;AAIA,OALD,MAKO;AACNqC,QAAAA,CAAC,CAACO,IAAI,CAACC,GAAN,CAAD,CAAYN,IAAZ,4BAAqC7B,SAAS,CAACV,IAA/C,SAAyDwC,GAAzD,CAA6D,kBAA7D,iBAAyFJ,GAAzF;AACA;AACD;AACD;;AAEDvC,EAAAA,WAAW,CAAC0B,YAAZ,CAAyB,QAAzB;AACA,CAtFM;;AAwFP,MAAMuB,YAAY,GAAIC,IAAD,IAAU;AAC9B,QAAMC,gBAAgB,GAAGpD,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCsC,GAAhC,CAAoCxD,YAApC,EAAkDyD,IAAlD,CAAuD,GAAvD,CAAzB;;AACA,MAAIF,gBAAgB,KAAKpD,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BqC,gBAApD,EAAsE;AACrEvD,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BqC,gBAA3B,GAA8CH,gBAA9C;AACApD,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BsC,OAA3B,GAAqC,IAAIC,MAAJ,yGAC+DL,gBAD/D,QAEpC,IAFoC,CAArC;AAIA;;AAEDD,EAAAA,IAAI,GAAGA,IAAI,CAACO,OAAL,CAAa1D,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BsC,OAAxC,EAAkDG,SAAD,IAAe;AACtE,QAAI,OAAOA,SAAP,KAAqB,WAArB,IAAoCA,SAAS,KAAK,EAAlD,IAAwD3D,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCM,OAAhC,CAAwCsC,SAAxC,MAAuD,CAAC,CAApH,EAAuH;AACtH,aAAOA,SAAP;AACA;;AAED,QAAIC,UAAU,GAAGD,SAAS,CAACD,OAAV,CAAkB,IAAlB,EAAwB,EAAxB,CAAjB;AAEA,QAAIG,SAAS,GAAG7D,KAAK,CAACe,IAAN,CAAW4C,SAAX,CAAhB;;AACA,QAAIE,SAAS,CAACd,cAAV,CAAyB,SAAzB,CAAJ,EAAyC;AACxCa,MAAAA,UAAU,GAAGC,SAAS,CAACtB,OAAvB;AACAsB,MAAAA,SAAS,GAAG7D,KAAK,CAACe,IAAN,YAAe6C,UAAf,OAAZ;AACA;;AAED,wEAA0DtE,mBAAmB,CAC5EsE,UAD4E,EAE5EC,SAAS,CAACxD,SAFkE,CAA7E,+BAGoBuD,UAHpB,wBAG0CD,SAH1C,gBAGwDA,SAHxD;AAIA,GAjBM,CAAP;AAmBA,SAAOR,IAAP;AACA,CA9BD;;AAgCAnD,KAAK,CAACiB,QAAN,CAAeC,WAAf,GAA6B;AAC5B4C,EAAAA,eAAe,EAAE,CAAC;AAAEvD,IAAAA,GAAG,EAAE,QAAP;AAAiBwD,IAAAA,IAAI,EAAE;AAAvB,GAAD,CADW;AAE5B7B,EAAAA,aAAa,EAAE,CAFa;AAG5B8B,EAAAA,QAAQ,EAAE,EAHkB;AAI5BjD,EAAAA,IAAI,EAAE,EAJsB;AAK5BwC,EAAAA,gBAAgB,EAAE,IALU;AAM5BC,EAAAA,OAAO,EAAE,IANmB;AAQ5BS,EAAAA,MAAM,EAAEf,YARoB;AAS5BgB,EAAAA,YAAY,EAAEhB;AATc,CAA7B;AAYAzD,MAAM,CAAC0E,OAAP,CAAe,MACdjE,uBAAuB,CAACkE,OAAxB,CAAgC,YAAY;AAC3C,MAAI;AACH,UAAM;AACLC,MAAAA,MAAM,EAAE;AAAEC,QAAAA,MAAM,EAAED;AAAV;AADH,QAEF,MAAMlE,SAAS,CAACoE,EAAV,CAAajE,GAAb,CAAiB,mBAAjB,CAFV;AAIAN,IAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,GAA8C;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAA9C;;AACA,SAAK,MAAMoD,YAAX,IAA2BH,MAA3B,EAAmC;AAClCrE,MAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BC,gBAA3B,CAA4CC,MAA5C,CAAmDe,IAAnD,CAAwDqC,YAAY,CAACpE,IAArE;AACAJ,MAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCoB,IAAhC,YAAyCqC,YAAY,CAACpE,IAAtD;AACAJ,MAAAA,KAAK,CAACe,IAAN,YAAeyD,YAAY,CAACpE,IAA5B,UAAuCoE,YAAvC;AACAxE,MAAAA,KAAK,CAACe,IAAN,YAAeyD,YAAY,CAACpE,IAA5B,QAAqCkC,YAArC,GAAoD,aAApD;;AACA,WAAK,MAAMb,KAAX,IAAoB+C,YAAY,CAAChD,OAAjC,EAA0C;AACzCxB,QAAAA,KAAK,CAACiB,QAAN,CAAeC,WAAf,CAA2BH,IAA3B,CAAgCoB,IAAhC,YAAyCV,KAAzC;AACAzB,QAAAA,KAAK,CAACe,IAAN,YAAeU,KAAf,UAA2B;AAC1Ba,UAAAA,YAAY,EAAE,aADY;AAE1BC,UAAAA,OAAO,EAAEiC,YAAY,CAACpE;AAFI,SAA3B;AAIA;AACD;;AAEDH,IAAAA,WAAW,CAAC0B,YAAZ,CAAyB,QAAzB;AACA,GArBD,CAqBE,OAAO8C,CAAP,EAAU;AACXC,IAAAA,OAAO,CAACC,KAAR,CAAc,4BAAd,EAA4CF,CAA5C;AACA;AACD,CAzBD,CADD","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\n\nimport { isSetNotNull } from './function-isSet';\nimport { RoomManager } from '../../../ui-utils/client';\nimport { emoji, EmojiPicker } from '../../../emoji/client';\nimport { CachedCollectionManager } from '../../../ui-cached-collection/client';\nimport { APIClient } from '../../../utils/client';\n\nexport const getEmojiUrlFromName = function (name, extension) {\n\tSession.get;\n\n\tconst key = `emoji_random_${name}`;\n\n\tlet random = 0;\n\tif (isSetNotNull(() => Session.keys[key])) {\n\t\trandom = Session.keys[key];\n\t}\n\n\tif (name == null) {\n\t\treturn;\n\t}\n\tconst path = __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';\n\treturn `${path}/emoji-custom/${encodeURIComponent(name)}.${extension}?_dc=${random}`;\n};\n\nexport const deleteEmojiCustom = function (emojiData) {\n\tdelete emoji.list[`:${emojiData.name}:`];\n\tconst arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.name);\n\tif (arrayIndex !== -1) {\n\t\temoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);\n\t}\n\tconst arrayIndexList = emoji.packages.emojiCustom.list.indexOf(`:${emojiData.name}:`);\n\tif (arrayIndexList !== -1) {\n\t\temoji.packages.emojiCustom.list.splice(arrayIndexList, 1);\n\t}\n\tif (isSetNotNull(() => emojiData.aliases)) {\n\t\tfor (const alias of emojiData.aliases) {\n\t\t\tdelete emoji.list[`:${alias}:`];\n\t\t\tconst aliasIndex = emoji.packages.emojiCustom.list.indexOf(`:${alias}:`);\n\t\t\tif (aliasIndex !== -1) {\n\t\t\t\temoji.packages.emojiCustom.list.splice(aliasIndex, 1);\n\t\t\t}\n\t\t}\n\t}\n\tEmojiPicker.updateRecent('rocket');\n};\n\nexport const updateEmojiCustom = function (emojiData) {\n\tlet key = `emoji_random_${emojiData.name}`;\n\tSession.set(key, Math.round(Math.random() * 1000));\n\n\tconst previousExists = isSetNotNull(() => emojiData.previousName);\n\tconst currentAliases = isSetNotNull(() => emojiData.aliases);\n\n\tif (previousExists && isSetNotNull(() => emoji.list[`:${emojiData.previousName}:`].aliases)) {\n\t\tfor (const alias of emoji.list[`:${emojiData.previousName}:`].aliases) {\n\t\t\tdelete emoji.list[`:${alias}:`];\n\t\t\tconst aliasIndex = emoji.packages.emojiCustom.list.indexOf(`:${alias}:`);\n\t\t\tif (aliasIndex !== -1) {\n\t\t\t\temoji.packages.emojiCustom.list.splice(aliasIndex, 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (previousExists && emojiData.name !== emojiData.previousName) {\n\t\tconst arrayIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(emojiData.previousName);\n\t\tif (arrayIndex !== -1) {\n\t\t\temoji.packages.emojiCustom.emojisByCategory.rocket.splice(arrayIndex, 1);\n\t\t}\n\t\tconst arrayIndexList = emoji.packages.emojiCustom.list.indexOf(`:${emojiData.previousName}:`);\n\t\tif (arrayIndexList !== -1) {\n\t\t\temoji.packages.emojiCustom.list.splice(arrayIndexList, 1);\n\t\t}\n\t\tdelete emoji.list[`:${emojiData.previousName}:`];\n\t}\n\n\tconst categoryIndex = emoji.packages.emojiCustom.emojisByCategory.rocket.indexOf(`${emojiData.name}`);\n\tif (categoryIndex === -1) {\n\t\temoji.packages.emojiCustom.emojisByCategory.rocket.push(`${emojiData.name}`);\n\t\temoji.packages.emojiCustom.list.push(`:${emojiData.name}:`);\n\t}\n\temoji.list[`:${emojiData.name}:`] = Object.assign({ emojiPackage: 'emojiCustom' }, emoji.list[`:${emojiData.name}:`], emojiData);\n\tif (currentAliases) {\n\t\tfor (const alias of emojiData.aliases) {\n\t\t\temoji.packages.emojiCustom.list.push(`:${alias}:`);\n\t\t\temoji.list[`:${alias}:`] = {};\n\t\t\temoji.list[`:${alias}:`].emojiPackage = 'emojiCustom';\n\t\t\temoji.list[`:${alias}:`].aliasOf = emojiData.name;\n\t\t}\n\t}\n\n\tconst url = getEmojiUrlFromName(emojiData.name, emojiData.extension);\n\n\t// update in admin interface\n\tif (previousExists && emojiData.name !== emojiData.previousName) {\n\t\t$(document)\n\t\t\t.find(`.emojiAdminPreview-image[data-emoji='${emojiData.previousName}']`)\n\t\t\t.css('background-image', `url('${url})'`)\n\t\t\t.attr('data-emoji', `${emojiData.name}`);\n\t} else {\n\t\t$(document).find(`.emojiAdminPreview-image[data-emoji='${emojiData.name}']`).css('background-image', `url('${url}')`);\n\t}\n\n\t// update in picker\n\tif (previousExists && emojiData.name !== emojiData.previousName) {\n\t\t$(document)\n\t\t\t.find(`li[data-emoji='${emojiData.previousName}'] span`)\n\t\t\t.css('background-image', `url('${url}')`)\n\t\t\t.attr('data-emoji', `${emojiData.name}`);\n\t\t$(document)\n\t\t\t.find(`li[data-emoji='${emojiData.previousName}']`)\n\t\t\t.attr('data-emoji', `${emojiData.name}`)\n\t\t\t.attr('class', `emoji-${emojiData.name}`);\n\t} else {\n\t\t$(document).find(`li[data-emoji='${emojiData.name}'] span`).css('background-image', `url('${url}')`);\n\t}\n\n\t// update in picker and opened rooms\n\tfor (key in RoomManager.openedRooms) {\n\t\tif (RoomManager.openedRooms.hasOwnProperty(key)) {\n\t\t\tconst room = RoomManager.openedRooms[key];\n\t\t\tif (previousExists && emojiData.name !== emojiData.previousName) {\n\t\t\t\t$(room.dom)\n\t\t\t\t\t.find(`span[data-emoji='${emojiData.previousName}']`)\n\t\t\t\t\t.css('background-image', `url('${url}')`)\n\t\t\t\t\t.attr('data-emoji', `${emojiData.name}`);\n\t\t\t} else {\n\t\t\t\t$(room.dom).find(`span[data-emoji='${emojiData.name}']`).css('background-image', `url('${url}')`);\n\t\t\t}\n\t\t}\n\t}\n\n\tEmojiPicker.updateRecent('rocket');\n};\n\nconst customRender = (html) => {\n\tconst emojisMatchGroup = emoji.packages.emojiCustom.list.map(escapeRegExp).join('|');\n\tif (emojisMatchGroup !== emoji.packages.emojiCustom._regexpSignature) {\n\t\temoji.packages.emojiCustom._regexpSignature = emojisMatchGroup;\n\t\temoji.packages.emojiCustom._regexp = new RegExp(\n\t\t\t`<object[^>]*>.*?<\\/object>|<span[^>]*>.*?<\\/span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|(${emojisMatchGroup})`,\n\t\t\t'gi',\n\t\t);\n\t}\n\n\thtml = html.replace(emoji.packages.emojiCustom._regexp, (shortname) => {\n\t\tif (typeof shortname === 'undefined' || shortname === '' || emoji.packages.emojiCustom.list.indexOf(shortname) === -1) {\n\t\t\treturn shortname;\n\t\t}\n\n\t\tlet emojiAlias = shortname.replace(/:/g, '');\n\n\t\tlet dataCheck = emoji.list[shortname];\n\t\tif (dataCheck.hasOwnProperty('aliasOf')) {\n\t\t\temojiAlias = dataCheck.aliasOf;\n\t\t\tdataCheck = emoji.list[`:${emojiAlias}:`];\n\t\t}\n\n\t\treturn `<span class=\"emoji\" style=\"background-image:url(${getEmojiUrlFromName(\n\t\t\temojiAlias,\n\t\t\tdataCheck.extension,\n\t\t)});\" data-emoji=\"${emojiAlias}\" title=\"${shortname}\">${shortname}</span>`;\n\t});\n\n\treturn html;\n};\n\nemoji.packages.emojiCustom = {\n\temojiCategories: [{ key: 'rocket', i18n: 'Custom' }],\n\tcategoryIndex: 1,\n\ttoneList: {},\n\tlist: [],\n\t_regexpSignature: null,\n\t_regexp: null,\n\n\trender: customRender,\n\trenderPicker: customRender,\n};\n\nMeteor.startup(() =>\n\tCachedCollectionManager.onLogin(async () => {\n\t\ttry {\n\t\t\tconst {\n\t\t\t\temojis: { update: emojis },\n\t\t\t} = await APIClient.v1.get('emoji-custom.list');\n\n\t\t\temoji.packages.emojiCustom.emojisByCategory = { rocket: [] };\n\t\t\tfor (const currentEmoji of emojis) {\n\t\t\t\temoji.packages.emojiCustom.emojisByCategory.rocket.push(currentEmoji.name);\n\t\t\t\temoji.packages.emojiCustom.list.push(`:${currentEmoji.name}:`);\n\t\t\t\temoji.list[`:${currentEmoji.name}:`] = currentEmoji;\n\t\t\t\temoji.list[`:${currentEmoji.name}:`].emojiPackage = 'emojiCustom';\n\t\t\t\tfor (const alias of currentEmoji.aliases) {\n\t\t\t\t\temoji.packages.emojiCustom.list.push(`:${alias}:`);\n\t\t\t\t\temoji.list[`:${alias}:`] = {\n\t\t\t\t\t\temojiPackage: 'emojiCustom',\n\t\t\t\t\t\taliasOf: currentEmoji.name,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tEmojiPicker.updateRecent('rocket');\n\t\t} catch (e) {\n\t\t\tconsole.error('Error getting custom emoji', e);\n\t\t}\n\t}),\n);\n"]},"sourceType":"module","hash":"6e1d6e9722b573a8a768564f589c820c739cd6ed"}
