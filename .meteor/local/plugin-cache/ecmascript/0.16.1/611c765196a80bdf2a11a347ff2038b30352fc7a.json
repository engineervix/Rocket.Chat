{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/sidebar/header/CreateChannelWithData.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/sidebar/header/CreateChannelWithData.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/sidebar/header/CreateChannelWithData.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/sidebar/header/CreateChannelWithData.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/sidebar/header/CreateChannelWithData.js"}},"code":"let _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 0);\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n\n}, 0);\nlet React, memo, useCallback, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  memo(v) {\n    memo = v;\n  },\n\n  useCallback(v) {\n    useCallback = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  }\n\n}, 1);\nlet usePermission;\nmodule.link(\"../../contexts/AuthorizationContext\", {\n  usePermission(v) {\n    usePermission = v;\n  }\n\n}, 2);\nlet useSetting;\nmodule.link(\"../../contexts/SettingsContext\", {\n  useSetting(v) {\n    useSetting = v;\n  }\n\n}, 3);\nlet useEndpointActionExperimental;\nmodule.link(\"../../hooks/useEndpointActionExperimental\", {\n  useEndpointActionExperimental(v) {\n    useEndpointActionExperimental = v;\n  }\n\n}, 4);\nlet useForm;\nmodule.link(\"../../hooks/useForm\", {\n  useForm(v) {\n    useForm = v;\n  }\n\n}, 5);\nlet goToRoomById;\nmodule.link(\"../../lib/utils/goToRoomById\", {\n  goToRoomById(v) {\n    goToRoomById = v;\n  }\n\n}, 6);\nlet CreateChannel;\nmodule.link(\"./CreateChannel\", {\n  default(v) {\n    CreateChannel = v;\n  }\n\n}, 7);\n\nconst CreateChannelWithData = _ref => {\n  let {\n    onClose,\n    teamId = '',\n    reload\n  } = _ref;\n  const createChannel = useEndpointActionExperimental('POST', 'channels.create');\n  const createPrivateChannel = useEndpointActionExperimental('POST', 'groups.create');\n  const canCreateChannel = usePermission('create-c');\n  const canCreatePrivateChannel = usePermission('create-p');\n  const e2eEnabledForPrivateByDefault = useSetting('E2E_Enabled_Default_PrivateRooms');\n  const canOnlyCreateOneType = useMemo(() => {\n    if (!canCreateChannel && canCreatePrivateChannel) {\n      return 'p';\n    }\n\n    if (canCreateChannel && !canCreatePrivateChannel) {\n      return 'c';\n    }\n\n    return false;\n  }, [canCreateChannel, canCreatePrivateChannel]);\n  const initialValues = {\n    users: [],\n    name: '',\n    description: '',\n    type: canOnlyCreateOneType ? canOnlyCreateOneType === 'p' : true,\n    readOnly: false,\n    encrypted: e2eEnabledForPrivateByDefault !== null && e2eEnabledForPrivateByDefault !== void 0 ? e2eEnabledForPrivateByDefault : false,\n    broadcast: false\n  };\n  const {\n    values,\n    handlers,\n    hasUnsavedChanges\n  } = useForm(initialValues);\n  const {\n    users,\n    name,\n    description,\n    type,\n    readOnly,\n    broadcast,\n    encrypted\n  } = values;\n  const {\n    handleUsers,\n    handleEncrypted,\n    handleType,\n    handleBroadcast,\n    handleReadOnly\n  } = handlers;\n  const onChangeUsers = useMutableCallback((value, action) => {\n    if (!action) {\n      if (users.includes(value)) {\n        return;\n      }\n\n      return handleUsers([...users, value]);\n    }\n\n    handleUsers(users.filter(current => current !== value));\n  });\n  const onChangeType = useMutableCallback(value => {\n    handleEncrypted(!value);\n    return handleType(value);\n  });\n  const onChangeBroadcast = useMutableCallback(value => {\n    handleEncrypted(!value);\n    handleReadOnly(value);\n    return handleBroadcast(value);\n  });\n  const onCreate = useCallback(async () => {\n    const goToRoom = rid => {\n      goToRoomById(rid);\n    };\n\n    const params = {\n      name,\n      members: users,\n      readOnly,\n      extraData: _objectSpread({\n        description,\n        broadcast,\n        encrypted\n      }, teamId && {\n        teamId\n      })\n    };\n    let roomData;\n\n    if (type) {\n      roomData = await createPrivateChannel(params);\n      !teamId && goToRoom(roomData.group._id);\n    } else {\n      roomData = await createChannel(params);\n      !teamId && goToRoom(roomData.channel._id);\n    }\n\n    onClose();\n    reload();\n  }, [broadcast, createChannel, createPrivateChannel, description, encrypted, name, onClose, readOnly, teamId, type, users, reload]);\n  return /*#__PURE__*/React.createElement(CreateChannel, {\n    values: values,\n    handlers: handlers,\n    hasUnsavedChanges: hasUnsavedChanges,\n    onChangeUsers: onChangeUsers,\n    onChangeType: onChangeType,\n    onChangeBroadcast: onChangeBroadcast,\n    canOnlyCreateOneType: canOnlyCreateOneType,\n    e2eEnabledForPrivateByDefault: e2eEnabledForPrivateByDefault,\n    onClose: onClose,\n    onCreate: onCreate\n  });\n};\n\nmodule.exportDefault( /*#__PURE__*/memo(CreateChannelWithData));","map":{"version":3,"sources":["client/sidebar/header/CreateChannelWithData.js"],"names":["_objectSpread","module","link","default","v","useMutableCallback","React","memo","useCallback","useMemo","usePermission","useSetting","useEndpointActionExperimental","useForm","goToRoomById","CreateChannel","CreateChannelWithData","onClose","teamId","reload","createChannel","createPrivateChannel","canCreateChannel","canCreatePrivateChannel","e2eEnabledForPrivateByDefault","canOnlyCreateOneType","initialValues","users","name","description","type","readOnly","encrypted","broadcast","values","handlers","hasUnsavedChanges","handleUsers","handleEncrypted","handleType","handleBroadcast","handleReadOnly","onChangeUsers","value","action","includes","filter","current","onChangeType","onChangeBroadcast","onCreate","goToRoom","rid","params","members","extraData","roomData","group","_id","channel","exportDefault"],"mappings":"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","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { memo, useCallback, useMemo } from 'react';\n\nimport { usePermission } from '../../contexts/AuthorizationContext';\nimport { useSetting } from '../../contexts/SettingsContext';\nimport { useEndpointActionExperimental } from '../../hooks/useEndpointActionExperimental';\nimport { useForm } from '../../hooks/useForm';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\nimport CreateChannel from './CreateChannel';\n\nconst CreateChannelWithData = ({ onClose, teamId = '', reload }) => {\n\tconst createChannel = useEndpointActionExperimental('POST', 'channels.create');\n\tconst createPrivateChannel = useEndpointActionExperimental('POST', 'groups.create');\n\tconst canCreateChannel = usePermission('create-c');\n\tconst canCreatePrivateChannel = usePermission('create-p');\n\tconst e2eEnabledForPrivateByDefault = useSetting('E2E_Enabled_Default_PrivateRooms');\n\tconst canOnlyCreateOneType = useMemo(() => {\n\t\tif (!canCreateChannel && canCreatePrivateChannel) {\n\t\t\treturn 'p';\n\t\t}\n\t\tif (canCreateChannel && !canCreatePrivateChannel) {\n\t\t\treturn 'c';\n\t\t}\n\t\treturn false;\n\t}, [canCreateChannel, canCreatePrivateChannel]);\n\n\tconst initialValues = {\n\t\tusers: [],\n\t\tname: '',\n\t\tdescription: '',\n\t\ttype: canOnlyCreateOneType ? canOnlyCreateOneType === 'p' : true,\n\t\treadOnly: false,\n\t\tencrypted: e2eEnabledForPrivateByDefault ?? false,\n\t\tbroadcast: false,\n\t};\n\tconst { values, handlers, hasUnsavedChanges } = useForm(initialValues);\n\n\tconst { users, name, description, type, readOnly, broadcast, encrypted } = values;\n\tconst { handleUsers, handleEncrypted, handleType, handleBroadcast, handleReadOnly } = handlers;\n\n\tconst onChangeUsers = useMutableCallback((value, action) => {\n\t\tif (!action) {\n\t\t\tif (users.includes(value)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleUsers([...users, value]);\n\t\t}\n\t\thandleUsers(users.filter((current) => current !== value));\n\t});\n\n\tconst onChangeType = useMutableCallback((value) => {\n\t\thandleEncrypted(!value);\n\t\treturn handleType(value);\n\t});\n\n\tconst onChangeBroadcast = useMutableCallback((value) => {\n\t\thandleEncrypted(!value);\n\t\thandleReadOnly(value);\n\t\treturn handleBroadcast(value);\n\t});\n\n\tconst onCreate = useCallback(async () => {\n\t\tconst goToRoom = (rid) => {\n\t\t\tgoToRoomById(rid);\n\t\t};\n\n\t\tconst params = {\n\t\t\tname,\n\t\t\tmembers: users,\n\t\t\treadOnly,\n\t\t\textraData: {\n\t\t\t\tdescription,\n\t\t\t\tbroadcast,\n\t\t\t\tencrypted,\n\t\t\t\t...(teamId && { teamId }),\n\t\t\t},\n\t\t};\n\t\tlet roomData;\n\n\t\tif (type) {\n\t\t\troomData = await createPrivateChannel(params);\n\t\t\t!teamId && goToRoom(roomData.group._id);\n\t\t} else {\n\t\t\troomData = await createChannel(params);\n\t\t\t!teamId && goToRoom(roomData.channel._id);\n\t\t}\n\n\t\tonClose();\n\t\treload();\n\t}, [broadcast, createChannel, createPrivateChannel, description, encrypted, name, onClose, readOnly, teamId, type, users, reload]);\n\n\treturn (\n\t\t<CreateChannel\n\t\t\tvalues={values}\n\t\t\thandlers={handlers}\n\t\t\thasUnsavedChanges={hasUnsavedChanges}\n\t\t\tonChangeUsers={onChangeUsers}\n\t\t\tonChangeType={onChangeType}\n\t\t\tonChangeBroadcast={onChangeBroadcast}\n\t\t\tcanOnlyCreateOneType={canOnlyCreateOneType}\n\t\t\te2eEnabledForPrivateByDefault={e2eEnabledForPrivateByDefault}\n\t\t\tonClose={onClose}\n\t\t\tonCreate={onCreate}\n\t\t/>\n\t);\n};\n\nexport default memo(CreateChannelWithData);\n"]},"sourceType":"module","hash":"611c765196a80bdf2a11a347ff2038b30352fc7a"}
