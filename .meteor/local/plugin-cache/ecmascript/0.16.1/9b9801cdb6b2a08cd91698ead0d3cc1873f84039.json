{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/Omnichannel/modals/CloseChatModal.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/components/Omnichannel/modals/CloseChatModal.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/Omnichannel/modals/CloseChatModal.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/components/Omnichannel/modals/CloseChatModal.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/components/Omnichannel/modals/CloseChatModal.js"}},"code":"var _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nvar Field, Button, TextInput, Icon, ButtonGroup, Modal, Box;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field: function (v) {\n    Field = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Modal: function (v) {\n    Modal = v;\n  },\n  Box: function (v) {\n    Box = v;\n  }\n}, 0);\nvar useAutoFocus;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useAutoFocus: function (v) {\n    useAutoFocus = v;\n  }\n}, 1);\nvar React, useCallback, useState, useMemo, useEffect;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 2);\nvar useSetting;\nmodule.link(\"../../../contexts/SettingsContext\", {\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 3);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 4);\nvar useComponentDidUpdate;\nmodule.link(\"../../../hooks/useComponentDidUpdate\", {\n  useComponentDidUpdate: function (v) {\n    useComponentDidUpdate = v;\n  }\n}, 5);\nvar useForm;\nmodule.link(\"../../../hooks/useForm\", {\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 6);\nvar GenericModal;\nmodule.link(\"../../GenericModal\", {\n  \"default\": function (v) {\n    GenericModal = v;\n  }\n}, 7);\nvar Tags;\nmodule.link(\"../Tags\", {\n  \"default\": function (v) {\n    Tags = v;\n  }\n}, 8);\n\nvar CloseChatModal = function (_ref) {\n  var _ref$department = _ref.department,\n      department = _ref$department === void 0 ? {} : _ref$department,\n      onCancel = _ref.onCancel,\n      onConfirm = _ref.onConfirm;\n  var t = useTranslation();\n  var inputRef = useAutoFocus(true);\n\n  var _useForm = useForm({\n    comment: '',\n    tags: []\n  }),\n      values = _useForm.values,\n      handlers = _useForm.handlers;\n\n  var commentRequired = useSetting('Livechat_request_comment_when_closing_conversation');\n  var comment = values.comment,\n      tags = values.tags;\n  var handleComment = handlers.handleComment,\n      handleTags = handlers.handleTags;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      commentError = _useState2[0],\n      setCommentError = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tagError = _useState4[0],\n      setTagError = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      tagRequired = _useState6[0],\n      setTagRequired = _useState6[1];\n\n  var handleConfirm = useCallback(function () {\n    onConfirm(comment, tags);\n  }, [comment, onConfirm, tags]);\n  useComponentDidUpdate(function () {\n    setCommentError(!comment && commentRequired ? t('The_field_is_required', t('Comment')) : '');\n  }, [commentRequired, comment, t]);\n  var canConfirm = useMemo(function () {\n    var canConfirmTag = !tagError && (tagRequired ? tags.length > 0 : true);\n    var canConfirmComment = !commentError && (commentRequired ? !!comment : true);\n    return canConfirmTag && canConfirmComment;\n  }, [comment, commentError, commentRequired, tagError, tagRequired, tags.length]);\n  useEffect(function () {\n    (department === null || department === void 0 ? void 0 : department.requestTagBeforeClosingChat) && setTagRequired(true);\n    setTagError(tagRequired && (!tags || tags.length === 0) ? t('error-tags-must-be-assigned-before-closing-chat') : '');\n  }, [department, tagRequired, t, tags]);\n\n  if (!commentRequired && !tagRequired) {\n    return /*#__PURE__*/React.createElement(GenericModal, {\n      variant: \"warning\",\n      title: t('Are_you_sure_you_want_to_close_this_chat'),\n      onConfirm: handleConfirm,\n      onCancel: onCancel,\n      onClose: onCancel,\n      confirmText: t('Confirm')\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Icon, {\n    name: \"baloon-close-top-right\",\n    size: 20\n  }), /*#__PURE__*/React.createElement(Modal.Title, null, t('Closing_chat')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onCancel\n  })), /*#__PURE__*/React.createElement(Modal.Content, {\n    fontScale: \"p2\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    color: \"neutral-600\"\n  }, t('Close_room_description')), /*#__PURE__*/React.createElement(Field, {\n    marginBlock: \"x15\"\n  }, /*#__PURE__*/React.createElement(Field.Label, {\n    required: commentRequired\n  }, t('Comment')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    ref: inputRef,\n    error: commentError,\n    flexGrow: 1,\n    value: comment,\n    onChange: handleComment,\n    placeholder: t('Please_add_a_comment')\n  })), /*#__PURE__*/React.createElement(Field.Error, null, commentError)), Tags && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Tags, {\n    tagRequired: tagRequired,\n    tags: tags,\n    handler: handleTags,\n    error: tagError\n  }), /*#__PURE__*/React.createElement(Field.Error, null, tagError))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    align: \"end\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: onCancel\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    disabled: !canConfirm,\n    primary: true,\n    onClick: handleConfirm\n  }, t('Confirm')))));\n};\n\nmodule.exportDefault(CloseChatModal);","map":{"version":3,"sources":["client/components/Omnichannel/modals/CloseChatModal.js"],"names":["_slicedToArray","module","link","default","v","Field","Button","TextInput","Icon","ButtonGroup","Modal","Box","useAutoFocus","React","useCallback","useState","useMemo","useEffect","useSetting","useTranslation","useComponentDidUpdate","useForm","GenericModal","Tags","CloseChatModal","department","onCancel","onConfirm","t","inputRef","comment","tags","values","handlers","commentRequired","handleComment","handleTags","commentError","setCommentError","tagError","setTagError","tagRequired","setTagRequired","handleConfirm","canConfirm","canConfirmTag","length","canConfirmComment","requestTagBeforeClosingChat","exportDefault"],"mappings":"AAAA,IAAIA,cAAJ;;AAAmBC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,IAAAA,cAAc,GAACI,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAAnB,IAAIC,KAAJ,EAAUC,MAAV,EAAiBC,SAAjB,EAA2BC,IAA3B,EAAgCC,WAAhC,EAA4CC,KAA5C,EAAkDC,GAAlD;AAAsDV,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACG,EAAAA,KAAK,EAAC,UAASD,CAAT,EAAW;AAACC,IAAAA,KAAK,GAACD,CAAN;AAAQ,GAA3B;AAA4BE,EAAAA,MAAM,EAAC,UAASF,CAAT,EAAW;AAACE,IAAAA,MAAM,GAACF,CAAP;AAAS,GAAxD;AAAyDG,EAAAA,SAAS,EAAC,UAASH,CAAT,EAAW;AAACG,IAAAA,SAAS,GAACH,CAAV;AAAY,GAA3F;AAA4FI,EAAAA,IAAI,EAAC,UAASJ,CAAT,EAAW;AAACI,IAAAA,IAAI,GAACJ,CAAL;AAAO,GAApH;AAAqHK,EAAAA,WAAW,EAAC,UAASL,CAAT,EAAW;AAACK,IAAAA,WAAW,GAACL,CAAZ;AAAc,GAA3J;AAA4JM,EAAAA,KAAK,EAAC,UAASN,CAAT,EAAW;AAACM,IAAAA,KAAK,GAACN,CAAN;AAAQ,GAAtL;AAAuLO,EAAAA,GAAG,EAAC,UAASP,CAAT,EAAW;AAACO,IAAAA,GAAG,GAACP,CAAJ;AAAM;AAA7M,CAApC,EAAmP,CAAnP;AAAsP,IAAIQ,YAAJ;AAAiBX,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACU,EAAAA,YAAY,EAAC,UAASR,CAAT,EAAW;AAACQ,IAAAA,YAAY,GAACR,CAAb;AAAe;AAAzC,CAA1C,EAAqF,CAArF;AAAwF,IAAIS,KAAJ,EAAUC,WAAV,EAAsBC,QAAtB,EAA+BC,OAA/B,EAAuCC,SAAvC;AAAiDhB,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACS,IAAAA,KAAK,GAACT,CAAN;AAAQ,GAA7B;AAA8BU,EAAAA,WAAW,EAAC,UAASV,CAAT,EAAW;AAACU,IAAAA,WAAW,GAACV,CAAZ;AAAc,GAApE;AAAqEW,EAAAA,QAAQ,EAAC,UAASX,CAAT,EAAW;AAACW,IAAAA,QAAQ,GAACX,CAAT;AAAW,GAArG;AAAsGY,EAAAA,OAAO,EAAC,UAASZ,CAAT,EAAW;AAACY,IAAAA,OAAO,GAACZ,CAAR;AAAU,GAApI;AAAqIa,EAAAA,SAAS,EAAC,UAASb,CAAT,EAAW;AAACa,IAAAA,SAAS,GAACb,CAAV;AAAY;AAAvK,CAApB,EAA6L,CAA7L;AAAgM,IAAIc,UAAJ;AAAejB,MAAM,CAACC,IAAP,CAAY,mCAAZ,EAAgD;AAACgB,EAAAA,UAAU,EAAC,UAASd,CAAT,EAAW;AAACc,IAAAA,UAAU,GAACd,CAAX;AAAa;AAArC,CAAhD,EAAuF,CAAvF;AAA0F,IAAIe,cAAJ;AAAmBlB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACiB,EAAAA,cAAc,EAAC,UAASf,CAAT,EAAW;AAACe,IAAAA,cAAc,GAACf,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,CAAlG;AAAqG,IAAIgB,qBAAJ;AAA0BnB,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACkB,EAAAA,qBAAqB,EAAC,UAAShB,CAAT,EAAW;AAACgB,IAAAA,qBAAqB,GAAChB,CAAtB;AAAwB;AAA3D,CAAnD,EAAgH,CAAhH;AAAmH,IAAIiB,OAAJ;AAAYpB,MAAM,CAACC,IAAP,CAAY,wBAAZ,EAAqC;AAACmB,EAAAA,OAAO,EAAC,UAASjB,CAAT,EAAW;AAACiB,IAAAA,OAAO,GAACjB,CAAR;AAAU;AAA/B,CAArC,EAAsE,CAAtE;AAAyE,IAAIkB,YAAJ;AAAiBrB,MAAM,CAACC,IAAP,CAAY,oBAAZ,EAAiC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACkB,IAAAA,YAAY,GAAClB,CAAb;AAAe;AAApC,CAAjC,EAAuE,CAAvE;AAA0E,IAAImB,IAAJ;AAAStB,MAAM,CAACC,IAAP,CAAY,SAAZ,EAAsB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACmB,IAAAA,IAAI,GAACnB,CAAL;AAAO;AAA5B,CAAtB,EAAoD,CAApD;;AAW7qC,IAAMoB,cAAc,GAAG,gBAA8C;AAAA,6BAA3CC,UAA2C;AAAA,MAA3CA,UAA2C,gCAA9B,EAA8B;AAAA,MAA1BC,QAA0B,QAA1BA,QAA0B;AAAA,MAAhBC,SAAgB,QAAhBA,SAAgB;AACpE,MAAMC,CAAC,GAAGT,cAAc,EAAxB;AAEA,MAAMU,QAAQ,GAAGjB,YAAY,CAAC,IAAD,CAA7B;;AAEA,iBAA6BS,OAAO,CAAC;AAAES,IAAAA,OAAO,EAAE,EAAX;AAAeC,IAAAA,IAAI,EAAE;AAArB,GAAD,CAApC;AAAA,MAAQC,MAAR,YAAQA,MAAR;AAAA,MAAgBC,QAAhB,YAAgBA,QAAhB;;AAEA,MAAMC,eAAe,GAAGhB,UAAU,CAAC,oDAAD,CAAlC;AAEA,MAAQY,OAAR,GAA0BE,MAA1B,CAAQF,OAAR;AAAA,MAAiBC,IAAjB,GAA0BC,MAA1B,CAAiBD,IAAjB;AACA,MAAQI,aAAR,GAAsCF,QAAtC,CAAQE,aAAR;AAAA,MAAuBC,UAAvB,GAAsCH,QAAtC,CAAuBG,UAAvB;;AACA,kBAAwCrB,QAAQ,CAAC,EAAD,CAAhD;AAAA;AAAA,MAAOsB,YAAP;AAAA,MAAqBC,eAArB;;AACA,mBAAgCvB,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAOwB,QAAP;AAAA,MAAiBC,WAAjB;;AACA,mBAAsCzB,QAAQ,CAAC,KAAD,CAA9C;AAAA;AAAA,MAAO0B,WAAP;AAAA,MAAoBC,cAApB;;AAEA,MAAMC,aAAa,GAAG7B,WAAW,CAAC,YAAM;AACvCa,IAAAA,SAAS,CAACG,OAAD,EAAUC,IAAV,CAAT;AACA,GAFgC,EAE9B,CAACD,OAAD,EAAUH,SAAV,EAAqBI,IAArB,CAF8B,CAAjC;AAIAX,EAAAA,qBAAqB,CAAC,YAAM;AAC3BkB,IAAAA,eAAe,CAAC,CAACR,OAAD,IAAYI,eAAZ,GAA8BN,CAAC,CAAC,uBAAD,EAA0BA,CAAC,CAAC,SAAD,CAA3B,CAA/B,GAAyE,EAA1E,CAAf;AACA,GAFoB,EAElB,CAACM,eAAD,EAAkBJ,OAAlB,EAA2BF,CAA3B,CAFkB,CAArB;AAIA,MAAMgB,UAAU,GAAG5B,OAAO,CAAC,YAAM;AAChC,QAAM6B,aAAa,GAAG,CAACN,QAAD,KAAcE,WAAW,GAAGV,IAAI,CAACe,MAAL,GAAc,CAAjB,GAAqB,IAA9C,CAAtB;AACA,QAAMC,iBAAiB,GAAG,CAACV,YAAD,KAAkBH,eAAe,GAAG,CAAC,CAACJ,OAAL,GAAe,IAAhD,CAA1B;AACA,WAAOe,aAAa,IAAIE,iBAAxB;AACA,GAJyB,EAIvB,CAACjB,OAAD,EAAUO,YAAV,EAAwBH,eAAxB,EAAyCK,QAAzC,EAAmDE,WAAnD,EAAgEV,IAAI,CAACe,MAArE,CAJuB,CAA1B;AAMA7B,EAAAA,SAAS,CAAC,YAAM;AACf,KAAAQ,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEuB,2BAAZ,KAA2CN,cAAc,CAAC,IAAD,CAAzD;AACAF,IAAAA,WAAW,CAACC,WAAW,KAAK,CAACV,IAAD,IAASA,IAAI,CAACe,MAAL,KAAgB,CAA9B,CAAX,GAA8ClB,CAAC,CAAC,iDAAD,CAA/C,GAAqG,EAAtG,CAAX;AACA,GAHQ,EAGN,CAACH,UAAD,EAAagB,WAAb,EAA0Bb,CAA1B,EAA6BG,IAA7B,CAHM,CAAT;;AAKA,MAAI,CAACG,eAAD,IAAoB,CAACO,WAAzB,EAAsC;AACrC,wBACC,oBAAC,YAAD;AACC,MAAA,OAAO,EAAC,SADT;AAEC,MAAA,KAAK,EAAEb,CAAC,CAAC,0CAAD,CAFT;AAGC,MAAA,SAAS,EAAEe,aAHZ;AAIC,MAAA,QAAQ,EAAEjB,QAJX;AAKC,MAAA,OAAO,EAAEA,QALV;AAMC,MAAA,WAAW,EAAEE,CAAC,CAAC,SAAD;AANf,MADD;AAUA;;AAED,sBACC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,MAAP,qBACC,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAC,wBAAX;AAAoC,IAAA,IAAI,EAAE;AAA1C,IADD,eAEC,oBAAC,KAAD,CAAO,KAAP,QAAcA,CAAC,CAAC,cAAD,CAAf,CAFD,eAGC,oBAAC,KAAD,CAAO,KAAP;AAAa,IAAA,OAAO,EAAEF;AAAtB,IAHD,CADD,eAMC,oBAAC,KAAD,CAAO,OAAP;AAAe,IAAA,SAAS,EAAC;AAAzB,kBACC,oBAAC,GAAD;AAAK,IAAA,KAAK,EAAC;AAAX,KAA0BE,CAAC,CAAC,wBAAD,CAA3B,CADD,eAEC,oBAAC,KAAD;AAAO,IAAA,WAAW,EAAC;AAAnB,kBACC,oBAAC,KAAD,CAAO,KAAP;AAAa,IAAA,QAAQ,EAAEM;AAAvB,KAAyCN,CAAC,CAAC,SAAD,CAA1C,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AACC,IAAA,GAAG,EAAEC,QADN;AAEC,IAAA,KAAK,EAAEQ,YAFR;AAGC,IAAA,QAAQ,EAAE,CAHX;AAIC,IAAA,KAAK,EAAEP,OAJR;AAKC,IAAA,QAAQ,EAAEK,aALX;AAMC,IAAA,WAAW,EAAEP,CAAC,CAAC,sBAAD;AANf,IADD,CAFD,eAYC,oBAAC,KAAD,CAAO,KAAP,QAAcS,YAAd,CAZD,CAFD,EAgBEd,IAAI,iBACJ,oBAAC,KAAD,qBACC,oBAAC,IAAD;AAAM,IAAA,WAAW,EAAEkB,WAAnB;AAAgC,IAAA,IAAI,EAAEV,IAAtC;AAA4C,IAAA,OAAO,EAAEK,UAArD;AAAiE,IAAA,KAAK,EAAEG;AAAxE,IADD,eAEC,oBAAC,KAAD,CAAO,KAAP,QAAcA,QAAd,CAFD,CAjBF,CAND,eA6BC,oBAAC,KAAD,CAAO,MAAP,qBACC,oBAAC,WAAD;AAAa,IAAA,KAAK,EAAC;AAAnB,kBACC,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAEb;AAAjB,KAA4BE,CAAC,CAAC,QAAD,CAA7B,CADD,eAEC,oBAAC,MAAD;AAAQ,IAAA,QAAQ,EAAE,CAACgB,UAAnB;AAA+B,IAAA,OAAO,MAAtC;AAAuC,IAAA,OAAO,EAAED;AAAhD,KACEf,CAAC,CAAC,SAAD,CADH,CAFD,CADD,CA7BD,CADD;AAwCA,CAvFD;;AAXA3B,MAAM,CAACgD,aAAP,CAoGezB,cApGf","sourcesContent":["import { Field, Button, TextInput, Icon, ButtonGroup, Modal, Box } from '@rocket.chat/fuselage';\nimport { useAutoFocus } from '@rocket.chat/fuselage-hooks';\nimport React, { useCallback, useState, useMemo, useEffect } from 'react';\n\nimport { useSetting } from '../../../contexts/SettingsContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { useForm } from '../../../hooks/useForm';\nimport GenericModal from '../../GenericModal';\nimport Tags from '../Tags';\n\nconst CloseChatModal = ({ department = {}, onCancel, onConfirm }) => {\n\tconst t = useTranslation();\n\n\tconst inputRef = useAutoFocus(true);\n\n\tconst { values, handlers } = useForm({ comment: '', tags: [] });\n\n\tconst commentRequired = useSetting('Livechat_request_comment_when_closing_conversation');\n\n\tconst { comment, tags } = values;\n\tconst { handleComment, handleTags } = handlers;\n\tconst [commentError, setCommentError] = useState('');\n\tconst [tagError, setTagError] = useState('');\n\tconst [tagRequired, setTagRequired] = useState(false);\n\n\tconst handleConfirm = useCallback(() => {\n\t\tonConfirm(comment, tags);\n\t}, [comment, onConfirm, tags]);\n\n\tuseComponentDidUpdate(() => {\n\t\tsetCommentError(!comment && commentRequired ? t('The_field_is_required', t('Comment')) : '');\n\t}, [commentRequired, comment, t]);\n\n\tconst canConfirm = useMemo(() => {\n\t\tconst canConfirmTag = !tagError && (tagRequired ? tags.length > 0 : true);\n\t\tconst canConfirmComment = !commentError && (commentRequired ? !!comment : true);\n\t\treturn canConfirmTag && canConfirmComment;\n\t}, [comment, commentError, commentRequired, tagError, tagRequired, tags.length]);\n\n\tuseEffect(() => {\n\t\tdepartment?.requestTagBeforeClosingChat && setTagRequired(true);\n\t\tsetTagError(tagRequired && (!tags || tags.length === 0) ? t('error-tags-must-be-assigned-before-closing-chat') : '');\n\t}, [department, tagRequired, t, tags]);\n\n\tif (!commentRequired && !tagRequired) {\n\t\treturn (\n\t\t\t<GenericModal\n\t\t\t\tvariant='warning'\n\t\t\t\ttitle={t('Are_you_sure_you_want_to_close_this_chat')}\n\t\t\t\tonConfirm={handleConfirm}\n\t\t\t\tonCancel={onCancel}\n\t\t\t\tonClose={onCancel}\n\t\t\t\tconfirmText={t('Confirm')}\n\t\t\t></GenericModal>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Modal>\n\t\t\t<Modal.Header>\n\t\t\t\t<Icon name='baloon-close-top-right' size={20} />\n\t\t\t\t<Modal.Title>{t('Closing_chat')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onCancel} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content fontScale='p2'>\n\t\t\t\t<Box color='neutral-600'>{t('Close_room_description')}</Box>\n\t\t\t\t<Field marginBlock='x15'>\n\t\t\t\t\t<Field.Label required={commentRequired}>{t('Comment')}</Field.Label>\n\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tref={inputRef}\n\t\t\t\t\t\t\terror={commentError}\n\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\tvalue={comment}\n\t\t\t\t\t\t\tonChange={handleComment}\n\t\t\t\t\t\t\tplaceholder={t('Please_add_a_comment')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Field.Row>\n\t\t\t\t\t<Field.Error>{commentError}</Field.Error>\n\t\t\t\t</Field>\n\t\t\t\t{Tags && (\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Tags tagRequired={tagRequired} tags={tags} handler={handleTags} error={tagError} />\n\t\t\t\t\t\t<Field.Error>{tagError}</Field.Error>\n\t\t\t\t\t</Field>\n\t\t\t\t)}\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button onClick={onCancel}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button disabled={!canConfirm} primary onClick={handleConfirm}>\n\t\t\t\t\t\t{t('Confirm')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default CloseChatModal;\n"]},"sourceType":"module","hash":"9b9801cdb6b2a08cd91698ead0d3cc1873f84039"}
