{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/apps/AppLogsPage.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/apps/AppLogsPage.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/apps/AppLogsPage.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/apps/AppLogsPage.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/apps/AppLogsPage.js"}},"code":"var _excluded = [\"id\"];\n\nvar _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default: function (v) {\n    _extends = v;\n  }\n}, 0);\n\nvar _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default: function (v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\n\nvar _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 2);\n\nvar _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 3);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 4);\nvar Box, Button, ButtonGroup, Icon, Accordion, Pagination;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  },\n  Accordion: function (v) {\n    Accordion = v;\n  },\n  Pagination: function (v) {\n    Pagination = v;\n  }\n}, 0);\nvar useSafely;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useSafely: function (v) {\n    useSafely = v;\n  }\n}, 1);\nvar React, useCallback, useState, useEffect;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 2);\nvar Page;\nmodule.link(\"../../../components/Page\", {\n  \"default\": function (v) {\n    Page = v;\n  }\n}, 3);\nvar useCurrentRoute, useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useCurrentRoute: function (v) {\n    useCurrentRoute = v;\n  },\n  useRoute: function (v) {\n    useRoute = v;\n  }\n}, 4);\nvar useEndpoint;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  }\n}, 5);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 6);\nvar useFormatDateAndTime;\nmodule.link(\"../../../hooks/useFormatDateAndTime\", {\n  useFormatDateAndTime: function (v) {\n    useFormatDateAndTime = v;\n  }\n}, 7);\nvar LogItem;\nmodule.link(\"./LogItem\", {\n  \"default\": function (v) {\n    LogItem = v;\n  }\n}, 8);\nvar LogsLoading;\nmodule.link(\"./LogsLoading\", {\n  \"default\": function (v) {\n    LogsLoading = v;\n  }\n}, 9);\n\nvar useAppWithLogs = function (_ref) {\n  var id = _ref.id,\n      current = _ref.current,\n      itemsPerPage = _ref.itemsPerPage;\n\n  var _useSafely = useSafely(useState({})),\n      _useSafely2 = _slicedToArray(_useSafely, 2),\n      data = _useSafely2[0],\n      setData = _useSafely2[1];\n\n  var getAppData = useEndpoint('GET', \"/apps/\" + id);\n  var getAppLogs = useEndpoint('GET', \"/apps/\" + id + \"/logs\");\n  var fetchData = useCallback(function () {\n    function _callee() {\n      var _await$Promise$all, _await$Promise$all2, app, logs;\n\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(Promise.all([getAppData(), getAppLogs()]));\n\n              case 3:\n                _await$Promise$all = _context.sent;\n                _await$Promise$all2 = _slicedToArray(_await$Promise$all, 2);\n                app = _await$Promise$all2[0].app;\n                logs = _await$Promise$all2[1].logs;\n                setData(_objectSpread(_objectSpread({}, app), {}, {\n                  logs: logs\n                }));\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](0);\n                setData({\n                  error: _context.t0\n                });\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, [[0, 10]], Promise);\n    }\n\n    return _callee;\n  }(), [getAppData, getAppLogs, setData]);\n  useEffect(function () {\n    fetchData();\n  }, [fetchData]);\n  var sliceStart = data.logs && current > data.logs.length ? 0 : current;\n  var total = data.logs ? data.logs.length : 0;\n  var filteredData = data.logs ? _objectSpread(_objectSpread({}, data), {}, {\n    logs: data.logs.slice(sliceStart, itemsPerPage + current)\n  }) : data;\n  return [filteredData, total, fetchData];\n};\n\nfunction AppLogsPage(_ref2) {\n  var id = _ref2.id,\n      props = _objectWithoutProperties(_ref2, _excluded);\n\n  var t = useTranslation();\n  var formatDateAndTime = useFormatDateAndTime();\n\n  var _useState = useState(25),\n      _useState2 = _slicedToArray(_useState, 2),\n      itemsPerPage = _useState2[0],\n      setItemsPerPage = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      current = _useState4[0],\n      setCurrent = _useState4[1];\n\n  var _useAppWithLogs = useAppWithLogs({\n    id: id,\n    itemsPerPage: itemsPerPage,\n    current: current\n  }),\n      _useAppWithLogs2 = _slicedToArray(_useAppWithLogs, 3),\n      app = _useAppWithLogs2[0],\n      logEntriesCount = _useAppWithLogs2[1],\n      fetchData = _useAppWithLogs2[2];\n\n  var _useCurrentRoute = useCurrentRoute(),\n      _useCurrentRoute2 = _slicedToArray(_useCurrentRoute, 1),\n      currentRouteName = _useCurrentRoute2[0];\n\n  var appLogsRoute = useRoute(currentRouteName);\n\n  var handleResetButtonClick = function () {\n    fetchData();\n  };\n\n  var handleBackButtonClick = function () {\n    appLogsRoute.push();\n  };\n\n  var loading = !Object.values(app).length;\n  var showData = !loading && !app.error;\n  var showingResultsLabel = useCallback(function (_ref3) {\n    var count = _ref3.count,\n        current = _ref3.current,\n        itemsPerPage = _ref3.itemsPerPage;\n    return t('Showing_results_of', current + 1, Math.min(current + itemsPerPage, count), count);\n  }, [t]);\n  var itemsPerPageLabel = useCallback(function () {\n    return t('Items_per_page:');\n  }, [t]);\n  return /*#__PURE__*/React.createElement(Page, _extends({\n    flexDirection: \"column\"\n  }, props), /*#__PURE__*/React.createElement(Page.Header, {\n    title: t('View_the_Logs_for', {\n      name: app.name || ''\n    })\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleResetButtonClick\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"undo\"\n  }), \" \", t('Refresh')), /*#__PURE__*/React.createElement(Button, {\n    onClick: handleBackButtonClick\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"back\"\n  }), \" \", t('Back')))), /*#__PURE__*/React.createElement(Page.ScrollableContent, null, loading && /*#__PURE__*/React.createElement(LogsLoading, null), app.error && /*#__PURE__*/React.createElement(Box, {\n    maxWidth: \"x600\",\n    alignSelf: \"center\",\n    fontScale: \"hh21\"\n  }, app.error.message), showData && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Accordion, {\n    maxWidth: \"x600\",\n    alignSelf: \"center\"\n  }, app.logs && app.logs.map(function (log) {\n    return /*#__PURE__*/React.createElement(LogItem, {\n      key: log._createdAt,\n      title: formatDateAndTime(log._createdAt) + \": \\\"\" + log.method + \"\\\" (\" + log.totalTime + \"ms)\",\n      instanceId: log.instanceId,\n      entries: log.entries\n    });\n  })))), /*#__PURE__*/React.createElement(Pagination, {\n    mi: \"x24\",\n    divider: true,\n    current: current,\n    itemsPerPage: itemsPerPage,\n    itemsPerPageLabel: itemsPerPageLabel,\n    showingResultsLabel: showingResultsLabel,\n    count: logEntriesCount,\n    onSetItemsPerPage: setItemsPerPage,\n    onSetCurrent: setCurrent\n  }));\n}\n\nmodule.exportDefault(AppLogsPage);","map":{"version":3,"sources":["client/views/admin/apps/AppLogsPage.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","_regeneratorRuntime","_objectSpread","_slicedToArray","Box","Button","ButtonGroup","Icon","Accordion","Pagination","useSafely","React","useCallback","useState","useEffect","Page","useCurrentRoute","useRoute","useEndpoint","useTranslation","useFormatDateAndTime","LogItem","LogsLoading","useAppWithLogs","id","current","itemsPerPage","data","setData","getAppData","getAppLogs","fetchData","Promise","all","app","logs","error","sliceStart","length","total","filteredData","slice","AppLogsPage","props","t","formatDateAndTime","setItemsPerPage","setCurrent","logEntriesCount","currentRouteName","appLogsRoute","handleResetButtonClick","handleBackButtonClick","push","loading","Object","values","showData","showingResultsLabel","count","Math","min","itemsPerPageLabel","name","message","map","log","_createdAt","method","totalTime","instanceId","entries","exportDefault"],"mappings":"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","sourcesContent":["import { Box, Button, ButtonGroup, Icon, Accordion, Pagination } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport React, { useCallback, useState, useEffect } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useCurrentRoute, useRoute } from '../../../contexts/RouterContext';\nimport { useEndpoint } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\nimport LogItem from './LogItem';\nimport LogsLoading from './LogsLoading';\n\nconst useAppWithLogs = ({ id, current, itemsPerPage }) => {\n\tconst [data, setData] = useSafely(useState({}));\n\tconst getAppData = useEndpoint('GET', `/apps/${id}`);\n\tconst getAppLogs = useEndpoint('GET', `/apps/${id}/logs`);\n\n\tconst fetchData = useCallback(async () => {\n\t\ttry {\n\t\t\tconst [{ app }, { logs }] = await Promise.all([getAppData(), getAppLogs()]);\n\t\t\tsetData({ ...app, logs });\n\t\t} catch (error) {\n\t\t\tsetData({ error });\n\t\t}\n\t}, [getAppData, getAppLogs, setData]);\n\n\tuseEffect(() => {\n\t\tfetchData();\n\t}, [fetchData]);\n\n\tconst sliceStart = data.logs && current > data.logs.length ? 0 : current;\n\tconst total = data.logs ? data.logs.length : 0;\n\tconst filteredData = data.logs ? { ...data, logs: data.logs.slice(sliceStart, itemsPerPage + current) } : data;\n\n\treturn [filteredData, total, fetchData];\n};\n\nfunction AppLogsPage({ id, ...props }) {\n\tconst t = useTranslation();\n\tconst formatDateAndTime = useFormatDateAndTime();\n\tconst [itemsPerPage, setItemsPerPage] = useState(25);\n\tconst [current, setCurrent] = useState(0);\n\n\tconst [app, logEntriesCount, fetchData] = useAppWithLogs({ id, itemsPerPage, current });\n\n\tconst [currentRouteName] = useCurrentRoute();\n\tconst appLogsRoute = useRoute(currentRouteName);\n\n\tconst handleResetButtonClick = () => {\n\t\tfetchData();\n\t};\n\n\tconst handleBackButtonClick = () => {\n\t\tappLogsRoute.push();\n\t};\n\n\tconst loading = !Object.values(app).length;\n\tconst showData = !loading && !app.error;\n\n\tconst showingResultsLabel = useCallback(\n\t\t({ count, current, itemsPerPage }) => t('Showing_results_of', current + 1, Math.min(current + itemsPerPage, count), count),\n\t\t[t],\n\t);\n\tconst itemsPerPageLabel = useCallback(() => t('Items_per_page:'), [t]);\n\n\treturn (\n\t\t<Page flexDirection='column' {...props}>\n\t\t\t<Page.Header title={t('View_the_Logs_for', { name: app.name || '' })}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary onClick={handleResetButtonClick}>\n\t\t\t\t\t\t<Icon name='undo' /> {t('Refresh')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button onClick={handleBackButtonClick}>\n\t\t\t\t\t\t<Icon name='back' /> {t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContent>\n\t\t\t\t{loading && <LogsLoading />}\n\t\t\t\t{app.error && (\n\t\t\t\t\t<Box maxWidth='x600' alignSelf='center' fontScale='hh21'>\n\t\t\t\t\t\t{app.error.message}\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t{showData && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Accordion maxWidth='x600' alignSelf='center'>\n\t\t\t\t\t\t\t{app.logs &&\n\t\t\t\t\t\t\t\tapp.logs.map((log) => (\n\t\t\t\t\t\t\t\t\t<LogItem\n\t\t\t\t\t\t\t\t\t\tkey={log._createdAt}\n\t\t\t\t\t\t\t\t\t\ttitle={`${formatDateAndTime(log._createdAt)}: \"${log.method}\" (${log.totalTime}ms)`}\n\t\t\t\t\t\t\t\t\t\tinstanceId={log.instanceId}\n\t\t\t\t\t\t\t\t\t\tentries={log.entries}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</Accordion>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Page.ScrollableContent>\n\n\t\t\t<Pagination\n\t\t\t\tmi='x24'\n\t\t\t\tdivider\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\titemsPerPageLabel={itemsPerPageLabel}\n\t\t\t\tshowingResultsLabel={showingResultsLabel}\n\t\t\t\tcount={logEntriesCount}\n\t\t\t\tonSetItemsPerPage={setItemsPerPage}\n\t\t\t\tonSetCurrent={setCurrent}\n\t\t\t/>\n\t\t</Page>\n\t);\n}\n\nexport default AppLogsPage;\n"]},"sourceType":"module","hash":"f9b006fa6149fbac90b34471c0a3cd83d06a7109"}
