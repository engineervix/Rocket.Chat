{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/utils/lib/getURL.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/utils/lib/getURL.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/utils/lib/getURL.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/utils/lib/getURL.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/utils/lib/getURL.js"}},"code":"var _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nmodule.export({\n  _getURL: function () {\n    return _getURL;\n  },\n  getURL: function () {\n    return getURL;\n  }\n});\nvar s;\nmodule.link(\"underscore.string\", {\n  \"default\": function (v) {\n    s = v;\n  }\n}, 0);\nvar escapeRegExp;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeRegExp: function (v) {\n    escapeRegExp = v;\n  }\n}, 1);\nvar isURL;\nmodule.link(\"./isURL\", {\n  isURL: function (v) {\n    isURL = v;\n  }\n}, 2);\nvar settings;\nmodule.link(\"../../settings\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 3);\n\nfunction getCloudUrl(path, _site_url, cloudRoute) {\n  var cloudParams = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var cloudBaseUrl = (settings.get('DeepLink_Url') || '').replace(/\\/+$/, '');\n  var siteUrl = s.rtrim(_site_url, '/'); // Remove the protocol\n\n  var host = siteUrl.replace(/https?\\:\\/\\//i, '');\n  path = s.ltrim(path, '/');\n  Object.assign(cloudParams, {\n    host: host,\n    path: path\n  });\n\n  if (siteUrl.includes('http://')) {\n    cloudParams.secure = 'no';\n  }\n\n  var params = Object.entries(cloudParams).map(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n\n    return key + \"=\" + encodeURIComponent(value);\n  }).join('&');\n  return cloudBaseUrl + \"/\" + cloudRoute + \"?\" + params;\n}\n\nvar _getURL = function (path, _ref3) {\n  var cdn = _ref3.cdn,\n      full = _ref3.full,\n      cloud = _ref3.cloud,\n      cloud_route = _ref3.cloud_route,\n      cloud_params = _ref3.cloud_params,\n      _cdn_prefix = _ref3._cdn_prefix,\n      _root_url_path_prefix = _ref3._root_url_path_prefix,\n      _site_url = _ref3._site_url;\n\n  if (isURL(path)) {\n    return path;\n  }\n\n  var _path$split = path.split('?'),\n      _path$split2 = _slicedToArray(_path$split, 2),\n      _path = _path$split2[0],\n      _query = _path$split2[1];\n\n  path = _path;\n  var query = _query ? \"?\" + _query : '';\n  var siteUrl = s.rtrim(s.trim(_site_url || ''), '/');\n  var cloudRoute = s.trim(cloud_route || '');\n  var cdnPrefix = s.rtrim(s.trim(_cdn_prefix || ''), '/');\n  var pathPrefix = s.rtrim(s.trim(_root_url_path_prefix || ''), '/');\n  var finalPath = s.ltrim(s.trim(path), '/');\n  var url = s.rtrim(pathPrefix + \"/\" + finalPath, '/') + query;\n\n  if (cloud) {\n    var cloudParams = cloud_params || {};\n    return getCloudUrl(url, siteUrl, cloudRoute, cloudParams);\n  }\n\n  if (cdn && cdnPrefix !== '') {\n    return cdnPrefix + url;\n  }\n\n  if (full) {\n    return siteUrl.replace(new RegExp(escapeRegExp(pathPrefix) + \"$\"), '') + url;\n  }\n\n  return url;\n};\n\nvar getURL = function (path) {\n  var _ref4 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref4$cdn = _ref4.cdn,\n      cdn = _ref4$cdn === void 0 ? true : _ref4$cdn,\n      _ref4$full = _ref4.full,\n      full = _ref4$full === void 0 ? false : _ref4$full,\n      _ref4$cloud = _ref4.cloud,\n      cloud = _ref4$cloud === void 0 ? false : _ref4$cloud,\n      _ref4$cloud_route = _ref4.cloud_route,\n      cloud_route = _ref4$cloud_route === void 0 ? '' : _ref4$cloud_route,\n      _ref4$cloud_params = _ref4.cloud_params,\n      cloud_params = _ref4$cloud_params === void 0 ? {} : _ref4$cloud_params;\n\n  return _getURL(path, {\n    cdn: cdn,\n    full: full,\n    cloud: cloud,\n    cloud_route: cloud_route,\n    cloud_params: cloud_params,\n    _cdn_prefix: settings.get('CDN_PREFIX'),\n    _root_url_path_prefix: __meteor_runtime_config__.ROOT_URL_PATH_PREFIX,\n    _site_url: settings.get('Site_Url')\n  });\n};","map":{"version":3,"sources":["app/utils/lib/getURL.js"],"names":["_slicedToArray","module","link","default","v","export","_getURL","getURL","s","escapeRegExp","isURL","settings","getCloudUrl","path","_site_url","cloudRoute","cloudParams","cloudBaseUrl","get","replace","siteUrl","rtrim","host","ltrim","Object","assign","includes","secure","params","entries","map","key","value","encodeURIComponent","join","cdn","full","cloud","cloud_route","cloud_params","_cdn_prefix","_root_url_path_prefix","split","_path","_query","query","trim","cdnPrefix","pathPrefix","finalPath","url","RegExp","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX"],"mappings":"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","sourcesContent":["import s from 'underscore.string';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\n\nimport { isURL } from './isURL';\nimport { settings } from '../../settings';\n\nfunction getCloudUrl(path, _site_url, cloudRoute, cloudParams = {}) {\n\tconst cloudBaseUrl = (settings.get('DeepLink_Url') || '').replace(/\\/+$/, '');\n\n\tconst siteUrl = s.rtrim(_site_url, '/');\n\n\t// Remove the protocol\n\tconst host = siteUrl.replace(/https?\\:\\/\\//i, '');\n\tpath = s.ltrim(path, '/');\n\n\tObject.assign(cloudParams, {\n\t\thost,\n\t\tpath,\n\t});\n\n\tif (siteUrl.includes('http://')) {\n\t\tcloudParams.secure = 'no';\n\t}\n\n\tconst params = Object.entries(cloudParams)\n\t\t.map(([key, value]) => `${key}=${encodeURIComponent(value)}`)\n\t\t.join('&');\n\n\treturn `${cloudBaseUrl}/${cloudRoute}?${params}`;\n}\n\nexport const _getURL = (path, { cdn, full, cloud, cloud_route, cloud_params, _cdn_prefix, _root_url_path_prefix, _site_url }) => {\n\tif (isURL(path)) {\n\t\treturn path;\n\t}\n\n\tconst [_path, _query] = path.split('?');\n\tpath = _path;\n\tconst query = _query ? `?${_query}` : '';\n\n\tconst siteUrl = s.rtrim(s.trim(_site_url || ''), '/');\n\tconst cloudRoute = s.trim(cloud_route || '');\n\tconst cdnPrefix = s.rtrim(s.trim(_cdn_prefix || ''), '/');\n\tconst pathPrefix = s.rtrim(s.trim(_root_url_path_prefix || ''), '/');\n\n\tconst finalPath = s.ltrim(s.trim(path), '/');\n\n\tconst url = s.rtrim(`${pathPrefix}/${finalPath}`, '/') + query;\n\n\tif (cloud) {\n\t\tconst cloudParams = cloud_params || {};\n\t\treturn getCloudUrl(url, siteUrl, cloudRoute, cloudParams);\n\t}\n\n\tif (cdn && cdnPrefix !== '') {\n\t\treturn cdnPrefix + url;\n\t}\n\n\tif (full) {\n\t\treturn siteUrl.replace(new RegExp(`${escapeRegExp(pathPrefix)}$`), '') + url;\n\t}\n\n\treturn url;\n};\n\nexport const getURL = (path, { cdn = true, full = false, cloud = false, cloud_route = '', cloud_params = {} } = {}) =>\n\t_getURL(path, {\n\t\tcdn,\n\t\tfull,\n\t\tcloud,\n\t\tcloud_route,\n\t\tcloud_params,\n\t\t_cdn_prefix: settings.get('CDN_PREFIX'),\n\t\t_root_url_path_prefix: __meteor_runtime_config__.ROOT_URL_PATH_PREFIX,\n\t\t_site_url: settings.get('Site_Url'),\n\t});\n"]},"sourceType":"module","hash":"559fa0b3067291f358c51735fa1bc4ce2dab51e5"}
