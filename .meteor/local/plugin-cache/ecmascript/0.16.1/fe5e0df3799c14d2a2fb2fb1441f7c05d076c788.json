{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/hooks/useUserInfoActions.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/hooks/useUserInfoActions.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/hooks/useUserInfoActions.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/room/hooks/useUserInfoActions.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/hooks/useUserInfoActions.js"}},"code":"const _excluded = [\"text\", \"confirmText\", \"close\", \"confirm\"];\n\nlet _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 0);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 1);\nmodule.export({\n  useUserInfoActions: () => useUserInfoActions\n});\nlet Button, ButtonGroup, Icon, Modal, Box;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Button(v) {\n    Button = v;\n  },\n\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  },\n\n  Modal(v) {\n    Modal = v;\n  },\n\n  Box(v) {\n    Box = v;\n  }\n\n}, 0);\nlet useAutoFocus, useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useAutoFocus(v) {\n    useAutoFocus = v;\n  },\n\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n\n}, 1);\nlet escapeHTML;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeHTML(v) {\n    escapeHTML = v;\n  }\n\n}, 2);\nlet React, useCallback, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useCallback(v) {\n    useCallback = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  }\n\n}, 3);\nlet RoomRoles;\nmodule.link(\"../../../../app/models/client\", {\n  RoomRoles(v) {\n    RoomRoles = v;\n  }\n\n}, 4);\nlet RoomMemberActions;\nmodule.link(\"../../../../definition/IRoomTypeConfig\", {\n  RoomMemberActions(v) {\n    RoomMemberActions = v;\n  }\n\n}, 5);\nlet usePermission, useAllPermissions;\nmodule.link(\"../../../contexts/AuthorizationContext\", {\n  usePermission(v) {\n    usePermission = v;\n  },\n\n  useAllPermissions(v) {\n    useAllPermissions = v;\n  }\n\n}, 6);\nlet useSetModal;\nmodule.link(\"../../../contexts/ModalContext\", {\n  useSetModal(v) {\n    useSetModal = v;\n  }\n\n}, 7);\nlet useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute(v) {\n    useRoute = v;\n  }\n\n}, 8);\nlet useMethod;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod(v) {\n    useMethod = v;\n  }\n\n}, 9);\nlet useToastMessageDispatch;\nmodule.link(\"../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  }\n\n}, 10);\nlet useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 11);\nlet useUserId, useUserSubscription, useUserSubscriptionByName;\nmodule.link(\"../../../contexts/UserContext\", {\n  useUserId(v) {\n    useUserId = v;\n  },\n\n  useUserSubscription(v) {\n    useUserSubscription = v;\n  },\n\n  useUserSubscriptionByName(v) {\n    useUserSubscriptionByName = v;\n  }\n\n}, 12);\nlet useEndpointActionExperimental;\nmodule.link(\"../../../hooks/useEndpointActionExperimental\", {\n  useEndpointActionExperimental(v) {\n    useEndpointActionExperimental = v;\n  }\n\n}, 13);\nlet useReactiveValue;\nmodule.link(\"../../../hooks/useReactiveValue\", {\n  useReactiveValue(v) {\n    useReactiveValue = v;\n  }\n\n}, 14);\nlet roomCoordinator;\nmodule.link(\"../../../lib/rooms/roomCoordinator\", {\n  roomCoordinator(v) {\n    roomCoordinator = v;\n  }\n\n}, 15);\nlet RemoveUsersModal;\nmodule.link(\"../../teams/contextualBar/members/RemoveUsersModal\", {\n  default(v) {\n    RemoveUsersModal = v;\n  }\n\n}, 16);\nlet useUserRoom;\nmodule.link(\"./useUserRoom\", {\n  useUserRoom(v) {\n    useUserRoom = v;\n  }\n\n}, 17);\nlet useWebRTC;\nmodule.link(\"./useWebRTC\", {\n  useWebRTC(v) {\n    useWebRTC = v;\n  }\n\n}, 18);\n\nconst useUserHasRoomRole = (uid, rid, role) => useReactiveValue(useCallback(() => !!RoomRoles.findOne({\n  rid,\n  'u._id': uid,\n  'roles': role\n}), [uid, rid, role]));\n\nconst getShouldOpenDirectMessage = (currentSubscription, usernameSubscription, canOpenDirectMessage, username) => {\n  const canOpenDm = canOpenDirectMessage || usernameSubscription;\n  const directMessageIsNotAlreadyOpen = currentSubscription && currentSubscription.name !== username;\n  return canOpenDm && directMessageIsNotAlreadyOpen;\n};\n\nconst getUserIsMuted = (room, user, userCanPostReadonly) => {\n  if (room && room.ro) {\n    if (Array.isArray(room.unmuted) && room.unmuted.indexOf(user && user.username) !== -1) {\n      return false;\n    }\n\n    if (userCanPostReadonly) {\n      return Array.isArray(room.muted) && room.muted.indexOf(user && user.username) !== -1;\n    }\n\n    return true;\n  }\n\n  return room && Array.isArray(room.muted) && room.muted.indexOf(user && user.username) > -1;\n};\n\nconst WarningModal = _ref => {\n  let {\n    text,\n    confirmText,\n    close,\n    confirm\n  } = _ref,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  const refAutoFocus = useAutoFocus(true);\n  const t = useTranslation();\n  return /*#__PURE__*/React.createElement(Modal, props, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Icon, {\n    color: \"warning\",\n    name: \"modal-warning\",\n    size: 20\n  }), /*#__PURE__*/React.createElement(Modal.Title, null, t('Are_you_sure')), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: close\n  })), /*#__PURE__*/React.createElement(Modal.Content, {\n    fontScale: \"p2\"\n  }, text), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    align: \"end\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    ghost: true,\n    onClick: close\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    ref: refAutoFocus,\n    primary: true,\n    danger: true,\n    onClick: confirm\n  }, confirmText))));\n};\n\nconst useUserInfoActions = function () {\n  let user = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let rid = arguments.length > 1 ? arguments[1] : undefined;\n  let reload = arguments.length > 2 ? arguments[2] : undefined;\n  const t = useTranslation();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const directRoute = useRoute('direct');\n  const setModal = useSetModal();\n  const {\n    _id: uid\n  } = user;\n  const ownUserId = useUserId();\n  const closeModal = useMutableCallback(() => setModal(null));\n  const room = useUserRoom(rid);\n  const currentSubscription = useUserSubscription(rid);\n  const usernameSubscription = useUserSubscriptionByName(user.username);\n  const isLeader = useUserHasRoomRole(uid, rid, 'leader');\n  const isModerator = useUserHasRoomRole(uid, rid, 'moderator');\n  const isOwner = useUserHasRoomRole(uid, rid, 'owner');\n  const otherUserCanPostReadonly = useAllPermissions('post-readonly', rid);\n  const isIgnored = currentSubscription && currentSubscription.ignored && currentSubscription.ignored.indexOf(uid) > -1;\n  const isMuted = getUserIsMuted(room, user, otherUserCanPostReadonly);\n  const endpointPrefix = room.t === 'p' ? 'groups' : 'channels';\n  const roomDirectives = room && room.t && roomCoordinator.getRoomDirectives(room.t);\n  const [roomCanSetOwner, roomCanSetLeader, roomCanSetModerator, roomCanIgnore, roomCanBlock, roomCanMute, roomCanRemove] = [...(roomDirectives && [roomDirectives.allowMemberAction(room, RoomMemberActions.SET_AS_OWNER), roomDirectives.allowMemberAction(room, RoomMemberActions.SET_AS_LEADER), roomDirectives.allowMemberAction(room, RoomMemberActions.SET_AS_MODERATOR), roomDirectives.allowMemberAction(room, RoomMemberActions.IGNORE), roomDirectives.allowMemberAction(room, RoomMemberActions.BLOCK), roomDirectives.allowMemberAction(room, RoomMemberActions.MUTE), roomDirectives.allowMemberAction(room, RoomMemberActions.REMOVE_USER)])];\n  const roomName = room && room.t && escapeHTML(roomCoordinator.getRoomName(room.t, room));\n  const userCanSetOwner = usePermission('set-owner', rid);\n  const userCanSetLeader = usePermission('set-leader', rid);\n  const userCanSetModerator = usePermission('set-moderator', rid);\n  const userCanMute = usePermission('mute-user', rid);\n  const userCanRemove = usePermission('remove-user', rid);\n  const userCanDirectMessage = usePermission('create-d');\n  const {\n    shouldAllowCalls,\n    callInProgress,\n    joinCall,\n    startCall\n  } = useWebRTC(rid);\n  const shouldOpenDirectMessage = getShouldOpenDirectMessage(currentSubscription, usernameSubscription, userCanDirectMessage, user.username);\n  const openDirectDm = useMutableCallback(() => directRoute.push({\n    rid: user.username\n  }));\n  const openDirectMessageOption = useMemo(() => shouldOpenDirectMessage && {\n    label: t('Direct_Message'),\n    icon: 'balloon',\n    action: openDirectDm\n  }, [openDirectDm, shouldOpenDirectMessage, t]);\n  const videoCallOption = useMemo(() => {\n    const handleJoinCall = () => {\n      joinCall({\n        audio: true,\n        video: true\n      });\n    };\n\n    const handleStartCall = () => {\n      startCall({\n        audio: true,\n        video: true\n      });\n    };\n\n    const action = callInProgress ? handleJoinCall : handleStartCall;\n    return shouldAllowCalls && {\n      label: t(callInProgress ? 'Join_video_call' : 'Start_video_call'),\n      icon: 'video',\n      action\n    };\n  }, [callInProgress, shouldAllowCalls, t, joinCall, startCall]);\n  const audioCallOption = useMemo(() => {\n    const handleJoinCall = () => {\n      joinCall({\n        audio: true,\n        video: false\n      });\n    };\n\n    const handleStartCall = () => {\n      startCall({\n        audio: true,\n        video: false\n      });\n    };\n\n    const action = callInProgress ? handleJoinCall : handleStartCall;\n    return shouldAllowCalls && {\n      label: t(callInProgress ? 'Join_audio_call' : 'Start_audio_call'),\n      icon: 'mic',\n      action\n    };\n  }, [callInProgress, shouldAllowCalls, t, joinCall, startCall]);\n  const changeOwnerEndpoint = isOwner ? 'removeOwner' : 'addOwner';\n  const changeOwnerMessage = isOwner ? 'User__username__removed_from__room_name__owners' : 'User__username__is_now_a_owner_of__room_name_';\n  const changeOwner = useEndpointActionExperimental('POST', \"\".concat(endpointPrefix, \".\").concat(changeOwnerEndpoint), t(changeOwnerMessage, {\n    username: user.username,\n    room_name: roomName\n  }));\n  const changeOwnerAction = useMutableCallback(async () => changeOwner({\n    roomId: rid,\n    userId: uid\n  }));\n  const changeOwnerOption = useMemo(() => roomCanSetOwner && userCanSetOwner && {\n    label: t(isOwner ? 'Remove_as_owner' : 'Set_as_owner'),\n    icon: 'shield-check',\n    action: changeOwnerAction\n  }, [changeOwnerAction, isOwner, t, roomCanSetOwner, userCanSetOwner]);\n  const changeLeaderEndpoint = isLeader ? 'removeLeader' : 'addLeader';\n  const changeLeaderMessage = isLeader ? 'User__username__removed_from__room_name__leaders' : 'User__username__is_now_a_leader_of__room_name_';\n  const changeLeader = useEndpointActionExperimental('POST', \"\".concat(endpointPrefix, \".\").concat(changeLeaderEndpoint), t(changeLeaderMessage, {\n    username: user.username,\n    room_name: roomName\n  }));\n  const changeLeaderAction = useMutableCallback(() => changeLeader({\n    roomId: rid,\n    userId: uid\n  }));\n  const changeLeaderOption = useMemo(() => roomCanSetLeader && userCanSetLeader && {\n    label: t(isLeader ? 'Remove_as_leader' : 'Set_as_leader'),\n    icon: 'shield-alt',\n    action: changeLeaderAction\n  }, [isLeader, roomCanSetLeader, t, userCanSetLeader, changeLeaderAction]);\n  const changeModeratorEndpoint = isModerator ? 'removeModerator' : 'addModerator';\n  const changeModeratorMessage = isModerator ? 'User__username__removed_from__room_name__moderators' : 'User__username__is_now_a_moderator_of__room_name_';\n  const changeModerator = useEndpointActionExperimental('POST', \"\".concat(endpointPrefix, \".\").concat(changeModeratorEndpoint), t(changeModeratorMessage, {\n    username: user.username,\n    room_name: roomName\n  }));\n  const changeModeratorAction = useMutableCallback(() => changeModerator({\n    roomId: rid,\n    userId: uid\n  }));\n  const changeModeratorOption = useMemo(() => roomCanSetModerator && userCanSetModerator && {\n    label: t(isModerator ? 'Remove_as_moderator' : 'Set_as_moderator'),\n    icon: 'shield',\n    action: changeModeratorAction\n  }, [changeModeratorAction, isModerator, roomCanSetModerator, t, userCanSetModerator]);\n  const ignoreUser = useMethod('ignoreUser');\n  const ignoreUserAction = useMutableCallback(async () => {\n    try {\n      await ignoreUser({\n        rid,\n        userId: uid,\n        ignore: !isIgnored\n      });\n\n      if (isIgnored) {\n        dispatchToastMessage({\n          type: 'success',\n          message: t('User_has_been_unignored')\n        });\n      } else {\n        dispatchToastMessage({\n          type: 'success',\n          message: t('User_has_been_ignored')\n        });\n      }\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  });\n  const ignoreUserOption = useMemo(() => roomCanIgnore && uid !== ownUserId && {\n    label: t(isIgnored ? 'Unignore' : 'Ignore'),\n    icon: 'ban',\n    action: ignoreUserAction\n  }, [ignoreUserAction, isIgnored, ownUserId, roomCanIgnore, t, uid]);\n  const isUserBlocked = currentSubscription && currentSubscription.blocker;\n  const toggleBlock = useMethod(isUserBlocked ? 'unblockUser' : 'blockUser');\n  const toggleBlockUserAction = useMutableCallback(async () => {\n    try {\n      await toggleBlock({\n        rid,\n        blocked: uid\n      });\n      dispatchToastMessage({\n        type: 'success',\n        message: t(isUserBlocked ? 'User_is_unblocked' : 'User_is_blocked')\n      });\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  });\n  const toggleBlockUserOption = useMemo(() => roomCanBlock && uid !== ownUserId && {\n    label: t(isUserBlocked ? 'Unblock' : 'Block'),\n    icon: 'ban',\n    action: toggleBlockUserAction\n  }, [isUserBlocked, ownUserId, roomCanBlock, t, toggleBlockUserAction, uid]);\n  const muteFn = useMethod(isMuted ? 'unmuteUserInRoom' : 'muteUserInRoom');\n  const muteUserOption = useMemo(() => {\n    const action = () => {\n      const onConfirm = async () => {\n        try {\n          await muteFn({\n            rid,\n            username: user.username\n          });\n          closeModal();\n          dispatchToastMessage({\n            type: 'success',\n            message: t(isMuted ? 'User__username__unmuted_in_room__roomName__' : 'User__username__muted_in_room__roomName__', {\n              username: user.username,\n              roomName\n            })\n          });\n        } catch (error) {\n          dispatchToastMessage({\n            type: 'error',\n            message: error\n          });\n        }\n      };\n\n      if (isMuted) {\n        return onConfirm();\n      }\n\n      setModal( /*#__PURE__*/React.createElement(WarningModal, {\n        text: t('The_user_wont_be_able_to_type_in_s', roomName),\n        close: closeModal,\n        confirmText: t('Yes_mute_user'),\n        confirm: onConfirm\n      }));\n    };\n\n    return roomCanMute && userCanMute && {\n      label: t(isMuted ? 'Unmute_user' : 'Mute_user'),\n      icon: isMuted ? 'mic' : 'mic-off',\n      action\n    };\n  }, [closeModal, dispatchToastMessage, isMuted, muteFn, rid, roomCanMute, roomName, setModal, t, user.username, userCanMute]);\n  const removeFromTeam = useEndpointActionExperimental('POST', 'teams.removeMember', t('User_has_been_removed_from_team'));\n  const removeUserAction = useEndpointActionExperimental('POST', \"\".concat(endpointPrefix, \".kick\"), t('User_has_been_removed_from_s', roomName));\n  const removeUserOptionAction = useMutableCallback(() => {\n    if (room.teamMain && room.teamId) {\n      return setModal( /*#__PURE__*/React.createElement(RemoveUsersModal, {\n        teamId: room === null || room === void 0 ? void 0 : room.teamId,\n        userId: uid,\n        onClose: closeModal,\n        onCancel: closeModal,\n        onConfirm: async rooms => {\n          const roomKeys = Object.keys(rooms);\n          await removeFromTeam(_objectSpread({\n            teamId: room.teamId,\n            userId: uid\n          }, roomKeys.length && {\n            rooms: roomKeys\n          }));\n          closeModal();\n          reload && reload();\n        }\n      }));\n    }\n\n    setModal( /*#__PURE__*/React.createElement(WarningModal, {\n      text: t('The_user_will_be_removed_from_s', roomName),\n      close: closeModal,\n      confirmText: t('Yes_remove_user'),\n      confirm: async () => {\n        await removeUserAction({\n          roomId: rid,\n          userId: uid\n        });\n        closeModal();\n        reload && reload();\n      }\n    }));\n  });\n  const removeUserOption = useMemo(() => roomCanRemove && userCanRemove && {\n    label: /*#__PURE__*/React.createElement(Box, {\n      color: \"danger\"\n    }, room.teamMain ? t('Remove_from_team') : t('Remove_from_room')),\n    icon: 'sign-out',\n    action: removeUserOptionAction\n  }, [room, roomCanRemove, userCanRemove, removeUserOptionAction, t]);\n  return useMemo(() => _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, openDirectMessageOption && {\n    openDirectMessage: openDirectMessageOption\n  }), videoCallOption && {\n    video: videoCallOption\n  }), audioCallOption && {\n    audio: audioCallOption\n  }), changeOwnerOption && {\n    changeOwner: changeOwnerOption\n  }), changeLeaderOption && {\n    changeLeader: changeLeaderOption\n  }), changeModeratorOption && {\n    changeModerator: changeModeratorOption\n  }), ignoreUserOption && {\n    ignoreUser: ignoreUserOption\n  }), muteUserOption && {\n    muteUser: muteUserOption\n  }), removeUserOption && {\n    removeUser: removeUserOption\n  }), toggleBlockUserOption && {\n    toggleBlock: toggleBlockUserOption\n  }), [audioCallOption, changeLeaderOption, changeModeratorOption, changeOwnerOption, ignoreUserOption, muteUserOption, openDirectMessageOption, removeUserOption, videoCallOption, toggleBlockUserOption]);\n};","map":{"version":3,"sources":["client/views/room/hooks/useUserInfoActions.js"],"names":["_objectSpread","module","link","default","v","_objectWithoutProperties","export","useUserInfoActions","Button","ButtonGroup","Icon","Modal","Box","useAutoFocus","useMutableCallback","escapeHTML","React","useCallback","useMemo","RoomRoles","RoomMemberActions","usePermission","useAllPermissions","useSetModal","useRoute","useMethod","useToastMessageDispatch","useTranslation","useUserId","useUserSubscription","useUserSubscriptionByName","useEndpointActionExperimental","useReactiveValue","roomCoordinator","RemoveUsersModal","useUserRoom","useWebRTC","useUserHasRoomRole","uid","rid","role","findOne","getShouldOpenDirectMessage","currentSubscription","usernameSubscription","canOpenDirectMessage","username","canOpenDm","directMessageIsNotAlreadyOpen","name","getUserIsMuted","room","user","userCanPostReadonly","ro","Array","isArray","unmuted","indexOf","muted","WarningModal","text","confirmText","close","confirm","props","refAutoFocus","t","reload","dispatchToastMessage","directRoute","setModal","_id","ownUserId","closeModal","isLeader","isModerator","isOwner","otherUserCanPostReadonly","isIgnored","ignored","isMuted","endpointPrefix","roomDirectives","getRoomDirectives","roomCanSetOwner","roomCanSetLeader","roomCanSetModerator","roomCanIgnore","roomCanBlock","roomCanMute","roomCanRemove","allowMemberAction","SET_AS_OWNER","SET_AS_LEADER","SET_AS_MODERATOR","IGNORE","BLOCK","MUTE","REMOVE_USER","roomName","getRoomName","userCanSetOwner","userCanSetLeader","userCanSetModerator","userCanMute","userCanRemove","userCanDirectMessage","shouldAllowCalls","callInProgress","joinCall","startCall","shouldOpenDirectMessage","openDirectDm","push","openDirectMessageOption","label","icon","action","videoCallOption","handleJoinCall","audio","video","handleStartCall","audioCallOption","changeOwnerEndpoint","changeOwnerMessage","changeOwner","room_name","changeOwnerAction","roomId","userId","changeOwnerOption","changeLeaderEndpoint","changeLeaderMessage","changeLeader","changeLeaderAction","changeLeaderOption","changeModeratorEndpoint","changeModeratorMessage","changeModerator","changeModeratorAction","changeModeratorOption","ignoreUser","ignoreUserAction","ignore","type","message","error","ignoreUserOption","isUserBlocked","blocker","toggleBlock","toggleBlockUserAction","blocked","toggleBlockUserOption","muteFn","muteUserOption","onConfirm","removeFromTeam","removeUserAction","removeUserOptionAction","teamMain","teamId","rooms","roomKeys","Object","keys","length","removeUserOption","openDirectMessage","muteUser","removeUser"],"mappings":"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","sourcesContent":["import { Button, ButtonGroup, Icon, Modal, Box } from '@rocket.chat/fuselage';\nimport { useAutoFocus, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { RoomRoles } from '../../../../app/models/client';\nimport { RoomMemberActions } from '../../../../definition/IRoomTypeConfig';\nimport { usePermission, useAllPermissions } from '../../../contexts/AuthorizationContext';\nimport { useSetModal } from '../../../contexts/ModalContext';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useUserId, useUserSubscription, useUserSubscriptionByName } from '../../../contexts/UserContext';\nimport { useEndpointActionExperimental } from '../../../hooks/useEndpointActionExperimental';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { roomCoordinator } from '../../../lib/rooms/roomCoordinator';\nimport RemoveUsersModal from '../../teams/contextualBar/members/RemoveUsersModal';\nimport { useUserRoom } from './useUserRoom';\nimport { useWebRTC } from './useWebRTC';\n\nconst useUserHasRoomRole = (uid, rid, role) =>\n\tuseReactiveValue(useCallback(() => !!RoomRoles.findOne({ rid, 'u._id': uid, 'roles': role }), [uid, rid, role]));\n\nconst getShouldOpenDirectMessage = (currentSubscription, usernameSubscription, canOpenDirectMessage, username) => {\n\tconst canOpenDm = canOpenDirectMessage || usernameSubscription;\n\tconst directMessageIsNotAlreadyOpen = currentSubscription && currentSubscription.name !== username;\n\treturn canOpenDm && directMessageIsNotAlreadyOpen;\n};\n\nconst getUserIsMuted = (room, user, userCanPostReadonly) => {\n\tif (room && room.ro) {\n\t\tif (Array.isArray(room.unmuted) && room.unmuted.indexOf(user && user.username) !== -1) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (userCanPostReadonly) {\n\t\t\treturn Array.isArray(room.muted) && room.muted.indexOf(user && user.username) !== -1;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\treturn room && Array.isArray(room.muted) && room.muted.indexOf(user && user.username) > -1;\n};\n\nconst WarningModal = ({ text, confirmText, close, confirm, ...props }) => {\n\tconst refAutoFocus = useAutoFocus(true);\n\tconst t = useTranslation();\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Icon color='warning' name='modal-warning' size={20} />\n\t\t\t\t<Modal.Title>{t('Are_you_sure')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={close} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content fontScale='p2'>{text}</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button ghost onClick={close}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button ref={refAutoFocus} primary danger onClick={confirm}>\n\t\t\t\t\t\t{confirmText}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport const useUserInfoActions = (user = {}, rid, reload) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst directRoute = useRoute('direct');\n\n\tconst setModal = useSetModal();\n\n\tconst { _id: uid } = user;\n\tconst ownUserId = useUserId();\n\n\tconst closeModal = useMutableCallback(() => setModal(null));\n\n\tconst room = useUserRoom(rid);\n\tconst currentSubscription = useUserSubscription(rid);\n\tconst usernameSubscription = useUserSubscriptionByName(user.username);\n\n\tconst isLeader = useUserHasRoomRole(uid, rid, 'leader');\n\tconst isModerator = useUserHasRoomRole(uid, rid, 'moderator');\n\tconst isOwner = useUserHasRoomRole(uid, rid, 'owner');\n\n\tconst otherUserCanPostReadonly = useAllPermissions('post-readonly', rid);\n\n\tconst isIgnored = currentSubscription && currentSubscription.ignored && currentSubscription.ignored.indexOf(uid) > -1;\n\tconst isMuted = getUserIsMuted(room, user, otherUserCanPostReadonly);\n\n\tconst endpointPrefix = room.t === 'p' ? 'groups' : 'channels';\n\n\tconst roomDirectives = room && room.t && roomCoordinator.getRoomDirectives(room.t);\n\n\tconst [roomCanSetOwner, roomCanSetLeader, roomCanSetModerator, roomCanIgnore, roomCanBlock, roomCanMute, roomCanRemove] = [\n\t\t...(roomDirectives && [\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.SET_AS_OWNER),\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.SET_AS_LEADER),\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.SET_AS_MODERATOR),\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.IGNORE),\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.BLOCK),\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.MUTE),\n\t\t\troomDirectives.allowMemberAction(room, RoomMemberActions.REMOVE_USER),\n\t\t]),\n\t];\n\n\tconst roomName = room && room.t && escapeHTML(roomCoordinator.getRoomName(room.t, room));\n\n\tconst userCanSetOwner = usePermission('set-owner', rid);\n\tconst userCanSetLeader = usePermission('set-leader', rid);\n\tconst userCanSetModerator = usePermission('set-moderator', rid);\n\tconst userCanMute = usePermission('mute-user', rid);\n\tconst userCanRemove = usePermission('remove-user', rid);\n\tconst userCanDirectMessage = usePermission('create-d');\n\tconst { shouldAllowCalls, callInProgress, joinCall, startCall } = useWebRTC(rid);\n\n\tconst shouldOpenDirectMessage = getShouldOpenDirectMessage(\n\t\tcurrentSubscription,\n\t\tusernameSubscription,\n\t\tuserCanDirectMessage,\n\t\tuser.username,\n\t);\n\n\tconst openDirectDm = useMutableCallback(() =>\n\t\tdirectRoute.push({\n\t\t\trid: user.username,\n\t\t}),\n\t);\n\n\tconst openDirectMessageOption = useMemo(\n\t\t() =>\n\t\t\tshouldOpenDirectMessage && {\n\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\ticon: 'balloon',\n\t\t\t\taction: openDirectDm,\n\t\t\t},\n\t\t[openDirectDm, shouldOpenDirectMessage, t],\n\t);\n\n\tconst videoCallOption = useMemo(() => {\n\t\tconst handleJoinCall = () => {\n\t\t\tjoinCall({ audio: true, video: true });\n\t\t};\n\t\tconst handleStartCall = () => {\n\t\t\tstartCall({ audio: true, video: true });\n\t\t};\n\t\tconst action = callInProgress ? handleJoinCall : handleStartCall;\n\n\t\treturn (\n\t\t\tshouldAllowCalls && {\n\t\t\t\tlabel: t(callInProgress ? 'Join_video_call' : 'Start_video_call'),\n\t\t\t\ticon: 'video',\n\t\t\t\taction,\n\t\t\t}\n\t\t);\n\t}, [callInProgress, shouldAllowCalls, t, joinCall, startCall]);\n\n\tconst audioCallOption = useMemo(() => {\n\t\tconst handleJoinCall = () => {\n\t\t\tjoinCall({ audio: true, video: false });\n\t\t};\n\t\tconst handleStartCall = () => {\n\t\t\tstartCall({ audio: true, video: false });\n\t\t};\n\t\tconst action = callInProgress ? handleJoinCall : handleStartCall;\n\n\t\treturn (\n\t\t\tshouldAllowCalls && {\n\t\t\t\tlabel: t(callInProgress ? 'Join_audio_call' : 'Start_audio_call'),\n\t\t\t\ticon: 'mic',\n\t\t\t\taction,\n\t\t\t}\n\t\t);\n\t}, [callInProgress, shouldAllowCalls, t, joinCall, startCall]);\n\n\tconst changeOwnerEndpoint = isOwner ? 'removeOwner' : 'addOwner';\n\tconst changeOwnerMessage = isOwner ? 'User__username__removed_from__room_name__owners' : 'User__username__is_now_a_owner_of__room_name_';\n\tconst changeOwner = useEndpointActionExperimental(\n\t\t'POST',\n\t\t`${endpointPrefix}.${changeOwnerEndpoint}`,\n\t\tt(changeOwnerMessage, { username: user.username, room_name: roomName }),\n\t);\n\tconst changeOwnerAction = useMutableCallback(async () => changeOwner({ roomId: rid, userId: uid }));\n\tconst changeOwnerOption = useMemo(\n\t\t() =>\n\t\t\troomCanSetOwner &&\n\t\t\tuserCanSetOwner && {\n\t\t\t\tlabel: t(isOwner ? 'Remove_as_owner' : 'Set_as_owner'),\n\t\t\t\ticon: 'shield-check',\n\t\t\t\taction: changeOwnerAction,\n\t\t\t},\n\t\t[changeOwnerAction, isOwner, t, roomCanSetOwner, userCanSetOwner],\n\t);\n\n\tconst changeLeaderEndpoint = isLeader ? 'removeLeader' : 'addLeader';\n\tconst changeLeaderMessage = isLeader\n\t\t? 'User__username__removed_from__room_name__leaders'\n\t\t: 'User__username__is_now_a_leader_of__room_name_';\n\tconst changeLeader = useEndpointActionExperimental(\n\t\t'POST',\n\t\t`${endpointPrefix}.${changeLeaderEndpoint}`,\n\t\tt(changeLeaderMessage, { username: user.username, room_name: roomName }),\n\t);\n\tconst changeLeaderAction = useMutableCallback(() => changeLeader({ roomId: rid, userId: uid }));\n\tconst changeLeaderOption = useMemo(\n\t\t() =>\n\t\t\troomCanSetLeader &&\n\t\t\tuserCanSetLeader && {\n\t\t\t\tlabel: t(isLeader ? 'Remove_as_leader' : 'Set_as_leader'),\n\t\t\t\ticon: 'shield-alt',\n\t\t\t\taction: changeLeaderAction,\n\t\t\t},\n\t\t[isLeader, roomCanSetLeader, t, userCanSetLeader, changeLeaderAction],\n\t);\n\n\tconst changeModeratorEndpoint = isModerator ? 'removeModerator' : 'addModerator';\n\tconst changeModeratorMessage = isModerator\n\t\t? 'User__username__removed_from__room_name__moderators'\n\t\t: 'User__username__is_now_a_moderator_of__room_name_';\n\tconst changeModerator = useEndpointActionExperimental(\n\t\t'POST',\n\t\t`${endpointPrefix}.${changeModeratorEndpoint}`,\n\t\tt(changeModeratorMessage, { username: user.username, room_name: roomName }),\n\t);\n\tconst changeModeratorAction = useMutableCallback(() => changeModerator({ roomId: rid, userId: uid }));\n\tconst changeModeratorOption = useMemo(\n\t\t() =>\n\t\t\troomCanSetModerator &&\n\t\t\tuserCanSetModerator && {\n\t\t\t\tlabel: t(isModerator ? 'Remove_as_moderator' : 'Set_as_moderator'),\n\t\t\t\ticon: 'shield',\n\t\t\t\taction: changeModeratorAction,\n\t\t\t},\n\t\t[changeModeratorAction, isModerator, roomCanSetModerator, t, userCanSetModerator],\n\t);\n\n\tconst ignoreUser = useMethod('ignoreUser');\n\tconst ignoreUserAction = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait ignoreUser({ rid, userId: uid, ignore: !isIgnored });\n\t\t\tif (isIgnored) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_unignored') });\n\t\t\t} else {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_ignored') });\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\tconst ignoreUserOption = useMemo(\n\t\t() =>\n\t\t\troomCanIgnore &&\n\t\t\tuid !== ownUserId && {\n\t\t\t\tlabel: t(isIgnored ? 'Unignore' : 'Ignore'),\n\t\t\t\ticon: 'ban',\n\t\t\t\taction: ignoreUserAction,\n\t\t\t},\n\t\t[ignoreUserAction, isIgnored, ownUserId, roomCanIgnore, t, uid],\n\t);\n\n\tconst isUserBlocked = currentSubscription && currentSubscription.blocker;\n\tconst toggleBlock = useMethod(isUserBlocked ? 'unblockUser' : 'blockUser');\n\tconst toggleBlockUserAction = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait toggleBlock({ rid, blocked: uid });\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t(isUserBlocked ? 'User_is_unblocked' : 'User_is_blocked'),\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\tconst toggleBlockUserOption = useMemo(\n\t\t() =>\n\t\t\troomCanBlock &&\n\t\t\tuid !== ownUserId && {\n\t\t\t\tlabel: t(isUserBlocked ? 'Unblock' : 'Block'),\n\t\t\t\ticon: 'ban',\n\t\t\t\taction: toggleBlockUserAction,\n\t\t\t},\n\t\t[isUserBlocked, ownUserId, roomCanBlock, t, toggleBlockUserAction, uid],\n\t);\n\n\tconst muteFn = useMethod(isMuted ? 'unmuteUserInRoom' : 'muteUserInRoom');\n\tconst muteUserOption = useMemo(() => {\n\t\tconst action = () => {\n\t\t\tconst onConfirm = async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait muteFn({ rid, username: user.username });\n\t\t\t\t\tcloseModal();\n\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\tmessage: t(isMuted ? 'User__username__unmuted_in_room__roomName__' : 'User__username__muted_in_room__roomName__', {\n\t\t\t\t\t\t\tusername: user.username,\n\t\t\t\t\t\t\troomName,\n\t\t\t\t\t\t}),\n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (isMuted) {\n\t\t\t\treturn onConfirm();\n\t\t\t}\n\n\t\t\tsetModal(\n\t\t\t\t<WarningModal\n\t\t\t\t\ttext={t('The_user_wont_be_able_to_type_in_s', roomName)}\n\t\t\t\t\tclose={closeModal}\n\t\t\t\t\tconfirmText={t('Yes_mute_user')}\n\t\t\t\t\tconfirm={onConfirm}\n\t\t\t\t/>,\n\t\t\t);\n\t\t};\n\n\t\treturn (\n\t\t\troomCanMute &&\n\t\t\tuserCanMute && {\n\t\t\t\tlabel: t(isMuted ? 'Unmute_user' : 'Mute_user'),\n\t\t\t\ticon: isMuted ? 'mic' : 'mic-off',\n\t\t\t\taction,\n\t\t\t}\n\t\t);\n\t}, [closeModal, dispatchToastMessage, isMuted, muteFn, rid, roomCanMute, roomName, setModal, t, user.username, userCanMute]);\n\n\tconst removeFromTeam = useEndpointActionExperimental('POST', 'teams.removeMember', t('User_has_been_removed_from_team'));\n\n\tconst removeUserAction = useEndpointActionExperimental('POST', `${endpointPrefix}.kick`, t('User_has_been_removed_from_s', roomName));\n\tconst removeUserOptionAction = useMutableCallback(() => {\n\t\tif (room.teamMain && room.teamId) {\n\t\t\treturn setModal(\n\t\t\t\t<RemoveUsersModal\n\t\t\t\t\tteamId={room?.teamId}\n\t\t\t\t\tuserId={uid}\n\t\t\t\t\tonClose={closeModal}\n\t\t\t\t\tonCancel={closeModal}\n\t\t\t\t\tonConfirm={async (rooms) => {\n\t\t\t\t\t\tconst roomKeys = Object.keys(rooms);\n\t\t\t\t\t\tawait removeFromTeam({\n\t\t\t\t\t\t\tteamId: room.teamId,\n\t\t\t\t\t\t\tuserId: uid,\n\t\t\t\t\t\t\t...(roomKeys.length && { rooms: roomKeys }),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcloseModal();\n\t\t\t\t\t\treload && reload();\n\t\t\t\t\t}}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\n\t\tsetModal(\n\t\t\t<WarningModal\n\t\t\t\ttext={t('The_user_will_be_removed_from_s', roomName)}\n\t\t\t\tclose={closeModal}\n\t\t\t\tconfirmText={t('Yes_remove_user')}\n\t\t\t\tconfirm={async () => {\n\t\t\t\t\tawait removeUserAction({ roomId: rid, userId: uid });\n\t\t\t\t\tcloseModal();\n\t\t\t\t\treload && reload();\n\t\t\t\t}}\n\t\t\t/>,\n\t\t);\n\t});\n\n\tconst removeUserOption = useMemo(\n\t\t() =>\n\t\t\troomCanRemove &&\n\t\t\tuserCanRemove && {\n\t\t\t\tlabel: <Box color='danger'>{room.teamMain ? t('Remove_from_team') : t('Remove_from_room')}</Box>,\n\t\t\t\ticon: 'sign-out',\n\t\t\t\taction: removeUserOptionAction,\n\t\t\t},\n\t\t[room, roomCanRemove, userCanRemove, removeUserOptionAction, t],\n\t);\n\n\treturn useMemo(\n\t\t() => ({\n\t\t\t...(openDirectMessageOption && { openDirectMessage: openDirectMessageOption }),\n\t\t\t...(videoCallOption && { video: videoCallOption }),\n\t\t\t...(audioCallOption && { audio: audioCallOption }),\n\t\t\t...(changeOwnerOption && { changeOwner: changeOwnerOption }),\n\t\t\t...(changeLeaderOption && { changeLeader: changeLeaderOption }),\n\t\t\t...(changeModeratorOption && { changeModerator: changeModeratorOption }),\n\t\t\t...(ignoreUserOption && { ignoreUser: ignoreUserOption }),\n\t\t\t...(muteUserOption && { muteUser: muteUserOption }),\n\t\t\t...(removeUserOption && { removeUser: removeUserOption }),\n\t\t\t...(toggleBlockUserOption && { toggleBlock: toggleBlockUserOption }),\n\t\t}),\n\t\t[\n\t\t\taudioCallOption,\n\t\t\tchangeLeaderOption,\n\t\t\tchangeModeratorOption,\n\t\t\tchangeOwnerOption,\n\t\t\tignoreUserOption,\n\t\t\tmuteUserOption,\n\t\t\topenDirectMessageOption,\n\t\t\tremoveUserOption,\n\t\t\tvideoCallOption,\n\t\t\ttoggleBlockUserOption,\n\t\t],\n\t);\n};\n"]},"sourceType":"module","hash":"fe5e0df3799c14d2a2fb2fb1441f7c05d076c788"}
