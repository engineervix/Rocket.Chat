{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/departments/EditDepartment.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/omnichannel/departments/EditDepartment.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/departments/EditDepartment.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/departments/EditDepartment.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/departments/EditDepartment.js"}},"code":"let FieldGroup, Field, TextInput, Chip, Box, Icon, Divider, ToggleSwitch, TextAreaInput, ButtonGroup, Button, PaginatedSelectFiltered;\nmodule.link(\"@rocket.chat/fuselage\", {\n  FieldGroup(v) {\n    FieldGroup = v;\n  },\n\n  Field(v) {\n    Field = v;\n  },\n\n  TextInput(v) {\n    TextInput = v;\n  },\n\n  Chip(v) {\n    Chip = v;\n  },\n\n  Box(v) {\n    Box = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  },\n\n  Divider(v) {\n    Divider = v;\n  },\n\n  ToggleSwitch(v) {\n    ToggleSwitch = v;\n  },\n\n  TextAreaInput(v) {\n    TextAreaInput = v;\n  },\n\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n\n  Button(v) {\n    Button = v;\n  },\n\n  PaginatedSelectFiltered(v) {\n    PaginatedSelectFiltered = v;\n  }\n\n}, 0);\nlet useMutableCallback, useUniqueId;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  },\n\n  useUniqueId(v) {\n    useUniqueId = v;\n  }\n\n}, 1);\nlet React, useMemo, useState, useRef;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  },\n\n  useState(v) {\n    useState = v;\n  },\n\n  useRef(v) {\n    useRef = v;\n  }\n\n}, 2);\nlet useSubscription;\nmodule.link(\"use-subscription\", {\n  useSubscription(v) {\n    useSubscription = v;\n  }\n\n}, 3);\nlet validateEmail;\nmodule.link(\"../../../../lib/emailValidator\", {\n  validateEmail(v) {\n    validateEmail = v;\n  }\n\n}, 4);\nlet Page;\nmodule.link(\"../../../components/Page\", {\n  default(v) {\n    Page = v;\n  }\n\n}, 5);\nlet useRoomsList;\nmodule.link(\"../../../components/RoomAutoComplete/hooks/useRoomsList\", {\n  useRoomsList(v) {\n    useRoomsList = v;\n  }\n\n}, 6);\nlet useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute(v) {\n    useRoute = v;\n  }\n\n}, 7);\nlet useMethod, useEndpoint;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod(v) {\n    useMethod = v;\n  },\n\n  useEndpoint(v) {\n    useEndpoint = v;\n  }\n\n}, 8);\nlet useToastMessageDispatch;\nmodule.link(\"../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  }\n\n}, 9);\nlet useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 10);\nlet useRecordList;\nmodule.link(\"../../../hooks/lists/useRecordList\", {\n  useRecordList(v) {\n    useRecordList = v;\n  }\n\n}, 11);\nlet useComponentDidUpdate;\nmodule.link(\"../../../hooks/useComponentDidUpdate\", {\n  useComponentDidUpdate(v) {\n    useComponentDidUpdate = v;\n  }\n\n}, 12);\nlet useForm;\nmodule.link(\"../../../hooks/useForm\", {\n  useForm(v) {\n    useForm = v;\n  }\n\n}, 13);\nlet AsyncStatePhase;\nmodule.link(\"../../../lib/asyncState\", {\n  AsyncStatePhase(v) {\n    AsyncStatePhase = v;\n  }\n\n}, 14);\nlet formsSubscription;\nmodule.link(\"../additionalForms\", {\n  formsSubscription(v) {\n    formsSubscription = v;\n  }\n\n}, 15);\nlet DepartmentsAgentsTable;\nmodule.link(\"./DepartmentsAgentsTable\", {\n  default(v) {\n    DepartmentsAgentsTable = v;\n  }\n\n}, 16);\n\nfunction withDefault(key, defaultValue) {\n  return key || defaultValue;\n}\n\nfunction EditDepartment(_ref) {\n  var _allowedToForwardData;\n\n  let {\n    data,\n    id,\n    title,\n    reload,\n    allowedToForwardData\n  } = _ref;\n  const t = useTranslation();\n  const departmentsRoute = useRoute('omnichannel-departments');\n  const {\n    useEeNumberInput = () => {},\n    useEeTextInput = () => {},\n    useEeTextAreaInput = () => {},\n    useDepartmentForwarding = () => {},\n    useDepartmentBusinessHours = () => {},\n    useSelectForwardDepartment = () => {}\n  } = useSubscription(formsSubscription);\n  const initialAgents = useRef(data && data.agents || []);\n  const MaxChats = useEeNumberInput();\n  const VisitorInactivity = useEeNumberInput();\n  const WaitingQueueMessageInput = useEeTextAreaInput();\n  const AbandonedMessageInput = useEeTextInput();\n  const DepartmentForwarding = useDepartmentForwarding();\n  const DepartmentBusinessHours = useDepartmentBusinessHours();\n  const AutoCompleteDepartment = useSelectForwardDepartment();\n  const [agentList, setAgentList] = useState([]);\n  const [agentsRemoved, setAgentsRemoved] = useState([]);\n  const [agentsAdded, setAgentsAdded] = useState([]);\n  const {\n    department\n  } = data || {\n    department: {}\n  };\n  const [[tags, tagsText], setTagsState] = useState(() => {\n    var _department$chatClosi;\n\n    return [(_department$chatClosi = department === null || department === void 0 ? void 0 : department.chatClosingTags) !== null && _department$chatClosi !== void 0 ? _department$chatClosi : [], ''];\n  });\n  const {\n    values,\n    handlers,\n    hasUnsavedChanges\n  } = useForm({\n    name: withDefault(department === null || department === void 0 ? void 0 : department.name, ''),\n    email: withDefault(department === null || department === void 0 ? void 0 : department.email, ''),\n    description: withDefault(department === null || department === void 0 ? void 0 : department.description, ''),\n    enabled: !!(department !== null && department !== void 0 && department.enabled),\n    maxNumberSimultaneousChat: department === null || department === void 0 ? void 0 : department.maxNumberSimultaneousChat,\n    showOnRegistration: !!(department !== null && department !== void 0 && department.showOnRegistration),\n    showOnOfflineForm: !!(department !== null && department !== void 0 && department.showOnOfflineForm),\n    abandonedRoomsCloseCustomMessage: withDefault(department === null || department === void 0 ? void 0 : department.abandonedRoomsCloseCustomMessage, ''),\n    requestTagBeforeClosingChat: !!(department !== null && department !== void 0 && department.requestTagBeforeClosingChat),\n    offlineMessageChannelName: withDefault(department === null || department === void 0 ? void 0 : department.offlineMessageChannelName, ''),\n    visitorInactivityTimeoutInSeconds: department === null || department === void 0 ? void 0 : department.visitorInactivityTimeoutInSeconds,\n    waitingQueueMessage: withDefault(department === null || department === void 0 ? void 0 : department.waitingQueueMessage, ''),\n    departmentsAllowedToForward: (allowedToForwardData === null || allowedToForwardData === void 0 ? void 0 : (_allowedToForwardData = allowedToForwardData.departments) === null || _allowedToForwardData === void 0 ? void 0 : _allowedToForwardData.map(dep => ({\n      label: dep.name,\n      value: dep._id\n    }))) || [],\n    fallbackForwardDepartment: withDefault(department === null || department === void 0 ? void 0 : department.fallbackForwardDepartment, '')\n  });\n  const {\n    handleName,\n    handleEmail,\n    handleDescription,\n    handleEnabled,\n    handleMaxNumberSimultaneousChat,\n    handleShowOnRegistration,\n    handleShowOnOfflineForm,\n    handleAbandonedRoomsCloseCustomMessage,\n    handleRequestTagBeforeClosingChat,\n    handleOfflineMessageChannelName,\n    handleVisitorInactivityTimeoutInSeconds,\n    handleWaitingQueueMessage,\n    handleDepartmentsAllowedToForward,\n    handleFallbackForwardDepartment\n  } = handlers;\n  const {\n    name,\n    email,\n    description,\n    enabled,\n    maxNumberSimultaneousChat,\n    showOnRegistration,\n    showOnOfflineForm,\n    abandonedRoomsCloseCustomMessage,\n    requestTagBeforeClosingChat,\n    offlineMessageChannelName,\n    visitorInactivityTimeoutInSeconds,\n    waitingQueueMessage,\n    departmentsAllowedToForward,\n    fallbackForwardDepartment\n  } = values;\n  const {\n    itemsList: RoomsList,\n    loadMoreItems: loadMoreRooms\n  } = useRoomsList(useMemo(() => ({\n    text: offlineMessageChannelName\n  }), [offlineMessageChannelName]));\n  const {\n    phase: roomsPhase,\n    items: roomsItems,\n    itemCount: roomsTotal\n  } = useRecordList(RoomsList);\n\n  const handleTagChipClick = tag => () => {\n    setTagsState(_ref2 => {\n      let [tags, tagsText] = _ref2;\n      return [tags.filter(_tag => _tag !== tag), tagsText];\n    });\n  };\n\n  const handleTagTextSubmit = useMutableCallback(() => {\n    setTagsState(state => {\n      const [tags, tagsText] = state;\n\n      if (tags.includes(tagsText)) {\n        return state;\n      }\n\n      return [[...tags, tagsText], ''];\n    });\n  });\n\n  const handleTagTextChange = e => {\n    setTagsState(_ref3 => {\n      let [tags] = _ref3;\n      return [tags, e.target.value];\n    });\n  };\n\n  const saveDepartmentInfo = useMethod('livechat:saveDepartment');\n  const saveDepartmentAgentsInfoOnEdit = useEndpoint('POST', \"livechat/department/\".concat(id, \"/agents\"));\n  const dispatchToastMessage = useToastMessageDispatch();\n  const [nameError, setNameError] = useState();\n  const [emailError, setEmailError] = useState();\n  const [tagError, setTagError] = useState();\n  useComponentDidUpdate(() => {\n    setNameError(!name ? t('The_field_is_required', 'name') : '');\n  }, [t, name]);\n  useComponentDidUpdate(() => {\n    setEmailError(!email ? t('The_field_is_required', 'email') : '');\n  }, [t, email]);\n  useComponentDidUpdate(() => {\n    setEmailError(!validateEmail(email) ? t('Validate_email_address') : '');\n  }, [t, email]);\n  useComponentDidUpdate(() => {\n    setTagError(requestTagBeforeClosingChat && (!tags || tags.length === 0) ? t('The_field_is_required', 'name') : '');\n  }, [requestTagBeforeClosingChat, t, tags]);\n  const handleSubmit = useMutableCallback(async e => {\n    e.preventDefault();\n    let error = false;\n\n    if (!name) {\n      setNameError(t('The_field_is_required', 'name'));\n      error = true;\n    }\n\n    if (!email) {\n      setEmailError(t('The_field_is_required', 'email'));\n      error = true;\n    }\n\n    if (!validateEmail(email)) {\n      setEmailError(t('Validate_email_address'));\n      error = true;\n    }\n\n    if (requestTagBeforeClosingChat && (!tags || tags.length === 0)) {\n      setTagError(t('The_field_is_required', 'tags'));\n      error = true;\n    }\n\n    if (error) {\n      return;\n    }\n\n    const payload = {\n      enabled,\n      name,\n      description,\n      showOnRegistration,\n      showOnOfflineForm,\n      requestTagBeforeClosingChat,\n      email,\n      chatClosingTags: tags,\n      offlineMessageChannelName,\n      maxNumberSimultaneousChat,\n      visitorInactivityTimeoutInSeconds,\n      abandonedRoomsCloseCustomMessage,\n      waitingQueueMessage,\n      departmentsAllowedToForward: departmentsAllowedToForward === null || departmentsAllowedToForward === void 0 ? void 0 : departmentsAllowedToForward.map(dep => dep.value).join(),\n      fallbackForwardDepartment: fallbackForwardDepartment.value\n    };\n    const agentListPayload = {\n      upsert: agentList.filter(agent => !initialAgents.current.some(initialAgent => initialAgent._id === agent._id && agent.count === initialAgent.count && agent.order === initialAgent.order)),\n      remove: initialAgents.current.filter(initialAgent => !agentList.some(agent => initialAgent._id === agent._id))\n    };\n\n    try {\n      if (id) {\n        await saveDepartmentInfo(id, payload, []);\n\n        if (agentListPayload.upsert.length > 0 || agentListPayload.remove.length > 0) {\n          await saveDepartmentAgentsInfoOnEdit(agentListPayload);\n        }\n      } else {\n        await saveDepartmentInfo(id, payload, agentList);\n      }\n\n      dispatchToastMessage({\n        type: 'success',\n        message: t('Saved')\n      });\n      reload();\n      departmentsRoute.push({});\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  });\n  const handleReturn = useMutableCallback(() => {\n    departmentsRoute.push({});\n  });\n  const invalidForm = !name || !email || !validateEmail(email) || !hasUnsavedChanges || requestTagBeforeClosingChat && (!tags || tags.length === 0);\n  const formId = useUniqueId();\n  const hasNewAgent = useMemo(() => data.agents.length === agentList.length, [data.agents, agentList]);\n\n  const agentsHaveChanged = () => {\n    let hasChanges = false;\n\n    if (agentList.length !== initialAgents.current.length) {\n      hasChanges = true;\n    }\n\n    if (agentsAdded.length > 0 && agentsRemoved.length > 0) {\n      hasChanges = true;\n    }\n\n    agentList.forEach(agent => {\n      const existingAgent = initialAgents.current.find(initial => initial.agentId === agent.agentId);\n\n      if (existingAgent) {\n        if (agent.count !== existingAgent.count) {\n          hasChanges = true;\n        }\n\n        if (agent.order !== existingAgent.order) {\n          hasChanges = true;\n        }\n      }\n    });\n    return hasChanges;\n  };\n\n  return /*#__PURE__*/React.createElement(Page, {\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: title\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, /*#__PURE__*/React.createElement(Button, {\n    onClick: handleReturn\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"back\"\n  }), \" \", t('Back')), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    form: formId,\n    primary: true,\n    disabled: invalidForm && hasNewAgent && !(id && agentsHaveChanged())\n  }, t('Save')))), /*#__PURE__*/React.createElement(Page.ScrollableContentWithShadow, null, /*#__PURE__*/React.createElement(FieldGroup, {\n    w: \"full\",\n    alignSelf: \"center\",\n    maxWidth: \"x600\",\n    id: formId,\n    is: \"form\",\n    autoComplete: \"off\",\n    onSubmit: handleSubmit\n  }, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Enabled')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: enabled,\n    onChange: handleEnabled\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Name'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    flexGrow: 1,\n    error: nameError,\n    value: name,\n    onChange: handleName,\n    placeholder: t('Name')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Description')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {\n    flexGrow: 1,\n    value: description,\n    onChange: handleDescription,\n    placeholder: t('Description')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Show_on_registration_page')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: showOnRegistration,\n    onChange: handleShowOnRegistration\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Email'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    flexGrow: 1,\n    error: emailError,\n    value: email,\n    addon: /*#__PURE__*/React.createElement(Icon, {\n      name: \"mail\",\n      size: \"x20\"\n    }),\n    onChange: handleEmail,\n    placeholder: t('Email')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Show_on_offline_page')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: showOnOfflineForm,\n    onChange: handleShowOnOfflineForm\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Livechat_DepartmentOfflineMessageToChannel')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(PaginatedSelectFiltered, {\n    value: offlineMessageChannelName,\n    onChange: handleOfflineMessageChannelName,\n    flexShrink: 0,\n    filter: offlineMessageChannelName,\n    setFilter: handleOfflineMessageChannelName,\n    options: roomsItems,\n    placeholder: t('Channel_name'),\n    endReached: roomsPhase === AsyncStatePhase.LOADING ? () => {} : start => loadMoreRooms(start, Math.min(50, roomsTotal))\n  }))), MaxChats && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(MaxChats, {\n    value: maxNumberSimultaneousChat,\n    handler: handleMaxNumberSimultaneousChat,\n    label: 'Max_number_of_chats_per_agent',\n    placeholder: \"Max_number_of_chats_per_agent_description\"\n  })), VisitorInactivity && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(VisitorInactivity, {\n    value: visitorInactivityTimeoutInSeconds,\n    handler: handleVisitorInactivityTimeoutInSeconds,\n    label: 'How_long_to_wait_to_consider_visitor_abandonment_in_seconds',\n    placeholder: \"Number_in_seconds\"\n  })), AbandonedMessageInput && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(AbandonedMessageInput, {\n    value: abandonedRoomsCloseCustomMessage,\n    handler: handleAbandonedRoomsCloseCustomMessage,\n    label: 'Livechat_abandoned_rooms_closed_custom_message',\n    placeholder: \"Enter_a_custom_message\"\n  })), WaitingQueueMessageInput && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(WaitingQueueMessageInput, {\n    value: waitingQueueMessage,\n    handler: handleWaitingQueueMessage,\n    label: 'Waiting_queue_message'\n  })), DepartmentForwarding && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(DepartmentForwarding, {\n    departmentId: id,\n    value: departmentsAllowedToForward,\n    handler: handleDepartmentsAllowedToForward,\n    label: 'List_of_departments_for_forward',\n    placeholder: \"Enter_a_department_name\"\n  })), AutoCompleteDepartment && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Fallback_forward_department')), /*#__PURE__*/React.createElement(AutoCompleteDepartment, {\n    haveNone: true,\n    excludeDepartmentId: department === null || department === void 0 ? void 0 : department._id,\n    value: fallbackForwardDepartment,\n    onChange: handleFallbackForwardDepartment,\n    placeholder: t('Fallback_forward_department'),\n    label: t('Fallback_forward_department'),\n    onlyMyDepartments: true\n  })), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Request_tag_before_closing_chat')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: requestTagBeforeClosingChat,\n    onChange: handleRequestTagBeforeClosingChat\n  })))), requestTagBeforeClosingChat && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, {\n    alignSelf: \"stretch\"\n  }, t('Conversation_closing_tags'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    error: tagError,\n    value: tagsText,\n    onChange: handleTagTextChange,\n    placeholder: t('Enter_a_tag')\n  }), /*#__PURE__*/React.createElement(Button, {\n    mis: \"x8\",\n    title: t('add'),\n    onClick: handleTagTextSubmit\n  }, t('Add'))), /*#__PURE__*/React.createElement(Field.Hint, null, t('Conversation_closing_tags_description')), (tags === null || tags === void 0 ? void 0 : tags.length) > 0 && /*#__PURE__*/React.createElement(Field.Row, {\n    justifyContent: \"flex-start\"\n  }, tags.map((tag, i) => /*#__PURE__*/React.createElement(Chip, {\n    key: i,\n    onClick: handleTagChipClick(tag),\n    mie: \"x8\"\n  }, tag)))), DepartmentBusinessHours && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(DepartmentBusinessHours, {\n    bhId: department === null || department === void 0 ? void 0 : department.businessHourId\n  })), /*#__PURE__*/React.createElement(Divider, {\n    mb: \"x16\"\n  }), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, {\n    mb: \"x4\"\n  }, t('Agents'), \":\"), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    height: \"50vh\"\n  }, /*#__PURE__*/React.createElement(DepartmentsAgentsTable, {\n    agents: data && data.agents,\n    setAgentListFinal: setAgentList,\n    setAgentsAdded: setAgentsAdded,\n    setAgentsRemoved: setAgentsRemoved\n  })))))));\n}\n\nmodule.exportDefault(EditDepartment);","map":{"version":3,"sources":["client/views/omnichannel/departments/EditDepartment.js"],"names":["FieldGroup","Field","TextInput","Chip","Box","Icon","Divider","ToggleSwitch","TextAreaInput","ButtonGroup","Button","PaginatedSelectFiltered","module","link","v","useMutableCallback","useUniqueId","React","useMemo","useState","useRef","default","useSubscription","validateEmail","Page","useRoomsList","useRoute","useMethod","useEndpoint","useToastMessageDispatch","useTranslation","useRecordList","useComponentDidUpdate","useForm","AsyncStatePhase","formsSubscription","DepartmentsAgentsTable","withDefault","key","defaultValue","EditDepartment","data","id","title","reload","allowedToForwardData","t","departmentsRoute","useEeNumberInput","useEeTextInput","useEeTextAreaInput","useDepartmentForwarding","useDepartmentBusinessHours","useSelectForwardDepartment","initialAgents","agents","MaxChats","VisitorInactivity","WaitingQueueMessageInput","AbandonedMessageInput","DepartmentForwarding","DepartmentBusinessHours","AutoCompleteDepartment","agentList","setAgentList","agentsRemoved","setAgentsRemoved","agentsAdded","setAgentsAdded","department","tags","tagsText","setTagsState","chatClosingTags","values","handlers","hasUnsavedChanges","name","email","description","enabled","maxNumberSimultaneousChat","showOnRegistration","showOnOfflineForm","abandonedRoomsCloseCustomMessage","requestTagBeforeClosingChat","offlineMessageChannelName","visitorInactivityTimeoutInSeconds","waitingQueueMessage","departmentsAllowedToForward","departments","map","dep","label","value","_id","fallbackForwardDepartment","handleName","handleEmail","handleDescription","handleEnabled","handleMaxNumberSimultaneousChat","handleShowOnRegistration","handleShowOnOfflineForm","handleAbandonedRoomsCloseCustomMessage","handleRequestTagBeforeClosingChat","handleOfflineMessageChannelName","handleVisitorInactivityTimeoutInSeconds","handleWaitingQueueMessage","handleDepartmentsAllowedToForward","handleFallbackForwardDepartment","itemsList","RoomsList","loadMoreItems","loadMoreRooms","text","phase","roomsPhase","items","roomsItems","itemCount","roomsTotal","handleTagChipClick","tag","filter","_tag","handleTagTextSubmit","state","includes","handleTagTextChange","e","target","saveDepartmentInfo","saveDepartmentAgentsInfoOnEdit","dispatchToastMessage","nameError","setNameError","emailError","setEmailError","tagError","setTagError","length","handleSubmit","preventDefault","error","payload","join","agentListPayload","upsert","agent","current","some","initialAgent","count","order","remove","type","message","push","handleReturn","invalidForm","formId","hasNewAgent","agentsHaveChanged","hasChanges","forEach","existingAgent","find","initial","agentId","LOADING","start","Math","min","i","businessHourId","exportDefault"],"mappings":"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","sourcesContent":["import {\n\tFieldGroup,\n\tField,\n\tTextInput,\n\tChip,\n\tBox,\n\tIcon,\n\tDivider,\n\tToggleSwitch,\n\tTextAreaInput,\n\tButtonGroup,\n\tButton,\n\tPaginatedSelectFiltered,\n} from '@rocket.chat/fuselage';\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useState, useRef } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { validateEmail } from '../../../../lib/emailValidator';\nimport Page from '../../../components/Page';\nimport { useRoomsList } from '../../../components/RoomAutoComplete/hooks/useRoomsList';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod, useEndpoint } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useRecordList } from '../../../hooks/lists/useRecordList';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { useForm } from '../../../hooks/useForm';\nimport { AsyncStatePhase } from '../../../lib/asyncState';\nimport { formsSubscription } from '../additionalForms';\nimport DepartmentsAgentsTable from './DepartmentsAgentsTable';\n\nfunction withDefault(key, defaultValue) {\n\treturn key || defaultValue;\n}\n\nfunction EditDepartment({ data, id, title, reload, allowedToForwardData }) {\n\tconst t = useTranslation();\n\tconst departmentsRoute = useRoute('omnichannel-departments');\n\n\tconst {\n\t\tuseEeNumberInput = () => {},\n\t\tuseEeTextInput = () => {},\n\t\tuseEeTextAreaInput = () => {},\n\t\tuseDepartmentForwarding = () => {},\n\t\tuseDepartmentBusinessHours = () => {},\n\t\tuseSelectForwardDepartment = () => {},\n\t} = useSubscription(formsSubscription);\n\n\tconst initialAgents = useRef((data && data.agents) || []);\n\n\tconst MaxChats = useEeNumberInput();\n\tconst VisitorInactivity = useEeNumberInput();\n\tconst WaitingQueueMessageInput = useEeTextAreaInput();\n\tconst AbandonedMessageInput = useEeTextInput();\n\tconst DepartmentForwarding = useDepartmentForwarding();\n\tconst DepartmentBusinessHours = useDepartmentBusinessHours();\n\tconst AutoCompleteDepartment = useSelectForwardDepartment();\n\tconst [agentList, setAgentList] = useState([]);\n\tconst [agentsRemoved, setAgentsRemoved] = useState([]);\n\tconst [agentsAdded, setAgentsAdded] = useState([]);\n\n\tconst { department } = data || { department: {} };\n\n\tconst [[tags, tagsText], setTagsState] = useState(() => [department?.chatClosingTags ?? [], '']);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm({\n\t\tname: withDefault(department?.name, ''),\n\t\temail: withDefault(department?.email, ''),\n\t\tdescription: withDefault(department?.description, ''),\n\t\tenabled: !!department?.enabled,\n\t\tmaxNumberSimultaneousChat: department?.maxNumberSimultaneousChat,\n\t\tshowOnRegistration: !!department?.showOnRegistration,\n\t\tshowOnOfflineForm: !!department?.showOnOfflineForm,\n\t\tabandonedRoomsCloseCustomMessage: withDefault(department?.abandonedRoomsCloseCustomMessage, ''),\n\t\trequestTagBeforeClosingChat: !!department?.requestTagBeforeClosingChat,\n\t\tofflineMessageChannelName: withDefault(department?.offlineMessageChannelName, ''),\n\t\tvisitorInactivityTimeoutInSeconds: department?.visitorInactivityTimeoutInSeconds,\n\t\twaitingQueueMessage: withDefault(department?.waitingQueueMessage, ''),\n\t\tdepartmentsAllowedToForward: allowedToForwardData?.departments?.map((dep) => ({ label: dep.name, value: dep._id })) || [],\n\t\tfallbackForwardDepartment: withDefault(department?.fallbackForwardDepartment, ''),\n\t});\n\tconst {\n\t\thandleName,\n\t\thandleEmail,\n\t\thandleDescription,\n\t\thandleEnabled,\n\t\thandleMaxNumberSimultaneousChat,\n\t\thandleShowOnRegistration,\n\t\thandleShowOnOfflineForm,\n\t\thandleAbandonedRoomsCloseCustomMessage,\n\t\thandleRequestTagBeforeClosingChat,\n\t\thandleOfflineMessageChannelName,\n\t\thandleVisitorInactivityTimeoutInSeconds,\n\t\thandleWaitingQueueMessage,\n\t\thandleDepartmentsAllowedToForward,\n\t\thandleFallbackForwardDepartment,\n\t} = handlers;\n\n\tconst {\n\t\tname,\n\t\temail,\n\t\tdescription,\n\t\tenabled,\n\t\tmaxNumberSimultaneousChat,\n\t\tshowOnRegistration,\n\t\tshowOnOfflineForm,\n\t\tabandonedRoomsCloseCustomMessage,\n\t\trequestTagBeforeClosingChat,\n\t\tofflineMessageChannelName,\n\t\tvisitorInactivityTimeoutInSeconds,\n\t\twaitingQueueMessage,\n\t\tdepartmentsAllowedToForward,\n\t\tfallbackForwardDepartment,\n\t} = values;\n\n\tconst { itemsList: RoomsList, loadMoreItems: loadMoreRooms } = useRoomsList(\n\t\tuseMemo(() => ({ text: offlineMessageChannelName }), [offlineMessageChannelName]),\n\t);\n\n\tconst { phase: roomsPhase, items: roomsItems, itemCount: roomsTotal } = useRecordList(RoomsList);\n\n\tconst handleTagChipClick = (tag) => () => {\n\t\tsetTagsState(([tags, tagsText]) => [tags.filter((_tag) => _tag !== tag), tagsText]);\n\t};\n\n\tconst handleTagTextSubmit = useMutableCallback(() => {\n\t\tsetTagsState((state) => {\n\t\t\tconst [tags, tagsText] = state;\n\n\t\t\tif (tags.includes(tagsText)) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn [[...tags, tagsText], ''];\n\t\t});\n\t});\n\n\tconst handleTagTextChange = (e) => {\n\t\tsetTagsState(([tags]) => [tags, e.target.value]);\n\t};\n\n\tconst saveDepartmentInfo = useMethod('livechat:saveDepartment');\n\tconst saveDepartmentAgentsInfoOnEdit = useEndpoint('POST', `livechat/department/${id}/agents`);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [nameError, setNameError] = useState();\n\tconst [emailError, setEmailError] = useState();\n\tconst [tagError, setTagError] = useState();\n\n\tuseComponentDidUpdate(() => {\n\t\tsetNameError(!name ? t('The_field_is_required', 'name') : '');\n\t}, [t, name]);\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!email ? t('The_field_is_required', 'email') : '');\n\t}, [t, email]);\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!validateEmail(email) ? t('Validate_email_address') : '');\n\t}, [t, email]);\n\tuseComponentDidUpdate(() => {\n\t\tsetTagError(requestTagBeforeClosingChat && (!tags || tags.length === 0) ? t('The_field_is_required', 'name') : '');\n\t}, [requestTagBeforeClosingChat, t, tags]);\n\n\tconst handleSubmit = useMutableCallback(async (e) => {\n\t\te.preventDefault();\n\t\tlet error = false;\n\t\tif (!name) {\n\t\t\tsetNameError(t('The_field_is_required', 'name'));\n\t\t\terror = true;\n\t\t}\n\t\tif (!email) {\n\t\t\tsetEmailError(t('The_field_is_required', 'email'));\n\t\t\terror = true;\n\t\t}\n\t\tif (!validateEmail(email)) {\n\t\t\tsetEmailError(t('Validate_email_address'));\n\t\t\terror = true;\n\t\t}\n\t\tif (requestTagBeforeClosingChat && (!tags || tags.length === 0)) {\n\t\t\tsetTagError(t('The_field_is_required', 'tags'));\n\t\t\terror = true;\n\t\t}\n\n\t\tif (error) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst payload = {\n\t\t\tenabled,\n\t\t\tname,\n\t\t\tdescription,\n\t\t\tshowOnRegistration,\n\t\t\tshowOnOfflineForm,\n\t\t\trequestTagBeforeClosingChat,\n\t\t\temail,\n\t\t\tchatClosingTags: tags,\n\t\t\tofflineMessageChannelName,\n\t\t\tmaxNumberSimultaneousChat,\n\t\t\tvisitorInactivityTimeoutInSeconds,\n\t\t\tabandonedRoomsCloseCustomMessage,\n\t\t\twaitingQueueMessage,\n\t\t\tdepartmentsAllowedToForward: departmentsAllowedToForward?.map((dep) => dep.value).join(),\n\t\t\tfallbackForwardDepartment: fallbackForwardDepartment.value,\n\t\t};\n\n\t\tconst agentListPayload = {\n\t\t\tupsert: agentList.filter(\n\t\t\t\t(agent) =>\n\t\t\t\t\t!initialAgents.current.some(\n\t\t\t\t\t\t(initialAgent) => initialAgent._id === agent._id && agent.count === initialAgent.count && agent.order === initialAgent.order,\n\t\t\t\t\t),\n\t\t\t),\n\t\t\tremove: initialAgents.current.filter((initialAgent) => !agentList.some((agent) => initialAgent._id === agent._id)),\n\t\t};\n\n\t\ttry {\n\t\t\tif (id) {\n\t\t\t\tawait saveDepartmentInfo(id, payload, []);\n\t\t\t\tif (agentListPayload.upsert.length > 0 || agentListPayload.remove.length > 0) {\n\t\t\t\t\tawait saveDepartmentAgentsInfoOnEdit(agentListPayload);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait saveDepartmentInfo(id, payload, agentList);\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tdepartmentsRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\tdepartmentsRoute.push({});\n\t});\n\n\tconst invalidForm =\n\t\t!name || !email || !validateEmail(email) || !hasUnsavedChanges || (requestTagBeforeClosingChat && (!tags || tags.length === 0));\n\n\tconst formId = useUniqueId();\n\n\tconst hasNewAgent = useMemo(() => data.agents.length === agentList.length, [data.agents, agentList]);\n\n\tconst agentsHaveChanged = () => {\n\t\tlet hasChanges = false;\n\t\tif (agentList.length !== initialAgents.current.length) {\n\t\t\thasChanges = true;\n\t\t}\n\n\t\tif (agentsAdded.length > 0 && agentsRemoved.length > 0) {\n\t\t\thasChanges = true;\n\t\t}\n\n\t\tagentList.forEach((agent) => {\n\t\t\tconst existingAgent = initialAgents.current.find((initial) => initial.agentId === agent.agentId);\n\t\t\tif (existingAgent) {\n\t\t\t\tif (agent.count !== existingAgent.count) {\n\t\t\t\t\thasChanges = true;\n\t\t\t\t}\n\t\t\t\tif (agent.order !== existingAgent.order) {\n\t\t\t\t\thasChanges = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn hasChanges;\n\t};\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={title}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button onClick={handleReturn}>\n\t\t\t\t\t\t\t<Icon name='back' /> {t('Back')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button type='submit' form={formId} primary disabled={invalidForm && hasNewAgent && !(id && agentsHaveChanged())}>\n\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<FieldGroup w='full' alignSelf='center' maxWidth='x600' id={formId} is='form' autoComplete='off' onSubmit={handleSubmit}>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Enabled')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={enabled} onChange={handleEnabled} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput flexGrow={1} error={nameError} value={name} onChange={handleName} placeholder={t('Name')} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Description')}</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextAreaInput flexGrow={1} value={description} onChange={handleDescription} placeholder={t('Description')} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Show_on_registration_page')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={showOnRegistration} onChange={handleShowOnRegistration} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Email')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\terror={emailError}\n\t\t\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\t\t\taddon={<Icon name='mail' size='x20' />}\n\t\t\t\t\t\t\t\t\tonChange={handleEmail}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Email')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Show_on_offline_page')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={showOnOfflineForm} onChange={handleShowOnOfflineForm} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Livechat_DepartmentOfflineMessageToChannel')}</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<PaginatedSelectFiltered\n\t\t\t\t\t\t\t\t\tvalue={offlineMessageChannelName}\n\t\t\t\t\t\t\t\t\tonChange={handleOfflineMessageChannelName}\n\t\t\t\t\t\t\t\t\tflexShrink={0}\n\t\t\t\t\t\t\t\t\tfilter={offlineMessageChannelName}\n\t\t\t\t\t\t\t\t\tsetFilter={handleOfflineMessageChannelName}\n\t\t\t\t\t\t\t\t\toptions={roomsItems}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Channel_name')}\n\t\t\t\t\t\t\t\t\tendReached={roomsPhase === AsyncStatePhase.LOADING ? () => {} : (start) => loadMoreRooms(start, Math.min(50, roomsTotal))}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t{MaxChats && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<MaxChats\n\t\t\t\t\t\t\t\t\tvalue={maxNumberSimultaneousChat}\n\t\t\t\t\t\t\t\t\thandler={handleMaxNumberSimultaneousChat}\n\t\t\t\t\t\t\t\t\tlabel={'Max_number_of_chats_per_agent'}\n\t\t\t\t\t\t\t\t\tplaceholder='Max_number_of_chats_per_agent_description'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{VisitorInactivity && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<VisitorInactivity\n\t\t\t\t\t\t\t\t\tvalue={visitorInactivityTimeoutInSeconds}\n\t\t\t\t\t\t\t\t\thandler={handleVisitorInactivityTimeoutInSeconds}\n\t\t\t\t\t\t\t\t\tlabel={'How_long_to_wait_to_consider_visitor_abandonment_in_seconds'}\n\t\t\t\t\t\t\t\t\tplaceholder='Number_in_seconds'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{AbandonedMessageInput && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<AbandonedMessageInput\n\t\t\t\t\t\t\t\t\tvalue={abandonedRoomsCloseCustomMessage}\n\t\t\t\t\t\t\t\t\thandler={handleAbandonedRoomsCloseCustomMessage}\n\t\t\t\t\t\t\t\t\tlabel={'Livechat_abandoned_rooms_closed_custom_message'}\n\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_custom_message'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{WaitingQueueMessageInput && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<WaitingQueueMessageInput value={waitingQueueMessage} handler={handleWaitingQueueMessage} label={'Waiting_queue_message'} />\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{DepartmentForwarding && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<DepartmentForwarding\n\t\t\t\t\t\t\t\t\tdepartmentId={id}\n\t\t\t\t\t\t\t\t\tvalue={departmentsAllowedToForward}\n\t\t\t\t\t\t\t\t\thandler={handleDepartmentsAllowedToForward}\n\t\t\t\t\t\t\t\t\tlabel={'List_of_departments_for_forward'}\n\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_department_name'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{AutoCompleteDepartment && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Fallback_forward_department')}</Field.Label>\n\t\t\t\t\t\t\t\t<AutoCompleteDepartment\n\t\t\t\t\t\t\t\t\thaveNone\n\t\t\t\t\t\t\t\t\texcludeDepartmentId={department?._id}\n\t\t\t\t\t\t\t\t\tvalue={fallbackForwardDepartment}\n\t\t\t\t\t\t\t\t\tonChange={handleFallbackForwardDepartment}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Fallback_forward_department')}\n\t\t\t\t\t\t\t\t\tlabel={t('Fallback_forward_department')}\n\t\t\t\t\t\t\t\t\tonlyMyDepartments\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Request_tag_before_closing_chat')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={requestTagBeforeClosingChat} onChange={handleRequestTagBeforeClosingChat} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t{requestTagBeforeClosingChat && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label alignSelf='stretch'>{t('Conversation_closing_tags')}*</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<TextInput error={tagError} value={tagsText} onChange={handleTagTextChange} placeholder={t('Enter_a_tag')} />\n\t\t\t\t\t\t\t\t\t<Button mis='x8' title={t('add')} onClick={handleTagTextSubmit}>\n\t\t\t\t\t\t\t\t\t\t{t('Add')}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t\t<Field.Hint>{t('Conversation_closing_tags_description')}</Field.Hint>\n\t\t\t\t\t\t\t\t{tags?.length > 0 && (\n\t\t\t\t\t\t\t\t\t<Field.Row justifyContent='flex-start'>\n\t\t\t\t\t\t\t\t\t\t{tags.map((tag, i) => (\n\t\t\t\t\t\t\t\t\t\t\t<Chip key={i} onClick={handleTagChipClick(tag)} mie='x8'>\n\t\t\t\t\t\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t\t\t\t\t</Chip>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{DepartmentBusinessHours && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<DepartmentBusinessHours bhId={department?.businessHourId} />\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Divider mb='x16' />\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label mb='x4'>{t('Agents')}:</Field.Label>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='column' height='50vh'>\n\t\t\t\t\t\t\t\t<DepartmentsAgentsTable\n\t\t\t\t\t\t\t\t\tagents={data && data.agents}\n\t\t\t\t\t\t\t\t\tsetAgentListFinal={setAgentList}\n\t\t\t\t\t\t\t\t\tsetAgentsAdded={setAgentsAdded}\n\t\t\t\t\t\t\t\t\tsetAgentsRemoved={setAgentsRemoved}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t</Page>\n\t);\n}\n\nexport default EditDepartment;\n"]},"sourceType":"module","hash":"270c5794845ce2352eca05e5bf9a57a19ecc5e79"}
