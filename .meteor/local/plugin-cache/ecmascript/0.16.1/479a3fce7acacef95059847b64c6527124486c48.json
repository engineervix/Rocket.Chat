{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/favico/client/favico.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/favico/client/favico.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/favico/client/favico.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/favico/client/favico.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/favico/client/favico.js"}},"code":"module.export({\n  Favico: function () {\n    return Favico;\n  }\n});\n\nvar Favico = function (opt) {\n  'use strict';\n\n  opt = opt ? opt : {};\n  var _def = {\n    bgColor: '#d00',\n    textColor: '#fff',\n    fontFamily: 'sans-serif',\n    //Arial,Verdana,Times New Roman,serif,sans-serif,...\n    fontStyle: 'bold',\n    //normal,italic,oblique,bold,bolder,lighter,100,200,300,400,500,600,700,800,900\n    type: 'circle',\n    position: 'down',\n    // down, up, left, leftup (upleft)\n    animation: 'slide',\n    elementId: false,\n    dataUrl: false,\n    win: window\n  };\n\n  var _opt, _orig, _h, _w, _canvas, _context, _img, _ready, _lastBadge, _running, _readyCb, _stop, _browser, _animTimeout, _drawTimeout, _doc;\n\n  _browser = {};\n  _browser.ff = typeof InstallTrigger !== 'undefined';\n  _browser.chrome = !!window.chrome;\n  _browser.opera = !!window.opera || navigator.userAgent.indexOf('Opera') >= 0;\n  _browser.ie =\n  /*@cc_on!@*/\n  false;\n  _browser.safari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;\n  _browser.supported = _browser.chrome || _browser.ff || _browser.opera;\n  var _queue = [];\n\n  _readyCb = function () {};\n\n  _ready = _stop = false;\n  /**\n   * Initialize favico\n   */\n\n  var init = function () {\n    //merge initial options\n    _opt = merge(_def, opt);\n    _opt.bgColor = hexToRgb(_opt.bgColor);\n    _opt.textColor = hexToRgb(_opt.textColor);\n    _opt.position = _opt.position.toLowerCase();\n    _opt.animation = animation.types['' + _opt.animation] ? _opt.animation : _def.animation;\n    _doc = _opt.win.document;\n    var isUp = _opt.position.indexOf('up') > -1;\n    var isLeft = _opt.position.indexOf('left') > -1; //transform the animations\n\n    if (isUp || isLeft) {\n      for (var a in meteorBabelHelpers.sanitizeForInObject(animation.types)) {\n        for (var i = 0; i < animation.types[a].length; i++) {\n          var step = animation.types[a][i];\n\n          if (isUp) {\n            if (step.y < 0.6) {\n              step.y = step.y - 0.4;\n            } else {\n              step.y = step.y - 2 * step.y + (1 - step.w);\n            }\n          }\n\n          if (isLeft) {\n            if (step.x < 0.6) {\n              step.x = step.x - 0.4;\n            } else {\n              step.x = step.x - 2 * step.x + (1 - step.h);\n            }\n          }\n\n          animation.types[a][i] = step;\n        }\n      }\n    }\n\n    _opt.type = type['' + _opt.type] ? _opt.type : _def.type;\n    _orig = link.getIcons(); //create temp canvas\n\n    _canvas = document.createElement('canvas'); //create temp image\n\n    _img = document.createElement('img');\n    var lastIcon = _orig[_orig.length - 1];\n\n    if (lastIcon.hasAttribute('href')) {\n      _img.setAttribute('crossOrigin', 'anonymous'); //get width/height\n\n\n      _img.onload = function () {\n        _h = _img.height > 0 ? _img.height : 32;\n        _w = _img.width > 0 ? _img.width : 32;\n        _canvas.height = _h;\n        _canvas.width = _w;\n        _context = _canvas.getContext('2d');\n        icon.ready();\n      };\n\n      _img.setAttribute('src', lastIcon.getAttribute('href'));\n    } else {\n      _img.onload = function () {\n        _h = 32;\n        _w = 32;\n        _img.height = _h;\n        _img.width = _w;\n        _canvas.height = _h;\n        _canvas.width = _w;\n        _context = _canvas.getContext('2d');\n        icon.ready();\n      };\n\n      _img.setAttribute('src', '');\n    }\n  };\n  /**\n   * Icon namespace\n   */\n\n\n  var icon = {};\n  /**\n   * Icon is ready (reset icon) and start animation (if ther is any)\n   */\n\n  icon.ready = function () {\n    _ready = true;\n    icon.reset();\n\n    _readyCb();\n  };\n  /**\n   * Reset icon to default state\n   */\n\n\n  icon.reset = function () {\n    //reset\n    if (!_ready) {\n      return;\n    }\n\n    _queue = [];\n    _lastBadge = false;\n    _running = false;\n\n    _context.clearRect(0, 0, _w, _h);\n\n    _context.drawImage(_img, 0, 0, _w, _h); //_stop=true;\n\n\n    link.setIcon(_canvas); //webcam('stop');\n    //video('stop');\n\n    window.clearTimeout(_animTimeout);\n    window.clearTimeout(_drawTimeout);\n  };\n  /**\n   * Start animation\n   */\n\n\n  icon.start = function () {\n    if (!_ready || _running) {\n      return;\n    }\n\n    var finished = function () {\n      _lastBadge = _queue[0];\n      _running = false;\n\n      if (_queue.length > 0) {\n        _queue.shift();\n\n        icon.start();\n      }\n    };\n\n    if (_queue.length > 0) {\n      _running = true;\n\n      var run = function () {\n        // apply options for this animation\n        ['type', 'animation', 'bgColor', 'textColor', 'fontFamily', 'fontStyle'].forEach(function (a) {\n          if (a in _queue[0].options) {\n            _opt[a] = _queue[0].options[a];\n          }\n        });\n        animation.run(_queue[0].options, function () {\n          finished();\n        }, false);\n      };\n\n      if (_lastBadge) {\n        animation.run(_lastBadge.options, function () {\n          run();\n        }, true);\n      } else {\n        run();\n      }\n    }\n  };\n  /**\n   * Badge types\n   */\n\n\n  var type = {};\n\n  var options = function (opt) {\n    opt.n = typeof opt.n === 'number' ? Math.abs(opt.n | 0) : opt.n;\n    opt.x = _w * opt.x;\n    opt.y = _h * opt.y;\n    opt.w = _w * opt.w;\n    opt.h = _h * opt.h;\n    opt.len = ('' + opt.n).length;\n    return opt;\n  };\n  /**\n   * Generate circle\n   * @param {Object} opt Badge options\n   */\n\n\n  type.circle = function (opt) {\n    opt = options(opt);\n    var more = false;\n\n    if (opt.len === 2) {\n      opt.x = opt.x - opt.w * 0.4;\n      opt.w = opt.w * 1.4;\n      more = true;\n    } else if (opt.len >= 3) {\n      opt.x = opt.x - opt.w * 0.65;\n      opt.w = opt.w * 1.65;\n      more = true;\n    }\n\n    _context.clearRect(0, 0, _w, _h);\n\n    _context.drawImage(_img, 0, 0, _w, _h);\n\n    _context.beginPath();\n\n    _context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.85 : 1)) + 'px ' + _opt.fontFamily;\n    _context.textAlign = 'center';\n\n    if (more) {\n      _context.moveTo(opt.x + opt.w / 2, opt.y);\n\n      _context.lineTo(opt.x + opt.w - opt.h / 2, opt.y);\n\n      _context.quadraticCurveTo(opt.x + opt.w, opt.y, opt.x + opt.w, opt.y + opt.h / 2);\n\n      _context.lineTo(opt.x + opt.w, opt.y + opt.h - opt.h / 2);\n\n      _context.quadraticCurveTo(opt.x + opt.w, opt.y + opt.h, opt.x + opt.w - opt.h / 2, opt.y + opt.h);\n\n      _context.lineTo(opt.x + opt.h / 2, opt.y + opt.h);\n\n      _context.quadraticCurveTo(opt.x, opt.y + opt.h, opt.x, opt.y + opt.h - opt.h / 2);\n\n      _context.lineTo(opt.x, opt.y + opt.h / 2);\n\n      _context.quadraticCurveTo(opt.x, opt.y, opt.x + opt.h / 2, opt.y);\n    } else {\n      _context.arc(opt.x + opt.w / 2, opt.y + opt.h / 2, opt.h / 2, 0, 2 * Math.PI);\n    }\n\n    _context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';\n\n    _context.fill();\n\n    _context.closePath();\n\n    _context.beginPath();\n\n    _context.stroke();\n\n    _context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')'; //_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\n    if (typeof opt.n === 'number' && opt.n > 999) {\n      _context.fillText((opt.n > 9999 ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));\n    } else {\n      _context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n    }\n\n    _context.closePath();\n  };\n  /**\n   * Generate rectangle\n   * @param {Object} opt Badge options\n   */\n\n\n  type.rectangle = function (opt) {\n    opt = options(opt);\n    var more = false;\n\n    if (opt.len === 2) {\n      opt.x = opt.x - opt.w * 0.4;\n      opt.w = opt.w * 1.4;\n      more = true;\n    } else if (opt.len >= 3) {\n      opt.x = opt.x - opt.w * 0.65;\n      opt.w = opt.w * 1.65;\n      more = true;\n    }\n\n    _context.clearRect(0, 0, _w, _h);\n\n    _context.drawImage(_img, 0, 0, _w, _h);\n\n    _context.beginPath();\n\n    _context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.9 : 1)) + 'px ' + _opt.fontFamily;\n    _context.textAlign = 'center';\n    _context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';\n\n    _context.fillRect(opt.x, opt.y, opt.w, opt.h);\n\n    _context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')'; //_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\n    if (typeof opt.n === 'number' && opt.n > 999) {\n      _context.fillText((opt.n > 9999 ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));\n    } else {\n      _context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n    }\n\n    _context.closePath();\n  };\n  /**\n   * Set badge\n   */\n\n\n  var badge = function (number, opts) {\n    opts = (typeof opts === 'string' ? {\n      animation: opts\n    } : opts) || {};\n\n    _readyCb = function () {\n      try {\n        if (typeof number === 'number' ? number > 0 : number !== '') {\n          var q = {\n            type: 'badge',\n            options: {\n              n: number\n            }\n          };\n\n          if ('animation' in opts && animation.types['' + opts.animation]) {\n            q.options.animation = '' + opts.animation;\n          }\n\n          if ('type' in opts && type['' + opts.type]) {\n            q.options.type = '' + opts.type;\n          }\n\n          ['bgColor', 'textColor'].forEach(function (o) {\n            if (o in opts) {\n              q.options[o] = hexToRgb(opts[o]);\n            }\n          });\n          ['fontStyle', 'fontFamily'].forEach(function (o) {\n            if (o in opts) {\n              q.options[o] = opts[o];\n            }\n          });\n\n          _queue.push(q);\n\n          if (_queue.length > 100) {\n            throw new Error('Too many badges requests in queue.');\n          }\n\n          icon.start();\n        } else {\n          icon.reset();\n        }\n      } catch (e) {\n        throw new Error('Error setting badge. Message: ' + e.message);\n      }\n    };\n\n    if (_ready) {\n      _readyCb();\n    }\n  };\n  /**\n   * Set image as icon\n   */\n\n\n  var image = function (imageElement) {\n    _readyCb = function () {\n      try {\n        var w = imageElement.width;\n        var h = imageElement.height;\n        var newImg = document.createElement('img');\n        var ratio = w / _w < h / _h ? w / _w : h / _h;\n        newImg.setAttribute('crossOrigin', 'anonymous');\n\n        newImg.onload = function () {\n          _context.clearRect(0, 0, _w, _h);\n\n          _context.drawImage(newImg, 0, 0, _w, _h);\n\n          link.setIcon(_canvas);\n        };\n\n        newImg.setAttribute('src', imageElement.getAttribute('src'));\n        newImg.height = h / ratio;\n        newImg.width = w / ratio;\n      } catch (e) {\n        throw new Error('Error setting image. Message: ' + e.message);\n      }\n    };\n\n    if (_ready) {\n      _readyCb();\n    }\n  };\n  /**\n   * Set video as icon\n   */\n\n\n  var video = function (videoElement) {\n    _readyCb = function () {\n      try {\n        if (videoElement === 'stop') {\n          _stop = true;\n          icon.reset();\n          _stop = false;\n          return;\n        } //var w = videoElement.width;\n        //var h = videoElement.height;\n        //var ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);\n\n\n        videoElement.addEventListener('play', function () {\n          drawVideo(this);\n        }, false);\n      } catch (e) {\n        throw new Error('Error setting video. Message: ' + e.message);\n      }\n    };\n\n    if (_ready) {\n      _readyCb();\n    }\n  };\n  /**\n   * Set video as icon\n   */\n\n\n  var webcam = function (action) {\n    //UR\n    if (!window.URL || !window.URL.createObjectURL) {\n      window.URL = window.URL || {};\n\n      window.URL.createObjectURL = function (obj) {\n        return obj;\n      };\n    }\n\n    if (_browser.supported) {\n      var newVideo = false;\n      navigator.getUserMedia = navigator.getUserMedia || navigator.oGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;\n\n      _readyCb = function () {\n        try {\n          if (action === 'stop') {\n            _stop = true;\n            icon.reset();\n            _stop = false;\n            return;\n          }\n\n          newVideo = document.createElement('video');\n          newVideo.width = _w;\n          newVideo.height = _h;\n          navigator.getUserMedia({\n            video: true,\n            audio: false\n          }, function (stream) {\n            newVideo.src = URL.createObjectURL(stream);\n            newVideo.play();\n            drawVideo(newVideo);\n          }, function () {});\n        } catch (e) {\n          throw new Error('Error setting webcam. Message: ' + e.message);\n        }\n      };\n\n      if (_ready) {\n        _readyCb();\n      }\n    }\n  };\n  /**\n   * Draw video to context and repeat :)\n   */\n\n\n  function drawVideo(video) {\n    if (video.paused || video.ended || _stop) {\n      return false;\n    } //nasty hack for FF webcam (Thanks to Julian Ćwirko, kontakt@redsunmedia.pl)\n\n\n    try {\n      _context.clearRect(0, 0, _w, _h);\n\n      _context.drawImage(video, 0, 0, _w, _h);\n    } catch (e) {}\n\n    _drawTimeout = setTimeout(function () {\n      drawVideo(video);\n    }, animation.duration);\n    link.setIcon(_canvas);\n  }\n\n  var link = {};\n  /**\n   * Get icons from HEAD tag or create a new <link> element\n   */\n\n  link.getIcons = function () {\n    var elms = []; //get link element\n\n    var getLinks = function () {\n      var icons = [];\n\n      var links = _doc.getElementsByTagName('head')[0].getElementsByTagName('link');\n\n      for (var i = 0; i < links.length; i++) {\n        if (/(^|\\s)icon(\\s|$)/i.test(links[i].getAttribute('rel'))) {\n          icons.push(links[i]);\n        }\n      }\n\n      return icons;\n    };\n\n    if (_opt.element) {\n      elms = [_opt.element];\n    } else if (_opt.elementId) {\n      //if img element identified by elementId\n      elms = [_doc.getElementById(_opt.elementId)];\n      elms[0].setAttribute('href', elms[0].getAttribute('src'));\n    } else {\n      //if link element\n      elms = getLinks();\n\n      if (elms.length === 0) {\n        elms = [_doc.createElement('link')];\n        elms[0].setAttribute('rel', 'icon');\n\n        _doc.getElementsByTagName('head')[0].appendChild(elms[0]);\n      }\n    }\n\n    elms.forEach(function (item) {\n      item.setAttribute('type', 'image/png');\n    });\n    return elms;\n  };\n\n  link.setIcon = function (canvas) {\n    var url = canvas.toDataURL('image/png');\n\n    if (_opt.dataUrl) {\n      //if using custom exporter\n      _opt.dataUrl(url);\n    }\n\n    if (_opt.element) {\n      _opt.element.setAttribute('href', url);\n\n      _opt.element.setAttribute('src', url);\n    } else if (_opt.elementId) {\n      //if is attached to element (image)\n      var elm = _doc.getElementById(_opt.elementId);\n\n      elm.setAttribute('href', url);\n      elm.setAttribute('src', url);\n    } else {\n      //if is attached to fav icon\n      if (_browser.ff || _browser.opera) {\n        //for FF we need to \"recreate\" element, atach to dom and remove old <link>\n        //var originalType = _orig.getAttribute('rel');\n        var old = _orig[_orig.length - 1];\n\n        var newIcon = _doc.createElement('link');\n\n        _orig = [newIcon]; //_orig.setAttribute('rel', originalType);\n\n        if (_browser.opera) {\n          newIcon.setAttribute('rel', 'icon');\n        }\n\n        newIcon.setAttribute('rel', 'icon');\n        newIcon.setAttribute('type', 'image/png');\n\n        _doc.getElementsByTagName('head')[0].appendChild(newIcon);\n\n        newIcon.setAttribute('href', url);\n\n        if (old.parentNode) {\n          old.parentNode.removeChild(old);\n        }\n      } else {\n        _orig.forEach(function (icon) {\n          icon.setAttribute('href', url);\n        });\n      }\n    }\n  }; //http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb#answer-5624139\n  //HEX to RGB convertor\n\n\n  function hexToRgb(hex) {\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n    hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n      return r + r + g + g + b + b;\n    });\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : false;\n  }\n  /**\n   * Merge options\n   */\n\n\n  function merge(def, opt) {\n    var mergedOpt = {};\n    var attrname;\n\n    for (attrname in meteorBabelHelpers.sanitizeForInObject(def)) {\n      mergedOpt[attrname] = def[attrname];\n    }\n\n    for (attrname in meteorBabelHelpers.sanitizeForInObject(opt)) {\n      mergedOpt[attrname] = opt[attrname];\n    }\n\n    return mergedOpt;\n  }\n  /**\n   * Cross-browser page visibility shim\n   * http://stackoverflow.com/questions/12536562/detect-whether-a-window-is-visible\n   */\n\n\n  function isPageHidden() {\n    return _doc.hidden || _doc.msHidden || _doc.webkitHidden || _doc.mozHidden;\n  }\n  /**\n   * @namespace animation\n   */\n\n\n  var animation = {};\n  /**\n   * Animation \"frame\" duration\n   */\n\n  animation.duration = 40;\n  /**\n   * Animation types (none,fade,pop,slide)\n   */\n\n  animation.types = {};\n  animation.types.fade = [{\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.0\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.1\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.2\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.3\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.4\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.5\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.6\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.7\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.8\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 0.9\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 1.0\n  }];\n  animation.types.none = [{\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }];\n  animation.types.pop = [{\n    x: 1,\n    y: 1,\n    w: 0,\n    h: 0,\n    o: 1\n  }, {\n    x: 0.9,\n    y: 0.9,\n    w: 0.1,\n    h: 0.1,\n    o: 1\n  }, {\n    x: 0.8,\n    y: 0.8,\n    w: 0.2,\n    h: 0.2,\n    o: 1\n  }, {\n    x: 0.7,\n    y: 0.7,\n    w: 0.3,\n    h: 0.3,\n    o: 1\n  }, {\n    x: 0.6,\n    y: 0.6,\n    w: 0.4,\n    h: 0.4,\n    o: 1\n  }, {\n    x: 0.5,\n    y: 0.5,\n    w: 0.5,\n    h: 0.5,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }];\n  animation.types.popFade = [{\n    x: 0.75,\n    y: 0.75,\n    w: 0,\n    h: 0,\n    o: 0\n  }, {\n    x: 0.65,\n    y: 0.65,\n    w: 0.1,\n    h: 0.1,\n    o: 0.2\n  }, {\n    x: 0.6,\n    y: 0.6,\n    w: 0.2,\n    h: 0.2,\n    o: 0.4\n  }, {\n    x: 0.55,\n    y: 0.55,\n    w: 0.3,\n    h: 0.3,\n    o: 0.6\n  }, {\n    x: 0.50,\n    y: 0.50,\n    w: 0.4,\n    h: 0.4,\n    o: 0.8\n  }, {\n    x: 0.45,\n    y: 0.45,\n    w: 0.5,\n    h: 0.5,\n    o: 0.9\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }];\n  animation.types.slide = [{\n    x: 0.4,\n    y: 1,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.9,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.9,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.8,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.7,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.6,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.5,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }, {\n    x: 0.4,\n    y: 0.4,\n    w: 0.6,\n    h: 0.6,\n    o: 1\n  }];\n  /**\n   * Run animation\n   * @param {Object} opt Animation options\n   * @param {Object} cb Callabak after all steps are done\n   * @param {Object} revert Reverse order? true|false\n   * @param {Object} step Optional step number (frame bumber)\n   */\n\n  animation.run = function (opt, cb, revert, step) {\n    var animationType = animation.types[isPageHidden() ? 'none' : _opt.animation];\n\n    if (revert === true) {\n      step = typeof step !== 'undefined' ? step : animationType.length - 1;\n    } else {\n      step = typeof step !== 'undefined' ? step : 0;\n    }\n\n    cb = cb ? cb : function () {};\n\n    if (step < animationType.length && step >= 0) {\n      type[_opt.type](merge(opt, animationType[step]));\n\n      _animTimeout = setTimeout(function () {\n        if (revert) {\n          step = step - 1;\n        } else {\n          step = step + 1;\n        }\n\n        animation.run(opt, cb, revert, step);\n      }, animation.duration);\n      link.setIcon(_canvas);\n    } else {\n      cb();\n      return;\n    }\n  }; //auto init\n\n\n  init();\n  return {\n    badge: badge,\n    video: video,\n    image: image,\n    webcam: webcam,\n    reset: icon.reset,\n    browser: {\n      supported: _browser.supported\n    }\n  };\n};","map":{"version":3,"sources":["app/favico/client/favico.js"],"names":["module","export","Favico","opt","_def","bgColor","textColor","fontFamily","fontStyle","type","position","animation","elementId","dataUrl","win","window","_opt","_orig","_h","_w","_canvas","_context","_img","_ready","_lastBadge","_running","_readyCb","_stop","_browser","_animTimeout","_drawTimeout","_doc","ff","InstallTrigger","chrome","opera","navigator","userAgent","indexOf","ie","safari","Object","prototype","toString","call","HTMLElement","supported","_queue","init","merge","hexToRgb","toLowerCase","types","document","isUp","isLeft","a","i","length","step","y","w","x","h","link","getIcons","createElement","lastIcon","hasAttribute","setAttribute","onload","height","width","getContext","icon","ready","getAttribute","reset","clearRect","drawImage","setIcon","clearTimeout","start","finished","shift","run","forEach","options","n","Math","abs","len","circle","more","beginPath","font","floor","textAlign","moveTo","lineTo","quadraticCurveTo","arc","PI","fillStyle","r","g","b","o","fill","closePath","stroke","fillText","rectangle","fillRect","badge","number","opts","q","push","Error","e","message","image","imageElement","newImg","ratio","video","videoElement","addEventListener","drawVideo","webcam","action","URL","createObjectURL","obj","newVideo","getUserMedia","oGetUserMedia","msGetUserMedia","mozGetUserMedia","webkitGetUserMedia","audio","stream","src","play","paused","ended","setTimeout","duration","elms","getLinks","icons","links","getElementsByTagName","test","element","getElementById","appendChild","item","canvas","url","toDataURL","elm","old","newIcon","parentNode","removeChild","hex","shorthandRegex","replace","m","result","exec","parseInt","def","mergedOpt","attrname","isPageHidden","hidden","msHidden","webkitHidden","mozHidden","fade","none","pop","popFade","slide","cb","revert","animationType","browser"],"mappings":"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","sourcesContent":["/**\n * @license MIT\n * @fileOverview Favico animations\n * @author Miroslav Magda, http://blog.ejci.net\n * @version 0.3.10\n */\n\n/**\n * Create new favico instance\n * @param {Object} Options\n * @return {Object} Favico object\n * @example\n * var favico = new Favico({\n *    bgColor : '#d00',\n *    textColor : '#fff',\n *    fontFamily : 'sans-serif',\n *    fontStyle : 'bold',\n *    position : 'down',\n *    type : 'circle',\n *    animation : 'slide',\n *    dataUrl: function(url){},\n *    win: top\n * });\n */\n/* eslint-disable */\n\n\texport const Favico = (function(opt) {\n\t\t'use strict';\n\t\topt = (opt) ? opt : {};\n\t\tvar _def = {\n\t\t\tbgColor: '#d00',\n\t\t\ttextColor: '#fff',\n\t\t\tfontFamily: 'sans-serif', //Arial,Verdana,Times New Roman,serif,sans-serif,...\n\t\t\tfontStyle: 'bold', //normal,italic,oblique,bold,bolder,lighter,100,200,300,400,500,600,700,800,900\n\t\t\ttype: 'circle',\n\t\t\tposition: 'down', // down, up, left, leftup (upleft)\n\t\t\tanimation: 'slide',\n\t\t\telementId: false,\n\t\t\tdataUrl: false,\n\t\t\twin: window\n\t\t};\n\t\tvar _opt, _orig, _h, _w, _canvas, _context, _img, _ready, _lastBadge, _running, _readyCb, _stop, _browser, _animTimeout, _drawTimeout, _doc;\n\n\t\t_browser = {};\n\t\t_browser.ff = typeof InstallTrigger !== 'undefined';\n\t\t_browser.chrome = !!window.chrome;\n\t\t_browser.opera = !!window.opera || navigator.userAgent.indexOf('Opera') >= 0;\n\t\t_browser.ie = /*@cc_on!@*/ false;\n\t\t_browser.safari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;\n\t\t_browser.supported = (_browser.chrome || _browser.ff || _browser.opera);\n\n\t\tvar _queue = [];\n\t\t_readyCb = function() {};\n\t\t_ready = _stop = false;\n\t\t/**\n\t\t * Initialize favico\n\t\t */\n\t\tvar init = function() {\n\t\t\t//merge initial options\n\t\t\t_opt = merge(_def, opt);\n\t\t\t_opt.bgColor = hexToRgb(_opt.bgColor);\n\t\t\t_opt.textColor = hexToRgb(_opt.textColor);\n\t\t\t_opt.position = _opt.position.toLowerCase();\n\t\t\t_opt.animation = (animation.types['' + _opt.animation]) ? _opt.animation : _def.animation;\n\n\t\t\t_doc = _opt.win.document;\n\n\t\t\tvar isUp = _opt.position.indexOf('up') > -1;\n\t\t\tvar isLeft = _opt.position.indexOf('left') > -1;\n\n\t\t\t//transform the animations\n\t\t\tif (isUp || isLeft) {\n\t\t\t\tfor (var a in animation.types) {\n\t\t\t\t\tfor (var i = 0; i < animation.types[a].length; i++) {\n\t\t\t\t\t\tvar step = animation.types[a][i];\n\n\t\t\t\t\t\tif (isUp) {\n\t\t\t\t\t\t\tif (step.y < 0.6) {\n\t\t\t\t\t\t\t\tstep.y = step.y - 0.4;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstep.y = step.y - 2 * step.y + (1 - step.w);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isLeft) {\n\t\t\t\t\t\t\tif (step.x < 0.6) {\n\t\t\t\t\t\t\t\tstep.x = step.x - 0.4;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstep.x = step.x - 2 * step.x + (1 - step.h);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tanimation.types[a][i] = step;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t_opt.type = (type['' + _opt.type]) ? _opt.type : _def.type;\n\n\t\t\t_orig = link.getIcons();\n\t\t\t//create temp canvas\n\t\t\t_canvas = document.createElement('canvas');\n\t\t\t//create temp image\n\t\t\t_img = document.createElement('img');\n\t\t\tvar lastIcon = _orig[_orig.length - 1];\n\t\t\tif (lastIcon.hasAttribute('href')) {\n\t\t\t\t_img.setAttribute('crossOrigin', 'anonymous');\n\t\t\t\t//get width/height\n\t\t\t\t_img.onload = function() {\n\t\t\t\t\t_h = (_img.height > 0) ? _img.height : 32;\n\t\t\t\t\t_w = (_img.width > 0) ? _img.width : 32;\n\t\t\t\t\t_canvas.height = _h;\n\t\t\t\t\t_canvas.width = _w;\n\t\t\t\t\t_context = _canvas.getContext('2d');\n\t\t\t\t\ticon.ready();\n\t\t\t\t};\n\t\t\t\t_img.setAttribute('src', lastIcon.getAttribute('href'));\n\t\t\t} else {\n\t\t\t\t_img.onload = function() {\n\t\t\t\t\t_h = 32;\n\t\t\t\t\t_w = 32;\n\t\t\t\t\t_img.height = _h;\n\t\t\t\t\t_img.width = _w;\n\t\t\t\t\t_canvas.height = _h;\n\t\t\t\t\t_canvas.width = _w;\n\t\t\t\t\t_context = _canvas.getContext('2d');\n\t\t\t\t\ticon.ready();\n\t\t\t\t};\n\t\t\t\t_img.setAttribute('src', '');\n\t\t\t}\n\n\t\t};\n\t\t/**\n\t\t * Icon namespace\n\t\t */\n\t\tvar icon = {};\n\t\t/**\n\t\t * Icon is ready (reset icon) and start animation (if ther is any)\n\t\t */\n\t\ticon.ready = function() {\n\t\t\t_ready = true;\n\t\t\ticon.reset();\n\t\t\t_readyCb();\n\t\t};\n\t\t/**\n\t\t * Reset icon to default state\n\t\t */\n\t\ticon.reset = function() {\n\t\t\t//reset\n\t\t\tif (!_ready) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_queue = [];\n\t\t\t_lastBadge = false;\n\t\t\t_running = false;\n\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t_context.drawImage(_img, 0, 0, _w, _h);\n\t\t\t//_stop=true;\n\t\t\tlink.setIcon(_canvas);\n\t\t\t//webcam('stop');\n\t\t\t//video('stop');\n\t\t\twindow.clearTimeout(_animTimeout);\n\t\t\twindow.clearTimeout(_drawTimeout);\n\t\t};\n\t\t/**\n\t\t * Start animation\n\t\t */\n\t\ticon.start = function() {\n\t\t\tif (!_ready || _running) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar finished = function() {\n\t\t\t\t_lastBadge = _queue[0];\n\t\t\t\t_running = false;\n\t\t\t\tif (_queue.length > 0) {\n\t\t\t\t\t_queue.shift();\n\t\t\t\t\ticon.start();\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_queue.length > 0) {\n\t\t\t\t_running = true;\n\t\t\t\tvar run = function() {\n\t\t\t\t\t// apply options for this animation\n\t\t\t\t\t['type', 'animation', 'bgColor', 'textColor', 'fontFamily', 'fontStyle'].forEach(function(a) {\n\t\t\t\t\t\tif (a in _queue[0].options) {\n\t\t\t\t\t\t\t_opt[a] = _queue[0].options[a];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tanimation.run(_queue[0].options, function() {\n\t\t\t\t\t\tfinished();\n\t\t\t\t\t}, false);\n\t\t\t\t};\n\t\t\t\tif (_lastBadge) {\n\t\t\t\t\tanimation.run(_lastBadge.options, function() {\n\t\t\t\t\t\trun();\n\t\t\t\t\t}, true);\n\t\t\t\t} else {\n\t\t\t\t\trun();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Badge types\n\t\t */\n\t\tvar type = {};\n\t\tvar options = function(opt) {\n\t\t\topt.n = ((typeof opt.n) === 'number') ? Math.abs(opt.n | 0) : opt.n;\n\t\t\topt.x = _w * opt.x;\n\t\t\topt.y = _h * opt.y;\n\t\t\topt.w = _w * opt.w;\n\t\t\topt.h = _h * opt.h;\n\t\t\topt.len = ('' + opt.n).length;\n\t\t\treturn opt;\n\t\t};\n\t\t/**\n\t\t * Generate circle\n\t\t * @param {Object} opt Badge options\n\t\t */\n\t\ttype.circle = function(opt) {\n\t\t\topt = options(opt);\n\t\t\tvar more = false;\n\t\t\tif (opt.len === 2) {\n\t\t\t\topt.x = opt.x - opt.w * 0.4;\n\t\t\t\topt.w = opt.w * 1.4;\n\t\t\t\tmore = true;\n\t\t\t} else if (opt.len >= 3) {\n\t\t\t\topt.x = opt.x - opt.w * 0.65;\n\t\t\t\topt.w = opt.w * 1.65;\n\t\t\t\tmore = true;\n\t\t\t}\n\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t_context.drawImage(_img, 0, 0, _w, _h);\n\t\t\t_context.beginPath();\n\t\t\t_context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.85 : 1)) + 'px ' + _opt.fontFamily;\n\t\t\t_context.textAlign = 'center';\n\t\t\tif (more) {\n\t\t\t\t_context.moveTo(opt.x + opt.w / 2, opt.y);\n\t\t\t\t_context.lineTo(opt.x + opt.w - opt.h / 2, opt.y);\n\t\t\t\t_context.quadraticCurveTo(opt.x + opt.w, opt.y, opt.x + opt.w, opt.y + opt.h / 2);\n\t\t\t\t_context.lineTo(opt.x + opt.w, opt.y + opt.h - opt.h / 2);\n\t\t\t\t_context.quadraticCurveTo(opt.x + opt.w, opt.y + opt.h, opt.x + opt.w - opt.h / 2, opt.y + opt.h);\n\t\t\t\t_context.lineTo(opt.x + opt.h / 2, opt.y + opt.h);\n\t\t\t\t_context.quadraticCurveTo(opt.x, opt.y + opt.h, opt.x, opt.y + opt.h - opt.h / 2);\n\t\t\t\t_context.lineTo(opt.x, opt.y + opt.h / 2);\n\t\t\t\t_context.quadraticCurveTo(opt.x, opt.y, opt.x + opt.h / 2, opt.y);\n\t\t\t} else {\n\t\t\t\t_context.arc(opt.x + opt.w / 2, opt.y + opt.h / 2, opt.h / 2, 0, 2 * Math.PI);\n\t\t\t}\n\t\t\t_context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';\n\t\t\t_context.fill();\n\t\t\t_context.closePath();\n\t\t\t_context.beginPath();\n\t\t\t_context.stroke();\n\t\t\t_context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')';\n\t\t\t//_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\tif ((typeof opt.n) === 'number' && opt.n > 999) {\n\t\t\t\t_context.fillText(((opt.n > 9999) ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));\n\t\t\t} else {\n\t\t\t\t_context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\t}\n\t\t\t_context.closePath();\n\t\t};\n\t\t/**\n\t\t * Generate rectangle\n\t\t * @param {Object} opt Badge options\n\t\t */\n\t\ttype.rectangle = function(opt) {\n\t\t\topt = options(opt);\n\t\t\tvar more = false;\n\t\t\tif (opt.len === 2) {\n\t\t\t\topt.x = opt.x - opt.w * 0.4;\n\t\t\t\topt.w = opt.w * 1.4;\n\t\t\t\tmore = true;\n\t\t\t} else if (opt.len >= 3) {\n\t\t\t\topt.x = opt.x - opt.w * 0.65;\n\t\t\t\topt.w = opt.w * 1.65;\n\t\t\t\tmore = true;\n\t\t\t}\n\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t_context.drawImage(_img, 0, 0, _w, _h);\n\t\t\t_context.beginPath();\n\t\t\t_context.font = _opt.fontStyle + ' ' + Math.floor(opt.h * (opt.n > 99 ? 0.9 : 1)) + 'px ' + _opt.fontFamily;\n\t\t\t_context.textAlign = 'center';\n\t\t\t_context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';\n\t\t\t_context.fillRect(opt.x, opt.y, opt.w, opt.h);\n\t\t\t_context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')';\n\t\t\t//_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\tif ((typeof opt.n) === 'number' && opt.n > 999) {\n\t\t\t\t_context.fillText(((opt.n > 9999) ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));\n\t\t\t} else {\n\t\t\t\t_context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\t}\n\t\t\t_context.closePath();\n\t\t};\n\n\t\t/**\n\t\t * Set badge\n\t\t */\n\t\tvar badge = function(number, opts) {\n\t\t\topts = ((typeof opts) === 'string' ? {\n\t\t\t\tanimation: opts\n\t\t\t} : opts) || {};\n\t\t\t_readyCb = function() {\n\t\t\t\ttry {\n\t\t\t\t\tif (typeof(number) === 'number' ? (number > 0) : (number !== '')) {\n\t\t\t\t\t\tvar q = {\n\t\t\t\t\t\t\ttype: 'badge',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tn: number\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif ('animation' in opts && animation.types['' + opts.animation]) {\n\t\t\t\t\t\t\tq.options.animation = '' + opts.animation;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ('type' in opts && type['' + opts.type]) {\n\t\t\t\t\t\t\tq.options.type = '' + opts.type;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t['bgColor', 'textColor'].forEach(function(o) {\n\t\t\t\t\t\t\tif (o in opts) {\n\t\t\t\t\t\t\t\tq.options[o] = hexToRgb(opts[o]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t['fontStyle', 'fontFamily'].forEach(function(o) {\n\t\t\t\t\t\t\tif (o in opts) {\n\t\t\t\t\t\t\t\tq.options[o] = opts[o];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t_queue.push(q);\n\t\t\t\t\t\tif (_queue.length > 100) {\n\t\t\t\t\t\t\tthrow new Error('Too many badges requests in queue.');\n\t\t\t\t\t\t}\n\t\t\t\t\t\ticon.start();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ticon.reset();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow new Error('Error setting badge. Message: ' + e.message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_ready) {\n\t\t\t\t_readyCb();\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Set image as icon\n\t\t */\n\t\tvar image = function(imageElement) {\n\t\t\t_readyCb = function() {\n\t\t\t\ttry {\n\t\t\t\t\tvar w = imageElement.width;\n\t\t\t\t\tvar h = imageElement.height;\n\t\t\t\t\tvar newImg = document.createElement('img');\n\t\t\t\t\tvar ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);\n\t\t\t\t\tnewImg.setAttribute('crossOrigin', 'anonymous');\n\t\t\t\t\tnewImg.onload = function() {\n\t\t\t\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t\t\t\t_context.drawImage(newImg, 0, 0, _w, _h);\n\t\t\t\t\t\tlink.setIcon(_canvas);\n\t\t\t\t\t};\n\t\t\t\t\tnewImg.setAttribute('src', imageElement.getAttribute('src'));\n\t\t\t\t\tnewImg.height = (h / ratio);\n\t\t\t\t\tnewImg.width = (w / ratio);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow new Error('Error setting image. Message: ' + e.message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_ready) {\n\t\t\t\t_readyCb();\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * Set video as icon\n\t\t */\n\t\tvar video = function(videoElement) {\n\t\t\t_readyCb = function() {\n\t\t\t\ttry {\n\t\t\t\t\tif (videoElement === 'stop') {\n\t\t\t\t\t\t_stop = true;\n\t\t\t\t\t\ticon.reset();\n\t\t\t\t\t\t_stop = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//var w = videoElement.width;\n\t\t\t\t\t//var h = videoElement.height;\n\t\t\t\t\t//var ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);\n\t\t\t\t\tvideoElement.addEventListener('play', function() {\n\t\t\t\t\t\tdrawVideo(this);\n\t\t\t\t\t}, false);\n\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow new Error('Error setting video. Message: ' + e.message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_ready) {\n\t\t\t\t_readyCb();\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * Set video as icon\n\t\t */\n\t\tvar webcam = function(action) {\n\t\t\t//UR\n\t\t\tif (!window.URL || !window.URL.createObjectURL) {\n\t\t\t\twindow.URL = window.URL || {};\n\t\t\t\twindow.URL.createObjectURL = function(obj) {\n\t\t\t\t\treturn obj;\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (_browser.supported) {\n\t\t\t\tvar newVideo = false;\n\t\t\t\tnavigator.getUserMedia = navigator.getUserMedia || navigator.oGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;\n\t\t\t\t_readyCb = function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (action === 'stop') {\n\t\t\t\t\t\t\t_stop = true;\n\t\t\t\t\t\t\ticon.reset();\n\t\t\t\t\t\t\t_stop = false;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewVideo = document.createElement('video');\n\t\t\t\t\t\tnewVideo.width = _w;\n\t\t\t\t\t\tnewVideo.height = _h;\n\t\t\t\t\t\tnavigator.getUserMedia({\n\t\t\t\t\t\t\tvideo: true,\n\t\t\t\t\t\t\taudio: false\n\t\t\t\t\t\t}, function(stream) {\n\t\t\t\t\t\t\tnewVideo.src = URL.createObjectURL(stream);\n\t\t\t\t\t\t\tnewVideo.play();\n\t\t\t\t\t\t\tdrawVideo(newVideo);\n\t\t\t\t\t\t}, function() {});\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthrow new Error('Error setting webcam. Message: ' + e.message);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (_ready) {\n\t\t\t\t\t_readyCb();\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t\t * Draw video to context and repeat :)\n\t\t */\n\t\tfunction drawVideo(video) {\n\t\t\tif (video.paused || video.ended || _stop) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//nasty hack for FF webcam (Thanks to Julian Ćwirko, kontakt@redsunmedia.pl)\n\t\t\ttry {\n\t\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t\t_context.drawImage(video, 0, 0, _w, _h);\n\t\t\t} catch (e) {\n\n\t\t\t}\n\t\t\t_drawTimeout = setTimeout(function() {\n\t\t\t\tdrawVideo(video);\n\t\t\t}, animation.duration);\n\t\t\tlink.setIcon(_canvas);\n\t\t}\n\n\t\tvar link = {};\n\t\t/**\n\t\t * Get icons from HEAD tag or create a new <link> element\n\t\t */\n\t\tlink.getIcons = function() {\n\t\t\tvar elms = [];\n\t\t\t//get link element\n\t\t\tvar getLinks = function() {\n\t\t\t\tvar icons = [];\n\t\t\t\tvar links = _doc.getElementsByTagName('head')[0].getElementsByTagName('link');\n\t\t\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\t\t\tif ((/(^|\\s)icon(\\s|$)/i).test(links[i].getAttribute('rel'))) {\n\t\t\t\t\t\ticons.push(links[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn icons;\n\t\t\t};\n\t\t\tif (_opt.element) {\n\t\t\t\telms = [_opt.element];\n\t\t\t} else if (_opt.elementId) {\n\t\t\t\t//if img element identified by elementId\n\t\t\t\telms = [_doc.getElementById(_opt.elementId)];\n\t\t\t\telms[0].setAttribute('href', elms[0].getAttribute('src'));\n\t\t\t} else {\n\t\t\t\t//if link element\n\t\t\t\telms = getLinks();\n\t\t\t\tif (elms.length === 0) {\n\t\t\t\t\telms = [_doc.createElement('link')];\n\t\t\t\t\telms[0].setAttribute('rel', 'icon');\n\t\t\t\t\t_doc.getElementsByTagName('head')[0].appendChild(elms[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telms.forEach(function(item) {\n\t\t\t\titem.setAttribute('type', 'image/png');\n\t\t\t});\n\t\t\treturn elms;\n\t\t};\n\t\tlink.setIcon = function(canvas) {\n\t\t\tvar url = canvas.toDataURL('image/png');\n\t\t\tif (_opt.dataUrl) {\n\t\t\t\t//if using custom exporter\n\t\t\t\t_opt.dataUrl(url);\n\t\t\t}\n\t\t\tif (_opt.element) {\n\t\t\t\t_opt.element.setAttribute('href', url);\n\t\t\t\t_opt.element.setAttribute('src', url);\n\t\t\t} else if (_opt.elementId) {\n\t\t\t\t//if is attached to element (image)\n\t\t\t\tvar elm = _doc.getElementById(_opt.elementId);\n\t\t\t\telm.setAttribute('href', url);\n\t\t\t\telm.setAttribute('src', url);\n\t\t\t} else {\n\t\t\t\t//if is attached to fav icon\n\t\t\t\tif (_browser.ff || _browser.opera) {\n\t\t\t\t\t//for FF we need to \"recreate\" element, atach to dom and remove old <link>\n\t\t\t\t\t//var originalType = _orig.getAttribute('rel');\n\t\t\t\t\tvar old = _orig[_orig.length - 1];\n\t\t\t\t\tvar newIcon = _doc.createElement('link');\n\t\t\t\t\t_orig = [newIcon];\n\t\t\t\t\t//_orig.setAttribute('rel', originalType);\n\t\t\t\t\tif (_browser.opera) {\n\t\t\t\t\t\tnewIcon.setAttribute('rel', 'icon');\n\t\t\t\t\t}\n\t\t\t\t\tnewIcon.setAttribute('rel', 'icon');\n\t\t\t\t\tnewIcon.setAttribute('type', 'image/png');\n\t\t\t\t\t_doc.getElementsByTagName('head')[0].appendChild(newIcon);\n\t\t\t\t\tnewIcon.setAttribute('href', url);\n\t\t\t\t\tif (old.parentNode) {\n\t\t\t\t\t\told.parentNode.removeChild(old);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t_orig.forEach(function(icon) {\n\t\t\t\t\t\ticon.setAttribute('href', url);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb#answer-5624139\n\t\t//HEX to RGB convertor\n\t\tfunction hexToRgb(hex) {\n\t\t\tvar shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n\t\t\thex = hex.replace(shorthandRegex, function(m, r, g, b) {\n\t\t\t\treturn r + r + g + g + b + b;\n\t\t\t});\n\t\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\t\t\treturn result ? {\n\t\t\t\tr: parseInt(result[1], 16),\n\t\t\t\tg: parseInt(result[2], 16),\n\t\t\t\tb: parseInt(result[3], 16)\n\t\t\t} : false;\n\t\t}\n\n\t\t/**\n\t\t * Merge options\n\t\t */\n\t\tfunction merge(def, opt) {\n\t\t\tvar mergedOpt = {};\n\t\t\tvar attrname;\n\t\t\tfor (attrname in def) {\n\t\t\t\tmergedOpt[attrname] = def[attrname];\n\t\t\t}\n\t\t\tfor (attrname in opt) {\n\t\t\t\tmergedOpt[attrname] = opt[attrname];\n\t\t\t}\n\t\t\treturn mergedOpt;\n\t\t}\n\n\t\t/**\n\t\t * Cross-browser page visibility shim\n\t\t * http://stackoverflow.com/questions/12536562/detect-whether-a-window-is-visible\n\t\t */\n\t\tfunction isPageHidden() {\n\t\t\treturn _doc.hidden || _doc.msHidden || _doc.webkitHidden || _doc.mozHidden;\n\t\t}\n\n\t\t/**\n\t\t * @namespace animation\n\t\t */\n\t\tvar animation = {};\n\t\t/**\n\t\t * Animation \"frame\" duration\n\t\t */\n\t\tanimation.duration = 40;\n\t\t/**\n\t\t * Animation types (none,fade,pop,slide)\n\t\t */\n\t\tanimation.types = {};\n\t\tanimation.types.fade = [{\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.0\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.2\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.3\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.4\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.5\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.6\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.7\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.8\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.9\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1.0\n\t\t}];\n\t\tanimation.types.none = [{\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}];\n\t\tanimation.types.pop = [{\n\t\t\tx: 1,\n\t\t\ty: 1,\n\t\t\tw: 0,\n\t\t\th: 0,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.9,\n\t\t\ty: 0.9,\n\t\t\tw: 0.1,\n\t\t\th: 0.1,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.8,\n\t\t\ty: 0.8,\n\t\t\tw: 0.2,\n\t\t\th: 0.2,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.7,\n\t\t\ty: 0.7,\n\t\t\tw: 0.3,\n\t\t\th: 0.3,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.6,\n\t\t\ty: 0.6,\n\t\t\tw: 0.4,\n\t\t\th: 0.4,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.5,\n\t\t\ty: 0.5,\n\t\t\tw: 0.5,\n\t\t\th: 0.5,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}];\n\t\tanimation.types.popFade = [{\n\t\t\tx: 0.75,\n\t\t\ty: 0.75,\n\t\t\tw: 0,\n\t\t\th: 0,\n\t\t\to: 0\n\t\t}, {\n\t\t\tx: 0.65,\n\t\t\ty: 0.65,\n\t\t\tw: 0.1,\n\t\t\th: 0.1,\n\t\t\to: 0.2\n\t\t}, {\n\t\t\tx: 0.6,\n\t\t\ty: 0.6,\n\t\t\tw: 0.2,\n\t\t\th: 0.2,\n\t\t\to: 0.4\n\t\t}, {\n\t\t\tx: 0.55,\n\t\t\ty: 0.55,\n\t\t\tw: 0.3,\n\t\t\th: 0.3,\n\t\t\to: 0.6\n\t\t}, {\n\t\t\tx: 0.50,\n\t\t\ty: 0.50,\n\t\t\tw: 0.4,\n\t\t\th: 0.4,\n\t\t\to: 0.8\n\t\t}, {\n\t\t\tx: 0.45,\n\t\t\ty: 0.45,\n\t\t\tw: 0.5,\n\t\t\th: 0.5,\n\t\t\to: 0.9\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}];\n\t\tanimation.types.slide = [{\n\t\t\tx: 0.4,\n\t\t\ty: 1,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.9,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.9,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.8,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.7,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.6,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.5,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}];\n\t\t/**\n\t\t * Run animation\n\t\t * @param {Object} opt Animation options\n\t\t * @param {Object} cb Callabak after all steps are done\n\t\t * @param {Object} revert Reverse order? true|false\n\t\t * @param {Object} step Optional step number (frame bumber)\n\t\t */\n\t\tanimation.run = function(opt, cb, revert, step) {\n\t\t\tvar animationType = animation.types[isPageHidden() ? 'none' : _opt.animation];\n\t\t\tif (revert === true) {\n\t\t\t\tstep = (typeof step !== 'undefined') ? step : animationType.length - 1;\n\t\t\t} else {\n\t\t\t\tstep = (typeof step !== 'undefined') ? step : 0;\n\t\t\t}\n\t\t\tcb = (cb) ? cb : function() {};\n\t\t\tif ((step < animationType.length) && (step >= 0)) {\n\t\t\t\ttype[_opt.type](merge(opt, animationType[step]));\n\t\t\t\t_animTimeout = setTimeout(function() {\n\t\t\t\t\tif (revert) {\n\t\t\t\t\t\tstep = step - 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep = step + 1;\n\t\t\t\t\t}\n\t\t\t\t\tanimation.run(opt, cb, revert, step);\n\t\t\t\t}, animation.duration);\n\n\t\t\t\tlink.setIcon(_canvas);\n\t\t\t} else {\n\t\t\t\tcb();\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\t\t//auto init\n\t\tinit();\n\t\treturn {\n\t\t\tbadge: badge,\n\t\t\tvideo: video,\n\t\t\timage: image,\n\t\t\twebcam: webcam,\n\t\t\treset: icon.reset,\n\t\t\tbrowser: {\n\t\t\t\tsupported: _browser.supported\n\t\t\t}\n\t\t};\n\t});\n"]},"sourceType":"module","hash":"479a3fce7acacef95059847b64c6527124486c48"}
