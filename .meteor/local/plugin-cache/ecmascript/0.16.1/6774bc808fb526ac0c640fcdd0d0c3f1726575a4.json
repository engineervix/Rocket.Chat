{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui/client/lib/codeMirror/codeMirrorComponent.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/ui/client/lib/codeMirror/codeMirrorComponent.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui/client/lib/codeMirror/codeMirrorComponent.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/ui/client/lib/codeMirror/codeMirrorComponent.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui/client/lib/codeMirror/codeMirrorComponent.js"}},"code":"let Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Session;\nmodule.link(\"meteor/session\", {\n  Session(v) {\n    Session = v;\n  }\n\n}, 1);\nlet Template;\nmodule.link(\"meteor/templating\", {\n  Template(v) {\n    Template = v;\n  }\n\n}, 2);\nmodule.link(\"./codeMirrorComponent.html\");\nconst CodeMirrors = {};\nTemplate.CodeMirror.onRendered(async function () {\n  const CodeMirror = await module.dynamicImport('codemirror/lib/codemirror.js');\n  await module.dynamicImport('./codeMirror');\n  await module.dynamicImport('codemirror/lib/codemirror.css');\n  const options = this.data.options || {\n    lineNumbers: true\n  };\n  const textarea = this.find('textarea');\n  const editor = CodeMirror.fromTextArea(textarea, options);\n  this.autorun(c => {\n    const {\n      code\n    } = Template.currentData();\n\n    if (code === undefined) {\n      return;\n    }\n\n    c.stop();\n    editor.setValue(code);\n  });\n  CodeMirrors[this.data.id || 'code-mirror-textarea'] = editor;\n\n  if (this.data && this.data.editorOnBlur) {\n    this.data.editorOnBlur(this.data.name);\n  }\n\n  const self = this;\n  editor.on('change', function (doc) {\n    const val = doc.getValue();\n    textarea.value = val;\n\n    if (self.data.reactiveVar) {\n      Session.set(self.data.reactiveVar, val);\n    }\n  });\n\n  if (this.data.reactiveVar) {\n    this.autorun(function () {\n      const val = Session.get(self.data.reactiveVar) || '';\n\n      if (val !== editor.getValue()) {\n        editor.setValue(val);\n      }\n    });\n  }\n\n  Meteor.defer(function () {\n    editor.refresh();\n  });\n});\n\nTemplate.CodeMirror.destroyed = function () {\n  delete CodeMirrors[this.data.id || 'code-mirror-textarea'];\n  this.$(\"#\".concat(this.data.id || 'code-mirror-textarea')).next('.CodeMirror').remove();\n};\n\nTemplate.CodeMirror.helpers({\n  editorId() {\n    return this.id || 'code-mirror-textarea';\n  },\n\n  editorName() {\n    return this.name || 'code-mirror-textarea';\n  }\n\n});","map":{"version":3,"sources":["app/ui/client/lib/codeMirror/codeMirrorComponent.js"],"names":["Meteor","module","link","v","Session","Template","CodeMirrors","CodeMirror","onRendered","options","data","lineNumbers","textarea","find","editor","fromTextArea","autorun","c","code","currentData","undefined","stop","setValue","id","editorOnBlur","name","self","on","doc","val","getValue","value","reactiveVar","set","get","defer","refresh","destroyed","$","next","remove","helpers","editorId","editorName"],"mappings":"AAAA,IAAIA,MAAJ;AAAWC,MAAM,CAACC,IAAP,CAAY,eAAZ,EAA4B;AAACF,EAAAA,MAAM,CAACG,CAAD,EAAG;AAACH,IAAAA,MAAM,GAACG,CAAP;AAAS;;AAApB,CAA5B,EAAkD,CAAlD;AAAqD,IAAIC,OAAJ;AAAYH,MAAM,CAACC,IAAP,CAAY,gBAAZ,EAA6B;AAACE,EAAAA,OAAO,CAACD,CAAD,EAAG;AAACC,IAAAA,OAAO,GAACD,CAAR;AAAU;;AAAtB,CAA7B,EAAqD,CAArD;AAAwD,IAAIE,QAAJ;AAAaJ,MAAM,CAACC,IAAP,CAAY,mBAAZ,EAAgC;AAACG,EAAAA,QAAQ,CAACF,CAAD,EAAG;AAACE,IAAAA,QAAQ,GAACF,CAAT;AAAW;;AAAxB,CAAhC,EAA0D,CAA1D;AAA6DF,MAAM,CAACC,IAAP,CAAY,4BAAZ;AAK9M,MAAMI,WAAW,GAAG,EAApB;AAEAD,QAAQ,CAACE,UAAT,CAAoBC,UAApB,CAA+B,kBAAkB;AAChD,QAAMD,UAAU,GAAG,MAAM,qBAAO,8BAAP,CAAzB;AAEA,QAAM,qBAAO,cAAP,CAAN;AACA,QAAM,qBAAO,+BAAP,CAAN;AAEA,QAAME,OAAO,GAAG,KAAKC,IAAL,CAAUD,OAAV,IAAqB;AAAEE,IAAAA,WAAW,EAAE;AAAf,GAArC;AACA,QAAMC,QAAQ,GAAG,KAAKC,IAAL,CAAU,UAAV,CAAjB;AACA,QAAMC,MAAM,GAAGP,UAAU,CAACQ,YAAX,CAAwBH,QAAxB,EAAkCH,OAAlC,CAAf;AAEA,OAAKO,OAAL,CAAcC,CAAD,IAAO;AACnB,UAAM;AAAEC,MAAAA;AAAF,QAAWb,QAAQ,CAACc,WAAT,EAAjB;;AACA,QAAID,IAAI,KAAKE,SAAb,EAAwB;AACvB;AACA;;AACDH,IAAAA,CAAC,CAACI,IAAF;AACAP,IAAAA,MAAM,CAACQ,QAAP,CAAgBJ,IAAhB;AACA,GAPD;AASAZ,EAAAA,WAAW,CAAC,KAAKI,IAAL,CAAUa,EAAV,IAAgB,sBAAjB,CAAX,GAAsDT,MAAtD;;AACA,MAAI,KAAKJ,IAAL,IAAa,KAAKA,IAAL,CAAUc,YAA3B,EAAyC;AACxC,SAAKd,IAAL,CAAUc,YAAV,CAAuB,KAAKd,IAAL,CAAUe,IAAjC;AACA;;AAED,QAAMC,IAAI,GAAG,IAAb;AACAZ,EAAAA,MAAM,CAACa,EAAP,CAAU,QAAV,EAAoB,UAAUC,GAAV,EAAe;AAClC,UAAMC,GAAG,GAAGD,GAAG,CAACE,QAAJ,EAAZ;AACAlB,IAAAA,QAAQ,CAACmB,KAAT,GAAiBF,GAAjB;;AACA,QAAIH,IAAI,CAAChB,IAAL,CAAUsB,WAAd,EAA2B;AAC1B5B,MAAAA,OAAO,CAAC6B,GAAR,CAAYP,IAAI,CAAChB,IAAL,CAAUsB,WAAtB,EAAmCH,GAAnC;AACA;AACD,GAND;;AAQA,MAAI,KAAKnB,IAAL,CAAUsB,WAAd,EAA2B;AAC1B,SAAKhB,OAAL,CAAa,YAAY;AACxB,YAAMa,GAAG,GAAGzB,OAAO,CAAC8B,GAAR,CAAYR,IAAI,CAAChB,IAAL,CAAUsB,WAAtB,KAAsC,EAAlD;;AACA,UAAIH,GAAG,KAAKf,MAAM,CAACgB,QAAP,EAAZ,EAA+B;AAC9BhB,QAAAA,MAAM,CAACQ,QAAP,CAAgBO,GAAhB;AACA;AACD,KALD;AAMA;;AAED7B,EAAAA,MAAM,CAACmC,KAAP,CAAa,YAAY;AACxBrB,IAAAA,MAAM,CAACsB,OAAP;AACA,GAFD;AAGA,CA7CD;;AA+CA/B,QAAQ,CAACE,UAAT,CAAoB8B,SAApB,GAAgC,YAAY;AAC3C,SAAO/B,WAAW,CAAC,KAAKI,IAAL,CAAUa,EAAV,IAAgB,sBAAjB,CAAlB;AACA,OAAKe,CAAL,YAAW,KAAK5B,IAAL,CAAUa,EAAV,IAAgB,sBAA3B,GACEgB,IADF,CACO,aADP,EAEEC,MAFF;AAGA,CALD;;AAOAnC,QAAQ,CAACE,UAAT,CAAoBkC,OAApB,CAA4B;AAC3BC,EAAAA,QAAQ,GAAG;AACV,WAAO,KAAKnB,EAAL,IAAW,sBAAlB;AACA,GAH0B;;AAK3BoB,EAAAA,UAAU,GAAG;AACZ,WAAO,KAAKlB,IAAL,IAAa,sBAApB;AACA;;AAP0B,CAA5B","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { Template } from 'meteor/templating';\nimport './codeMirrorComponent.html';\n\nconst CodeMirrors = {};\n\nTemplate.CodeMirror.onRendered(async function () {\n\tconst CodeMirror = await import('codemirror/lib/codemirror.js');\n\n\tawait import('./codeMirror');\n\tawait import('codemirror/lib/codemirror.css');\n\n\tconst options = this.data.options || { lineNumbers: true };\n\tconst textarea = this.find('textarea');\n\tconst editor = CodeMirror.fromTextArea(textarea, options);\n\n\tthis.autorun((c) => {\n\t\tconst { code } = Template.currentData();\n\t\tif (code === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tc.stop();\n\t\teditor.setValue(code);\n\t});\n\n\tCodeMirrors[this.data.id || 'code-mirror-textarea'] = editor;\n\tif (this.data && this.data.editorOnBlur) {\n\t\tthis.data.editorOnBlur(this.data.name);\n\t}\n\n\tconst self = this;\n\teditor.on('change', function (doc) {\n\t\tconst val = doc.getValue();\n\t\ttextarea.value = val;\n\t\tif (self.data.reactiveVar) {\n\t\t\tSession.set(self.data.reactiveVar, val);\n\t\t}\n\t});\n\n\tif (this.data.reactiveVar) {\n\t\tthis.autorun(function () {\n\t\t\tconst val = Session.get(self.data.reactiveVar) || '';\n\t\t\tif (val !== editor.getValue()) {\n\t\t\t\teditor.setValue(val);\n\t\t\t}\n\t\t});\n\t}\n\n\tMeteor.defer(function () {\n\t\teditor.refresh();\n\t});\n});\n\nTemplate.CodeMirror.destroyed = function () {\n\tdelete CodeMirrors[this.data.id || 'code-mirror-textarea'];\n\tthis.$(`#${this.data.id || 'code-mirror-textarea'}`)\n\t\t.next('.CodeMirror')\n\t\t.remove();\n};\n\nTemplate.CodeMirror.helpers({\n\teditorId() {\n\t\treturn this.id || 'code-mirror-textarea';\n\t},\n\n\teditorName() {\n\t\treturn this.name || 'code-mirror-textarea';\n\t},\n});\n"]},"sourceType":"module","hash":"6774bc808fb526ac0c640fcdd0d0c3f1726575a4"}
