{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/departments/EditDepartment.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/omnichannel/departments/EditDepartment.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/departments/EditDepartment.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/omnichannel/departments/EditDepartment.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/departments/EditDepartment.js"}},"code":"var _regeneratorRuntime;\n\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\n\nvar _toConsumableArray;\n\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\n\nvar _slicedToArray;\n\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar FieldGroup, Field, TextInput, Chip, Box, Icon, Divider, ToggleSwitch, TextAreaInput, ButtonGroup, Button, PaginatedSelectFiltered;\nmodule.link(\"@rocket.chat/fuselage\", {\n  FieldGroup: function (v) {\n    FieldGroup = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  Chip: function (v) {\n    Chip = v;\n  },\n  Box: function (v) {\n    Box = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  },\n  Divider: function (v) {\n    Divider = v;\n  },\n  ToggleSwitch: function (v) {\n    ToggleSwitch = v;\n  },\n  TextAreaInput: function (v) {\n    TextAreaInput = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  PaginatedSelectFiltered: function (v) {\n    PaginatedSelectFiltered = v;\n  }\n}, 0);\nvar useMutableCallback, useUniqueId;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  },\n  useUniqueId: function (v) {\n    useUniqueId = v;\n  }\n}, 1);\nvar React, useMemo, useState, useRef;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useRef: function (v) {\n    useRef = v;\n  }\n}, 2);\nvar useSubscription;\nmodule.link(\"use-subscription\", {\n  useSubscription: function (v) {\n    useSubscription = v;\n  }\n}, 3);\nvar validateEmail;\nmodule.link(\"../../../../lib/emailValidator\", {\n  validateEmail: function (v) {\n    validateEmail = v;\n  }\n}, 4);\nvar Page;\nmodule.link(\"../../../components/Page\", {\n  \"default\": function (v) {\n    Page = v;\n  }\n}, 5);\nvar useRoomsList;\nmodule.link(\"../../../components/RoomAutoComplete/hooks/useRoomsList\", {\n  useRoomsList: function (v) {\n    useRoomsList = v;\n  }\n}, 6);\nvar useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useRoute: function (v) {\n    useRoute = v;\n  }\n}, 7);\nvar useMethod, useEndpoint;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useMethod: function (v) {\n    useMethod = v;\n  },\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  }\n}, 8);\nvar useToastMessageDispatch;\nmodule.link(\"../../../contexts/ToastMessagesContext\", {\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  }\n}, 9);\nvar useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 10);\nvar useRecordList;\nmodule.link(\"../../../hooks/lists/useRecordList\", {\n  useRecordList: function (v) {\n    useRecordList = v;\n  }\n}, 11);\nvar useComponentDidUpdate;\nmodule.link(\"../../../hooks/useComponentDidUpdate\", {\n  useComponentDidUpdate: function (v) {\n    useComponentDidUpdate = v;\n  }\n}, 12);\nvar useForm;\nmodule.link(\"../../../hooks/useForm\", {\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 13);\nvar AsyncStatePhase;\nmodule.link(\"../../../lib/asyncState\", {\n  AsyncStatePhase: function (v) {\n    AsyncStatePhase = v;\n  }\n}, 14);\nvar formsSubscription;\nmodule.link(\"../additionalForms\", {\n  formsSubscription: function (v) {\n    formsSubscription = v;\n  }\n}, 15);\nvar DepartmentsAgentsTable;\nmodule.link(\"./DepartmentsAgentsTable\", {\n  \"default\": function (v) {\n    DepartmentsAgentsTable = v;\n  }\n}, 16);\n\nfunction withDefault(key, defaultValue) {\n  return key || defaultValue;\n}\n\nfunction EditDepartment(_ref) {\n  var _allowedToForwardData;\n\n  var data = _ref.data,\n      id = _ref.id,\n      title = _ref.title,\n      reload = _ref.reload,\n      allowedToForwardData = _ref.allowedToForwardData;\n  var t = useTranslation();\n  var departmentsRoute = useRoute('omnichannel-departments');\n\n  var _useSubscription = useSubscription(formsSubscription),\n      _useSubscription$useE = _useSubscription.useEeNumberInput,\n      useEeNumberInput = _useSubscription$useE === void 0 ? function () {} : _useSubscription$useE,\n      _useSubscription$useE2 = _useSubscription.useEeTextInput,\n      useEeTextInput = _useSubscription$useE2 === void 0 ? function () {} : _useSubscription$useE2,\n      _useSubscription$useE3 = _useSubscription.useEeTextAreaInput,\n      useEeTextAreaInput = _useSubscription$useE3 === void 0 ? function () {} : _useSubscription$useE3,\n      _useSubscription$useD = _useSubscription.useDepartmentForwarding,\n      useDepartmentForwarding = _useSubscription$useD === void 0 ? function () {} : _useSubscription$useD,\n      _useSubscription$useD2 = _useSubscription.useDepartmentBusinessHours,\n      useDepartmentBusinessHours = _useSubscription$useD2 === void 0 ? function () {} : _useSubscription$useD2,\n      _useSubscription$useS = _useSubscription.useSelectForwardDepartment,\n      useSelectForwardDepartment = _useSubscription$useS === void 0 ? function () {} : _useSubscription$useS;\n\n  var initialAgents = useRef(data && data.agents || []);\n  var MaxChats = useEeNumberInput();\n  var VisitorInactivity = useEeNumberInput();\n  var WaitingQueueMessageInput = useEeTextAreaInput();\n  var AbandonedMessageInput = useEeTextInput();\n  var DepartmentForwarding = useDepartmentForwarding();\n  var DepartmentBusinessHours = useDepartmentBusinessHours();\n  var AutoCompleteDepartment = useSelectForwardDepartment();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      agentList = _useState2[0],\n      setAgentList = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      agentsRemoved = _useState4[0],\n      setAgentsRemoved = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      agentsAdded = _useState6[0],\n      setAgentsAdded = _useState6[1];\n\n  var _ref2 = data || {\n    department: {}\n  },\n      department = _ref2.department;\n\n  var _useState7 = useState(function () {\n    var _department$chatClosi;\n\n    return [(_department$chatClosi = department === null || department === void 0 ? void 0 : department.chatClosingTags) !== null && _department$chatClosi !== void 0 ? _department$chatClosi : [], ''];\n  }),\n      _useState8 = _slicedToArray(_useState7, 2),\n      _useState8$ = _slicedToArray(_useState8[0], 2),\n      tags = _useState8$[0],\n      tagsText = _useState8$[1],\n      setTagsState = _useState8[1];\n\n  var _useForm = useForm({\n    name: withDefault(department === null || department === void 0 ? void 0 : department.name, ''),\n    email: withDefault(department === null || department === void 0 ? void 0 : department.email, ''),\n    description: withDefault(department === null || department === void 0 ? void 0 : department.description, ''),\n    enabled: !!(department !== null && department !== void 0 && department.enabled),\n    maxNumberSimultaneousChat: department === null || department === void 0 ? void 0 : department.maxNumberSimultaneousChat,\n    showOnRegistration: !!(department !== null && department !== void 0 && department.showOnRegistration),\n    showOnOfflineForm: !!(department !== null && department !== void 0 && department.showOnOfflineForm),\n    abandonedRoomsCloseCustomMessage: withDefault(department === null || department === void 0 ? void 0 : department.abandonedRoomsCloseCustomMessage, ''),\n    requestTagBeforeClosingChat: !!(department !== null && department !== void 0 && department.requestTagBeforeClosingChat),\n    offlineMessageChannelName: withDefault(department === null || department === void 0 ? void 0 : department.offlineMessageChannelName, ''),\n    visitorInactivityTimeoutInSeconds: department === null || department === void 0 ? void 0 : department.visitorInactivityTimeoutInSeconds,\n    waitingQueueMessage: withDefault(department === null || department === void 0 ? void 0 : department.waitingQueueMessage, ''),\n    departmentsAllowedToForward: (allowedToForwardData === null || allowedToForwardData === void 0 ? void 0 : (_allowedToForwardData = allowedToForwardData.departments) === null || _allowedToForwardData === void 0 ? void 0 : _allowedToForwardData.map(function (dep) {\n      return {\n        label: dep.name,\n        value: dep._id\n      };\n    })) || [],\n    fallbackForwardDepartment: withDefault(department === null || department === void 0 ? void 0 : department.fallbackForwardDepartment, '')\n  }),\n      values = _useForm.values,\n      handlers = _useForm.handlers,\n      hasUnsavedChanges = _useForm.hasUnsavedChanges;\n\n  var handleName = handlers.handleName,\n      handleEmail = handlers.handleEmail,\n      handleDescription = handlers.handleDescription,\n      handleEnabled = handlers.handleEnabled,\n      handleMaxNumberSimultaneousChat = handlers.handleMaxNumberSimultaneousChat,\n      handleShowOnRegistration = handlers.handleShowOnRegistration,\n      handleShowOnOfflineForm = handlers.handleShowOnOfflineForm,\n      handleAbandonedRoomsCloseCustomMessage = handlers.handleAbandonedRoomsCloseCustomMessage,\n      handleRequestTagBeforeClosingChat = handlers.handleRequestTagBeforeClosingChat,\n      handleOfflineMessageChannelName = handlers.handleOfflineMessageChannelName,\n      handleVisitorInactivityTimeoutInSeconds = handlers.handleVisitorInactivityTimeoutInSeconds,\n      handleWaitingQueueMessage = handlers.handleWaitingQueueMessage,\n      handleDepartmentsAllowedToForward = handlers.handleDepartmentsAllowedToForward,\n      handleFallbackForwardDepartment = handlers.handleFallbackForwardDepartment;\n  var name = values.name,\n      email = values.email,\n      description = values.description,\n      enabled = values.enabled,\n      maxNumberSimultaneousChat = values.maxNumberSimultaneousChat,\n      showOnRegistration = values.showOnRegistration,\n      showOnOfflineForm = values.showOnOfflineForm,\n      abandonedRoomsCloseCustomMessage = values.abandonedRoomsCloseCustomMessage,\n      requestTagBeforeClosingChat = values.requestTagBeforeClosingChat,\n      offlineMessageChannelName = values.offlineMessageChannelName,\n      visitorInactivityTimeoutInSeconds = values.visitorInactivityTimeoutInSeconds,\n      waitingQueueMessage = values.waitingQueueMessage,\n      departmentsAllowedToForward = values.departmentsAllowedToForward,\n      fallbackForwardDepartment = values.fallbackForwardDepartment;\n\n  var _useRoomsList = useRoomsList(useMemo(function () {\n    return {\n      text: offlineMessageChannelName\n    };\n  }, [offlineMessageChannelName])),\n      RoomsList = _useRoomsList.itemsList,\n      loadMoreRooms = _useRoomsList.loadMoreItems;\n\n  var _useRecordList = useRecordList(RoomsList),\n      roomsPhase = _useRecordList.phase,\n      roomsItems = _useRecordList.items,\n      roomsTotal = _useRecordList.itemCount;\n\n  var handleTagChipClick = function (tag) {\n    return function () {\n      setTagsState(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            tags = _ref4[0],\n            tagsText = _ref4[1];\n\n        return [tags.filter(function (_tag) {\n          return _tag !== tag;\n        }), tagsText];\n      });\n    };\n  };\n\n  var handleTagTextSubmit = useMutableCallback(function () {\n    setTagsState(function (state) {\n      var _state = _slicedToArray(state, 2),\n          tags = _state[0],\n          tagsText = _state[1];\n\n      if (tags.includes(tagsText)) {\n        return state;\n      }\n\n      return [[].concat(_toConsumableArray(tags), [tagsText]), ''];\n    });\n  });\n\n  var handleTagTextChange = function (e) {\n    setTagsState(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 1),\n          tags = _ref6[0];\n\n      return [tags, e.target.value];\n    });\n  };\n\n  var saveDepartmentInfo = useMethod('livechat:saveDepartment');\n  var saveDepartmentAgentsInfoOnEdit = useEndpoint('POST', \"livechat/department/\" + id + \"/agents\");\n  var dispatchToastMessage = useToastMessageDispatch();\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      nameError = _useState10[0],\n      setNameError = _useState10[1];\n\n  var _useState11 = useState(),\n      _useState12 = _slicedToArray(_useState11, 2),\n      emailError = _useState12[0],\n      setEmailError = _useState12[1];\n\n  var _useState13 = useState(),\n      _useState14 = _slicedToArray(_useState13, 2),\n      tagError = _useState14[0],\n      setTagError = _useState14[1];\n\n  useComponentDidUpdate(function () {\n    setNameError(!name ? t('The_field_is_required', 'name') : '');\n  }, [t, name]);\n  useComponentDidUpdate(function () {\n    setEmailError(!email ? t('The_field_is_required', 'email') : '');\n  }, [t, email]);\n  useComponentDidUpdate(function () {\n    setEmailError(!validateEmail(email) ? t('Validate_email_address') : '');\n  }, [t, email]);\n  useComponentDidUpdate(function () {\n    setTagError(requestTagBeforeClosingChat && (!tags || tags.length === 0) ? t('The_field_is_required', 'name') : '');\n  }, [requestTagBeforeClosingChat, t, tags]);\n  var handleSubmit = useMutableCallback(function () {\n    function _callee(e) {\n      var error, payload, agentListPayload;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                error = false;\n\n                if (!name) {\n                  setNameError(t('The_field_is_required', 'name'));\n                  error = true;\n                }\n\n                if (!email) {\n                  setEmailError(t('The_field_is_required', 'email'));\n                  error = true;\n                }\n\n                if (!validateEmail(email)) {\n                  setEmailError(t('Validate_email_address'));\n                  error = true;\n                }\n\n                if (requestTagBeforeClosingChat && (!tags || tags.length === 0)) {\n                  setTagError(t('The_field_is_required', 'tags'));\n                  error = true;\n                }\n\n                if (!error) {\n                  _context.next = 8;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 8:\n                payload = {\n                  enabled: enabled,\n                  name: name,\n                  description: description,\n                  showOnRegistration: showOnRegistration,\n                  showOnOfflineForm: showOnOfflineForm,\n                  requestTagBeforeClosingChat: requestTagBeforeClosingChat,\n                  email: email,\n                  chatClosingTags: tags,\n                  offlineMessageChannelName: offlineMessageChannelName,\n                  maxNumberSimultaneousChat: maxNumberSimultaneousChat,\n                  visitorInactivityTimeoutInSeconds: visitorInactivityTimeoutInSeconds,\n                  abandonedRoomsCloseCustomMessage: abandonedRoomsCloseCustomMessage,\n                  waitingQueueMessage: waitingQueueMessage,\n                  departmentsAllowedToForward: departmentsAllowedToForward === null || departmentsAllowedToForward === void 0 ? void 0 : departmentsAllowedToForward.map(function (dep) {\n                    return dep.value;\n                  }).join(),\n                  fallbackForwardDepartment: fallbackForwardDepartment.value\n                };\n                agentListPayload = {\n                  upsert: agentList.filter(function (agent) {\n                    return !initialAgents.current.some(function (initialAgent) {\n                      return initialAgent._id === agent._id && agent.count === initialAgent.count && agent.order === initialAgent.order;\n                    });\n                  }),\n                  remove: initialAgents.current.filter(function (initialAgent) {\n                    return !agentList.some(function (agent) {\n                      return initialAgent._id === agent._id;\n                    });\n                  })\n                };\n                _context.prev = 10;\n\n                if (!id) {\n                  _context.next = 19;\n                  break;\n                }\n\n                _context.next = 14;\n                return _regeneratorRuntime.awrap(saveDepartmentInfo(id, payload, []));\n\n              case 14:\n                if (!(agentListPayload.upsert.length > 0 || agentListPayload.remove.length > 0)) {\n                  _context.next = 17;\n                  break;\n                }\n\n                _context.next = 17;\n                return _regeneratorRuntime.awrap(saveDepartmentAgentsInfoOnEdit(agentListPayload));\n\n              case 17:\n                _context.next = 21;\n                break;\n\n              case 19:\n                _context.next = 21;\n                return _regeneratorRuntime.awrap(saveDepartmentInfo(id, payload, agentList));\n\n              case 21:\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Saved')\n                });\n                reload();\n                departmentsRoute.push({});\n                _context.next = 29;\n                break;\n\n              case 26:\n                _context.prev = 26;\n                _context.t0 = _context[\"catch\"](10);\n                dispatchToastMessage({\n                  type: 'error',\n                  message: _context.t0\n                });\n\n              case 29:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), null, null, [[10, 26]], Promise);\n    }\n\n    return _callee;\n  }());\n  var handleReturn = useMutableCallback(function () {\n    departmentsRoute.push({});\n  });\n  var invalidForm = !name || !email || !validateEmail(email) || !hasUnsavedChanges || requestTagBeforeClosingChat && (!tags || tags.length === 0);\n  var formId = useUniqueId();\n  var hasNewAgent = useMemo(function () {\n    return data.agents.length === agentList.length;\n  }, [data.agents, agentList]);\n\n  var agentsHaveChanged = function () {\n    var hasChanges = false;\n\n    if (agentList.length !== initialAgents.current.length) {\n      hasChanges = true;\n    }\n\n    if (agentsAdded.length > 0 && agentsRemoved.length > 0) {\n      hasChanges = true;\n    }\n\n    agentList.forEach(function (agent) {\n      var existingAgent = initialAgents.current.find(function (initial) {\n        return initial.agentId === agent.agentId;\n      });\n\n      if (existingAgent) {\n        if (agent.count !== existingAgent.count) {\n          hasChanges = true;\n        }\n\n        if (agent.order !== existingAgent.order) {\n          hasChanges = true;\n        }\n      }\n    });\n    return hasChanges;\n  };\n\n  return /*#__PURE__*/React.createElement(Page, {\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: title\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, /*#__PURE__*/React.createElement(Button, {\n    onClick: handleReturn\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"back\"\n  }), \" \", t('Back')), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    form: formId,\n    primary: true,\n    disabled: invalidForm && hasNewAgent && !(id && agentsHaveChanged())\n  }, t('Save')))), /*#__PURE__*/React.createElement(Page.ScrollableContentWithShadow, null, /*#__PURE__*/React.createElement(FieldGroup, {\n    w: \"full\",\n    alignSelf: \"center\",\n    maxWidth: \"x600\",\n    id: formId,\n    is: \"form\",\n    autoComplete: \"off\",\n    onSubmit: handleSubmit\n  }, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Enabled')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: enabled,\n    onChange: handleEnabled\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Name'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    flexGrow: 1,\n    error: nameError,\n    value: name,\n    onChange: handleName,\n    placeholder: t('Name')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Description')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextAreaInput, {\n    flexGrow: 1,\n    value: description,\n    onChange: handleDescription,\n    placeholder: t('Description')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Show_on_registration_page')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: showOnRegistration,\n    onChange: handleShowOnRegistration\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Email'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    flexGrow: 1,\n    error: emailError,\n    value: email,\n    addon: /*#__PURE__*/React.createElement(Icon, {\n      name: \"mail\",\n      size: \"x20\"\n    }),\n    onChange: handleEmail,\n    placeholder: t('Email')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Show_on_offline_page')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: showOnOfflineForm,\n    onChange: handleShowOnOfflineForm\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Livechat_DepartmentOfflineMessageToChannel')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(PaginatedSelectFiltered, {\n    value: offlineMessageChannelName,\n    onChange: handleOfflineMessageChannelName,\n    flexShrink: 0,\n    filter: offlineMessageChannelName,\n    setFilter: handleOfflineMessageChannelName,\n    options: roomsItems,\n    placeholder: t('Channel_name'),\n    endReached: roomsPhase === AsyncStatePhase.LOADING ? function () {} : function (start) {\n      return loadMoreRooms(start, Math.min(50, roomsTotal));\n    }\n  }))), MaxChats && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(MaxChats, {\n    value: maxNumberSimultaneousChat,\n    handler: handleMaxNumberSimultaneousChat,\n    label: 'Max_number_of_chats_per_agent',\n    placeholder: \"Max_number_of_chats_per_agent_description\"\n  })), VisitorInactivity && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(VisitorInactivity, {\n    value: visitorInactivityTimeoutInSeconds,\n    handler: handleVisitorInactivityTimeoutInSeconds,\n    label: 'How_long_to_wait_to_consider_visitor_abandonment_in_seconds',\n    placeholder: \"Number_in_seconds\"\n  })), AbandonedMessageInput && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(AbandonedMessageInput, {\n    value: abandonedRoomsCloseCustomMessage,\n    handler: handleAbandonedRoomsCloseCustomMessage,\n    label: 'Livechat_abandoned_rooms_closed_custom_message',\n    placeholder: \"Enter_a_custom_message\"\n  })), WaitingQueueMessageInput && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(WaitingQueueMessageInput, {\n    value: waitingQueueMessage,\n    handler: handleWaitingQueueMessage,\n    label: 'Waiting_queue_message'\n  })), DepartmentForwarding && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(DepartmentForwarding, {\n    departmentId: id,\n    value: departmentsAllowedToForward,\n    handler: handleDepartmentsAllowedToForward,\n    label: 'List_of_departments_for_forward',\n    placeholder: \"Enter_a_department_name\"\n  })), AutoCompleteDepartment && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Fallback_forward_department')), /*#__PURE__*/React.createElement(AutoCompleteDepartment, {\n    haveNone: true,\n    excludeDepartmentId: department === null || department === void 0 ? void 0 : department._id,\n    value: fallbackForwardDepartment,\n    onChange: handleFallbackForwardDepartment,\n    placeholder: t('Fallback_forward_department'),\n    label: t('Fallback_forward_department'),\n    onlyMyDepartments: true\n  })), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Field.Label, null, t('Request_tag_before_closing_chat')), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(ToggleSwitch, {\n    flexGrow: 1,\n    checked: requestTagBeforeClosingChat,\n    onChange: handleRequestTagBeforeClosingChat\n  })))), requestTagBeforeClosingChat && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, {\n    alignSelf: \"stretch\"\n  }, t('Conversation_closing_tags'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    error: tagError,\n    value: tagsText,\n    onChange: handleTagTextChange,\n    placeholder: t('Enter_a_tag')\n  }), /*#__PURE__*/React.createElement(Button, {\n    mis: \"x8\",\n    title: t('add'),\n    onClick: handleTagTextSubmit\n  }, t('Add'))), /*#__PURE__*/React.createElement(Field.Hint, null, t('Conversation_closing_tags_description')), (tags === null || tags === void 0 ? void 0 : tags.length) > 0 && /*#__PURE__*/React.createElement(Field.Row, {\n    justifyContent: \"flex-start\"\n  }, tags.map(function (tag, i) {\n    return /*#__PURE__*/React.createElement(Chip, {\n      key: i,\n      onClick: handleTagChipClick(tag),\n      mie: \"x8\"\n    }, tag);\n  }))), DepartmentBusinessHours && /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(DepartmentBusinessHours, {\n    bhId: department === null || department === void 0 ? void 0 : department.businessHourId\n  })), /*#__PURE__*/React.createElement(Divider, {\n    mb: \"x16\"\n  }), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, {\n    mb: \"x4\"\n  }, t('Agents'), \":\"), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    height: \"50vh\"\n  }, /*#__PURE__*/React.createElement(DepartmentsAgentsTable, {\n    agents: data && data.agents,\n    setAgentListFinal: setAgentList,\n    setAgentsAdded: setAgentsAdded,\n    setAgentsRemoved: setAgentsRemoved\n  })))))));\n}\n\nmodule.exportDefault(EditDepartment);","map":{"version":3,"sources":["client/views/omnichannel/departments/EditDepartment.js"],"names":["_regeneratorRuntime","module","link","default","v","_toConsumableArray","_slicedToArray","FieldGroup","Field","TextInput","Chip","Box","Icon","Divider","ToggleSwitch","TextAreaInput","ButtonGroup","Button","PaginatedSelectFiltered","useMutableCallback","useUniqueId","React","useMemo","useState","useRef","useSubscription","validateEmail","Page","useRoomsList","useRoute","useMethod","useEndpoint","useToastMessageDispatch","useTranslation","useRecordList","useComponentDidUpdate","useForm","AsyncStatePhase","formsSubscription","DepartmentsAgentsTable","withDefault","key","defaultValue","EditDepartment","data","id","title","reload","allowedToForwardData","t","departmentsRoute","useEeNumberInput","useEeTextInput","useEeTextAreaInput","useDepartmentForwarding","useDepartmentBusinessHours","useSelectForwardDepartment","initialAgents","agents","MaxChats","VisitorInactivity","WaitingQueueMessageInput","AbandonedMessageInput","DepartmentForwarding","DepartmentBusinessHours","AutoCompleteDepartment","agentList","setAgentList","agentsRemoved","setAgentsRemoved","agentsAdded","setAgentsAdded","department","chatClosingTags","tags","tagsText","setTagsState","name","email","description","enabled","maxNumberSimultaneousChat","showOnRegistration","showOnOfflineForm","abandonedRoomsCloseCustomMessage","requestTagBeforeClosingChat","offlineMessageChannelName","visitorInactivityTimeoutInSeconds","waitingQueueMessage","departmentsAllowedToForward","departments","map","dep","label","value","_id","fallbackForwardDepartment","values","handlers","hasUnsavedChanges","handleName","handleEmail","handleDescription","handleEnabled","handleMaxNumberSimultaneousChat","handleShowOnRegistration","handleShowOnOfflineForm","handleAbandonedRoomsCloseCustomMessage","handleRequestTagBeforeClosingChat","handleOfflineMessageChannelName","handleVisitorInactivityTimeoutInSeconds","handleWaitingQueueMessage","handleDepartmentsAllowedToForward","handleFallbackForwardDepartment","text","RoomsList","itemsList","loadMoreRooms","loadMoreItems","roomsPhase","phase","roomsItems","items","roomsTotal","itemCount","handleTagChipClick","tag","filter","_tag","handleTagTextSubmit","state","includes","handleTagTextChange","e","target","saveDepartmentInfo","saveDepartmentAgentsInfoOnEdit","dispatchToastMessage","nameError","setNameError","emailError","setEmailError","tagError","setTagError","length","handleSubmit","preventDefault","error","payload","join","agentListPayload","upsert","agent","current","some","initialAgent","count","order","remove","type","message","push","handleReturn","invalidForm","formId","hasNewAgent","agentsHaveChanged","hasChanges","forEach","existingAgent","find","initial","agentId","LOADING","start","Math","min","i","businessHourId","exportDefault"],"mappings":"AAAA,IAAIA,mBAAJ;;AAAwBC,MAAM,CAACC,IAAP,CAAY,4BAAZ,EAAyC;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACJ,IAAAA,mBAAmB,GAACI,CAApB;AAAsB;AAA3C,CAAzC,EAAsF,CAAtF;;AAAyF,IAAIC,kBAAJ;;AAAuBJ,MAAM,CAACC,IAAP,CAAY,0CAAZ,EAAuD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACC,IAAAA,kBAAkB,GAACD,CAAnB;AAAqB;AAA1C,CAAvD,EAAmG,CAAnG;;AAAsG,IAAIE,cAAJ;;AAAmBL,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,EAAC,UAASC,CAAT,EAAW;AAACE,IAAAA,cAAc,GAACF,CAAf;AAAiB;AAAtC,CAAnD,EAA2F,CAA3F;AAAjQ,IAAIG,UAAJ,EAAeC,KAAf,EAAqBC,SAArB,EAA+BC,IAA/B,EAAoCC,GAApC,EAAwCC,IAAxC,EAA6CC,OAA7C,EAAqDC,YAArD,EAAkEC,aAAlE,EAAgFC,WAAhF,EAA4FC,MAA5F,EAAmGC,uBAAnG;AAA2HjB,MAAM,CAACC,IAAP,CAAY,uBAAZ,EAAoC;AAACK,EAAAA,UAAU,EAAC,UAASH,CAAT,EAAW;AAACG,IAAAA,UAAU,GAACH,CAAX;AAAa,GAArC;AAAsCI,EAAAA,KAAK,EAAC,UAASJ,CAAT,EAAW;AAACI,IAAAA,KAAK,GAACJ,CAAN;AAAQ,GAAhE;AAAiEK,EAAAA,SAAS,EAAC,UAASL,CAAT,EAAW;AAACK,IAAAA,SAAS,GAACL,CAAV;AAAY,GAAnG;AAAoGM,EAAAA,IAAI,EAAC,UAASN,CAAT,EAAW;AAACM,IAAAA,IAAI,GAACN,CAAL;AAAO,GAA5H;AAA6HO,EAAAA,GAAG,EAAC,UAASP,CAAT,EAAW;AAACO,IAAAA,GAAG,GAACP,CAAJ;AAAM,GAAnJ;AAAoJQ,EAAAA,IAAI,EAAC,UAASR,CAAT,EAAW;AAACQ,IAAAA,IAAI,GAACR,CAAL;AAAO,GAA5K;AAA6KS,EAAAA,OAAO,EAAC,UAAST,CAAT,EAAW;AAACS,IAAAA,OAAO,GAACT,CAAR;AAAU,GAA3M;AAA4MU,EAAAA,YAAY,EAAC,UAASV,CAAT,EAAW;AAACU,IAAAA,YAAY,GAACV,CAAb;AAAe,GAApP;AAAqPW,EAAAA,aAAa,EAAC,UAASX,CAAT,EAAW;AAACW,IAAAA,aAAa,GAACX,CAAd;AAAgB,GAA/R;AAAgSY,EAAAA,WAAW,EAAC,UAASZ,CAAT,EAAW;AAACY,IAAAA,WAAW,GAACZ,CAAZ;AAAc,GAAtU;AAAuUa,EAAAA,MAAM,EAAC,UAASb,CAAT,EAAW;AAACa,IAAAA,MAAM,GAACb,CAAP;AAAS,GAAnW;AAAoWc,EAAAA,uBAAuB,EAAC,UAASd,CAAT,EAAW;AAACc,IAAAA,uBAAuB,GAACd,CAAxB;AAA0B;AAAla,CAApC,EAAwc,CAAxc;AAA2c,IAAIe,kBAAJ,EAAuBC,WAAvB;AAAmCnB,MAAM,CAACC,IAAP,CAAY,6BAAZ,EAA0C;AAACiB,EAAAA,kBAAkB,EAAC,UAASf,CAAT,EAAW;AAACe,IAAAA,kBAAkB,GAACf,CAAnB;AAAqB,GAArD;AAAsDgB,EAAAA,WAAW,EAAC,UAAShB,CAAT,EAAW;AAACgB,IAAAA,WAAW,GAAChB,CAAZ;AAAc;AAA5F,CAA1C,EAAwI,CAAxI;AAA2I,IAAIiB,KAAJ,EAAUC,OAAV,EAAkBC,QAAlB,EAA2BC,MAA3B;AAAkCvB,MAAM,CAACC,IAAP,CAAY,OAAZ,EAAoB;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACiB,IAAAA,KAAK,GAACjB,CAAN;AAAQ,GAA7B;AAA8BkB,EAAAA,OAAO,EAAC,UAASlB,CAAT,EAAW;AAACkB,IAAAA,OAAO,GAAClB,CAAR;AAAU,GAA5D;AAA6DmB,EAAAA,QAAQ,EAAC,UAASnB,CAAT,EAAW;AAACmB,IAAAA,QAAQ,GAACnB,CAAT;AAAW,GAA7F;AAA8FoB,EAAAA,MAAM,EAAC,UAASpB,CAAT,EAAW;AAACoB,IAAAA,MAAM,GAACpB,CAAP;AAAS;AAA1H,CAApB,EAAgJ,CAAhJ;AAAmJ,IAAIqB,eAAJ;AAAoBxB,MAAM,CAACC,IAAP,CAAY,kBAAZ,EAA+B;AAACuB,EAAAA,eAAe,EAAC,UAASrB,CAAT,EAAW;AAACqB,IAAAA,eAAe,GAACrB,CAAhB;AAAkB;AAA/C,CAA/B,EAAgF,CAAhF;AAAmF,IAAIsB,aAAJ;AAAkBzB,MAAM,CAACC,IAAP,CAAY,gCAAZ,EAA6C;AAACwB,EAAAA,aAAa,EAAC,UAAStB,CAAT,EAAW;AAACsB,IAAAA,aAAa,GAACtB,CAAd;AAAgB;AAA3C,CAA7C,EAA0F,CAA1F;AAA6F,IAAIuB,IAAJ;AAAS1B,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACuB,IAAAA,IAAI,GAACvB,CAAL;AAAO;AAA5B,CAAvC,EAAqE,CAArE;AAAwE,IAAIwB,YAAJ;AAAiB3B,MAAM,CAACC,IAAP,CAAY,yDAAZ,EAAsE;AAAC0B,EAAAA,YAAY,EAAC,UAASxB,CAAT,EAAW;AAACwB,IAAAA,YAAY,GAACxB,CAAb;AAAe;AAAzC,CAAtE,EAAiH,CAAjH;AAAoH,IAAIyB,QAAJ;AAAa5B,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAAC2B,EAAAA,QAAQ,EAAC,UAASzB,CAAT,EAAW;AAACyB,IAAAA,QAAQ,GAACzB,CAAT;AAAW;AAAjC,CAA9C,EAAiF,CAAjF;AAAoF,IAAI0B,SAAJ,EAAcC,WAAd;AAA0B9B,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAAC4B,EAAAA,SAAS,EAAC,UAAS1B,CAAT,EAAW;AAAC0B,IAAAA,SAAS,GAAC1B,CAAV;AAAY,GAAnC;AAAoC2B,EAAAA,WAAW,EAAC,UAAS3B,CAAT,EAAW;AAAC2B,IAAAA,WAAW,GAAC3B,CAAZ;AAAc;AAA1E,CAA9C,EAA0H,CAA1H;AAA6H,IAAI4B,uBAAJ;AAA4B/B,MAAM,CAACC,IAAP,CAAY,wCAAZ,EAAqD;AAAC8B,EAAAA,uBAAuB,EAAC,UAAS5B,CAAT,EAAW;AAAC4B,IAAAA,uBAAuB,GAAC5B,CAAxB;AAA0B;AAA/D,CAArD,EAAsH,CAAtH;AAAyH,IAAI6B,cAAJ;AAAmBhC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAAC+B,EAAAA,cAAc,EAAC,UAAS7B,CAAT,EAAW;AAAC6B,IAAAA,cAAc,GAAC7B,CAAf;AAAiB;AAA7C,CAAnD,EAAkG,EAAlG;AAAsG,IAAI8B,aAAJ;AAAkBjC,MAAM,CAACC,IAAP,CAAY,oCAAZ,EAAiD;AAACgC,EAAAA,aAAa,EAAC,UAAS9B,CAAT,EAAW;AAAC8B,IAAAA,aAAa,GAAC9B,CAAd;AAAgB;AAA3C,CAAjD,EAA8F,EAA9F;AAAkG,IAAI+B,qBAAJ;AAA0BlC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACiC,EAAAA,qBAAqB,EAAC,UAAS/B,CAAT,EAAW;AAAC+B,IAAAA,qBAAqB,GAAC/B,CAAtB;AAAwB;AAA3D,CAAnD,EAAgH,EAAhH;AAAoH,IAAIgC,OAAJ;AAAYnC,MAAM,CAACC,IAAP,CAAY,wBAAZ,EAAqC;AAACkC,EAAAA,OAAO,EAAC,UAAShC,CAAT,EAAW;AAACgC,IAAAA,OAAO,GAAChC,CAAR;AAAU;AAA/B,CAArC,EAAsE,EAAtE;AAA0E,IAAIiC,eAAJ;AAAoBpC,MAAM,CAACC,IAAP,CAAY,yBAAZ,EAAsC;AAACmC,EAAAA,eAAe,EAAC,UAASjC,CAAT,EAAW;AAACiC,IAAAA,eAAe,GAACjC,CAAhB;AAAkB;AAA/C,CAAtC,EAAuF,EAAvF;AAA2F,IAAIkC,iBAAJ;AAAsBrC,MAAM,CAACC,IAAP,CAAY,oBAAZ,EAAiC;AAACoC,EAAAA,iBAAiB,EAAC,UAASlC,CAAT,EAAW;AAACkC,IAAAA,iBAAiB,GAAClC,CAAlB;AAAoB;AAAnD,CAAjC,EAAsF,EAAtF;AAA0F,IAAImC,sBAAJ;AAA2BtC,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAAC,aAAQ,UAASE,CAAT,EAAW;AAACmC,IAAAA,sBAAsB,GAACnC,CAAvB;AAAyB;AAA9C,CAAvC,EAAuF,EAAvF;;AAgC76E,SAASoC,WAAT,CAAqBC,GAArB,EAA0BC,YAA1B,EAAwC;AACvC,SAAOD,GAAG,IAAIC,YAAd;AACA;;AAED,SAASC,cAAT,OAA2E;AAAA;;AAAA,MAAjDC,IAAiD,QAAjDA,IAAiD;AAAA,MAA3CC,EAA2C,QAA3CA,EAA2C;AAAA,MAAvCC,KAAuC,QAAvCA,KAAuC;AAAA,MAAhCC,MAAgC,QAAhCA,MAAgC;AAAA,MAAxBC,oBAAwB,QAAxBA,oBAAwB;AAC1E,MAAMC,CAAC,GAAGhB,cAAc,EAAxB;AACA,MAAMiB,gBAAgB,GAAGrB,QAAQ,CAAC,yBAAD,CAAjC;;AAEA,yBAOIJ,eAAe,CAACa,iBAAD,CAPnB;AAAA,+CACCa,gBADD;AAAA,MACCA,gBADD,sCACoB,YAAM,CAAE,CAD5B;AAAA,gDAECC,cAFD;AAAA,MAECA,cAFD,uCAEkB,YAAM,CAAE,CAF1B;AAAA,gDAGCC,kBAHD;AAAA,MAGCA,kBAHD,uCAGsB,YAAM,CAAE,CAH9B;AAAA,+CAICC,uBAJD;AAAA,MAICA,uBAJD,sCAI2B,YAAM,CAAE,CAJnC;AAAA,gDAKCC,0BALD;AAAA,MAKCA,0BALD,uCAK8B,YAAM,CAAE,CALtC;AAAA,+CAMCC,0BAND;AAAA,MAMCA,0BAND,sCAM8B,YAAM,CAAE,CANtC;;AASA,MAAMC,aAAa,GAAGjC,MAAM,CAAEoB,IAAI,IAAIA,IAAI,CAACc,MAAd,IAAyB,EAA1B,CAA5B;AAEA,MAAMC,QAAQ,GAAGR,gBAAgB,EAAjC;AACA,MAAMS,iBAAiB,GAAGT,gBAAgB,EAA1C;AACA,MAAMU,wBAAwB,GAAGR,kBAAkB,EAAnD;AACA,MAAMS,qBAAqB,GAAGV,cAAc,EAA5C;AACA,MAAMW,oBAAoB,GAAGT,uBAAuB,EAApD;AACA,MAAMU,uBAAuB,GAAGT,0BAA0B,EAA1D;AACA,MAAMU,sBAAsB,GAAGT,0BAA0B,EAAzD;;AACA,kBAAkCjC,QAAQ,CAAC,EAAD,CAA1C;AAAA;AAAA,MAAO2C,SAAP;AAAA,MAAkBC,YAAlB;;AACA,mBAA0C5C,QAAQ,CAAC,EAAD,CAAlD;AAAA;AAAA,MAAO6C,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,mBAAsC9C,QAAQ,CAAC,EAAD,CAA9C;AAAA;AAAA,MAAO+C,WAAP;AAAA,MAAoBC,cAApB;;AAEA,cAAuB3B,IAAI,IAAI;AAAE4B,IAAAA,UAAU,EAAE;AAAd,GAA/B;AAAA,MAAQA,UAAR,SAAQA,UAAR;;AAEA,mBAAyCjD,QAAQ,CAAC;AAAA;;AAAA,WAAM,0BAACiD,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEC,eAAb,yEAAgC,EAAhC,EAAoC,EAApC,CAAN;AAAA,GAAD,CAAjD;AAAA;AAAA;AAAA,MAAQC,IAAR;AAAA,MAAcC,QAAd;AAAA,MAAyBC,YAAzB;;AAEA,iBAAgDxC,OAAO,CAAC;AACvDyC,IAAAA,IAAI,EAAErC,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEK,IAAb,EAAmB,EAAnB,CADsC;AAEvDC,IAAAA,KAAK,EAAEtC,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEM,KAAb,EAAoB,EAApB,CAFqC;AAGvDC,IAAAA,WAAW,EAAEvC,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEO,WAAb,EAA0B,EAA1B,CAH+B;AAIvDC,IAAAA,OAAO,EAAE,CAAC,EAACR,UAAD,aAACA,UAAD,eAACA,UAAU,CAAEQ,OAAb,CAJ6C;AAKvDC,IAAAA,yBAAyB,EAAET,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAES,yBALgB;AAMvDC,IAAAA,kBAAkB,EAAE,CAAC,EAACV,UAAD,aAACA,UAAD,eAACA,UAAU,CAAEU,kBAAb,CANkC;AAOvDC,IAAAA,iBAAiB,EAAE,CAAC,EAACX,UAAD,aAACA,UAAD,eAACA,UAAU,CAAEW,iBAAb,CAPmC;AAQvDC,IAAAA,gCAAgC,EAAE5C,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEY,gCAAb,EAA+C,EAA/C,CARU;AASvDC,IAAAA,2BAA2B,EAAE,CAAC,EAACb,UAAD,aAACA,UAAD,eAACA,UAAU,CAAEa,2BAAb,CATyB;AAUvDC,IAAAA,yBAAyB,EAAE9C,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEc,yBAAb,EAAwC,EAAxC,CAViB;AAWvDC,IAAAA,iCAAiC,EAAEf,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAEe,iCAXQ;AAYvDC,IAAAA,mBAAmB,EAAEhD,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEgB,mBAAb,EAAkC,EAAlC,CAZuB;AAavDC,IAAAA,2BAA2B,EAAE,CAAAzC,oBAAoB,SAApB,IAAAA,oBAAoB,WAApB,qCAAAA,oBAAoB,CAAE0C,WAAtB,gFAAmCC,GAAnC,CAAuC,UAACC,GAAD;AAAA,aAAU;AAAEC,QAAAA,KAAK,EAAED,GAAG,CAACf,IAAb;AAAmBiB,QAAAA,KAAK,EAAEF,GAAG,CAACG;AAA9B,OAAV;AAAA,KAAvC,MAA0F,EAbhE;AAcvDC,IAAAA,yBAAyB,EAAExD,WAAW,CAACgC,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEwB,yBAAb,EAAwC,EAAxC;AAdiB,GAAD,CAAvD;AAAA,MAAQC,MAAR,YAAQA,MAAR;AAAA,MAAgBC,QAAhB,YAAgBA,QAAhB;AAAA,MAA0BC,iBAA1B,YAA0BA,iBAA1B;;AAgBA,MACCC,UADD,GAeIF,QAfJ,CACCE,UADD;AAAA,MAECC,WAFD,GAeIH,QAfJ,CAECG,WAFD;AAAA,MAGCC,iBAHD,GAeIJ,QAfJ,CAGCI,iBAHD;AAAA,MAICC,aAJD,GAeIL,QAfJ,CAICK,aAJD;AAAA,MAKCC,+BALD,GAeIN,QAfJ,CAKCM,+BALD;AAAA,MAMCC,wBAND,GAeIP,QAfJ,CAMCO,wBAND;AAAA,MAOCC,uBAPD,GAeIR,QAfJ,CAOCQ,uBAPD;AAAA,MAQCC,sCARD,GAeIT,QAfJ,CAQCS,sCARD;AAAA,MASCC,iCATD,GAeIV,QAfJ,CASCU,iCATD;AAAA,MAUCC,+BAVD,GAeIX,QAfJ,CAUCW,+BAVD;AAAA,MAWCC,uCAXD,GAeIZ,QAfJ,CAWCY,uCAXD;AAAA,MAYCC,yBAZD,GAeIb,QAfJ,CAYCa,yBAZD;AAAA,MAaCC,iCAbD,GAeId,QAfJ,CAaCc,iCAbD;AAAA,MAcCC,+BAdD,GAeIf,QAfJ,CAcCe,+BAdD;AAiBA,MACCpC,IADD,GAeIoB,MAfJ,CACCpB,IADD;AAAA,MAECC,KAFD,GAeImB,MAfJ,CAECnB,KAFD;AAAA,MAGCC,WAHD,GAeIkB,MAfJ,CAGClB,WAHD;AAAA,MAICC,OAJD,GAeIiB,MAfJ,CAICjB,OAJD;AAAA,MAKCC,yBALD,GAeIgB,MAfJ,CAKChB,yBALD;AAAA,MAMCC,kBAND,GAeIe,MAfJ,CAMCf,kBAND;AAAA,MAOCC,iBAPD,GAeIc,MAfJ,CAOCd,iBAPD;AAAA,MAQCC,gCARD,GAeIa,MAfJ,CAQCb,gCARD;AAAA,MASCC,2BATD,GAeIY,MAfJ,CASCZ,2BATD;AAAA,MAUCC,yBAVD,GAeIW,MAfJ,CAUCX,yBAVD;AAAA,MAWCC,iCAXD,GAeIU,MAfJ,CAWCV,iCAXD;AAAA,MAYCC,mBAZD,GAeIS,MAfJ,CAYCT,mBAZD;AAAA,MAaCC,2BAbD,GAeIQ,MAfJ,CAaCR,2BAbD;AAAA,MAcCO,yBAdD,GAeIC,MAfJ,CAcCD,yBAdD;;AAiBA,sBAA+DpE,YAAY,CAC1EN,OAAO,CAAC;AAAA,WAAO;AAAE4F,MAAAA,IAAI,EAAE5B;AAAR,KAAP;AAAA,GAAD,EAA8C,CAACA,yBAAD,CAA9C,CADmE,CAA3E;AAAA,MAAmB6B,SAAnB,iBAAQC,SAAR;AAAA,MAA6CC,aAA7C,iBAA8BC,aAA9B;;AAIA,uBAAwEpF,aAAa,CAACiF,SAAD,CAArF;AAAA,MAAeI,UAAf,kBAAQC,KAAR;AAAA,MAAkCC,UAAlC,kBAA2BC,KAA3B;AAAA,MAAyDC,UAAzD,kBAA8CC,SAA9C;;AAEA,MAAMC,kBAAkB,GAAG,UAACC,GAAD;AAAA,WAAS,YAAM;AACzClD,MAAAA,YAAY,CAAC;AAAA;AAAA,YAAEF,IAAF;AAAA,YAAQC,QAAR;;AAAA,eAAsB,CAACD,IAAI,CAACqD,MAAL,CAAY,UAACC,IAAD;AAAA,iBAAUA,IAAI,KAAKF,GAAnB;AAAA,SAAZ,CAAD,EAAsCnD,QAAtC,CAAtB;AAAA,OAAD,CAAZ;AACA,KAF0B;AAAA,GAA3B;;AAIA,MAAMsD,mBAAmB,GAAG9G,kBAAkB,CAAC,YAAM;AACpDyD,IAAAA,YAAY,CAAC,UAACsD,KAAD,EAAW;AACvB,kCAAyBA,KAAzB;AAAA,UAAOxD,IAAP;AAAA,UAAaC,QAAb;;AAEA,UAAID,IAAI,CAACyD,QAAL,CAAcxD,QAAd,CAAJ,EAA6B;AAC5B,eAAOuD,KAAP;AACA;;AAED,aAAO,8BAAKxD,IAAL,IAAWC,QAAX,IAAsB,EAAtB,CAAP;AACA,KARW,CAAZ;AASA,GAV6C,CAA9C;;AAYA,MAAMyD,mBAAmB,GAAG,UAACC,CAAD,EAAO;AAClCzD,IAAAA,YAAY,CAAC;AAAA;AAAA,UAAEF,IAAF;;AAAA,aAAY,CAACA,IAAD,EAAO2D,CAAC,CAACC,MAAF,CAASxC,KAAhB,CAAZ;AAAA,KAAD,CAAZ;AACA,GAFD;;AAIA,MAAMyC,kBAAkB,GAAGzG,SAAS,CAAC,yBAAD,CAApC;AACA,MAAM0G,8BAA8B,GAAGzG,WAAW,CAAC,MAAD,2BAAgCc,EAAhC,aAAlD;AAEA,MAAM4F,oBAAoB,GAAGzG,uBAAuB,EAApD;;AAEA,mBAAkCT,QAAQ,EAA1C;AAAA;AAAA,MAAOmH,SAAP;AAAA,MAAkBC,YAAlB;;AACA,oBAAoCpH,QAAQ,EAA5C;AAAA;AAAA,MAAOqH,UAAP;AAAA,MAAmBC,aAAnB;;AACA,oBAAgCtH,QAAQ,EAAxC;AAAA;AAAA,MAAOuH,QAAP;AAAA,MAAiBC,WAAjB;;AAEA5G,EAAAA,qBAAqB,CAAC,YAAM;AAC3BwG,IAAAA,YAAY,CAAC,CAAC9D,IAAD,GAAQ5B,CAAC,CAAC,uBAAD,EAA0B,MAA1B,CAAT,GAA6C,EAA9C,CAAZ;AACA,GAFoB,EAElB,CAACA,CAAD,EAAI4B,IAAJ,CAFkB,CAArB;AAGA1C,EAAAA,qBAAqB,CAAC,YAAM;AAC3B0G,IAAAA,aAAa,CAAC,CAAC/D,KAAD,GAAS7B,CAAC,CAAC,uBAAD,EAA0B,OAA1B,CAAV,GAA+C,EAAhD,CAAb;AACA,GAFoB,EAElB,CAACA,CAAD,EAAI6B,KAAJ,CAFkB,CAArB;AAGA3C,EAAAA,qBAAqB,CAAC,YAAM;AAC3B0G,IAAAA,aAAa,CAAC,CAACnH,aAAa,CAACoD,KAAD,CAAd,GAAwB7B,CAAC,CAAC,wBAAD,CAAzB,GAAsD,EAAvD,CAAb;AACA,GAFoB,EAElB,CAACA,CAAD,EAAI6B,KAAJ,CAFkB,CAArB;AAGA3C,EAAAA,qBAAqB,CAAC,YAAM;AAC3B4G,IAAAA,WAAW,CAAC1D,2BAA2B,KAAK,CAACX,IAAD,IAASA,IAAI,CAACsE,MAAL,KAAgB,CAA9B,CAA3B,GAA8D/F,CAAC,CAAC,uBAAD,EAA0B,MAA1B,CAA/D,GAAmG,EAApG,CAAX;AACA,GAFoB,EAElB,CAACoC,2BAAD,EAA8BpC,CAA9B,EAAiCyB,IAAjC,CAFkB,CAArB;AAIA,MAAMuE,YAAY,GAAG9H,kBAAkB;AAAC,qBAAOkH,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACvCA,gBAAAA,CAAC,CAACa,cAAF;AACIC,gBAAAA,KAFmC,GAE3B,KAF2B;;AAGvC,oBAAI,CAACtE,IAAL,EAAW;AACV8D,kBAAAA,YAAY,CAAC1F,CAAC,CAAC,uBAAD,EAA0B,MAA1B,CAAF,CAAZ;AACAkG,kBAAAA,KAAK,GAAG,IAAR;AACA;;AACD,oBAAI,CAACrE,KAAL,EAAY;AACX+D,kBAAAA,aAAa,CAAC5F,CAAC,CAAC,uBAAD,EAA0B,OAA1B,CAAF,CAAb;AACAkG,kBAAAA,KAAK,GAAG,IAAR;AACA;;AACD,oBAAI,CAACzH,aAAa,CAACoD,KAAD,CAAlB,EAA2B;AAC1B+D,kBAAAA,aAAa,CAAC5F,CAAC,CAAC,wBAAD,CAAF,CAAb;AACAkG,kBAAAA,KAAK,GAAG,IAAR;AACA;;AACD,oBAAI9D,2BAA2B,KAAK,CAACX,IAAD,IAASA,IAAI,CAACsE,MAAL,KAAgB,CAA9B,CAA/B,EAAiE;AAChED,kBAAAA,WAAW,CAAC9F,CAAC,CAAC,uBAAD,EAA0B,MAA1B,CAAF,CAAX;AACAkG,kBAAAA,KAAK,GAAG,IAAR;AACA;;AAlBsC,qBAoBnCA,KApBmC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAwBjCC,gBAAAA,OAxBiC,GAwBvB;AACfpE,kBAAAA,OAAO,EAAPA,OADe;AAEfH,kBAAAA,IAAI,EAAJA,IAFe;AAGfE,kBAAAA,WAAW,EAAXA,WAHe;AAIfG,kBAAAA,kBAAkB,EAAlBA,kBAJe;AAKfC,kBAAAA,iBAAiB,EAAjBA,iBALe;AAMfE,kBAAAA,2BAA2B,EAA3BA,2BANe;AAOfP,kBAAAA,KAAK,EAALA,KAPe;AAQfL,kBAAAA,eAAe,EAAEC,IARF;AASfY,kBAAAA,yBAAyB,EAAzBA,yBATe;AAUfL,kBAAAA,yBAAyB,EAAzBA,yBAVe;AAWfM,kBAAAA,iCAAiC,EAAjCA,iCAXe;AAYfH,kBAAAA,gCAAgC,EAAhCA,gCAZe;AAafI,kBAAAA,mBAAmB,EAAnBA,mBAbe;AAcfC,kBAAAA,2BAA2B,EAAEA,2BAAF,aAAEA,2BAAF,uBAAEA,2BAA2B,CAAEE,GAA7B,CAAiC,UAACC,GAAD;AAAA,2BAASA,GAAG,CAACE,KAAb;AAAA,mBAAjC,EAAqDuD,IAArD,EAdd;AAefrD,kBAAAA,yBAAyB,EAAEA,yBAAyB,CAACF;AAftC,iBAxBuB;AA0CjCwD,gBAAAA,gBA1CiC,GA0Cd;AACxBC,kBAAAA,MAAM,EAAErF,SAAS,CAAC6D,MAAV,CACP,UAACyB,KAAD;AAAA,2BACC,CAAC/F,aAAa,CAACgG,OAAd,CAAsBC,IAAtB,CACA,UAACC,YAAD;AAAA,6BAAkBA,YAAY,CAAC5D,GAAb,KAAqByD,KAAK,CAACzD,GAA3B,IAAkCyD,KAAK,CAACI,KAAN,KAAgBD,YAAY,CAACC,KAA/D,IAAwEJ,KAAK,CAACK,KAAN,KAAgBF,YAAY,CAACE,KAAvH;AAAA,qBADA,CADF;AAAA,mBADO,CADgB;AAOxBC,kBAAAA,MAAM,EAAErG,aAAa,CAACgG,OAAd,CAAsB1B,MAAtB,CAA6B,UAAC4B,YAAD;AAAA,2BAAkB,CAACzF,SAAS,CAACwF,IAAV,CAAe,UAACF,KAAD;AAAA,6BAAWG,YAAY,CAAC5D,GAAb,KAAqByD,KAAK,CAACzD,GAAtC;AAAA,qBAAf,CAAnB;AAAA,mBAA7B;AAPgB,iBA1Cc;AAAA;;AAAA,qBAqDlClD,EArDkC;AAAA;AAAA;AAAA;;AAAA;AAAA,iDAsD/B0F,kBAAkB,CAAC1F,EAAD,EAAKuG,OAAL,EAAc,EAAd,CAtDa;;AAAA;AAAA,sBAuDjCE,gBAAgB,CAACC,MAAjB,CAAwBP,MAAxB,GAAiC,CAAjC,IAAsCM,gBAAgB,CAACQ,MAAjB,CAAwBd,MAAxB,GAAiC,CAvDtC;AAAA;AAAA;AAAA;;AAAA;AAAA,iDAwD9BR,8BAA8B,CAACc,gBAAD,CAxDA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,iDA2D/Bf,kBAAkB,CAAC1F,EAAD,EAAKuG,OAAL,EAAclF,SAAd,CA3Da;;AAAA;AA6DtCuE,gBAAAA,oBAAoB,CAAC;AAAEsB,kBAAAA,IAAI,EAAE,SAAR;AAAmBC,kBAAAA,OAAO,EAAE/G,CAAC,CAAC,OAAD;AAA7B,iBAAD,CAApB;AACAF,gBAAAA,MAAM;AACNG,gBAAAA,gBAAgB,CAAC+G,IAAjB,CAAsB,EAAtB;AA/DsC;AAAA;;AAAA;AAAA;AAAA;AAiEtCxB,gBAAAA,oBAAoB,CAAC;AAAEsB,kBAAAA,IAAI,EAAE,OAAR;AAAiBC,kBAAAA,OAAO;AAAxB,iBAAD,CAApB;;AAjEsC;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAD;AAAA,MAAvC;AAqEA,MAAME,YAAY,GAAG/I,kBAAkB,CAAC,YAAM;AAC7C+B,IAAAA,gBAAgB,CAAC+G,IAAjB,CAAsB,EAAtB;AACA,GAFsC,CAAvC;AAIA,MAAME,WAAW,GAChB,CAACtF,IAAD,IAAS,CAACC,KAAV,IAAmB,CAACpD,aAAa,CAACoD,KAAD,CAAjC,IAA4C,CAACqB,iBAA7C,IAAmEd,2BAA2B,KAAK,CAACX,IAAD,IAASA,IAAI,CAACsE,MAAL,KAAgB,CAA9B,CAD/F;AAGA,MAAMoB,MAAM,GAAGhJ,WAAW,EAA1B;AAEA,MAAMiJ,WAAW,GAAG/I,OAAO,CAAC;AAAA,WAAMsB,IAAI,CAACc,MAAL,CAAYsF,MAAZ,KAAuB9E,SAAS,CAAC8E,MAAvC;AAAA,GAAD,EAAgD,CAACpG,IAAI,CAACc,MAAN,EAAcQ,SAAd,CAAhD,CAA3B;;AAEA,MAAMoG,iBAAiB,GAAG,YAAM;AAC/B,QAAIC,UAAU,GAAG,KAAjB;;AACA,QAAIrG,SAAS,CAAC8E,MAAV,KAAqBvF,aAAa,CAACgG,OAAd,CAAsBT,MAA/C,EAAuD;AACtDuB,MAAAA,UAAU,GAAG,IAAb;AACA;;AAED,QAAIjG,WAAW,CAAC0E,MAAZ,GAAqB,CAArB,IAA0B5E,aAAa,CAAC4E,MAAd,GAAuB,CAArD,EAAwD;AACvDuB,MAAAA,UAAU,GAAG,IAAb;AACA;;AAEDrG,IAAAA,SAAS,CAACsG,OAAV,CAAkB,UAAChB,KAAD,EAAW;AAC5B,UAAMiB,aAAa,GAAGhH,aAAa,CAACgG,OAAd,CAAsBiB,IAAtB,CAA2B,UAACC,OAAD;AAAA,eAAaA,OAAO,CAACC,OAAR,KAAoBpB,KAAK,CAACoB,OAAvC;AAAA,OAA3B,CAAtB;;AACA,UAAIH,aAAJ,EAAmB;AAClB,YAAIjB,KAAK,CAACI,KAAN,KAAgBa,aAAa,CAACb,KAAlC,EAAyC;AACxCW,UAAAA,UAAU,GAAG,IAAb;AACA;;AACD,YAAIf,KAAK,CAACK,KAAN,KAAgBY,aAAa,CAACZ,KAAlC,EAAyC;AACxCU,UAAAA,UAAU,GAAG,IAAb;AACA;AACD;AACD,KAVD;AAYA,WAAOA,UAAP;AACA,GAvBD;;AAyBA,sBACC,oBAAC,IAAD;AAAM,IAAA,aAAa,EAAC;AAApB,kBACC,oBAAC,IAAD,qBACC,oBAAC,IAAD,CAAM,MAAN;AAAa,IAAA,KAAK,EAAEzH;AAApB,kBACC,oBAAC,WAAD,qBACC,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAEoH;AAAjB,kBACC,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAC;AAAX,IADD,OACuBjH,CAAC,CAAC,MAAD,CADxB,CADD,eAIC,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAsB,IAAA,IAAI,EAAEmH,MAA5B;AAAoC,IAAA,OAAO,MAA3C;AAA4C,IAAA,QAAQ,EAAED,WAAW,IAAIE,WAAf,IAA8B,EAAExH,EAAE,IAAIyH,iBAAiB,EAAzB;AAApF,KACErH,CAAC,CAAC,MAAD,CADH,CAJD,CADD,CADD,eAWC,oBAAC,IAAD,CAAM,2BAAN,qBACC,oBAAC,UAAD;AAAY,IAAA,CAAC,EAAC,MAAd;AAAqB,IAAA,SAAS,EAAC,QAA/B;AAAwC,IAAA,QAAQ,EAAC,MAAjD;AAAwD,IAAA,EAAE,EAAEmH,MAA5D;AAAoE,IAAA,EAAE,EAAC,MAAvE;AAA8E,IAAA,YAAY,EAAC,KAA3F;AAAiG,IAAA,QAAQ,EAAEnB;AAA3G,kBACC,oBAAC,KAAD,qBACC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC;AAAlC,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAchG,CAAC,CAAC,SAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,YAAD;AAAc,IAAA,QAAQ,EAAE,CAAxB;AAA2B,IAAA,OAAO,EAAE+B,OAApC;AAA6C,IAAA,QAAQ,EAAEuB;AAAvD,IADD,CAFD,CADD,CADD,eASC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAActD,CAAC,CAAC,MAAD,CAAf,MADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,QAAQ,EAAE,CAArB;AAAwB,IAAA,KAAK,EAAEyF,SAA/B;AAA0C,IAAA,KAAK,EAAE7D,IAAjD;AAAuD,IAAA,QAAQ,EAAEuB,UAAjE;AAA6E,IAAA,WAAW,EAAEnD,CAAC,CAAC,MAAD;AAA3F,IADD,CAFD,CATD,eAeC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAAcA,CAAC,CAAC,aAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,aAAD;AAAe,IAAA,QAAQ,EAAE,CAAzB;AAA4B,IAAA,KAAK,EAAE8B,WAAnC;AAAgD,IAAA,QAAQ,EAAEuB,iBAA1D;AAA6E,IAAA,WAAW,EAAErD,CAAC,CAAC,aAAD;AAA3F,IADD,CAFD,CAfD,eAqBC,oBAAC,KAAD,qBACC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC;AAAlC,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAcA,CAAC,CAAC,2BAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,YAAD;AAAc,IAAA,QAAQ,EAAE,CAAxB;AAA2B,IAAA,OAAO,EAAEiC,kBAApC;AAAwD,IAAA,QAAQ,EAAEuB;AAAlE,IADD,CAFD,CADD,CArBD,eA6BC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAAcxD,CAAC,CAAC,OAAD,CAAf,MADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AACC,IAAA,QAAQ,EAAE,CADX;AAEC,IAAA,KAAK,EAAE2F,UAFR;AAGC,IAAA,KAAK,EAAE9D,KAHR;AAIC,IAAA,KAAK,eAAE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAkB,MAAA,IAAI,EAAC;AAAvB,MAJR;AAKC,IAAA,QAAQ,EAAEuB,WALX;AAMC,IAAA,WAAW,EAAEpD,CAAC,CAAC,OAAD;AANf,IADD,CAFD,CA7BD,eA0CC,oBAAC,KAAD,qBACC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC;AAAlC,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAcA,CAAC,CAAC,sBAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,YAAD;AAAc,IAAA,QAAQ,EAAE,CAAxB;AAA2B,IAAA,OAAO,EAAEkC,iBAApC;AAAuD,IAAA,QAAQ,EAAEuB;AAAjE,IADD,CAFD,CADD,CA1CD,eAkDC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAAczD,CAAC,CAAC,4CAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,uBAAD;AACC,IAAA,KAAK,EAAEqC,yBADR;AAEC,IAAA,QAAQ,EAAEuB,+BAFX;AAGC,IAAA,UAAU,EAAE,CAHb;AAIC,IAAA,MAAM,EAAEvB,yBAJT;AAKC,IAAA,SAAS,EAAEuB,+BALZ;AAMC,IAAA,OAAO,EAAEY,UANV;AAOC,IAAA,WAAW,EAAExE,CAAC,CAAC,cAAD,CAPf;AAQC,IAAA,UAAU,EAAEsE,UAAU,KAAKlF,eAAe,CAACwI,OAA/B,GAAyC,YAAM,CAAE,CAAjD,GAAoD,UAACC,KAAD;AAAA,aAAWzD,aAAa,CAACyD,KAAD,EAAQC,IAAI,CAACC,GAAL,CAAS,EAAT,EAAarD,UAAb,CAAR,CAAxB;AAAA;AARjE,IADD,CAFD,CAlDD,EAiEEhE,QAAQ,iBACR,oBAAC,KAAD,qBACC,oBAAC,QAAD;AACC,IAAA,KAAK,EAAEsB,yBADR;AAEC,IAAA,OAAO,EAAEuB,+BAFV;AAGC,IAAA,KAAK,EAAE,+BAHR;AAIC,IAAA,WAAW,EAAC;AAJb,IADD,CAlEF,EA2EE5C,iBAAiB,iBACjB,oBAAC,KAAD,qBACC,oBAAC,iBAAD;AACC,IAAA,KAAK,EAAE2B,iCADR;AAEC,IAAA,OAAO,EAAEuB,uCAFV;AAGC,IAAA,KAAK,EAAE,6DAHR;AAIC,IAAA,WAAW,EAAC;AAJb,IADD,CA5EF,EAqFEhD,qBAAqB,iBACrB,oBAAC,KAAD,qBACC,oBAAC,qBAAD;AACC,IAAA,KAAK,EAAEsB,gCADR;AAEC,IAAA,OAAO,EAAEuB,sCAFV;AAGC,IAAA,KAAK,EAAE,gDAHR;AAIC,IAAA,WAAW,EAAC;AAJb,IADD,CAtFF,EA+FE9C,wBAAwB,iBACxB,oBAAC,KAAD,qBACC,oBAAC,wBAAD;AAA0B,IAAA,KAAK,EAAE2B,mBAAjC;AAAsD,IAAA,OAAO,EAAEuB,yBAA/D;AAA0F,IAAA,KAAK,EAAE;AAAjG,IADD,CAhGF,EAoGEhD,oBAAoB,iBACpB,oBAAC,KAAD,qBACC,oBAAC,oBAAD;AACC,IAAA,YAAY,EAAElB,EADf;AAEC,IAAA,KAAK,EAAE4C,2BAFR;AAGC,IAAA,OAAO,EAAEuB,iCAHV;AAIC,IAAA,KAAK,EAAE,iCAJR;AAKC,IAAA,WAAW,EAAC;AALb,IADD,CArGF,EA+GE/C,sBAAsB,iBACtB,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP,QAAchB,CAAC,CAAC,6BAAD,CAAf,CADD,eAEC,oBAAC,sBAAD;AACC,IAAA,QAAQ,MADT;AAEC,IAAA,mBAAmB,EAAEuB,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAEuB,GAFlC;AAGC,IAAA,KAAK,EAAEC,yBAHR;AAIC,IAAA,QAAQ,EAAEiB,+BAJX;AAKC,IAAA,WAAW,EAAEhE,CAAC,CAAC,6BAAD,CALf;AAMC,IAAA,KAAK,EAAEA,CAAC,CAAC,6BAAD,CANT;AAOC,IAAA,iBAAiB;AAPlB,IAFD,CAhHF,eA6HC,oBAAC,KAAD,qBACC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC;AAAlC,kBACC,oBAAC,KAAD,CAAO,KAAP,QAAcA,CAAC,CAAC,iCAAD,CAAf,CADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,YAAD;AAAc,IAAA,QAAQ,EAAE,CAAxB;AAA2B,IAAA,OAAO,EAAEoC,2BAApC;AAAiE,IAAA,QAAQ,EAAEuB;AAA3E,IADD,CAFD,CADD,CA7HD,EAqIEvB,2BAA2B,iBAC3B,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP;AAAa,IAAA,SAAS,EAAC;AAAvB,KAAkCpC,CAAC,CAAC,2BAAD,CAAnC,MADD,eAEC,oBAAC,KAAD,CAAO,GAAP,qBACC,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE6F,QAAlB;AAA4B,IAAA,KAAK,EAAEnE,QAAnC;AAA6C,IAAA,QAAQ,EAAEyD,mBAAvD;AAA4E,IAAA,WAAW,EAAEnF,CAAC,CAAC,aAAD;AAA1F,IADD,eAEC,oBAAC,MAAD;AAAQ,IAAA,GAAG,EAAC,IAAZ;AAAiB,IAAA,KAAK,EAAEA,CAAC,CAAC,KAAD,CAAzB;AAAkC,IAAA,OAAO,EAAEgF;AAA3C,KACEhF,CAAC,CAAC,KAAD,CADH,CAFD,CAFD,eAQC,oBAAC,KAAD,CAAO,IAAP,QAAaA,CAAC,CAAC,uCAAD,CAAd,CARD,EASE,CAAAyB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEsE,MAAN,IAAe,CAAf,iBACA,oBAAC,KAAD,CAAO,GAAP;AAAW,IAAA,cAAc,EAAC;AAA1B,KACEtE,IAAI,CAACiB,GAAL,CAAS,UAACmC,GAAD,EAAMmD,CAAN;AAAA,wBACT,oBAAC,IAAD;AAAM,MAAA,GAAG,EAAEA,CAAX;AAAc,MAAA,OAAO,EAAEpD,kBAAkB,CAACC,GAAD,CAAzC;AAAgD,MAAA,GAAG,EAAC;AAApD,OACEA,GADF,CADS;AAAA,GAAT,CADF,CAVF,CAtIF,EA0JE9D,uBAAuB,iBACvB,oBAAC,KAAD,qBACC,oBAAC,uBAAD;AAAyB,IAAA,IAAI,EAAEQ,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAE0G;AAA3C,IADD,CA3JF,eA+JC,oBAAC,OAAD;AAAS,IAAA,EAAE,EAAC;AAAZ,IA/JD,eAgKC,oBAAC,KAAD,qBACC,oBAAC,KAAD,CAAO,KAAP;AAAa,IAAA,EAAE,EAAC;AAAhB,KAAsBjI,CAAC,CAAC,QAAD,CAAvB,MADD,eAEC,oBAAC,GAAD;AAAK,IAAA,OAAO,EAAC,MAAb;AAAoB,IAAA,aAAa,EAAC,QAAlC;AAA2C,IAAA,MAAM,EAAC;AAAlD,kBACC,oBAAC,sBAAD;AACC,IAAA,MAAM,EAAEL,IAAI,IAAIA,IAAI,CAACc,MADtB;AAEC,IAAA,iBAAiB,EAAES,YAFpB;AAGC,IAAA,cAAc,EAAEI,cAHjB;AAIC,IAAA,gBAAgB,EAAEF;AAJnB,IADD,CAFD,CAhKD,CADD,CAXD,CADD,CADD;AA8LA;;AA3cDpE,MAAM,CAACkL,aAAP,CA6cexI,cA7cf","sourcesContent":["import {\n\tFieldGroup,\n\tField,\n\tTextInput,\n\tChip,\n\tBox,\n\tIcon,\n\tDivider,\n\tToggleSwitch,\n\tTextAreaInput,\n\tButtonGroup,\n\tButton,\n\tPaginatedSelectFiltered,\n} from '@rocket.chat/fuselage';\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useState, useRef } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { validateEmail } from '../../../../lib/emailValidator';\nimport Page from '../../../components/Page';\nimport { useRoomsList } from '../../../components/RoomAutoComplete/hooks/useRoomsList';\nimport { useRoute } from '../../../contexts/RouterContext';\nimport { useMethod, useEndpoint } from '../../../contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useRecordList } from '../../../hooks/lists/useRecordList';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { useForm } from '../../../hooks/useForm';\nimport { AsyncStatePhase } from '../../../lib/asyncState';\nimport { formsSubscription } from '../additionalForms';\nimport DepartmentsAgentsTable from './DepartmentsAgentsTable';\n\nfunction withDefault(key, defaultValue) {\n\treturn key || defaultValue;\n}\n\nfunction EditDepartment({ data, id, title, reload, allowedToForwardData }) {\n\tconst t = useTranslation();\n\tconst departmentsRoute = useRoute('omnichannel-departments');\n\n\tconst {\n\t\tuseEeNumberInput = () => {},\n\t\tuseEeTextInput = () => {},\n\t\tuseEeTextAreaInput = () => {},\n\t\tuseDepartmentForwarding = () => {},\n\t\tuseDepartmentBusinessHours = () => {},\n\t\tuseSelectForwardDepartment = () => {},\n\t} = useSubscription(formsSubscription);\n\n\tconst initialAgents = useRef((data && data.agents) || []);\n\n\tconst MaxChats = useEeNumberInput();\n\tconst VisitorInactivity = useEeNumberInput();\n\tconst WaitingQueueMessageInput = useEeTextAreaInput();\n\tconst AbandonedMessageInput = useEeTextInput();\n\tconst DepartmentForwarding = useDepartmentForwarding();\n\tconst DepartmentBusinessHours = useDepartmentBusinessHours();\n\tconst AutoCompleteDepartment = useSelectForwardDepartment();\n\tconst [agentList, setAgentList] = useState([]);\n\tconst [agentsRemoved, setAgentsRemoved] = useState([]);\n\tconst [agentsAdded, setAgentsAdded] = useState([]);\n\n\tconst { department } = data || { department: {} };\n\n\tconst [[tags, tagsText], setTagsState] = useState(() => [department?.chatClosingTags ?? [], '']);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm({\n\t\tname: withDefault(department?.name, ''),\n\t\temail: withDefault(department?.email, ''),\n\t\tdescription: withDefault(department?.description, ''),\n\t\tenabled: !!department?.enabled,\n\t\tmaxNumberSimultaneousChat: department?.maxNumberSimultaneousChat,\n\t\tshowOnRegistration: !!department?.showOnRegistration,\n\t\tshowOnOfflineForm: !!department?.showOnOfflineForm,\n\t\tabandonedRoomsCloseCustomMessage: withDefault(department?.abandonedRoomsCloseCustomMessage, ''),\n\t\trequestTagBeforeClosingChat: !!department?.requestTagBeforeClosingChat,\n\t\tofflineMessageChannelName: withDefault(department?.offlineMessageChannelName, ''),\n\t\tvisitorInactivityTimeoutInSeconds: department?.visitorInactivityTimeoutInSeconds,\n\t\twaitingQueueMessage: withDefault(department?.waitingQueueMessage, ''),\n\t\tdepartmentsAllowedToForward: allowedToForwardData?.departments?.map((dep) => ({ label: dep.name, value: dep._id })) || [],\n\t\tfallbackForwardDepartment: withDefault(department?.fallbackForwardDepartment, ''),\n\t});\n\tconst {\n\t\thandleName,\n\t\thandleEmail,\n\t\thandleDescription,\n\t\thandleEnabled,\n\t\thandleMaxNumberSimultaneousChat,\n\t\thandleShowOnRegistration,\n\t\thandleShowOnOfflineForm,\n\t\thandleAbandonedRoomsCloseCustomMessage,\n\t\thandleRequestTagBeforeClosingChat,\n\t\thandleOfflineMessageChannelName,\n\t\thandleVisitorInactivityTimeoutInSeconds,\n\t\thandleWaitingQueueMessage,\n\t\thandleDepartmentsAllowedToForward,\n\t\thandleFallbackForwardDepartment,\n\t} = handlers;\n\n\tconst {\n\t\tname,\n\t\temail,\n\t\tdescription,\n\t\tenabled,\n\t\tmaxNumberSimultaneousChat,\n\t\tshowOnRegistration,\n\t\tshowOnOfflineForm,\n\t\tabandonedRoomsCloseCustomMessage,\n\t\trequestTagBeforeClosingChat,\n\t\tofflineMessageChannelName,\n\t\tvisitorInactivityTimeoutInSeconds,\n\t\twaitingQueueMessage,\n\t\tdepartmentsAllowedToForward,\n\t\tfallbackForwardDepartment,\n\t} = values;\n\n\tconst { itemsList: RoomsList, loadMoreItems: loadMoreRooms } = useRoomsList(\n\t\tuseMemo(() => ({ text: offlineMessageChannelName }), [offlineMessageChannelName]),\n\t);\n\n\tconst { phase: roomsPhase, items: roomsItems, itemCount: roomsTotal } = useRecordList(RoomsList);\n\n\tconst handleTagChipClick = (tag) => () => {\n\t\tsetTagsState(([tags, tagsText]) => [tags.filter((_tag) => _tag !== tag), tagsText]);\n\t};\n\n\tconst handleTagTextSubmit = useMutableCallback(() => {\n\t\tsetTagsState((state) => {\n\t\t\tconst [tags, tagsText] = state;\n\n\t\t\tif (tags.includes(tagsText)) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn [[...tags, tagsText], ''];\n\t\t});\n\t});\n\n\tconst handleTagTextChange = (e) => {\n\t\tsetTagsState(([tags]) => [tags, e.target.value]);\n\t};\n\n\tconst saveDepartmentInfo = useMethod('livechat:saveDepartment');\n\tconst saveDepartmentAgentsInfoOnEdit = useEndpoint('POST', `livechat/department/${id}/agents`);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [nameError, setNameError] = useState();\n\tconst [emailError, setEmailError] = useState();\n\tconst [tagError, setTagError] = useState();\n\n\tuseComponentDidUpdate(() => {\n\t\tsetNameError(!name ? t('The_field_is_required', 'name') : '');\n\t}, [t, name]);\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!email ? t('The_field_is_required', 'email') : '');\n\t}, [t, email]);\n\tuseComponentDidUpdate(() => {\n\t\tsetEmailError(!validateEmail(email) ? t('Validate_email_address') : '');\n\t}, [t, email]);\n\tuseComponentDidUpdate(() => {\n\t\tsetTagError(requestTagBeforeClosingChat && (!tags || tags.length === 0) ? t('The_field_is_required', 'name') : '');\n\t}, [requestTagBeforeClosingChat, t, tags]);\n\n\tconst handleSubmit = useMutableCallback(async (e) => {\n\t\te.preventDefault();\n\t\tlet error = false;\n\t\tif (!name) {\n\t\t\tsetNameError(t('The_field_is_required', 'name'));\n\t\t\terror = true;\n\t\t}\n\t\tif (!email) {\n\t\t\tsetEmailError(t('The_field_is_required', 'email'));\n\t\t\terror = true;\n\t\t}\n\t\tif (!validateEmail(email)) {\n\t\t\tsetEmailError(t('Validate_email_address'));\n\t\t\terror = true;\n\t\t}\n\t\tif (requestTagBeforeClosingChat && (!tags || tags.length === 0)) {\n\t\t\tsetTagError(t('The_field_is_required', 'tags'));\n\t\t\terror = true;\n\t\t}\n\n\t\tif (error) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst payload = {\n\t\t\tenabled,\n\t\t\tname,\n\t\t\tdescription,\n\t\t\tshowOnRegistration,\n\t\t\tshowOnOfflineForm,\n\t\t\trequestTagBeforeClosingChat,\n\t\t\temail,\n\t\t\tchatClosingTags: tags,\n\t\t\tofflineMessageChannelName,\n\t\t\tmaxNumberSimultaneousChat,\n\t\t\tvisitorInactivityTimeoutInSeconds,\n\t\t\tabandonedRoomsCloseCustomMessage,\n\t\t\twaitingQueueMessage,\n\t\t\tdepartmentsAllowedToForward: departmentsAllowedToForward?.map((dep) => dep.value).join(),\n\t\t\tfallbackForwardDepartment: fallbackForwardDepartment.value,\n\t\t};\n\n\t\tconst agentListPayload = {\n\t\t\tupsert: agentList.filter(\n\t\t\t\t(agent) =>\n\t\t\t\t\t!initialAgents.current.some(\n\t\t\t\t\t\t(initialAgent) => initialAgent._id === agent._id && agent.count === initialAgent.count && agent.order === initialAgent.order,\n\t\t\t\t\t),\n\t\t\t),\n\t\t\tremove: initialAgents.current.filter((initialAgent) => !agentList.some((agent) => initialAgent._id === agent._id)),\n\t\t};\n\n\t\ttry {\n\t\t\tif (id) {\n\t\t\t\tawait saveDepartmentInfo(id, payload, []);\n\t\t\t\tif (agentListPayload.upsert.length > 0 || agentListPayload.remove.length > 0) {\n\t\t\t\t\tawait saveDepartmentAgentsInfoOnEdit(agentListPayload);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait saveDepartmentInfo(id, payload, agentList);\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tdepartmentsRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\tdepartmentsRoute.push({});\n\t});\n\n\tconst invalidForm =\n\t\t!name || !email || !validateEmail(email) || !hasUnsavedChanges || (requestTagBeforeClosingChat && (!tags || tags.length === 0));\n\n\tconst formId = useUniqueId();\n\n\tconst hasNewAgent = useMemo(() => data.agents.length === agentList.length, [data.agents, agentList]);\n\n\tconst agentsHaveChanged = () => {\n\t\tlet hasChanges = false;\n\t\tif (agentList.length !== initialAgents.current.length) {\n\t\t\thasChanges = true;\n\t\t}\n\n\t\tif (agentsAdded.length > 0 && agentsRemoved.length > 0) {\n\t\t\thasChanges = true;\n\t\t}\n\n\t\tagentList.forEach((agent) => {\n\t\t\tconst existingAgent = initialAgents.current.find((initial) => initial.agentId === agent.agentId);\n\t\t\tif (existingAgent) {\n\t\t\t\tif (agent.count !== existingAgent.count) {\n\t\t\t\t\thasChanges = true;\n\t\t\t\t}\n\t\t\t\tif (agent.order !== existingAgent.order) {\n\t\t\t\t\thasChanges = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn hasChanges;\n\t};\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={title}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button onClick={handleReturn}>\n\t\t\t\t\t\t\t<Icon name='back' /> {t('Back')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button type='submit' form={formId} primary disabled={invalidForm && hasNewAgent && !(id && agentsHaveChanged())}>\n\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<FieldGroup w='full' alignSelf='center' maxWidth='x600' id={formId} is='form' autoComplete='off' onSubmit={handleSubmit}>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Enabled')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={enabled} onChange={handleEnabled} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput flexGrow={1} error={nameError} value={name} onChange={handleName} placeholder={t('Name')} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Description')}</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextAreaInput flexGrow={1} value={description} onChange={handleDescription} placeholder={t('Description')} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Show_on_registration_page')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={showOnRegistration} onChange={handleShowOnRegistration} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Email')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\terror={emailError}\n\t\t\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\t\t\taddon={<Icon name='mail' size='x20' />}\n\t\t\t\t\t\t\t\t\tonChange={handleEmail}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Email')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Show_on_offline_page')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={showOnOfflineForm} onChange={handleShowOnOfflineForm} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Livechat_DepartmentOfflineMessageToChannel')}</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<PaginatedSelectFiltered\n\t\t\t\t\t\t\t\t\tvalue={offlineMessageChannelName}\n\t\t\t\t\t\t\t\t\tonChange={handleOfflineMessageChannelName}\n\t\t\t\t\t\t\t\t\tflexShrink={0}\n\t\t\t\t\t\t\t\t\tfilter={offlineMessageChannelName}\n\t\t\t\t\t\t\t\t\tsetFilter={handleOfflineMessageChannelName}\n\t\t\t\t\t\t\t\t\toptions={roomsItems}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Channel_name')}\n\t\t\t\t\t\t\t\t\tendReached={roomsPhase === AsyncStatePhase.LOADING ? () => {} : (start) => loadMoreRooms(start, Math.min(50, roomsTotal))}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t{MaxChats && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<MaxChats\n\t\t\t\t\t\t\t\t\tvalue={maxNumberSimultaneousChat}\n\t\t\t\t\t\t\t\t\thandler={handleMaxNumberSimultaneousChat}\n\t\t\t\t\t\t\t\t\tlabel={'Max_number_of_chats_per_agent'}\n\t\t\t\t\t\t\t\t\tplaceholder='Max_number_of_chats_per_agent_description'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{VisitorInactivity && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<VisitorInactivity\n\t\t\t\t\t\t\t\t\tvalue={visitorInactivityTimeoutInSeconds}\n\t\t\t\t\t\t\t\t\thandler={handleVisitorInactivityTimeoutInSeconds}\n\t\t\t\t\t\t\t\t\tlabel={'How_long_to_wait_to_consider_visitor_abandonment_in_seconds'}\n\t\t\t\t\t\t\t\t\tplaceholder='Number_in_seconds'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{AbandonedMessageInput && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<AbandonedMessageInput\n\t\t\t\t\t\t\t\t\tvalue={abandonedRoomsCloseCustomMessage}\n\t\t\t\t\t\t\t\t\thandler={handleAbandonedRoomsCloseCustomMessage}\n\t\t\t\t\t\t\t\t\tlabel={'Livechat_abandoned_rooms_closed_custom_message'}\n\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_custom_message'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{WaitingQueueMessageInput && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<WaitingQueueMessageInput value={waitingQueueMessage} handler={handleWaitingQueueMessage} label={'Waiting_queue_message'} />\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{DepartmentForwarding && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<DepartmentForwarding\n\t\t\t\t\t\t\t\t\tdepartmentId={id}\n\t\t\t\t\t\t\t\t\tvalue={departmentsAllowedToForward}\n\t\t\t\t\t\t\t\t\thandler={handleDepartmentsAllowedToForward}\n\t\t\t\t\t\t\t\t\tlabel={'List_of_departments_for_forward'}\n\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_department_name'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{AutoCompleteDepartment && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Fallback_forward_department')}</Field.Label>\n\t\t\t\t\t\t\t\t<AutoCompleteDepartment\n\t\t\t\t\t\t\t\t\thaveNone\n\t\t\t\t\t\t\t\t\texcludeDepartmentId={department?._id}\n\t\t\t\t\t\t\t\t\tvalue={fallbackForwardDepartment}\n\t\t\t\t\t\t\t\t\tonChange={handleFallbackForwardDepartment}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Fallback_forward_department')}\n\t\t\t\t\t\t\t\t\tlabel={t('Fallback_forward_department')}\n\t\t\t\t\t\t\t\t\tonlyMyDepartments\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<Field.Label>{t('Request_tag_before_closing_chat')}</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} checked={requestTagBeforeClosingChat} onChange={handleRequestTagBeforeClosingChat} />\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t{requestTagBeforeClosingChat && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Field.Label alignSelf='stretch'>{t('Conversation_closing_tags')}*</Field.Label>\n\t\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t\t<TextInput error={tagError} value={tagsText} onChange={handleTagTextChange} placeholder={t('Enter_a_tag')} />\n\t\t\t\t\t\t\t\t\t<Button mis='x8' title={t('add')} onClick={handleTagTextSubmit}>\n\t\t\t\t\t\t\t\t\t\t{t('Add')}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t\t<Field.Hint>{t('Conversation_closing_tags_description')}</Field.Hint>\n\t\t\t\t\t\t\t\t{tags?.length > 0 && (\n\t\t\t\t\t\t\t\t\t<Field.Row justifyContent='flex-start'>\n\t\t\t\t\t\t\t\t\t\t{tags.map((tag, i) => (\n\t\t\t\t\t\t\t\t\t\t\t<Chip key={i} onClick={handleTagChipClick(tag)} mie='x8'>\n\t\t\t\t\t\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t\t\t\t\t</Chip>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{DepartmentBusinessHours && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<DepartmentBusinessHours bhId={department?.businessHourId} />\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Divider mb='x16' />\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label mb='x4'>{t('Agents')}:</Field.Label>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='column' height='50vh'>\n\t\t\t\t\t\t\t\t<DepartmentsAgentsTable\n\t\t\t\t\t\t\t\t\tagents={data && data.agents}\n\t\t\t\t\t\t\t\t\tsetAgentListFinal={setAgentList}\n\t\t\t\t\t\t\t\t\tsetAgentsAdded={setAgentsAdded}\n\t\t\t\t\t\t\t\t\tsetAgentsRemoved={setAgentsRemoved}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t</Page>\n\t);\n}\n\nexport default EditDepartment;\n"]},"sourceType":"module","hash":"888f136abac5d31b94c07420a087a5b493a2c095"}
