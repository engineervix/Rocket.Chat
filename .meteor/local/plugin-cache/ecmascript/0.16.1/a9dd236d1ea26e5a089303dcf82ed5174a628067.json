{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/utils/lib/slashCommand.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/utils/lib/slashCommand.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/utils/lib/slashCommand.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/app/utils/lib/slashCommand.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/utils/lib/slashCommand.js"}},"code":"var _typeof;\n\nmodule.link(\"@babel/runtime/helpers/typeof\", {\n  default: function (v) {\n    _typeof = v;\n  }\n}, 0);\nmodule.export({\n  slashCommands: function () {\n    return slashCommands;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar slashCommands = {\n  commands: {},\n  add: function () {\n    function _addingSlashCommand(command, callback) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var result = arguments.length > 3 ? arguments[3] : undefined;\n      var providesPreview = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var previewer = arguments.length > 5 ? arguments[5] : undefined;\n      var previewCallback = arguments.length > 6 ? arguments[6] : undefined;\n      slashCommands.commands[command] = {\n        command: command,\n        callback: callback,\n        params: options.params,\n        description: options.description,\n        permission: options.permission,\n        clientOnly: options.clientOnly || false,\n        result: result,\n        providesPreview: providesPreview,\n        previewer: previewer,\n        previewCallback: previewCallback\n      };\n    }\n\n    return _addingSlashCommand;\n  }(),\n  run: function () {\n    function _runningSlashCommand(command, params, message, triggerId) {\n      if (slashCommands.commands[command] && typeof slashCommands.commands[command].callback === 'function') {\n        if (!message || !message.rid) {\n          throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n        }\n\n        return slashCommands.commands[command].callback(command, params, message, triggerId);\n      }\n    }\n\n    return _runningSlashCommand;\n  }(),\n  getPreviews: function () {\n    function _gettingSlashCommandPreviews(command, params, message) {\n      if (slashCommands.commands[command] && typeof slashCommands.commands[command].previewer === 'function') {\n        if (!message || !message.rid) {\n          throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n        } // { i18nTitle, items: [{ id, type, value }] }\n\n\n        var previewInfo = slashCommands.commands[command].previewer(command, params, message);\n\n        if (_typeof(previewInfo) !== 'object' || !Array.isArray(previewInfo.items) || previewInfo.items.length === 0) {\n          return;\n        } // A limit of ten results, to save time and bandwidth\n\n\n        if (previewInfo.items.length >= 10) {\n          previewInfo.items = previewInfo.items.slice(0, 10);\n        }\n\n        return previewInfo;\n      }\n    }\n\n    return _gettingSlashCommandPreviews;\n  }(),\n  executePreview: function () {\n    function _executeSlashCommandPreview(command, params, message, preview, triggerId) {\n      if (slashCommands.commands[command] && typeof slashCommands.commands[command].previewCallback === 'function') {\n        if (!message || !message.rid) {\n          throw new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n        } // { id, type, value }\n\n\n        if (!preview.id || !preview.type || !preview.value) {\n          throw new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');\n        }\n\n        return slashCommands.commands[command].previewCallback(command, params, message, preview, triggerId);\n      }\n    }\n\n    return _executeSlashCommandPreview;\n  }()\n};\nMeteor.methods({\n  slashCommand: function (command) {\n    if (!Meteor.userId()) {\n      throw new Meteor.Error('error-invalid-user', 'Invalid user', {\n        method: 'slashCommand'\n      });\n    }\n\n    if (!command || !command.cmd || !slashCommands.commands[command.cmd]) {\n      throw new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n        method: 'executeSlashCommandPreview'\n      });\n    }\n\n    return slashCommands.run(command.cmd, command.params, command.msg, command.triggerId);\n  }\n});","map":{"version":3,"sources":["app/utils/lib/slashCommand.js"],"names":["_typeof","module","link","default","v","export","slashCommands","Meteor","commands","add","_addingSlashCommand","command","callback","options","result","providesPreview","previewer","previewCallback","params","description","permission","clientOnly","run","_runningSlashCommand","message","triggerId","rid","Error","getPreviews","_gettingSlashCommandPreviews","previewInfo","Array","isArray","items","length","slice","executePreview","_executeSlashCommandPreview","preview","id","type","value","methods","slashCommand","userId","method","cmd","msg"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nexport const slashCommands = {\n\tcommands: {},\n\tadd: function _addingSlashCommand(command, callback, options = {}, result, providesPreview = false, previewer, previewCallback) {\n\t\tslashCommands.commands[command] = {\n\t\t\tcommand,\n\t\t\tcallback,\n\t\t\tparams: options.params,\n\t\t\tdescription: options.description,\n\t\t\tpermission: options.permission,\n\t\t\tclientOnly: options.clientOnly || false,\n\t\t\tresult,\n\t\t\tprovidesPreview,\n\t\t\tpreviewer,\n\t\t\tpreviewCallback,\n\t\t};\n\t},\n\trun: function _runningSlashCommand(command, params, message, triggerId) {\n\t\tif (slashCommands.commands[command] && typeof slashCommands.commands[command].callback === 'function') {\n\t\t\tif (!message || !message.rid) {\n\t\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t\t}\n\t\t\treturn slashCommands.commands[command].callback(command, params, message, triggerId);\n\t\t}\n\t},\n\tgetPreviews: function _gettingSlashCommandPreviews(command, params, message) {\n\t\tif (slashCommands.commands[command] && typeof slashCommands.commands[command].previewer === 'function') {\n\t\t\tif (!message || !message.rid) {\n\t\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t\t}\n\n\t\t\t// { i18nTitle, items: [{ id, type, value }] }\n\t\t\tconst previewInfo = slashCommands.commands[command].previewer(command, params, message);\n\n\t\t\tif (typeof previewInfo !== 'object' || !Array.isArray(previewInfo.items) || previewInfo.items.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// A limit of ten results, to save time and bandwidth\n\t\t\tif (previewInfo.items.length >= 10) {\n\t\t\t\tpreviewInfo.items = previewInfo.items.slice(0, 10);\n\t\t\t}\n\n\t\t\treturn previewInfo;\n\t\t}\n\t},\n\texecutePreview: function _executeSlashCommandPreview(command, params, message, preview, triggerId) {\n\t\tif (slashCommands.commands[command] && typeof slashCommands.commands[command].previewCallback === 'function') {\n\t\t\tif (!message || !message.rid) {\n\t\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t\t}\n\n\t\t\t// { id, type, value }\n\t\t\tif (!preview.id || !preview.type || !preview.value) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');\n\t\t\t}\n\n\t\t\treturn slashCommands.commands[command].previewCallback(command, params, message, preview, triggerId);\n\t\t}\n\t},\n};\n\nMeteor.methods({\n\tslashCommand(command) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'slashCommand',\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\t\treturn slashCommands.run(command.cmd, command.params, command.msg, command.triggerId);\n\t},\n});\n"]},"sourceType":"module","hash":"a9dd236d1ea26e5a089303dcf82ed5174a628067"}
