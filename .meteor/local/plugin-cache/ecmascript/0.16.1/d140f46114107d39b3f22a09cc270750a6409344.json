{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/app/auditing/client/templates/audit/audit.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"ee/app/auditing/client/templates/audit/audit.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/app/auditing/client/templates/audit/audit.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/app/auditing/client/templates/audit/audit.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/app/auditing/client/templates/audit/audit.js"}},"code":"let _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 0);\nlet Template;\nmodule.link(\"meteor/templating\", {\n  Template(v) {\n    Template = v;\n  }\n\n}, 0);\nlet ReactiveVar;\nmodule.link(\"meteor/reactive-var\", {\n  ReactiveVar(v) {\n    ReactiveVar = v;\n  }\n\n}, 1);\nlet FlowRouter;\nmodule.link(\"meteor/kadira:flow-router\", {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 2);\nlet hasAllPermission;\nmodule.link(\"../../../../../../app/authorization/client\", {\n  hasAllPermission(v) {\n    hasAllPermission = v;\n  }\n\n}, 3);\nlet messageContext;\nmodule.link(\"../../../../../../app/ui-utils/client/lib/messageContext\", {\n  messageContext(v) {\n    messageContext = v;\n  }\n\n}, 4);\nlet call;\nmodule.link(\"../../utils.js\", {\n  call(v) {\n    call = v;\n  }\n\n}, 5);\nmodule.link(\"./audit.html\");\n\nconst loadMessages = async function (_ref) {\n  let {\n    rid,\n    users,\n    startDate,\n    endDate = new Date(),\n    msg,\n    type,\n    visitor,\n    agent\n  } = _ref;\n  this.messages = this.messages || new ReactiveVar([]);\n  this.loading = this.loading || new ReactiveVar(true);\n\n  try {\n    this.loading.set(true);\n    const messages = type === 'l' ? await call('auditGetOmnichannelMessages', {\n      rid,\n      users,\n      startDate,\n      endDate,\n      msg,\n      type,\n      visitor,\n      agent\n    }) : await call('auditGetMessages', {\n      rid,\n      users,\n      startDate,\n      endDate,\n      msg,\n      type,\n      visitor,\n      agent\n    });\n    this.messagesContext.set(_objectSpread(_objectSpread({}, messageContext({\n      rid\n    })), {}, {\n      messages\n    }));\n  } catch (e) {\n    this.messagesContext.set({});\n  } finally {\n    this.loading.set(false);\n  }\n};\n\nTemplate.audit.helpers({\n  isLoading() {\n    return Template.instance().loading.get();\n  },\n\n  messageContext() {\n    return Template.instance().messagesContext.get();\n  },\n\n  hasResults() {\n    return Template.instance().hasResults.get();\n  }\n\n});\nTemplate.audit.onCreated(async function () {\n  this.messagesContext = new ReactiveVar({});\n  this.loading = new ReactiveVar(false);\n  this.hasResults = new ReactiveVar(false);\n\n  if (!hasAllPermission('can-audit')) {\n    return FlowRouter.go('/home');\n  }\n\n  this.autorun(() => {\n    const messagesContext = this.messagesContext.get();\n    this.hasResults.set(messagesContext && messagesContext.messages && messagesContext.messages.length > 0);\n  });\n  this.loadMessages = loadMessages.bind(this);\n  const {\n    visitor,\n    agent,\n    users,\n    rid\n  } = this.data;\n\n  if (rid || users.length || agent || visitor) {\n    await this.loadMessages(this.data);\n  }\n});","map":{"version":3,"sources":["ee/app/auditing/client/templates/audit/audit.js"],"names":["_objectSpread","module","link","default","v","Template","ReactiveVar","FlowRouter","hasAllPermission","messageContext","call","loadMessages","rid","users","startDate","endDate","Date","msg","type","visitor","agent","messages","loading","set","messagesContext","e","audit","helpers","isLoading","instance","get","hasResults","onCreated","go","autorun","length","bind","data"],"mappings":"AAAA,IAAIA,aAAJ;;AAAkBC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,CAACC,CAAD,EAAG;AAACJ,IAAAA,aAAa,GAACI,CAAd;AAAgB;;AAA5B,CAAnD,EAAiF,CAAjF;AAAlB,IAAIC,QAAJ;AAAaJ,MAAM,CAACC,IAAP,CAAY,mBAAZ,EAAgC;AAACG,EAAAA,QAAQ,CAACD,CAAD,EAAG;AAACC,IAAAA,QAAQ,GAACD,CAAT;AAAW;;AAAxB,CAAhC,EAA0D,CAA1D;AAA6D,IAAIE,WAAJ;AAAgBL,MAAM,CAACC,IAAP,CAAY,qBAAZ,EAAkC;AAACI,EAAAA,WAAW,CAACF,CAAD,EAAG;AAACE,IAAAA,WAAW,GAACF,CAAZ;AAAc;;AAA9B,CAAlC,EAAkE,CAAlE;AAAqE,IAAIG,UAAJ;AAAeN,MAAM,CAACC,IAAP,CAAY,2BAAZ,EAAwC;AAACK,EAAAA,UAAU,CAACH,CAAD,EAAG;AAACG,IAAAA,UAAU,GAACH,CAAX;AAAa;;AAA5B,CAAxC,EAAsE,CAAtE;AAAyE,IAAII,gBAAJ;AAAqBP,MAAM,CAACC,IAAP,CAAY,4CAAZ,EAAyD;AAACM,EAAAA,gBAAgB,CAACJ,CAAD,EAAG;AAACI,IAAAA,gBAAgB,GAACJ,CAAjB;AAAmB;;AAAxC,CAAzD,EAAmG,CAAnG;AAAsG,IAAIK,cAAJ;AAAmBR,MAAM,CAACC,IAAP,CAAY,0DAAZ,EAAuE;AAACO,EAAAA,cAAc,CAACL,CAAD,EAAG;AAACK,IAAAA,cAAc,GAACL,CAAf;AAAiB;;AAApC,CAAvE,EAA6G,CAA7G;AAAgH,IAAIM,IAAJ;AAAST,MAAM,CAACC,IAAP,CAAY,gBAAZ,EAA6B;AAACQ,EAAAA,IAAI,CAACN,CAAD,EAAG;AAACM,IAAAA,IAAI,GAACN,CAAL;AAAO;;AAAhB,CAA7B,EAA+C,CAA/C;AAAkDH,MAAM,CAACC,IAAP,CAAY,cAAZ;;AAUhjB,MAAMS,YAAY,GAAG,sBAA4F;AAAA,MAA5E;AAAEC,IAAAA,GAAF;AAAOC,IAAAA,KAAP;AAAcC,IAAAA,SAAd;AAAyBC,IAAAA,OAAO,GAAG,IAAIC,IAAJ,EAAnC;AAA+CC,IAAAA,GAA/C;AAAoDC,IAAAA,IAApD;AAA0DC,IAAAA,OAA1D;AAAmEC,IAAAA;AAAnE,GAA4E;AAChH,OAAKC,QAAL,GAAgB,KAAKA,QAAL,IAAiB,IAAIf,WAAJ,CAAgB,EAAhB,CAAjC;AACA,OAAKgB,OAAL,GAAe,KAAKA,OAAL,IAAgB,IAAIhB,WAAJ,CAAgB,IAAhB,CAA/B;;AACA,MAAI;AACH,SAAKgB,OAAL,CAAaC,GAAb,CAAiB,IAAjB;AACA,UAAMF,QAAQ,GACbH,IAAI,KAAK,GAAT,GACG,MAAMR,IAAI,CAAC,6BAAD,EAAgC;AAC1CE,MAAAA,GAD0C;AAE1CC,MAAAA,KAF0C;AAG1CC,MAAAA,SAH0C;AAI1CC,MAAAA,OAJ0C;AAK1CE,MAAAA,GAL0C;AAM1CC,MAAAA,IAN0C;AAO1CC,MAAAA,OAP0C;AAQ1CC,MAAAA;AAR0C,KAAhC,CADb,GAWG,MAAMV,IAAI,CAAC,kBAAD,EAAqB;AAC/BE,MAAAA,GAD+B;AAE/BC,MAAAA,KAF+B;AAG/BC,MAAAA,SAH+B;AAI/BC,MAAAA,OAJ+B;AAK/BE,MAAAA,GAL+B;AAM/BC,MAAAA,IAN+B;AAO/BC,MAAAA,OAP+B;AAQ/BC,MAAAA;AAR+B,KAArB,CAZd;AAsBA,SAAKI,eAAL,CAAqBD,GAArB,iCACId,cAAc,CAAC;AAAEG,MAAAA;AAAF,KAAD,CADlB;AAECS,MAAAA;AAFD;AAIA,GA5BD,CA4BE,OAAOI,CAAP,EAAU;AACX,SAAKD,eAAL,CAAqBD,GAArB,CAAyB,EAAzB;AACA,GA9BD,SA8BU;AACT,SAAKD,OAAL,CAAaC,GAAb,CAAiB,KAAjB;AACA;AACD,CApCD;;AAsCAlB,QAAQ,CAACqB,KAAT,CAAeC,OAAf,CAAuB;AACtBC,EAAAA,SAAS,GAAG;AACX,WAAOvB,QAAQ,CAACwB,QAAT,GAAoBP,OAApB,CAA4BQ,GAA5B,EAAP;AACA,GAHqB;;AAItBrB,EAAAA,cAAc,GAAG;AAChB,WAAOJ,QAAQ,CAACwB,QAAT,GAAoBL,eAApB,CAAoCM,GAApC,EAAP;AACA,GANqB;;AAOtBC,EAAAA,UAAU,GAAG;AACZ,WAAO1B,QAAQ,CAACwB,QAAT,GAAoBE,UAApB,CAA+BD,GAA/B,EAAP;AACA;;AATqB,CAAvB;AAYAzB,QAAQ,CAACqB,KAAT,CAAeM,SAAf,CAAyB,kBAAkB;AAC1C,OAAKR,eAAL,GAAuB,IAAIlB,WAAJ,CAAgB,EAAhB,CAAvB;AACA,OAAKgB,OAAL,GAAe,IAAIhB,WAAJ,CAAgB,KAAhB,CAAf;AACA,OAAKyB,UAAL,GAAkB,IAAIzB,WAAJ,CAAgB,KAAhB,CAAlB;;AAEA,MAAI,CAACE,gBAAgB,CAAC,WAAD,CAArB,EAAoC;AACnC,WAAOD,UAAU,CAAC0B,EAAX,CAAc,OAAd,CAAP;AACA;;AAED,OAAKC,OAAL,CAAa,MAAM;AAClB,UAAMV,eAAe,GAAG,KAAKA,eAAL,CAAqBM,GAArB,EAAxB;AAEA,SAAKC,UAAL,CAAgBR,GAAhB,CAAoBC,eAAe,IAAIA,eAAe,CAACH,QAAnC,IAA+CG,eAAe,CAACH,QAAhB,CAAyBc,MAAzB,GAAkC,CAArG;AACA,GAJD;AAMA,OAAKxB,YAAL,GAAoBA,YAAY,CAACyB,IAAb,CAAkB,IAAlB,CAApB;AAEA,QAAM;AAAEjB,IAAAA,OAAF;AAAWC,IAAAA,KAAX;AAAkBP,IAAAA,KAAlB;AAAyBD,IAAAA;AAAzB,MAAiC,KAAKyB,IAA5C;;AACA,MAAIzB,GAAG,IAAIC,KAAK,CAACsB,MAAb,IAAuBf,KAAvB,IAAgCD,OAApC,EAA6C;AAC5C,UAAM,KAAKR,YAAL,CAAkB,KAAK0B,IAAvB,CAAN;AACA;AACD,CArBD","sourcesContent":["import { Template } from 'meteor/templating';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\n\nimport { hasAllPermission } from '../../../../../../app/authorization/client';\nimport { messageContext } from '../../../../../../app/ui-utils/client/lib/messageContext';\nimport { call } from '../../utils.js';\n\nimport './audit.html';\n\nconst loadMessages = async function ({ rid, users, startDate, endDate = new Date(), msg, type, visitor, agent }) {\n\tthis.messages = this.messages || new ReactiveVar([]);\n\tthis.loading = this.loading || new ReactiveVar(true);\n\ttry {\n\t\tthis.loading.set(true);\n\t\tconst messages =\n\t\t\ttype === 'l'\n\t\t\t\t? await call('auditGetOmnichannelMessages', {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\tusers,\n\t\t\t\t\t\tstartDate,\n\t\t\t\t\t\tendDate,\n\t\t\t\t\t\tmsg,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t\tvisitor,\n\t\t\t\t\t\tagent,\n\t\t\t\t  })\n\t\t\t\t: await call('auditGetMessages', {\n\t\t\t\t\t\trid,\n\t\t\t\t\t\tusers,\n\t\t\t\t\t\tstartDate,\n\t\t\t\t\t\tendDate,\n\t\t\t\t\t\tmsg,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t\tvisitor,\n\t\t\t\t\t\tagent,\n\t\t\t\t  });\n\t\tthis.messagesContext.set({\n\t\t\t...messageContext({ rid }),\n\t\t\tmessages,\n\t\t});\n\t} catch (e) {\n\t\tthis.messagesContext.set({});\n\t} finally {\n\t\tthis.loading.set(false);\n\t}\n};\n\nTemplate.audit.helpers({\n\tisLoading() {\n\t\treturn Template.instance().loading.get();\n\t},\n\tmessageContext() {\n\t\treturn Template.instance().messagesContext.get();\n\t},\n\thasResults() {\n\t\treturn Template.instance().hasResults.get();\n\t},\n});\n\nTemplate.audit.onCreated(async function () {\n\tthis.messagesContext = new ReactiveVar({});\n\tthis.loading = new ReactiveVar(false);\n\tthis.hasResults = new ReactiveVar(false);\n\n\tif (!hasAllPermission('can-audit')) {\n\t\treturn FlowRouter.go('/home');\n\t}\n\n\tthis.autorun(() => {\n\t\tconst messagesContext = this.messagesContext.get();\n\n\t\tthis.hasResults.set(messagesContext && messagesContext.messages && messagesContext.messages.length > 0);\n\t});\n\n\tthis.loadMessages = loadMessages.bind(this);\n\n\tconst { visitor, agent, users, rid } = this.data;\n\tif (rid || users.length || agent || visitor) {\n\t\tawait this.loadMessages(this.data);\n\t}\n});\n"]},"sourceType":"module","hash":"d140f46114107d39b3f22a09cc270750a6409344"}
