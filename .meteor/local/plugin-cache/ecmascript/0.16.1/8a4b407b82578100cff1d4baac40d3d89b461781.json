{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/omnichannel/units/UnitEdit.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"ee/client/omnichannel/units/UnitEdit.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/omnichannel/units/UnitEdit.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/ee/client/omnichannel/units/UnitEdit.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/client/omnichannel/units/UnitEdit.js"}},"code":"const _excluded = [\"title\", \"data\", \"unitId\", \"isNew\", \"unitMonitors\", \"unitDepartments\", \"reload\"];\n\nlet _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 1);\nlet Field, TextInput, Button, PaginatedMultiSelectFiltered, Select, ButtonGroup, Icon, FieldGroup;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field(v) {\n    Field = v;\n  },\n\n  TextInput(v) {\n    TextInput = v;\n  },\n\n  Button(v) {\n    Button = v;\n  },\n\n  PaginatedMultiSelectFiltered(v) {\n    PaginatedMultiSelectFiltered = v;\n  },\n\n  Select(v) {\n    Select = v;\n  },\n\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  },\n\n  FieldGroup(v) {\n    FieldGroup = v;\n  }\n\n}, 0);\nlet useMutableCallback, useDebouncedValue;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  },\n\n  useDebouncedValue(v) {\n    useDebouncedValue = v;\n  }\n\n}, 1);\nlet React, useMemo, useState;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useMemo(v) {\n    useMemo = v;\n  },\n\n  useState(v) {\n    useState = v;\n  }\n\n}, 2);\nlet Page;\nmodule.link(\"../../../../client/components/Page\", {\n  default(v) {\n    Page = v;\n  }\n\n}, 3);\nlet useRoute;\nmodule.link(\"../../../../client/contexts/RouterContext\", {\n  useRoute(v) {\n    useRoute = v;\n  }\n\n}, 4);\nlet useMethod;\nmodule.link(\"../../../../client/contexts/ServerContext\", {\n  useMethod(v) {\n    useMethod = v;\n  }\n\n}, 5);\nlet useToastMessageDispatch;\nmodule.link(\"../../../../client/contexts/ToastMessagesContext\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  }\n\n}, 6);\nlet useTranslation;\nmodule.link(\"../../../../client/contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 7);\nlet useRecordList;\nmodule.link(\"../../../../client/hooks/lists/useRecordList\", {\n  useRecordList(v) {\n    useRecordList = v;\n  }\n\n}, 8);\nlet AsyncStatePhase;\nmodule.link(\"../../../../client/hooks/useAsyncState\", {\n  AsyncStatePhase(v) {\n    AsyncStatePhase = v;\n  }\n\n}, 9);\nlet useForm;\nmodule.link(\"../../../../client/hooks/useForm\", {\n  useForm(v) {\n    useForm = v;\n  }\n\n}, 10);\nlet useDepartmentsByUnitsList;\nmodule.link(\"../../../../client/views/hooks/useDepartmentsByUnitsList\", {\n  useDepartmentsByUnitsList(v) {\n    useDepartmentsByUnitsList = v;\n  }\n\n}, 11);\nlet useMonitorsList;\nmodule.link(\"../../../../client/views/hooks/useMonitorsList\", {\n  useMonitorsList(v) {\n    useMonitorsList = v;\n  }\n\n}, 12);\n\nfunction UnitEdit(_ref) {\n  let {\n    title,\n    data,\n    unitId,\n    isNew,\n    unitMonitors,\n    unitDepartments,\n    reload\n  } = _ref,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  const t = useTranslation();\n  const unitsRoute = useRoute('omnichannel-units');\n  const [monitorsFilter, setMonitorsFilter] = useState('');\n  const debouncedMonitorsFilter = useDebouncedValue(monitorsFilter, 500);\n  const [departmentsFilter, setDepartmentsFilter] = useState('');\n  const debouncedDepartmentsFilter = useDebouncedValue(departmentsFilter, 500);\n  const {\n    itemsList: monitorsList,\n    loadMoreItems: loadMoreMonitors\n  } = useMonitorsList(useMemo(() => ({\n    filter: debouncedMonitorsFilter\n  }), [debouncedMonitorsFilter]));\n  const {\n    phase: monitorsPhase,\n    items: monitorsItems,\n    itemCount: monitorsTotal\n  } = useRecordList(monitorsList);\n  const {\n    itemsList: departmentsList,\n    loadMoreItems: loadMoreDepartments\n  } = useDepartmentsByUnitsList(useMemo(() => ({\n    filter: debouncedDepartmentsFilter,\n    unitId\n  }), [debouncedDepartmentsFilter, unitId]));\n  const {\n    phase: departmentsPhase,\n    items: departmentsItems,\n    itemCount: departmentsTotal\n  } = useRecordList(departmentsList);\n  const departmentsSortedByName = departmentsItems.sort((a, b) => {\n    if (a.name > b.name) {\n      return 1;\n    }\n\n    if (a.name < b.name) {\n      return -1;\n    }\n\n    return 0;\n  });\n  const unit = data || {};\n  const currUnitMonitors = useMemo(() => unitMonitors && unitMonitors.monitors ? unitMonitors.monitors.map(_ref2 => {\n    let {\n      monitorId,\n      username\n    } = _ref2;\n    return {\n      value: monitorId,\n      label: username\n    };\n  }) : [], [unitMonitors]);\n  const visibilityOpts = [['public', t('Public')], ['private', t('Private')]];\n  const currUnitDepartments = useMemo(() => unitDepartments && unitDepartments.departments && unitId ? unitDepartments.departments.map(_ref3 => {\n    let {\n      _id,\n      name\n    } = _ref3;\n    return {\n      value: _id,\n      label: name\n    };\n  }) : [], [unitDepartments, unitId]);\n  const {\n    values,\n    handlers,\n    hasUnsavedChanges\n  } = useForm({\n    name: unit.name,\n    visibility: unit.visibility,\n    departments: currUnitDepartments,\n    monitors: currUnitMonitors\n  });\n  const {\n    handleName,\n    handleVisibility,\n    handleDepartments,\n    handleMonitors\n  } = handlers;\n  const {\n    name,\n    visibility,\n    departments,\n    monitors\n  } = values;\n  const nameError = useMemo(() => !name || name.length === 0 ? t('The_field_is_required', t('name')) : undefined, [name, t]);\n  const visibilityError = useMemo(() => !visibility || visibility.length === 0 ? t('The_field_is_required', t('description')) : undefined, [visibility, t]);\n  const departmentError = useMemo(() => !departments || departments.length === 0 ? t('The_field_is_required', t('departments')) : undefined, [departments, t]);\n  const unitMonitorsError = useMemo(() => !monitors || monitors.length === 0 ? t('The_field_is_required', t('monitors')) : undefined, [monitors, t]);\n  const saveUnit = useMethod('livechat:saveUnit');\n  const dispatchToastMessage = useToastMessageDispatch();\n  const handleReturn = useMutableCallback(() => {\n    unitsRoute.push({});\n  });\n  const canSave = useMemo(() => !nameError && !visibilityError && !departmentError && !unitMonitorsError, [nameError, visibilityError, departmentError, unitMonitorsError]);\n  const handleSave = useMutableCallback(async () => {\n    const unitData = {\n      name,\n      visibility\n    };\n    const departmentsData = departments.map(department => ({\n      departmentId: department.value\n    }));\n    const monitorsData = monitors.map(monitor => ({\n      monitorId: monitor.value,\n      username: monitor.label\n    }));\n\n    if (!canSave) {\n      return dispatchToastMessage({\n        type: 'error',\n        message: t('The_field_is_required')\n      });\n    }\n\n    try {\n      await saveUnit(unitId, unitData, monitorsData, departmentsData);\n      dispatchToastMessage({\n        type: 'success',\n        message: t('Saved')\n      });\n      reload();\n      unitsRoute.push({});\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  });\n  return /*#__PURE__*/React.createElement(Page, {\n    flexDirection: \"row\"\n  }, /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(Page.Header, {\n    title: title\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, /*#__PURE__*/React.createElement(Button, {\n    onClick: handleReturn\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"back\"\n  }), \" \", t('Back')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    mie: \"none\",\n    flexGrow: 1,\n    disabled: !hasUnsavedChanges || !canSave,\n    onClick: handleSave\n  }, t('Save')))), /*#__PURE__*/React.createElement(Page.ScrollableContentWithShadow, null, /*#__PURE__*/React.createElement(FieldGroup, _extends({\n    w: \"full\",\n    alignSelf: \"center\",\n    maxWidth: \"x600\",\n    is: \"form\",\n    autoComplete: \"off\"\n  }, props), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Name'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(TextInput, {\n    placeholder: t('Name'),\n    flexGrow: 1,\n    value: name,\n    onChange: handleName,\n    error: hasUnsavedChanges && nameError\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Visibility'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(Select, {\n    options: visibilityOpts,\n    value: visibility,\n    error: hasUnsavedChanges && visibilityError,\n    placeholder: t('Select_an_option'),\n    onChange: handleVisibility,\n    flexGrow: 1\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Departments'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(PaginatedMultiSelectFiltered, {\n    withTitle: true,\n    filter: departmentsFilter,\n    setFilter: setDepartmentsFilter,\n    options: departmentsSortedByName,\n    value: departments,\n    error: hasUnsavedChanges && departmentError,\n    maxWidth: \"100%\",\n    placeholder: t('Select_an_option'),\n    onChange: handleDepartments,\n    flexGrow: 1,\n    endReached: departmentsPhase === AsyncStatePhase.LOADING ? () => {} : start => loadMoreDepartments(start, Math.min(50, departmentsTotal))\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Field.Label, null, t('Monitors'), \"*\"), /*#__PURE__*/React.createElement(Field.Row, null, /*#__PURE__*/React.createElement(PaginatedMultiSelectFiltered, {\n    withTitle: true,\n    filter: monitorsFilter,\n    setFilter: setMonitorsFilter,\n    options: monitorsItems,\n    value: monitors,\n    error: hasUnsavedChanges && unitMonitorsError,\n    maxWidth: \"100%\",\n    placeholder: t('Select_an_option'),\n    onChange: handleMonitors,\n    flexGrow: 1,\n    endReached: monitorsPhase === AsyncStatePhase.LOADING ? () => {} : start => loadMoreMonitors(start, Math.min(50, monitorsTotal))\n  })))))));\n}\n\nmodule.exportDefault(UnitEdit);","map":{"version":3,"sources":["ee/client/omnichannel/units/UnitEdit.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","Field","TextInput","Button","PaginatedMultiSelectFiltered","Select","ButtonGroup","Icon","FieldGroup","useMutableCallback","useDebouncedValue","React","useMemo","useState","Page","useRoute","useMethod","useToastMessageDispatch","useTranslation","useRecordList","AsyncStatePhase","useForm","useDepartmentsByUnitsList","useMonitorsList","UnitEdit","title","data","unitId","isNew","unitMonitors","unitDepartments","reload","props","t","unitsRoute","monitorsFilter","setMonitorsFilter","debouncedMonitorsFilter","departmentsFilter","setDepartmentsFilter","debouncedDepartmentsFilter","itemsList","monitorsList","loadMoreItems","loadMoreMonitors","filter","phase","monitorsPhase","items","monitorsItems","itemCount","monitorsTotal","departmentsList","loadMoreDepartments","departmentsPhase","departmentsItems","departmentsTotal","departmentsSortedByName","sort","a","b","name","unit","currUnitMonitors","monitors","map","monitorId","username","value","label","visibilityOpts","currUnitDepartments","departments","_id","values","handlers","hasUnsavedChanges","visibility","handleName","handleVisibility","handleDepartments","handleMonitors","nameError","length","undefined","visibilityError","departmentError","unitMonitorsError","saveUnit","dispatchToastMessage","handleReturn","push","canSave","handleSave","unitData","departmentsData","department","departmentId","monitorsData","monitor","type","message","error","LOADING","start","Math","min","exportDefault"],"mappings":"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","sourcesContent":["import { Field, TextInput, Button, PaginatedMultiSelectFiltered, Select, ButtonGroup, Icon, FieldGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback, useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport React, { useMemo, useState } from 'react';\n\nimport Page from '../../../../client/components/Page';\nimport { useRoute } from '../../../../client/contexts/RouterContext';\nimport { useMethod } from '../../../../client/contexts/ServerContext';\nimport { useToastMessageDispatch } from '../../../../client/contexts/ToastMessagesContext';\nimport { useTranslation } from '../../../../client/contexts/TranslationContext';\nimport { useRecordList } from '../../../../client/hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../client/hooks/useAsyncState';\nimport { useForm } from '../../../../client/hooks/useForm';\nimport { useDepartmentsByUnitsList } from '../../../../client/views/hooks/useDepartmentsByUnitsList';\nimport { useMonitorsList } from '../../../../client/views/hooks/useMonitorsList';\n\nfunction UnitEdit({ title, data, unitId, isNew, unitMonitors, unitDepartments, reload, ...props }) {\n\tconst t = useTranslation();\n\tconst unitsRoute = useRoute('omnichannel-units');\n\tconst [monitorsFilter, setMonitorsFilter] = useState('');\n\n\tconst debouncedMonitorsFilter = useDebouncedValue(monitorsFilter, 500);\n\n\tconst [departmentsFilter, setDepartmentsFilter] = useState('');\n\n\tconst debouncedDepartmentsFilter = useDebouncedValue(departmentsFilter, 500);\n\n\tconst { itemsList: monitorsList, loadMoreItems: loadMoreMonitors } = useMonitorsList(\n\t\tuseMemo(() => ({ filter: debouncedMonitorsFilter }), [debouncedMonitorsFilter]),\n\t);\n\n\tconst { phase: monitorsPhase, items: monitorsItems, itemCount: monitorsTotal } = useRecordList(monitorsList);\n\n\tconst { itemsList: departmentsList, loadMoreItems: loadMoreDepartments } = useDepartmentsByUnitsList(\n\t\tuseMemo(() => ({ filter: debouncedDepartmentsFilter, unitId }), [debouncedDepartmentsFilter, unitId]),\n\t);\n\n\tconst { phase: departmentsPhase, items: departmentsItems, itemCount: departmentsTotal } = useRecordList(departmentsList);\n\n\tconst departmentsSortedByName = departmentsItems.sort((a, b) => {\n\t\tif (a.name > b.name) {\n\t\t\treturn 1;\n\t\t}\n\t\tif (a.name < b.name) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn 0;\n\t});\n\n\tconst unit = data || {};\n\n\tconst currUnitMonitors = useMemo(\n\t\t() =>\n\t\t\tunitMonitors && unitMonitors.monitors\n\t\t\t\t? unitMonitors.monitors.map(({ monitorId, username }) => ({\n\t\t\t\t\t\tvalue: monitorId,\n\t\t\t\t\t\tlabel: username,\n\t\t\t\t  }))\n\t\t\t\t: [],\n\t\t[unitMonitors],\n\t);\n\tconst visibilityOpts = [\n\t\t['public', t('Public')],\n\t\t['private', t('Private')],\n\t];\n\n\tconst currUnitDepartments = useMemo(\n\t\t() =>\n\t\t\tunitDepartments && unitDepartments.departments && unitId\n\t\t\t\t? unitDepartments.departments.map(({ _id, name }) => ({\n\t\t\t\t\t\tvalue: _id,\n\t\t\t\t\t\tlabel: name,\n\t\t\t\t  }))\n\t\t\t\t: [],\n\t\t[unitDepartments, unitId],\n\t);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm({\n\t\tname: unit.name,\n\t\tvisibility: unit.visibility,\n\t\tdepartments: currUnitDepartments,\n\t\tmonitors: currUnitMonitors,\n\t});\n\n\tconst { handleName, handleVisibility, handleDepartments, handleMonitors } = handlers;\n\tconst { name, visibility, departments, monitors } = values;\n\n\tconst nameError = useMemo(() => (!name || name.length === 0 ? t('The_field_is_required', t('name')) : undefined), [name, t]);\n\tconst visibilityError = useMemo(\n\t\t() => (!visibility || visibility.length === 0 ? t('The_field_is_required', t('description')) : undefined),\n\t\t[visibility, t],\n\t);\n\tconst departmentError = useMemo(\n\t\t() => (!departments || departments.length === 0 ? t('The_field_is_required', t('departments')) : undefined),\n\t\t[departments, t],\n\t);\n\tconst unitMonitorsError = useMemo(\n\t\t() => (!monitors || monitors.length === 0 ? t('The_field_is_required', t('monitors')) : undefined),\n\t\t[monitors, t],\n\t);\n\n\tconst saveUnit = useMethod('livechat:saveUnit');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\tunitsRoute.push({});\n\t});\n\n\tconst canSave = useMemo(\n\t\t() => !nameError && !visibilityError && !departmentError && !unitMonitorsError,\n\t\t[nameError, visibilityError, departmentError, unitMonitorsError],\n\t);\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst unitData = { name, visibility };\n\t\tconst departmentsData = departments.map((department) => ({ departmentId: department.value }));\n\t\tconst monitorsData = monitors.map((monitor) => ({\n\t\t\tmonitorId: monitor.value,\n\t\t\tusername: monitor.label,\n\t\t}));\n\n\t\tif (!canSave) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('The_field_is_required') });\n\t\t}\n\n\t\ttry {\n\t\t\tawait saveUnit(unitId, unitData, monitorsData, departmentsData);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tunitsRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={title}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button onClick={handleReturn}>\n\t\t\t\t\t\t\t<Icon name='back' /> {t('Back')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button primary mie='none' flexGrow={1} disabled={!hasUnsavedChanges || !canSave} onClick={handleSave}>\n\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<FieldGroup w='full' alignSelf='center' maxWidth='x600' is='form' autoComplete='off' {...props}>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Name')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<TextInput placeholder={t('Name')} flexGrow={1} value={name} onChange={handleName} error={hasUnsavedChanges && nameError} />\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Visibility')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\toptions={visibilityOpts}\n\t\t\t\t\t\t\t\t\tvalue={visibility}\n\t\t\t\t\t\t\t\t\terror={hasUnsavedChanges && visibilityError}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Select_an_option')}\n\t\t\t\t\t\t\t\t\tonChange={handleVisibility}\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Departments')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<PaginatedMultiSelectFiltered\n\t\t\t\t\t\t\t\t\twithTitle\n\t\t\t\t\t\t\t\t\tfilter={departmentsFilter}\n\t\t\t\t\t\t\t\t\tsetFilter={setDepartmentsFilter}\n\t\t\t\t\t\t\t\t\toptions={departmentsSortedByName}\n\t\t\t\t\t\t\t\t\tvalue={departments}\n\t\t\t\t\t\t\t\t\terror={hasUnsavedChanges && departmentError}\n\t\t\t\t\t\t\t\t\tmaxWidth='100%'\n\t\t\t\t\t\t\t\t\tplaceholder={t('Select_an_option')}\n\t\t\t\t\t\t\t\t\tonChange={handleDepartments}\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\t\t\t\tdepartmentsPhase === AsyncStatePhase.LOADING\n\t\t\t\t\t\t\t\t\t\t\t? () => {}\n\t\t\t\t\t\t\t\t\t\t\t: (start) => loadMoreDepartments(start, Math.min(50, departmentsTotal))\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Field.Label>{t('Monitors')}*</Field.Label>\n\t\t\t\t\t\t\t<Field.Row>\n\t\t\t\t\t\t\t\t<PaginatedMultiSelectFiltered\n\t\t\t\t\t\t\t\t\twithTitle\n\t\t\t\t\t\t\t\t\tfilter={monitorsFilter}\n\t\t\t\t\t\t\t\t\tsetFilter={setMonitorsFilter}\n\t\t\t\t\t\t\t\t\toptions={monitorsItems}\n\t\t\t\t\t\t\t\t\tvalue={monitors}\n\t\t\t\t\t\t\t\t\terror={hasUnsavedChanges && unitMonitorsError}\n\t\t\t\t\t\t\t\t\tmaxWidth='100%'\n\t\t\t\t\t\t\t\t\tplaceholder={t('Select_an_option')}\n\t\t\t\t\t\t\t\t\tonChange={handleMonitors}\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\t\t\t\tmonitorsPhase === AsyncStatePhase.LOADING ? () => {} : (start) => loadMoreMonitors(start, Math.min(50, monitorsTotal))\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field.Row>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t</Page>\n\t);\n}\n\nexport default UnitEdit;\n"]},"sourceType":"module","hash":"8a4b407b82578100cff1d4baac40d3d89b461781"}
