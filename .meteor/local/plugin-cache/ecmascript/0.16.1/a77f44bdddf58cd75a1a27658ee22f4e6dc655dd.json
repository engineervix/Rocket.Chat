{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/apps/AppLogsPage.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/apps/AppLogsPage.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/apps/AppLogsPage.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/client/views/admin/apps/AppLogsPage.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/apps/AppLogsPage.js"}},"code":"const _excluded = [\"id\"];\n\nlet _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 1);\n\nlet _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 2);\nlet Box, Button, ButtonGroup, Icon, Accordion, Pagination;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  },\n\n  Button(v) {\n    Button = v;\n  },\n\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n\n  Icon(v) {\n    Icon = v;\n  },\n\n  Accordion(v) {\n    Accordion = v;\n  },\n\n  Pagination(v) {\n    Pagination = v;\n  }\n\n}, 0);\nlet useSafely;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useSafely(v) {\n    useSafely = v;\n  }\n\n}, 1);\nlet React, useCallback, useState, useEffect;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n\n  useCallback(v) {\n    useCallback = v;\n  },\n\n  useState(v) {\n    useState = v;\n  },\n\n  useEffect(v) {\n    useEffect = v;\n  }\n\n}, 2);\nlet Page;\nmodule.link(\"../../../components/Page\", {\n  default(v) {\n    Page = v;\n  }\n\n}, 3);\nlet useCurrentRoute, useRoute;\nmodule.link(\"../../../contexts/RouterContext\", {\n  useCurrentRoute(v) {\n    useCurrentRoute = v;\n  },\n\n  useRoute(v) {\n    useRoute = v;\n  }\n\n}, 4);\nlet useEndpoint;\nmodule.link(\"../../../contexts/ServerContext\", {\n  useEndpoint(v) {\n    useEndpoint = v;\n  }\n\n}, 5);\nlet useTranslation;\nmodule.link(\"../../../contexts/TranslationContext\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n\n}, 6);\nlet useFormatDateAndTime;\nmodule.link(\"../../../hooks/useFormatDateAndTime\", {\n  useFormatDateAndTime(v) {\n    useFormatDateAndTime = v;\n  }\n\n}, 7);\nlet LogItem;\nmodule.link(\"./LogItem\", {\n  default(v) {\n    LogItem = v;\n  }\n\n}, 8);\nlet LogsLoading;\nmodule.link(\"./LogsLoading\", {\n  default(v) {\n    LogsLoading = v;\n  }\n\n}, 9);\n\nconst useAppWithLogs = _ref => {\n  let {\n    id,\n    current,\n    itemsPerPage\n  } = _ref;\n  const [data, setData] = useSafely(useState({}));\n  const getAppData = useEndpoint('GET', \"/apps/\".concat(id));\n  const getAppLogs = useEndpoint('GET', \"/apps/\".concat(id, \"/logs\"));\n  const fetchData = useCallback(async () => {\n    try {\n      const [{\n        app\n      }, {\n        logs\n      }] = await Promise.all([getAppData(), getAppLogs()]);\n      setData(_objectSpread(_objectSpread({}, app), {}, {\n        logs\n      }));\n    } catch (error) {\n      setData({\n        error\n      });\n    }\n  }, [getAppData, getAppLogs, setData]);\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n  const sliceStart = data.logs && current > data.logs.length ? 0 : current;\n  const total = data.logs ? data.logs.length : 0;\n  const filteredData = data.logs ? _objectSpread(_objectSpread({}, data), {}, {\n    logs: data.logs.slice(sliceStart, itemsPerPage + current)\n  }) : data;\n  return [filteredData, total, fetchData];\n};\n\nfunction AppLogsPage(_ref2) {\n  let {\n    id\n  } = _ref2,\n      props = _objectWithoutProperties(_ref2, _excluded);\n\n  const t = useTranslation();\n  const formatDateAndTime = useFormatDateAndTime();\n  const [itemsPerPage, setItemsPerPage] = useState(25);\n  const [current, setCurrent] = useState(0);\n  const [app, logEntriesCount, fetchData] = useAppWithLogs({\n    id,\n    itemsPerPage,\n    current\n  });\n  const [currentRouteName] = useCurrentRoute();\n  const appLogsRoute = useRoute(currentRouteName);\n\n  const handleResetButtonClick = () => {\n    fetchData();\n  };\n\n  const handleBackButtonClick = () => {\n    appLogsRoute.push();\n  };\n\n  const loading = !Object.values(app).length;\n  const showData = !loading && !app.error;\n  const showingResultsLabel = useCallback(_ref3 => {\n    let {\n      count,\n      current,\n      itemsPerPage\n    } = _ref3;\n    return t('Showing_results_of', current + 1, Math.min(current + itemsPerPage, count), count);\n  }, [t]);\n  const itemsPerPageLabel = useCallback(() => t('Items_per_page:'), [t]);\n  return /*#__PURE__*/React.createElement(Page, _extends({\n    flexDirection: \"column\"\n  }, props), /*#__PURE__*/React.createElement(Page.Header, {\n    title: t('View_the_Logs_for', {\n      name: app.name || ''\n    })\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleResetButtonClick\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"undo\"\n  }), \" \", t('Refresh')), /*#__PURE__*/React.createElement(Button, {\n    onClick: handleBackButtonClick\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"back\"\n  }), \" \", t('Back')))), /*#__PURE__*/React.createElement(Page.ScrollableContent, null, loading && /*#__PURE__*/React.createElement(LogsLoading, null), app.error && /*#__PURE__*/React.createElement(Box, {\n    maxWidth: \"x600\",\n    alignSelf: \"center\",\n    fontScale: \"hh21\"\n  }, app.error.message), showData && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Accordion, {\n    maxWidth: \"x600\",\n    alignSelf: \"center\"\n  }, app.logs && app.logs.map(log => /*#__PURE__*/React.createElement(LogItem, {\n    key: log._createdAt,\n    title: \"\".concat(formatDateAndTime(log._createdAt), \": \\\"\").concat(log.method, \"\\\" (\").concat(log.totalTime, \"ms)\"),\n    instanceId: log.instanceId,\n    entries: log.entries\n  }))))), /*#__PURE__*/React.createElement(Pagination, {\n    mi: \"x24\",\n    divider: true,\n    current: current,\n    itemsPerPage: itemsPerPage,\n    itemsPerPageLabel: itemsPerPageLabel,\n    showingResultsLabel: showingResultsLabel,\n    count: logEntriesCount,\n    onSetItemsPerPage: setItemsPerPage,\n    onSetCurrent: setCurrent\n  }));\n}\n\nmodule.exportDefault(AppLogsPage);","map":{"version":3,"sources":["client/views/admin/apps/AppLogsPage.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","_objectSpread","Box","Button","ButtonGroup","Icon","Accordion","Pagination","useSafely","React","useCallback","useState","useEffect","Page","useCurrentRoute","useRoute","useEndpoint","useTranslation","useFormatDateAndTime","LogItem","LogsLoading","useAppWithLogs","id","current","itemsPerPage","data","setData","getAppData","getAppLogs","fetchData","app","logs","Promise","all","error","sliceStart","length","total","filteredData","slice","AppLogsPage","props","t","formatDateAndTime","setItemsPerPage","setCurrent","logEntriesCount","currentRouteName","appLogsRoute","handleResetButtonClick","handleBackButtonClick","push","loading","Object","values","showData","showingResultsLabel","count","Math","min","itemsPerPageLabel","name","message","map","log","_createdAt","method","totalTime","instanceId","entries","exportDefault"],"mappings":"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","sourcesContent":["import { Box, Button, ButtonGroup, Icon, Accordion, Pagination } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport React, { useCallback, useState, useEffect } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useCurrentRoute, useRoute } from '../../../contexts/RouterContext';\nimport { useEndpoint } from '../../../contexts/ServerContext';\nimport { useTranslation } from '../../../contexts/TranslationContext';\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\nimport LogItem from './LogItem';\nimport LogsLoading from './LogsLoading';\n\nconst useAppWithLogs = ({ id, current, itemsPerPage }) => {\n\tconst [data, setData] = useSafely(useState({}));\n\tconst getAppData = useEndpoint('GET', `/apps/${id}`);\n\tconst getAppLogs = useEndpoint('GET', `/apps/${id}/logs`);\n\n\tconst fetchData = useCallback(async () => {\n\t\ttry {\n\t\t\tconst [{ app }, { logs }] = await Promise.all([getAppData(), getAppLogs()]);\n\t\t\tsetData({ ...app, logs });\n\t\t} catch (error) {\n\t\t\tsetData({ error });\n\t\t}\n\t}, [getAppData, getAppLogs, setData]);\n\n\tuseEffect(() => {\n\t\tfetchData();\n\t}, [fetchData]);\n\n\tconst sliceStart = data.logs && current > data.logs.length ? 0 : current;\n\tconst total = data.logs ? data.logs.length : 0;\n\tconst filteredData = data.logs ? { ...data, logs: data.logs.slice(sliceStart, itemsPerPage + current) } : data;\n\n\treturn [filteredData, total, fetchData];\n};\n\nfunction AppLogsPage({ id, ...props }) {\n\tconst t = useTranslation();\n\tconst formatDateAndTime = useFormatDateAndTime();\n\tconst [itemsPerPage, setItemsPerPage] = useState(25);\n\tconst [current, setCurrent] = useState(0);\n\n\tconst [app, logEntriesCount, fetchData] = useAppWithLogs({ id, itemsPerPage, current });\n\n\tconst [currentRouteName] = useCurrentRoute();\n\tconst appLogsRoute = useRoute(currentRouteName);\n\n\tconst handleResetButtonClick = () => {\n\t\tfetchData();\n\t};\n\n\tconst handleBackButtonClick = () => {\n\t\tappLogsRoute.push();\n\t};\n\n\tconst loading = !Object.values(app).length;\n\tconst showData = !loading && !app.error;\n\n\tconst showingResultsLabel = useCallback(\n\t\t({ count, current, itemsPerPage }) => t('Showing_results_of', current + 1, Math.min(current + itemsPerPage, count), count),\n\t\t[t],\n\t);\n\tconst itemsPerPageLabel = useCallback(() => t('Items_per_page:'), [t]);\n\n\treturn (\n\t\t<Page flexDirection='column' {...props}>\n\t\t\t<Page.Header title={t('View_the_Logs_for', { name: app.name || '' })}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary onClick={handleResetButtonClick}>\n\t\t\t\t\t\t<Icon name='undo' /> {t('Refresh')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button onClick={handleBackButtonClick}>\n\t\t\t\t\t\t<Icon name='back' /> {t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContent>\n\t\t\t\t{loading && <LogsLoading />}\n\t\t\t\t{app.error && (\n\t\t\t\t\t<Box maxWidth='x600' alignSelf='center' fontScale='hh21'>\n\t\t\t\t\t\t{app.error.message}\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t{showData && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Accordion maxWidth='x600' alignSelf='center'>\n\t\t\t\t\t\t\t{app.logs &&\n\t\t\t\t\t\t\t\tapp.logs.map((log) => (\n\t\t\t\t\t\t\t\t\t<LogItem\n\t\t\t\t\t\t\t\t\t\tkey={log._createdAt}\n\t\t\t\t\t\t\t\t\t\ttitle={`${formatDateAndTime(log._createdAt)}: \"${log.method}\" (${log.totalTime}ms)`}\n\t\t\t\t\t\t\t\t\t\tinstanceId={log.instanceId}\n\t\t\t\t\t\t\t\t\t\tentries={log.entries}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</Accordion>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Page.ScrollableContent>\n\n\t\t\t<Pagination\n\t\t\t\tmi='x24'\n\t\t\t\tdivider\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\titemsPerPageLabel={itemsPerPageLabel}\n\t\t\t\tshowingResultsLabel={showingResultsLabel}\n\t\t\t\tcount={logEntriesCount}\n\t\t\t\tonSetItemsPerPage={setItemsPerPage}\n\t\t\t\tonSetCurrent={setCurrent}\n\t\t\t/>\n\t\t</Page>\n\t);\n}\n\nexport default AppLogsPage;\n"]},"sourceType":"module","hash":"a77f44bdddf58cd75a1a27658ee22f4e6dc655dd"}
